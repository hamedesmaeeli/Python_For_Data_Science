{
 "cells": [
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "f34856e8",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "station_geo \n",
      "       station_co  district_n          x           y\n",
      "0           1129           7  563030.95  3615891.13\n",
      "1           1154           7  564271.98  3615841.64\n",
      "2           1155           7  564024.45  3615856.68\n",
      "3           1190           7  563032.43  3615642.03\n",
      "4           1212           7  563608.63  3615871.86\n",
      "...          ...         ...        ...         ...\n",
      "2725         132           8  560349.63  3619997.18\n",
      "2726         133           8  561637.98  3619868.29\n",
      "2727         134           8  561637.98  3619868.29\n",
      "2728         135           8  562395.97  3618967.34\n",
      "2729         137           8  562843.09  3618183.53\n",
      "\n",
      "[2730 rows x 4 columns]\n",
      "Zones : \n",
      "  [ 1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16]\n",
      "Number of stations :  16\n",
      "od_matrix_df \n",
      "      1    2    3    4    5    6    7    8    9    10   11   12   13   14   15  \\\n",
      "1   0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0   \n",
      "2   0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0   \n",
      "3   0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0   \n",
      "4   0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0   \n",
      "5   0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0   \n",
      "6   0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0   \n",
      "7   0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0   \n",
      "8   0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0   \n",
      "9   0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0   \n",
      "10  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0   \n",
      "11  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0   \n",
      "12  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0   \n",
      "13  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0   \n",
      "14  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0   \n",
      "15  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0   \n",
      "16  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0   \n",
      "\n",
      "     16  \n",
      "1   0.0  \n",
      "2   0.0  \n",
      "3   0.0  \n",
      "4   0.0  \n",
      "5   0.0  \n",
      "6   0.0  \n",
      "7   0.0  \n",
      "8   0.0  \n",
      "9   0.0  \n",
      "10  0.0  \n",
      "11  0.0  \n",
      "12  0.0  \n",
      "13  0.0  \n",
      "14  0.0  \n",
      "15  0.0  \n",
      "16  0.0  \n",
      "bus_records_raw \n",
      "              CardID  LineCode       FDate   Time  plat\n",
      "0        2491304948        83  1398/06/23  36631  E219\n",
      "1        4276627762        83  1398/06/23  36965  E219\n",
      "2        3209862820        83  1398/06/23  36948  E219\n",
      "3        1835095101        83  1398/06/23  37641  E219\n",
      "4        2741823204        83  1398/06/23  39235  E219\n",
      "...             ...       ...         ...    ...   ...\n",
      "6596011   722029228      1001  1398/07/10  46072   D70\n",
      "6596012  4061449629      1001  1398/07/10  46074   D70\n",
      "6596013  3210041924      1001  1398/07/10  46076   D70\n",
      "6596014  3102002446      1001  1398/07/10  46080   D70\n",
      "6596015  3108922901      1001  1398/07/10  46157   D70\n",
      "\n",
      "[6596016 rows x 5 columns]\n",
      "bus_records after remove duplicates \n",
      "              CardID  LineCode       FDate   Time  plat\n",
      "0        2491304948        83  1398/06/23  36631  E219\n",
      "1        4276627762        83  1398/06/23  36965  E219\n",
      "2        3209862820        83  1398/06/23  36948  E219\n",
      "3        1835095101        83  1398/06/23  37641  E219\n",
      "4        2741823204        83  1398/06/23  39235  E219\n",
      "...             ...       ...         ...    ...   ...\n",
      "6596011   722029228      1001  1398/07/10  46072   D70\n",
      "6596012  4061449629      1001  1398/07/10  46074   D70\n",
      "6596013  3210041924      1001  1398/07/10  46076   D70\n",
      "6596014  3102002446      1001  1398/07/10  46080   D70\n",
      "6596015  3108922901      1001  1398/07/10  46157   D70\n",
      "\n",
      "[6001481 rows x 5 columns]\n",
      "Get the bus_records after sorting:\n",
      "              CardID  LineCode       FDate   Time  plat\n",
      "328847    542446139         1  1398/06/23  24030  A145\n",
      "328848   2620656172         1  1398/06/23  24302  A145\n",
      "328849   3446252780         1  1398/06/23  26200  A145\n",
      "328850   1281272526         1  1398/06/23  26446  A145\n",
      "328851    981010891         1  1398/06/23  26449  A145\n",
      "...             ...       ...         ...    ...   ...\n",
      "6514542   428903246      1028  1398/07/11  64517  N132\n",
      "6514543   721781564      1028  1398/07/11  64778  N132\n",
      "6514544  3603875324      1028  1398/07/11  64836  N132\n",
      "6514545  2048368098      1028  1398/07/11  65184  N132\n",
      "6514546  3405829442      1028  1398/07/11  65742  N132\n",
      "\n",
      "[6001481 rows x 5 columns]\n",
      "Bus routes \n",
      "       station_code  line order go_back                   station_name  \\\n",
      "0             3169     1     1      go                    ????-157-57   \n",
      "1             3170     1     2      go                ???? ???? ?????   \n",
      "2             3172     1     3      go                          ?????   \n",
      "3             3175     1     4      go                     ??? ??????   \n",
      "4             3177     1     5      go                          ?????   \n",
      "...            ...   ...   ...     ...                            ...   \n",
      "5023          2898  brt3    28    back                         ??????   \n",
      "5024          2885  brt3    29    back                ????? ???? ????   \n",
      "5025          2886  brt3    30    back                      ???? ????   \n",
      "5026          3931  brt3    31    back                          ?????   \n",
      "5027          2870  brt3    32    back  ?????? ????? ????????-????? 3   \n",
      "\n",
      "      geo_width  geo_length station_type roate_type in_terminal  \n",
      "0     51.731912   32.720558           od     normal          no  \n",
      "1     51.728978   32.715887       normal     normal          no  \n",
      "2     51.727200   32.712987       normal     normal          no  \n",
      "3     51.725108   32.710537       normal     normal          no  \n",
      "4     51.720581   32.707897       normal     normal          no  \n",
      "...         ...         ...          ...        ...         ...  \n",
      "5023  51.763670   32.654585       normal        BRT          no  \n",
      "5024  51.768907   32.652085       normal        BRT          no  \n",
      "5025  51.774118   32.649536       normal        BRT          no  \n",
      "5026  51.775672   32.648610       normal     normal          no  \n",
      "5027  51.783792   32.645565           od     normal         yes  \n",
      "\n",
      "[5028 rows x 10 columns]\n",
      "metro_records_raw \n",
      "             CardID  gate_id       FDate   Time\n",
      "0        114043411      137  1398/06/27  62191\n",
      "1       2502119140      137  1398/06/27  62215\n",
      "2          7743732      137  1398/06/27  62236\n",
      "3        885624044      137  1398/06/27  62241\n",
      "4       3700852613      137  1398/06/27  62250\n",
      "...            ...      ...         ...    ...\n",
      "814781  3405942033      137  1398/06/27  37711\n",
      "814782  2505470036      137  1398/06/27  37726\n",
      "814783  2505470036      137  1398/06/27  37732\n",
      "814784  4265814114      137  1398/06/27  37745\n",
      "814785  4058911741      137  1398/06/27  37921\n",
      "\n",
      "[814786 rows x 4 columns]\n",
      "metro_records after remove duplicates \n",
      "             CardID  gate_id       FDate   Time\n",
      "0        114043411      137  1398/06/27  62191\n",
      "1       2502119140      137  1398/06/27  62215\n",
      "2          7743732      137  1398/06/27  62236\n",
      "3        885624044      137  1398/06/27  62241\n",
      "4       3700852613      137  1398/06/27  62250\n",
      "...            ...      ...         ...    ...\n",
      "416276  2500276068      137  1398/06/27  62109\n",
      "416277  2137068445      137  1398/06/27  62124\n",
      "416278   885624044      137  1398/06/27  62139\n",
      "416279   261327025      137  1398/06/27  62153\n",
      "416280   233310170      137  1398/06/27  62186\n",
      "\n",
      "[406617 rows x 4 columns]\n",
      "Get the metro_records after sorting:\n",
      "             CardID  gate_id       FDate   Time\n",
      "115624  3553272220      126  1398/06/23  22910\n",
      "117207  3151596446      126  1398/06/23  22917\n",
      "117208  3794635356      126  1398/06/23  22925\n",
      "117209   293791323      126  1398/06/23  22930\n",
      "115354  2681130596      126  1398/06/23  22950\n",
      "...            ...      ...         ...    ...\n",
      "183000   722206651      154  1398/06/28  73997\n",
      "183001   722206651      154  1398/06/28  74003\n",
      "183238   869461393      154  1398/06/28  74134\n",
      "183239   721972958      154  1398/06/28  74164\n",
      "183240  3213414628      154  1398/06/28  74169\n",
      "\n",
      "[406617 rows x 4 columns]\n",
      "Fdates in Bus records \n",
      " ['1398/06/23' '1398/06/24' '1398/06/25' '1398/06/26' '1398/06/27'\n",
      " '1398/06/28' '1398/07/06' '1398/07/07' '1398/07/08' '1398/07/09'\n",
      " '1398/07/10' '1398/07/11']\n",
      "Fdates in metro records \n",
      " ['1398/06/23' '1398/06/24' '1398/06/25' '1398/06/26' '1398/06/27'\n",
      " '1398/06/28']\n",
      "**** FDate****  1398/06/23\n",
      "Bus transactions in fdate 1398/06/23 \n",
      "\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "             CardID  LineCode       FDate   Time  plat\n",
      "328847    542446139         1  1398/06/23  24030  A145\n",
      "328848   2620656172         1  1398/06/23  24302  A145\n",
      "328849   3446252780         1  1398/06/23  26200  A145\n",
      "328850   1281272526         1  1398/06/23  26446  A145\n",
      "328851    981010891         1  1398/06/23  26449  A145\n",
      "...             ...       ...         ...    ...   ...\n",
      "3347256  3256171325      1019  1398/06/23  26450   A23\n",
      "3347257   636295002      1019  1398/06/23  26572   A23\n",
      "3347258  3104840174      1019  1398/06/23  26961   A23\n",
      "3347259   636322666      1019  1398/06/23  26966   A23\n",
      "3347260  3256171325      1019  1398/06/23  26999   A23\n",
      "\n",
      "[470576 rows x 5 columns]\n",
      "Metro transactions in fdate 1398/06/23 \n",
      "\n",
      "            CardID  gate_id       FDate   Time\n",
      "115624  3553272220      126  1398/06/23  22910\n",
      "117207  3151596446      126  1398/06/23  22917\n",
      "117208  3794635356      126  1398/06/23  22925\n",
      "117209   293791323      126  1398/06/23  22930\n",
      "115354  2681130596      126  1398/06/23  22950\n",
      "...            ...      ...         ...    ...\n",
      "24721   3676368338      154  1398/06/23  76900\n",
      "24212   4270756674      154  1398/06/23  76903\n",
      "393176  3108568869      154  1398/06/23  76905\n",
      "24722   4240943639      154  1398/06/23  76908\n",
      "24723   1957859172      154  1398/06/23  77038\n",
      "\n",
      "[68964 rows x 4 columns]\n",
      "unique Line Codes: \n",
      "  [1, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 16, 17, 18, 19, 20, 22, 24, 25, 26, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 52, 53, 54, 55, 56, 57, 58, 59, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 79, 80, 81, 82, 83, 84, 85, 86, 88, 90, 91, 92, 94, 95, 96, 97, 98, 101, 102, 103, 106, 120, 145, 146, 147, 149, 150, 151, 152, 155, 156, 157, 167, 176, 267, 998, 1001, 1002, 1003, 1004, 1005, 1006, 1007, 1008, 1010, 1011, 1012, 1013, 1015, 1018, 1019]\n",
      "unique plats: \n",
      "  ['A145' 'A148' 'A34' 'B25' 'C16' 'C62' 'C65' 'D23' 'D33' 'D35' 'D44' 'D92'\n",
      " 'D94' 'E31' 'E52' 'E55' 'F82' 'M50' 'N11' 'N167' 'N54' 'N77' 'A41' 'F143'\n",
      " 'M32' 'M69' 'N32' 'N85' 'N86' 'A142' 'A51' 'B118' 'B52' 'E106' 'E166'\n",
      " 'E213' 'E26' 'F20' 'F64' 'N35' 'A38' 'B129' 'E135' 'E160' 'E163' 'E172'\n",
      " 'E177' 'E191' 'F47' 'F56' 'M100' 'A131' 'A134' 'D96' 'E193' 'E224' 'E241'\n",
      " 'F28' 'F35' 'F71' 'F86' 'M89' 'N17' 'N33' 'E110' 'E16' 'F29' 'M67' 'N118'\n",
      " 'N193' 'A35' 'A45' 'A50' 'B125' 'B63' 'B75' 'E12' 'E126' 'F97' 'M198'\n",
      " 'N111' 'N179' 'A144' 'A17' 'A31' 'D49' 'D52' 'E187' 'F11' 'F118' 'F150'\n",
      " 'F152' 'F153' 'F21' 'F81' 'M39' 'N190' 'A49' 'B62' 'D31' 'F161' 'F167'\n",
      " 'F168' 'F172' 'F181' 'F182' 'M12' 'M21' 'M22' 'N143' 'N97' 'F106' 'M34'\n",
      " 'N13' 'N72' 'D79' 'E206' 'F27' 'M128' 'N115' 'A141' 'B66' 'D28' 'E120'\n",
      " 'F108' 'F173' 'M121' 'M205' 'M96' 'N71' 'A65' 'B39' 'C17' 'C24' 'D47'\n",
      " 'E131' 'E132' 'E188' 'E33' 'E92' 'F149' 'F176' 'M45' 'M77' 'N175' 'N182'\n",
      " 'N82' 'A117' 'A126' 'A129' 'F183' 'F58' 'F74' 'M149' 'M153' 'A110' 'E236'\n",
      " 'F70' 'F80' 'M116' 'N18' 'A112' 'E238' 'E243' 'F40' 'F85' 'N58' 'A166'\n",
      " 'E142' 'E46' 'F130' 'M133' 'M54' 'M56' 'M57' 'M86' 'N100' 'N106' 'C57'\n",
      " 'D55' 'D95' 'E109' 'E212' 'E36' 'E39' 'F121' 'F98' 'F99' 'N199' 'N37'\n",
      " 'N89' 'A140' 'A154' 'A158' 'A64' 'B38' 'E169' 'F117' 'F146' 'F174' 'M146'\n",
      " 'M52' 'A27' 'B69' 'D86' 'E174' 'E240' 'F18' 'F63' 'M152' 'M36' 'M75'\n",
      " 'N113' 'N157' 'A120' 'A151' 'A152' 'A160' 'B126' 'C58' 'D13' 'D15' 'D50'\n",
      " 'D72' 'E65' 'M150' 'M178' 'M202' 'M70' 'N121' 'N20' 'N96' 'A118' 'B14'\n",
      " 'B20' 'B73' 'C36' 'C37' 'E228' 'F138' 'F139' 'F145' 'M190' 'M211' 'N125'\n",
      " 'N161' 'N169' 'N75' 'A29' 'B17' 'B55' 'B78' 'C12' 'C49' 'E15' 'E170'\n",
      " 'E62' 'F92' 'M134' 'M139' 'M140' 'M209' 'M37' 'M58' 'M76' 'N162' 'B42'\n",
      " 'M138' 'M97' 'N107' 'N153' 'B45' 'B48' 'B51' 'B68' 'B74' 'B77' 'C20'\n",
      " 'C64' 'D80' 'E214' 'F175' 'F26' 'M41' 'M44' 'E88' 'B64' 'D41' 'F90'\n",
      " 'M101' 'M158' 'A12' 'A130' 'A48' 'A53' 'A59' 'B112' 'B113' 'C40' 'E179'\n",
      " 'F101' 'M104' 'M105' 'M106' 'M111' 'M113' 'M118' 'M144' 'M159' 'M169'\n",
      " 'M170' 'M177' 'M180' 'M181' 'M185' 'M186' 'M188' 'M193' 'M194' 'M197'\n",
      " 'M55' 'M82' 'M99' 'N105' 'N110' 'N124' 'N128' 'N129' 'N134' 'N136' 'N141'\n",
      " 'N15' 'N98' 'B41' 'E116' 'E156' 'E198' 'E204' 'E82' 'F65' 'N117' 'N39'\n",
      " 'E105' 'N196' 'D69' 'F154' 'F169' 'M15' 'M84' 'C42' 'D48' 'F103' 'E112'\n",
      " 'F96' 'A163' 'E230' 'F111' 'F114' 'F128' 'F136' 'F141' 'M212' 'M43'\n",
      " 'N159' 'N163' 'N78' 'A146' 'A164' 'F163' 'F46' 'F87' 'M11' 'M137' 'M60'\n",
      " 'M66' 'N93' 'B111' 'B34' 'D17' 'D53' 'D60' 'D61' 'E202' 'E216' 'E75'\n",
      " 'M124' 'M167' 'M192' 'N120' 'N140' 'N60' 'C15' 'C41' 'C60' 'D25' 'D26'\n",
      " 'D34' 'D75' 'D76' 'E73' 'F142' 'M117' 'M16' 'M183' 'M40' 'N102' 'N198'\n",
      " 'N70' 'B56' 'C11' 'C14' 'E24' 'M200' 'E113' 'E207' 'F177' 'F44' 'M115'\n",
      " 'A47' 'E107' 'E183' 'F159' 'F19' 'M135' 'M195' 'M95' 'A20' 'C23' 'D68'\n",
      " 'D84' 'D91' 'F54' 'M48' 'A153' 'E136' 'M83' 'A114' 'A62' 'B110' 'B23'\n",
      " 'B70' 'E123' 'E233' 'E41' 'M91' 'A128' 'B33' 'E205' 'A162' 'B114' 'E192'\n",
      " 'E218' 'F157' 'M109' 'M123' 'M143' 'M174' 'N114' 'N64' 'D64' 'B32' 'B53'\n",
      " 'D83' 'E150' 'E17' 'M112' 'M78' 'N103' 'N108' 'N135' 'N137' 'N87' 'E100'\n",
      " 'E101' 'E146' 'E176' 'E184' 'E223' 'E42' 'E96' 'F30' 'F34' 'N31' 'N51'\n",
      " 'N38' 'A18' 'A58' 'B115' 'B116' 'B21' 'E130' 'E76' 'F137' 'M120' 'M126'\n",
      " 'M130' 'M151' 'M187' 'M23' 'M64' 'M81' 'N187' 'N76' 'B61' 'F122' 'F59'\n",
      " 'M131' 'B121' 'B16' 'B26' 'B36' 'B49' 'C52' 'C53' 'D85' 'F31' 'F41' 'F43'\n",
      " 'N133' 'N69' 'E148' 'E182' 'E79' 'M122' 'M166' 'C33' 'F133' 'M71' 'M72'\n",
      " 'A123' 'A157' 'A63' 'B124' 'D36' 'D59' 'N185' 'C63' 'E43' 'M25' 'A159'\n",
      " 'A21' 'A37' 'D20' 'E175' 'E178' 'M38' 'N180' 'N21' 'N28' 'N99' 'A155'\n",
      " 'A167' 'F15' 'F178' 'M182' 'M29' 'A61' 'B12' 'B65' 'C25' 'N109' 'N144'\n",
      " 'A124' 'A136' 'C39' 'C54' 'D54' 'E129' 'E13' 'E40' 'E94' 'F127' 'F66'\n",
      " 'F91' 'N116' 'N197' 'A113' 'B127' 'B128' 'B130' 'E138' 'E159' 'E167'\n",
      " 'E181' 'E77' 'E91' 'F53' 'F57' 'M161' 'M171' 'M172' 'M175' 'M176' 'M19'\n",
      " 'N126' 'N131' 'N147' 'N148' 'N149' 'N150' 'N151' 'N26' 'N29' 'N30' 'N40'\n",
      " 'N41' 'N42' 'N43' 'N44' 'N47' 'N48' 'N55' 'N56' 'N61' 'N62' 'N79' 'N80'\n",
      " 'N83' 'N84' 'A133' 'D90' 'E217' 'E242' 'F144' 'F23' 'F33' 'M62' 'M80'\n",
      " 'A125' 'C21' 'C44' 'E152' 'E220' 'E30' 'E32' 'E49' 'E85' 'F14' 'N67'\n",
      " 'E56' 'E72' 'M28' 'M47' 'E58' 'M35' 'A135' 'A67' 'E157' 'M145' 'N14'\n",
      " 'A119' 'C50' 'C56' 'E134' 'M125' 'M164' 'N188' 'A66' 'B119' 'B13' 'D24'\n",
      " 'D77' 'E115' 'E225' 'F105' 'F107' 'F131' 'M119' 'M13' 'M162' 'M92' 'N192'\n",
      " 'N22' 'N34' 'B22' 'B37' 'C28' 'E196' 'E199' 'E231' 'F12' 'F148' 'F39'\n",
      " 'M114' 'A150' 'B19' 'E151' 'E44' 'E51' 'F135' 'F17' 'F180' 'F48' 'M160'\n",
      " 'M53' 'N158' 'N16' 'A143' 'A52' 'B11' 'C35' 'C61' 'D18' 'D19' 'D46' 'E61'\n",
      " 'F115' 'F88' 'M102' 'M110' 'N101' 'N154' 'N156' 'N160' 'N170' 'N25' 'N81'\n",
      " 'N95' 'A122' 'A132' 'A139' 'E140' 'F124' 'F126' 'F42' 'F69' 'M154' 'B59'\n",
      " 'C59' 'E34' 'F132' 'F67' 'F78' 'M129' 'A13' 'A137' 'A161' 'A40' 'D16'\n",
      " 'D87' 'E200' 'E219' 'F102' 'F32' 'F84' 'M108' 'N181' 'N66' 'N73' 'F22'\n",
      " 'N90' 'A138' 'A54' 'D30' 'D38' 'D73' 'D81' 'E143' 'E189' 'E53' 'E66'\n",
      " 'F109' 'F120' 'F164' 'F37' 'F60' 'M165' 'M210' 'N172' 'A26' 'A69' 'D14'\n",
      " 'E114' 'F116' 'F119' 'F151' 'F68' 'N122' 'N164' 'N171' 'N200' 'N46'\n",
      " 'F129' 'E68' 'F38' 'M157' 'M173' 'B29' 'B50' 'B54' 'B71' 'C19' 'C66'\n",
      " 'D12' 'D22' 'D63' 'D78' 'D89' 'E127' 'E29' 'E35' 'M127' 'M199' 'M201'\n",
      " 'N139' 'N168' 'N173' 'N174' 'N178' 'N183' 'N191' 'N23' 'A116' 'A24' 'C43'\n",
      " 'C46' 'D39' 'D58' 'D67' 'E158' 'E22' 'E226' 'E28' 'E70' 'E84' 'E98' 'E99'\n",
      " 'F112' 'M163' 'N127' 'N19' 'N49' 'N88' 'B117' 'B24' 'B76' 'C22' 'D11'\n",
      " 'D21' 'D43' 'E128' 'E145' 'E153' 'E25' 'E47' 'E54' 'E63' 'E86' 'N166'\n",
      " 'B43' 'D71' 'F166' 'B31' 'E125' 'E221' 'E59' 'F125' 'M147' 'C47' 'A30'\n",
      " 'A55' 'C18' 'F95' 'A60' 'N195' 'C32' 'D32' 'E201' 'F162' 'F62' 'C27'\n",
      " 'N146' 'M42' 'M46' 'E234' 'M59' 'E171' 'M107' 'E211' 'E209' 'F16' 'F76'\n",
      " 'M179' 'M27' 'D62' 'E14' 'E194' 'E195' 'E21' 'E239' 'E78' 'E87' 'F13'\n",
      " 'N50' 'E37' 'M148' 'B44' 'E117' 'C55' 'M18' 'A43' 'A111' 'A147' 'A68'\n",
      " 'D40' 'D57' 'D65' 'D70' 'E141' 'E20' 'E27' 'E45' 'M14' 'M142' 'M168'\n",
      " 'M17' 'M203' 'M206' 'A16' 'B72' 'C30' 'N155' 'A33' 'A42' 'A71' 'C13'\n",
      " 'C31' 'E232' 'F110' 'N57' 'N65' 'A156' 'B40' 'C34' 'D66' 'E19' 'E208'\n",
      " 'E23' 'F147' 'M61' 'M73' 'E197' 'F104' 'F72' 'M208' 'E186' 'F55' 'A22'\n",
      " 'B27' 'N152' 'A70' 'A23' 'D45' 'F45']\n",
      "stations in a specefic bus line 1\n",
      "len-of-go stations: 34\n",
      "len-of-back stations: 34\n",
      "len-of-go back stations: 0\n",
      "first Station  [3169 '1' '1' 'go' '????-157-57' 51.731912 32.720558 'od' 'normal' 'no'] 3169\n",
      "last Station  [1227 '1' '1' 'back' '????? ???????-1' 51.693389 32.640658 'od' 'normal'\n",
      " 'no']\n",
      "['A145' 'A148' 'A34' 'B25' 'C16' 'C62' 'C65' 'D23' 'D33' 'D35' 'D44' 'D92'\n",
      " 'D94' 'E31' 'E52' 'E55' 'F82' 'M50' 'N11' 'N167' 'N54' 'N77']\n",
      "transactions in line 1 plat A145\n",
      "ps: \n",
      "              CardID  LineCode       FDate   Time  plat\n",
      "328847   542446139         1  1398/06/23  24030  A145\n",
      "328848  2620656172         1  1398/06/23  24302  A145\n",
      "328849  3446252780         1  1398/06/23  26200  A145\n",
      "328850  1281272526         1  1398/06/23  26446  A145\n",
      "328851   981010891         1  1398/06/23  26449  A145\n",
      "...            ...       ...         ...    ...   ...\n",
      "694288  2505359876         1  1398/06/23  76409  A145\n",
      "694289  2505359876         1  1398/06/23  76411  A145\n",
      "694290  2505359876         1  1398/06/23  76412  A145\n",
      "694291  2505359876         1  1398/06/23  76413  A145\n",
      "694292  3109163381         1  1398/06/23  76875  A145\n",
      "\n",
      "[916 rows x 5 columns]\n",
      "first row of the selected chunck : \n",
      " [542446139 1 '1398/06/23' 24030 'A145']\n",
      "916\n",
      "t0 = 24030\n",
      "ts = 76875\n",
      "time_intervals 88\n",
      "Origin destination interval view reindex \n",
      "    time_in  time_out\n",
      "0  24030.0   24630.0\n",
      "1  25230.0   26430.0\n",
      "2  29430.0   30030.0\n",
      "3  32430.0   35430.0\n",
      "4  39030.0   39630.0\n",
      "5  52230.0   54630.0\n",
      "6  60630.0   64230.0\n",
      "7  72630.0   74430.0\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "OD bus stations of transactions: \n",
      "         CardID LineCode       FDate   Time  plat Station\n",
      "0    542446139        1  1398/06/23  24030  A145    3169\n",
      "1   2620656172        1  1398/06/23  24302  A145    3169\n",
      "2   3446252780        1  1398/06/23  26200  A145    1227\n",
      "3      7900260        1  1398/06/23  29677  A145    3169\n",
      "4    361857972        1  1398/06/23  29720  A145    3169\n",
      "..         ...      ...         ...    ...   ...     ...\n",
      "61  3446907884        1  1398/06/23  74398  A145    1227\n",
      "62  4268576994        1  1398/06/23  74400  A145    1227\n",
      "63   721882830        1  1398/06/23  74402  A145    1227\n",
      "64   721882830        1  1398/06/23  74403  A145    1227\n",
      "65   175996118        1  1398/06/23  74407  A145    1227\n",
      "\n",
      "[66 rows x 6 columns]\n",
      "transactions in line 1 plat A148\n",
      "ps: \n",
      "              CardID  LineCode       FDate   Time  plat\n",
      "354894   212671675         1  1398/06/23  21811  A148\n",
      "354895   426167598         1  1398/06/23  21850  A148\n",
      "354896  2741717316         1  1398/06/23  21888  A148\n",
      "354897  3446907884         1  1398/06/23  22194  A148\n",
      "354898  2044557086         1  1398/06/23  22444  A148\n",
      "...            ...       ...         ...    ...   ...\n",
      "552551  3997019956         1  1398/06/23  77624  A148\n",
      "552552  3180856990         1  1398/06/23  77802  A148\n",
      "552553  2048218530         1  1398/06/23  78270  A148\n",
      "552554  3166414222         1  1398/06/23  78276  A148\n",
      "552555   173733190         1  1398/06/23  78281  A148\n",
      "\n",
      "[817 rows x 5 columns]\n",
      "first row of the selected chunck : \n",
      " [212671675 1 '1398/06/23' 21811 'A148']\n",
      "817\n",
      "t0 = 21811\n",
      "ts = 78281\n",
      "time_intervals 94\n",
      "Origin destination interval view reindex \n",
      "    time_in  time_out\n",
      "0  21811.0   22411.0\n",
      "1  23611.0   26011.0\n",
      "2  29011.0   29611.0\n",
      "3  32611.0   35011.0\n",
      "4  44011.0   44611.0\n",
      "5  52411.0   54211.0\n",
      "6  60811.0   63811.0\n",
      "7  66811.0   67411.0\n",
      "8  68011.0   68611.0\n",
      "9  72811.0   75811.0\n",
      "OD bus stations of transactions: \n",
      "          CardID LineCode       FDate   Time  plat Station\n",
      "0     542446139        1  1398/06/23  24030  A145    3169\n",
      "1    2620656172        1  1398/06/23  24302  A145    3169\n",
      "2    3446252780        1  1398/06/23  26200  A145    1227\n",
      "3       7900260        1  1398/06/23  29677  A145    3169\n",
      "4     361857972        1  1398/06/23  29720  A145    3169\n",
      "..          ...      ...         ...    ...   ...     ...\n",
      "932  1831885661        1  1398/06/23  75560  A148    1227\n",
      "933  2618313532        1  1398/06/23  75625  A148    1227\n",
      "934  2618313532        1  1398/06/23  75627  A148    1227\n",
      "935  1506135774        1  1398/06/23  75655  A148    1227\n",
      "936  1506135774        1  1398/06/23  75656  A148    1227\n",
      "\n",
      "[937 rows x 6 columns]\n",
      "transactions in line 1 plat A34\n",
      "ps: \n",
      "              CardID  LineCode       FDate   Time plat\n",
      "619176  3254533261         1  1398/06/23  21100  A34\n",
      "619177  2499836756         1  1398/06/23  21379  A34\n",
      "619178  2672251844         1  1398/06/23  21516  A34\n",
      "619180  2743407620         1  1398/06/23  21807  A34\n",
      "619181  3151648462         1  1398/06/23  21808  A34\n",
      "...            ...       ...         ...    ...  ...\n",
      "527401   233569786         1  1398/06/23  74894  A34\n",
      "527402  2125904836         1  1398/06/23  74894  A34\n",
      "527403  2855839198         1  1398/06/23  74899  A34\n",
      "527404  3678152956         1  1398/06/23  75187  A34\n",
      "527405  3678152956         1  1398/06/23  75189  A34\n",
      "\n",
      "[761 rows x 5 columns]\n",
      "first row of the selected chunck : \n",
      " [3254533261 1 '1398/06/23' 21100 'A34']\n",
      "761\n",
      "t0 = 21100\n",
      "ts = 75189\n",
      "time_intervals 90\n",
      "Origin destination interval view reindex \n",
      "    time_in  time_out\n",
      "0  21100.0   21700.0\n",
      "1  22900.0   25300.0\n",
      "2  27700.0   28900.0\n",
      "3  31900.0   33700.0\n",
      "4  37300.0   38500.0\n",
      "5  42700.0   46900.0\n",
      "6  52300.0   52900.0\n",
      "7  54700.0   56500.0\n",
      "8  58900.0   62500.0\n",
      "9  71500.0   72100.0\n",
      "OD bus stations of transactions: \n",
      "           CardID LineCode       FDate   Time  plat Station\n",
      "0      542446139        1  1398/06/23  24030  A145    3169\n",
      "1     2620656172        1  1398/06/23  24302  A145    3169\n",
      "2     3446252780        1  1398/06/23  26200  A145    1227\n",
      "3        7900260        1  1398/06/23  29677  A145    3169\n",
      "4      361857972        1  1398/06/23  29720  A145    3169\n",
      "...          ...      ...         ...    ...   ...     ...\n",
      "1757  3152855710        1  1398/06/23  71819   A34    1227\n",
      "1758   737781184        1  1398/06/23  71854   A34    1227\n",
      "1759   721938930        1  1398/06/23  71923   A34    1227\n",
      "1760  1093759220        1  1398/06/23  72095   A34    1227\n",
      "1761  3202170164        1  1398/06/23  72099   A34    1227\n",
      "\n",
      "[1762 rows x 6 columns]\n",
      "transactions in line 1 plat B25\n",
      "ps: \n",
      "              CardID  LineCode       FDate   Time plat\n",
      "252877  3405857235         1  1398/06/23  24232  B25\n",
      "252898   262238401         1  1398/06/23  24235  B25\n",
      "252882  3792608284         1  1398/06/23  24237  B25\n",
      "252886  1001217566         1  1398/06/23  24260  B25\n",
      "252889  3258005613         1  1398/06/23  24264  B25\n",
      "252904  3446716236         1  1398/06/23  24314  B25\n",
      "252893  4059318045         1  1398/06/23  24332  B25\n",
      "252908   212456011         1  1398/06/23  24359  B25\n",
      "17073    537939870         1  1398/06/23  24520  B25\n",
      "17077   3996810372         1  1398/06/23  24525  B25\n",
      "17082   3794217068         1  1398/06/23  24586  B25\n",
      "17087    234290778         1  1398/06/23  24629  B25\n",
      "17095   2740601460         1  1398/06/23  24641  B25\n",
      "17099   2497977524         1  1398/06/23  24643  B25\n",
      "17091   3648975444         1  1398/06/23  24646  B25\n",
      "17103   2125830612         1  1398/06/23  24978  B25\n",
      "252790  3680292124         1  1398/06/23  25403  B25\n",
      "17110   2115521716         1  1398/06/23  25517  B25\n",
      "17114    980735675         1  1398/06/23  25795  B25\n",
      "17118   1528046382         1  1398/06/23  27458  B25\n",
      "17130    722133212         1  1398/06/23  27459  B25\n",
      "17122   1291390174         1  1398/06/23  27470  B25\n",
      "17126   1371741102         1  1398/06/23  27474  B25\n",
      "17308   4276487330         1  1398/06/23  27476  B25\n",
      "first row of the selected chunck : \n",
      " [3405857235 1 '1398/06/23' 24232 'B25']\n",
      "24\n",
      "t0 = 24232\n",
      "ts = 27476\n",
      "time_intervals 5\n",
      "Origin destination interval view reindex \n",
      "    time_in  time_out\n",
      "0  24232.0   24832.0\n",
      "1  26632.0   27232.0\n",
      "OD bus stations of transactions: \n",
      "           CardID LineCode       FDate   Time  plat Station\n",
      "0      542446139        1  1398/06/23  24030  A145    3169\n",
      "1     2620656172        1  1398/06/23  24302  A145    3169\n",
      "2     3446252780        1  1398/06/23  26200  A145    1227\n",
      "3        7900260        1  1398/06/23  29677  A145    3169\n",
      "4      361857972        1  1398/06/23  29720  A145    3169\n",
      "...          ...      ...         ...    ...   ...     ...\n",
      "2293  3794217068        1  1398/06/23  24586   B25    3169\n",
      "2294   234290778        1  1398/06/23  24629   B25    3169\n",
      "2295  2740601460        1  1398/06/23  24641   B25    3169\n",
      "2296  2497977524        1  1398/06/23  24643   B25    3169\n",
      "2297  3648975444        1  1398/06/23  24646   B25    3169\n",
      "\n",
      "[2298 rows x 6 columns]\n",
      "transactions in line 1 plat C16\n",
      "ps: \n",
      "              CardID  LineCode       FDate   Time plat\n",
      "379751   722090946         1  1398/06/23  21377  C16\n",
      "379752  2117203508         1  1398/06/23  21389  C16\n",
      "379753  2680053934         1  1398/06/23  21532  C16\n",
      "379754  2124941188         1  1398/06/23  21872  C16\n",
      "379755  1528649022         1  1398/06/23  21874  C16\n",
      "...            ...       ...         ...    ...  ...\n",
      "427444  3701415973         1  1398/06/23  74321  C16\n",
      "427445  3701415973         1  1398/06/23  74327  C16\n",
      "427446  3701415973         1  1398/06/23  74329  C16\n",
      "427447  3701415973         1  1398/06/23  74330  C16\n",
      "427448  1368123646         1  1398/06/23  77137  C16\n",
      "\n",
      "[324 rows x 5 columns]\n",
      "first row of the selected chunck : \n",
      " [722090946 1 '1398/06/23' 21377 'C16']\n",
      "324\n",
      "t0 = 21377\n",
      "ts = 77137\n",
      "time_intervals 93\n",
      "Origin destination interval view reindex \n",
      "    time_in  time_out\n",
      "0  21377.0   21977.0\n",
      "1  23177.0   24977.0\n",
      "2  27377.0   28577.0\n",
      "3  29777.0   60977.0\n",
      "4  63377.0   65777.0\n",
      "5  69977.0   71177.0\n",
      "6  75377.0   77177.0\n",
      "OD bus stations of transactions: \n",
      "           CardID LineCode       FDate   Time  plat Station\n",
      "0      542446139        1  1398/06/23  24030  A145    3169\n",
      "1     2620656172        1  1398/06/23  24302  A145    3169\n",
      "2     3446252780        1  1398/06/23  26200  A145    1227\n",
      "3        7900260        1  1398/06/23  29677  A145    3169\n",
      "4      361857972        1  1398/06/23  29720  A145    3169\n",
      "...          ...      ...         ...    ...   ...     ...\n",
      "2349   173474292        1  1398/06/23  70742   C16    1227\n",
      "2350   721858629        1  1398/06/23  70762   C16    1227\n",
      "2351   262546289        1  1398/06/23  71059   C16    1227\n",
      "2352   981992267        1  1398/06/23  71088   C16    1227\n",
      "2353  1368123646        1  1398/06/23  77137   C16    3169\n",
      "\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "[2354 rows x 6 columns]\n",
      "transactions in line 1 plat C62\n",
      "ps: \n",
      "              CardID  LineCode       FDate   Time plat\n",
      "37994   1283977614         1  1398/06/23  23811  C62\n",
      "37996    480500164         1  1398/06/23  23960  C62\n",
      "37995   3405939083         1  1398/06/23  24000  C62\n",
      "37997    262790433         1  1398/06/23  24337  C62\n",
      "37998   3631559516         1  1398/06/23  24345  C62\n",
      "...            ...       ...         ...    ...  ...\n",
      "177446  3184157278         1  1398/06/23  73930  C62\n",
      "177448  3254221741         1  1398/06/23  73930  C62\n",
      "177447  2123244116         1  1398/06/23  73932  C62\n",
      "177449   645898733         1  1398/06/23  74063  C62\n",
      "177450  2742836996         1  1398/06/23  74222  C62\n",
      "\n",
      "[735 rows x 5 columns]\n",
      "first row of the selected chunck : \n",
      " [1283977614 1 '1398/06/23' 23811 'C62']\n",
      "735\n",
      "t0 = 23811\n",
      "ts = 74222\n",
      "time_intervals 84\n",
      "Origin destination interval view reindex \n",
      "    time_in  time_out\n",
      "0  23811.0   24411.0\n",
      "1  25611.0   27411.0\n",
      "2  30411.0   31011.0\n",
      "3  34011.0   35811.0\n",
      "4  39411.0   40611.0\n",
      "5  44211.0   46011.0\n",
      "6  53211.0   55611.0\n",
      "7  58611.0   59211.0\n",
      "8  61611.0   64611.0\n",
      "9  68811.0   71211.0\n",
      "OD bus stations of transactions: \n",
      "           CardID LineCode       FDate   Time  plat Station\n",
      "0      542446139        1  1398/06/23  24030  A145    3169\n",
      "1     2620656172        1  1398/06/23  24302  A145    3169\n",
      "2     3446252780        1  1398/06/23  26200  A145    1227\n",
      "3        7900260        1  1398/06/23  29677  A145    3169\n",
      "4      361857972        1  1398/06/23  29720  A145    3169\n",
      "...          ...      ...         ...    ...   ...     ...\n",
      "2655   981718859        1  1398/06/23  71078   C62    1227\n",
      "2656   981718859        1  1398/06/23  71086   C62    1227\n",
      "2657  1360440554        1  1398/06/23  71199   C62    1227\n",
      "2658   428737806        1  1398/06/23  71202   C62    1227\n",
      "2659  3793136268        1  1398/06/23  71206   C62    1227\n",
      "\n",
      "[2660 rows x 6 columns]\n",
      "transactions in line 1 plat C65\n",
      "ps: \n",
      "              CardID  LineCode       FDate   Time plat\n",
      "675762  3997448164         1  1398/06/23  24485  C65\n",
      "675763  1527730158         1  1398/06/23  24553  C65\n",
      "675764   174855524         1  1398/06/23  24567  C65\n",
      "675765  3631661004         1  1398/06/23  24849  C65\n",
      "675766  1529125566         1  1398/06/23  25111  C65\n",
      "...            ...       ...         ...    ...  ...\n",
      "97039   2742334932         1  1398/06/23  72818  C65\n",
      "97042   1530213550         1  1398/06/23  72858  C65\n",
      "97041   3258247773         1  1398/06/23  73018  C65\n",
      "97043    361708292         1  1398/06/23  73027  C65\n",
      "97044   3556378577         1  1398/06/23  73363  C65\n",
      "\n",
      "[358 rows x 5 columns]\n",
      "first row of the selected chunck : \n",
      " [3997448164 1 '1398/06/23' 24485 'C65']\n",
      "358\n",
      "t0 = 24485\n",
      "ts = 73363\n",
      "time_intervals 81\n",
      "Origin destination interval view reindex \n",
      "    time_in  time_out\n",
      "0  24485.0   25085.0\n",
      "1  26885.0   28085.0\n",
      "2  29285.0   47885.0\n",
      "3  50885.0   51485.0\n",
      "4  54485.0   56885.0\n",
      "5  59885.0   60485.0\n",
      "6  64085.0   65285.0\n",
      "7  69485.0   70685.0\n",
      "OD bus stations of transactions: \n",
      "           CardID LineCode       FDate   Time  plat Station\n",
      "0      542446139        1  1398/06/23  24030  A145    3169\n",
      "1     2620656172        1  1398/06/23  24302  A145    3169\n",
      "2     3446252780        1  1398/06/23  26200  A145    1227\n",
      "3        7900260        1  1398/06/23  29677  A145    3169\n",
      "4      361857972        1  1398/06/23  29720  A145    3169\n",
      "...          ...      ...         ...    ...   ...     ...\n",
      "3248  3180282782        1  1398/06/23  70413   C65    1227\n",
      "3249   722244534        1  1398/06/23  70423   C65    1227\n",
      "3250  3405824217        1  1398/06/23  70594   C65    1227\n",
      "3251  3445011052        1  1398/06/23  70631   C65    1227\n",
      "3252  2498542941        1  1398/06/23  70651   C65    1227\n",
      "\n",
      "[3253 rows x 6 columns]\n",
      "transactions in line 1 plat D23\n",
      "ps: \n",
      "              CardID  LineCode       FDate   Time plat\n",
      "444994  2053204658         1  1398/06/23  23372  D23\n",
      "444995   984261499         1  1398/06/23  23815  D23\n",
      "444996   361746468         1  1398/06/23  23853  D23\n",
      "444997   174373222         1  1398/06/23  23935  D23\n",
      "444998   722120973         1  1398/06/23  23939  D23\n",
      "...            ...       ...         ...    ...  ...\n",
      "499410  2184420707         1  1398/06/23  73375  D23\n",
      "499411  1529821134         1  1398/06/23  73411  D23\n",
      "499412  1529821134         1  1398/06/23  73413  D23\n",
      "499413  1529821134         1  1398/06/23  73414  D23\n",
      "499414  3791825333         1  1398/06/23  73522  D23\n",
      "\n",
      "[740 rows x 5 columns]\n",
      "first row of the selected chunck : \n",
      " [2053204658 1 '1398/06/23' 23372 'D23']\n",
      "740\n",
      "t0 = 23372\n",
      "ts = 73522\n",
      "time_intervals 84\n",
      "Origin destination interval view reindex \n",
      "     time_in  time_out\n",
      "0   23372.0   23972.0\n",
      "1   25172.0   26972.0\n",
      "2   29372.0   30572.0\n",
      "3   33572.0   35972.0\n",
      "4   39572.0   40172.0\n",
      "5   43772.0   44372.0\n",
      "6   48572.0   49772.0\n",
      "7   52172.0   55172.0\n",
      "8   58172.0   58772.0\n",
      "9   62372.0   64772.0\n",
      "10  68972.0   69572.0\n",
      "OD bus stations of transactions: \n",
      "           CardID LineCode       FDate   Time  plat Station\n",
      "0      542446139        1  1398/06/23  24030  A145    3169\n",
      "1     2620656172        1  1398/06/23  24302  A145    3169\n",
      "2     3446252780        1  1398/06/23  26200  A145    1227\n",
      "3        7900260        1  1398/06/23  29677  A145    3169\n",
      "4      361857972        1  1398/06/23  29720  A145    3169\n",
      "...          ...      ...         ...    ...   ...     ...\n",
      "3547   721757141        1  1398/06/23  64602   D23    1227\n",
      "3548   721757141        1  1398/06/23  64605   D23    1227\n",
      "3549  3207033108        1  1398/06/23  64623   D23    1227\n",
      "3550  3180866766        1  1398/06/23  69556   D23    3169\n",
      "3551  3632110748        1  1398/06/23  69563   D23    3169\n",
      "\n",
      "[3552 rows x 6 columns]\n",
      "transactions in line 1 plat D33\n",
      "ps: \n",
      "              CardID  LineCode       FDate   Time plat\n",
      "594132  3794822812         1  1398/06/23  21441  D33\n",
      "594133  3794208508         1  1398/06/23  21445  D33\n",
      "594134   261483009         1  1398/06/23  21448  D33\n",
      "594135   361013812         1  1398/06/23  21452  D33\n",
      "594136  2586637540         1  1398/06/23  21456  D33\n",
      "...            ...       ...         ...    ...  ...\n",
      "379746  1835468173         1  1398/06/23  75740  D33\n",
      "379747  1835468173         1  1398/06/23  75741  D33\n",
      "379748  1835468173         1  1398/06/23  75743  D33\n",
      "379749  3208101508         1  1398/06/23  76050  D33\n",
      "379750  3208101508         1  1398/06/23  76056  D33\n",
      "\n",
      "[1042 rows x 5 columns]\n",
      "first row of the selected chunck : \n",
      " [3794822812 1 '1398/06/23' 21441 'D33']\n",
      "1042\n",
      "t0 = 21441\n",
      "ts = 76056\n",
      "time_intervals 91\n",
      "Origin destination interval view reindex \n",
      "    time_in  time_out\n",
      "0  21441.0   22041.0\n",
      "1  23841.0   25641.0\n",
      "2  28041.0   29241.0\n",
      "3  36441.0   37041.0\n",
      "4  46641.0   47841.0\n",
      "5  54441.0   57441.0\n",
      "6  61041.0   62241.0\n",
      "7  71241.0   72441.0\n",
      "OD bus stations of transactions: \n",
      "           CardID LineCode       FDate   Time  plat Station\n",
      "0      542446139        1  1398/06/23  24030  A145    3169\n",
      "1     2620656172        1  1398/06/23  24302  A145    3169\n",
      "2     3446252780        1  1398/06/23  26200  A145    1227\n",
      "3        7900260        1  1398/06/23  29677  A145    3169\n",
      "4      361857972        1  1398/06/23  29720  A145    3169\n",
      "...          ...      ...         ...    ...   ...     ...\n",
      "4119  3648685924        1  1398/06/23  72187   D33    1227\n",
      "4120  3604339788        1  1398/06/23  72195   D33    1227\n",
      "4121  2618123420        1  1398/06/23  72253   D33    1227\n",
      "4122   211026652        1  1398/06/23  72262   D33    1227\n",
      "4123  2855809950        1  1398/06/23  72332   D33    1227\n",
      "\n",
      "[4124 rows x 6 columns]\n",
      "transactions in line 1 plat D35\n",
      "ps: \n",
      "              CardID  LineCode       FDate   Time plat\n",
      "348046   480433540         1  1398/06/23  23910  D35\n",
      "348047  1003123719         1  1398/06/23  24278  D35\n",
      "348048  1407159865         1  1398/06/23  24281  D35\n",
      "348049   982036667         1  1398/06/23  24284  D35\n",
      "348050   721834121         1  1398/06/23  24356  D35\n",
      "...            ...       ...         ...    ...  ...\n",
      "459302   722027457         1  1398/06/23  62506  D35\n",
      "459303   722027457         1  1398/06/23  62507  D35\n",
      "459298   722176236         1  1398/06/23  62508  D35\n",
      "459304  3553834492         1  1398/06/23  62524  D35\n",
      "459305  3553834492         1  1398/06/23  62530  D35\n",
      "\n",
      "[682 rows x 5 columns]\n",
      "first row of the selected chunck : \n",
      " [480433540 1 '1398/06/23' 23910 'D35']\n",
      "682\n",
      "t0 = 23910\n",
      "ts = 62530\n",
      "time_intervals 64\n",
      "Origin destination interval view reindex \n",
      "    time_in  time_out\n",
      "0  23910.0   24510.0\n",
      "1  26310.0   27510.0\n",
      "2  30510.0   31710.0\n",
      "3  34710.0   35910.0\n",
      "4  39510.0   41310.0\n",
      "5  44910.0   46710.0\n",
      "6  53910.0   56310.0\n",
      "7  59310.0   59910.0\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "OD bus stations of transactions: \n",
      "           CardID LineCode       FDate   Time  plat Station\n",
      "0      542446139        1  1398/06/23  24030  A145    3169\n",
      "1     2620656172        1  1398/06/23  24302  A145    3169\n",
      "2     3446252780        1  1398/06/23  26200  A145    1227\n",
      "3        7900260        1  1398/06/23  29677  A145    3169\n",
      "4      361857972        1  1398/06/23  29720  A145    3169\n",
      "...          ...      ...         ...    ...   ...     ...\n",
      "5042  3206780053        1  1398/06/23  59720   D35    1227\n",
      "5043  1527622158        1  1398/06/23  59725   D35    1227\n",
      "5044  1598741764        1  1398/06/23  59801   D35    1227\n",
      "5045  1598741764        1  1398/06/23  59802   D35    1227\n",
      "5046   722206318        1  1398/06/23  59817   D35    1227\n",
      "\n",
      "[5047 rows x 6 columns]\n",
      "transactions in line 1 plat D44\n",
      "ps: \n",
      "             CardID  LineCode       FDate   Time plat\n",
      "18729   427668190         1  1398/06/23  22333  D44\n",
      "18730  3180814910         1  1398/06/23  22339  D44\n",
      "18731  1788471364         1  1398/06/23  22475  D44\n",
      "18732   991556526         1  1398/06/23  22574  D44\n",
      "18733   722265013         1  1398/06/23  22578  D44\n",
      "...           ...       ...         ...    ...  ...\n",
      "61754  3677462236         1  1398/06/23  74482  D44\n",
      "61755   722117991         1  1398/06/23  74484  D44\n",
      "61756   722117991         1  1398/06/23  74485  D44\n",
      "61757  1371853038         1  1398/06/23  74488  D44\n",
      "61758   645793597         1  1398/06/23  74495  D44\n",
      "\n",
      "[842 rows x 5 columns]\n",
      "first row of the selected chunck : \n",
      " [427668190 1 '1398/06/23' 22333 'D44']\n",
      "842\n",
      "t0 = 22333\n",
      "ts = 74495\n",
      "time_intervals 87\n",
      "Origin destination interval view reindex \n",
      "     time_in  time_out\n",
      "0   22333.0   22933.0\n",
      "1   24733.0   26533.0\n",
      "2   28933.0   30133.0\n",
      "3   37333.0   38533.0\n",
      "4   42733.0   43333.0\n",
      "5   47533.0   49333.0\n",
      "6   52333.0   52933.0\n",
      "7   55333.0   58333.0\n",
      "8   61933.0   62533.0\n",
      "9   66133.0   67333.0\n",
      "10  71533.0   72733.0\n",
      "OD bus stations of transactions: \n",
      "           CardID LineCode       FDate   Time  plat Station\n",
      "0      542446139        1  1398/06/23  24030  A145    3169\n",
      "1     2620656172        1  1398/06/23  24302  A145    3169\n",
      "2     3446252780        1  1398/06/23  26200  A145    1227\n",
      "3        7900260        1  1398/06/23  29677  A145    3169\n",
      "4      361857972        1  1398/06/23  29720  A145    3169\n",
      "...          ...      ...         ...    ...   ...     ...\n",
      "5646  3648625284        1  1398/06/23  72524   D44    3169\n",
      "5647   263091105        1  1398/06/23  72531   D44    3169\n",
      "5648   184130086        1  1398/06/23  72545   D44    3169\n",
      "5649  3793127388        1  1398/06/23  72548   D44    3169\n",
      "5650  1529479998        1  1398/06/23  72701   D44    3169\n",
      "\n",
      "[5651 rows x 6 columns]\n",
      "transactions in line 1 plat D92\n",
      "ps: \n",
      "              CardID  LineCode       FDate   Time plat\n",
      "206472  3446800188         1  1398/06/23  45540  D92\n",
      "206473  2620469084         1  1398/06/23  45553  D92\n",
      "206474  2620469084         1  1398/06/23  45554  D92\n",
      "206475    80435002         1  1398/06/23  45633  D92\n",
      "206476    80435002         1  1398/06/23  45634  D92\n",
      "...            ...       ...         ...    ...  ...\n",
      "160890   869334501         1  1398/06/23  78099  D92\n",
      "160891  3405812918         1  1398/06/23  78104  D92\n",
      "160892  2039188522         1  1398/06/23  78107  D92\n",
      "161174  2188151859         1  1398/06/23  78192  D92\n",
      "161175  3794658780         1  1398/06/23  78756  D92\n",
      "\n",
      "[500 rows x 5 columns]\n",
      "first row of the selected chunck : \n",
      " [3446800188 1 '1398/06/23' 45540 'D92']\n",
      "500\n",
      "t0 = 45540\n",
      "ts = 78756\n",
      "time_intervals 55\n",
      "Origin destination interval view reindex \n",
      "    time_in  time_out\n",
      "0  45540.0   46140.0\n",
      "1  49740.0   50940.0\n",
      "2  58140.0   61140.0\n",
      "3  64740.0   65340.0\n",
      "4  69540.0   70740.0\n",
      "5  74340.0   76740.0\n",
      "OD bus stations of transactions: \n",
      "           CardID LineCode       FDate   Time  plat Station\n",
      "0      542446139        1  1398/06/23  24030  A145    3169\n",
      "1     2620656172        1  1398/06/23  24302  A145    3169\n",
      "2     3446252780        1  1398/06/23  26200  A145    1227\n",
      "3        7900260        1  1398/06/23  29677  A145    3169\n",
      "4      361857972        1  1398/06/23  29720  A145    3169\n",
      "...          ...      ...         ...    ...   ...     ...\n",
      "6316  4265897730        1  1398/06/23  70697   D92    3169\n",
      "6317  1835851757        1  1398/06/23  70699   D92    3169\n",
      "6318  2621665980        1  1398/06/23  70723   D92    3169\n",
      "6319  3405782636        1  1398/06/23  76464   D92    1227\n",
      "6320   555692158        1  1398/06/23  76471   D92    1227\n",
      "\n",
      "[6321 rows x 6 columns]\n",
      "transactions in line 1 plat D94\n",
      "ps: \n",
      "              CardID  LineCode       FDate   Time plat\n",
      "237472   426374638         1  1398/06/23  23642  D94\n",
      "237473  2740637204         1  1398/06/23  23648  D94\n",
      "237474  3206499412         1  1398/06/23  23657  D94\n",
      "237475   262668353         1  1398/06/23  23688  D94\n",
      "237593  2125138836         1  1398/06/23  23909  D94\n",
      "...            ...       ...         ...    ...  ...\n",
      "93535   3104940894         1  1398/06/23  76514  D94\n",
      "93536    982917643         1  1398/06/23  76549  D94\n",
      "93537   3630312652         1  1398/06/23  76642  D94\n",
      "93534    428543534         1  1398/06/23  76671  D94\n",
      "93538    173141668         1  1398/06/23  77635  D94\n",
      "\n",
      "[920 rows x 5 columns]\n",
      "first row of the selected chunck : \n",
      " [426374638 1 '1398/06/23' 23642 'D94']\n",
      "920\n",
      "t0 = 23642\n",
      "ts = 77635\n",
      "time_intervals 90\n",
      "Origin destination interval view reindex \n",
      "    time_in  time_out\n",
      "0  23642.0   24242.0\n",
      "1  26642.0   27242.0\n",
      "2  30242.0   31442.0\n",
      "3  39842.0   40442.0\n",
      "4  44642.0   45242.0\n",
      "5  48842.0   50642.0\n",
      "6  56642.0   59642.0\n",
      "7  68042.0   69242.0\n",
      "8  74042.0   74642.0\n",
      "OD bus stations of transactions: \n",
      "           CardID LineCode       FDate   Time  plat Station\n",
      "0      542446139        1  1398/06/23  24030  A145    3169\n",
      "1     2620656172        1  1398/06/23  24302  A145    3169\n",
      "2     3446252780        1  1398/06/23  26200  A145    1227\n",
      "3        7900260        1  1398/06/23  29677  A145    3169\n",
      "4      361857972        1  1398/06/23  29720  A145    3169\n",
      "...          ...      ...         ...    ...   ...     ...\n",
      "6742   721712745        1  1398/06/23  59609   D94    3169\n",
      "6743  3210100100        1  1398/06/23  69234   D94    1227\n",
      "6744  3210100100        1  1398/06/23  69235   D94    1227\n",
      "6745  3210100100        1  1398/06/23  69236   D94    1227\n",
      "6746   300567691        1  1398/06/23  74636   D94    3169\n",
      "\n",
      "[6747 rows x 6 columns]\n",
      "transactions in line 1 plat E31\n",
      "ps: \n",
      "              CardID  LineCode       FDate   Time plat\n",
      "121609  3630924908         1  1398/06/23  24567  E31\n",
      "121610   722176236         1  1398/06/23  24575  E31\n",
      "121611  2542179726         1  1398/06/23  24581  E31\n",
      "121612   721864973         1  1398/06/23  24591  E31\n",
      "121613   211090492         1  1398/06/23  24606  E31\n",
      "...            ...       ...         ...    ...  ...\n",
      "12590   2505513732         1  1398/06/23  80753  E31\n",
      "12591   2130308292         1  1398/06/23  80966  E31\n",
      "12592   4276381650         1  1398/06/23  81007  E31\n",
      "12593   4276381650         1  1398/06/23  81009  E31\n",
      "12594   4265342754         1  1398/06/23  82180  E31\n",
      "\n",
      "[849 rows x 5 columns]\n",
      "first row of the selected chunck : \n",
      " [3630924908 1 '1398/06/23' 24567 'E31']\n",
      "849\n",
      "t0 = 24567\n",
      "ts = 82180\n",
      "time_intervals 96\n",
      "Origin destination interval view reindex \n",
      "     time_in  time_out\n",
      "0   24567.0   25167.0\n",
      "1   26967.0   28167.0\n",
      "2   30567.0   33567.0\n",
      "3   37167.0   37767.0\n",
      "4   41367.0   41967.0\n",
      "5   46167.0   46767.0\n",
      "6   49767.0   52167.0\n",
      "7   55167.0   55767.0\n",
      "8   58767.0   61767.0\n",
      "9   65967.0   66567.0\n",
      "10  70767.0   71367.0\n",
      "11  75567.0   80967.0\n",
      "OD bus stations of transactions: \n",
      "           CardID LineCode       FDate   Time  plat Station\n",
      "0      542446139        1  1398/06/23  24030  A145    3169\n",
      "1     2620656172        1  1398/06/23  24302  A145    3169\n",
      "2     3446252780        1  1398/06/23  26200  A145    1227\n",
      "3        7900260        1  1398/06/23  29677  A145    3169\n",
      "4      361857972        1  1398/06/23  29720  A145    3169\n",
      "...          ...      ...         ...    ...   ...     ...\n",
      "7632  3648251684        1  1398/06/23  80532   E31    1227\n",
      "7633  2125950324        1  1398/06/23  80555   E31    1227\n",
      "7634  2505513732        1  1398/06/23  80752   E31    1227\n",
      "7635  2505513732        1  1398/06/23  80753   E31    1227\n",
      "7636  2130308292        1  1398/06/23  80966   E31    1227\n",
      "\n",
      "[7637 rows x 6 columns]\n",
      "transactions in line 1 plat E52\n",
      "ps: \n",
      "              CardID  LineCode       FDate   Time plat\n",
      "537398   869254986         1  1398/06/23  23037  E52\n",
      "537399  3179347822         1  1398/06/23  23278  E52\n",
      "537400  1000721726         1  1398/06/23  23370  E52\n",
      "537401   721723218         1  1398/06/23  23379  E52\n",
      "537402  2124204212         1  1398/06/23  23770  E52\n",
      "...            ...       ...         ...    ...  ...\n",
      "691025  3180778782         1  1398/06/23  73531  E52\n",
      "691026  3180778782         1  1398/06/23  73532  E52\n",
      "691027  2741847092         1  1398/06/23  73724  E52\n",
      "691028  2741847092         1  1398/06/23  73725  E52\n",
      "691029  2741847092         1  1398/06/23  73726  E52\n",
      "\n",
      "[671 rows x 5 columns]\n",
      "first row of the selected chunck : \n",
      " [869254986 1 '1398/06/23' 23037 'E52']\n",
      "671\n",
      "t0 = 23037\n",
      "ts = 73726\n",
      "time_intervals 84\n",
      "Origin destination interval view reindex \n",
      "    time_in  time_out\n",
      "0  23037.0   23637.0\n",
      "1  25437.0   26637.0\n",
      "2  29637.0   34437.0\n",
      "3  35637.0   39837.0\n",
      "4  44637.0   45237.0\n",
      "5  48837.0   49437.0\n",
      "6  53037.0   55437.0\n",
      "7  62037.0   65037.0\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "OD bus stations of transactions: \n",
      "           CardID LineCode       FDate   Time  plat Station\n",
      "0      542446139        1  1398/06/23  24030  A145    3169\n",
      "1     2620656172        1  1398/06/23  24302  A145    3169\n",
      "2     3446252780        1  1398/06/23  26200  A145    1227\n",
      "3        7900260        1  1398/06/23  29677  A145    3169\n",
      "4      361857972        1  1398/06/23  29720  A145    3169\n",
      "...          ...      ...         ...    ...   ...     ...\n",
      "8403  2137868477        1  1398/06/23  64890   E52    1227\n",
      "8404  2239119591        1  1398/06/23  64893   E52    1227\n",
      "8405  2621782460        1  1398/06/23  64895   E52    1227\n",
      "8406   982983963        1  1398/06/23  64897   E52    1227\n",
      "8407  2137868477        1  1398/06/23  64989   E52    1227\n",
      "\n",
      "[8408 rows x 6 columns]\n",
      "transactions in line 1 plat E55\n",
      "ps: \n",
      "              CardID  LineCode       FDate   Time plat\n",
      "691030  2116349892         1  1398/06/23  22214  E55\n",
      "691031   536823662         1  1398/06/23  22230  E55\n",
      "691032  2497827933         1  1398/06/23  22240  E55\n",
      "691033  3997309844         1  1398/06/23  22427  E55\n",
      "691034  2125309716         1  1398/06/23  22429  E55\n",
      "...            ...       ...         ...    ...  ...\n",
      "386417  1844882964         1  1398/06/23  74922  E55\n",
      "386418  3209872436         1  1398/06/23  74927  E55\n",
      "386422   361741556         1  1398/06/23  75135  E55\n",
      "386421  4254739588         1  1398/06/23  75200  E55\n",
      "386423  2962086309         1  1398/06/23  75265  E55\n",
      "\n",
      "[881 rows x 5 columns]\n",
      "first row of the selected chunck : \n",
      " [2116349892 1 '1398/06/23' 22214 'E55']\n",
      "881\n",
      "t0 = 22214\n",
      "ts = 75265\n",
      "time_intervals 88\n",
      "Origin destination interval view reindex \n",
      "     time_in  time_out\n",
      "0   22214.0   22814.0\n",
      "1   24614.0   25814.0\n",
      "2   28214.0   30014.0\n",
      "3   33014.0   33614.0\n",
      "4   37214.0   37814.0\n",
      "5   42014.0   42614.0\n",
      "6   46814.0   48614.0\n",
      "7   51614.0   52214.0\n",
      "8   54614.0   57614.0\n",
      "9   60614.0   61214.0\n",
      "10  64814.0   66614.0\n",
      "11  71414.0   72014.0\n",
      "OD bus stations of transactions: \n",
      "           CardID LineCode       FDate   Time  plat Station\n",
      "0      542446139        1  1398/06/23  24030  A145    3169\n",
      "1     2620656172        1  1398/06/23  24302  A145    3169\n",
      "2     3446252780        1  1398/06/23  26200  A145    1227\n",
      "3        7900260        1  1398/06/23  29677  A145    3169\n",
      "4      361857972        1  1398/06/23  29720  A145    3169\n",
      "...          ...      ...         ...    ...   ...     ...\n",
      "8913  2045359822        1  1398/06/23  61108   E55    1227\n",
      "8914  2045359822        1  1398/06/23  61110   E55    1227\n",
      "8915   984044795        1  1398/06/23  61197   E55    1227\n",
      "8916  1001555102        1  1398/06/23  66606   E55    3169\n",
      "8917   722058773        1  1398/06/23  71861   E55    1227\n",
      "\n",
      "[8918 rows x 6 columns]\n",
      "transactions in line 1 plat F82\n",
      "ps: \n",
      "              CardID  LineCode       FDate   Time plat\n",
      "219796  3152820782         1  1398/06/23  23231  F82\n",
      "219797   722155418         1  1398/06/23  23320  F82\n",
      "219798  2239157527         1  1398/06/23  23392  F82\n",
      "219799  3679740876         1  1398/06/23  23399  F82\n",
      "219801  3210020900         1  1398/06/23  23406  F82\n",
      "...            ...       ...         ...    ...  ...\n",
      "210522  3152360206         1  1398/06/23  77083  F82\n",
      "210524  2621759468         1  1398/06/23  77733  F82\n",
      "210525  3205276405         1  1398/06/23  77745  F82\n",
      "210526  3205276405         1  1398/06/23  77749  F82\n",
      "210527  3678079740         1  1398/06/23  77967  F82\n",
      "\n",
      "[834 rows x 5 columns]\n",
      "first row of the selected chunck : \n",
      " [3152820782 1 '1398/06/23' 23231 'F82']\n",
      "834\n",
      "t0 = 23231\n",
      "ts = 77967\n",
      "time_intervals 91\n",
      "Origin destination interval view reindex \n",
      "     time_in  time_out\n",
      "0   23231.0   23831.0\n",
      "1   26231.0   26831.0\n",
      "2   29831.0   31031.0\n",
      "3   34631.0   35231.0\n",
      "4   38831.0   39431.0\n",
      "5   43631.0   44231.0\n",
      "6   48431.0   49631.0\n",
      "7   55631.0   59231.0\n",
      "8   62831.0   63431.0\n",
      "9   67031.0   68831.0\n",
      "10  73031.0   74831.0\n",
      "OD bus stations of transactions: \n",
      "           CardID LineCode       FDate   Time  plat Station\n",
      "0      542446139        1  1398/06/23  24030  A145    3169\n",
      "1     2620656172        1  1398/06/23  24302  A145    3169\n",
      "2     3446252780        1  1398/06/23  26200  A145    1227\n",
      "3        7900260        1  1398/06/23  29677  A145    3169\n",
      "4      361857972        1  1398/06/23  29720  A145    3169\n",
      "...          ...      ...         ...    ...   ...     ...\n",
      "9621  3792825036        1  1398/06/23  74511   F82    3169\n",
      "9622   427264990        1  1398/06/23  74558   F82    3169\n",
      "9623  2500267156        1  1398/06/23  74559   F82    3169\n",
      "9624  3676319938        1  1398/06/23  74614   F82    3169\n",
      "9625   722164516        1  1398/06/23  74799   F82    3169\n",
      "\n",
      "[9626 rows x 6 columns]\n",
      "transactions in line 1 plat M50\n",
      "ps: \n",
      "              CardID  LineCode       FDate   Time plat\n",
      "241743   210666907         1  1398/06/23  22914  M50\n",
      "241744  4274559394         1  1398/06/23  23101  M50\n",
      "241745   262145537         1  1398/06/23  23101  M50\n",
      "241746  3839952509         1  1398/06/23  23101  M50\n",
      "241747  3675011058         1  1398/06/23  23101  M50\n",
      "...            ...       ...         ...    ...  ...\n",
      "215445  2482180820         1  1398/06/23  75520  M50\n",
      "215446   262952177         1  1398/06/23  75523  M50\n",
      "215447  3405824885         1  1398/06/23  75959  M50\n",
      "215448   722231248         1  1398/06/23  75962  M50\n",
      "215449  1854595301         1  1398/06/23  76040  M50\n",
      "\n",
      "[977 rows x 5 columns]\n",
      "first row of the selected chunck : \n",
      " [210666907 1 '1398/06/23' 22914 'M50']\n",
      "977\n",
      "t0 = 22914\n",
      "ts = 76040\n",
      "time_intervals 89\n",
      "Origin destination interval view reindex \n",
      "    time_in  time_out\n",
      "0  22914.0   23514.0\n",
      "1  25914.0   26514.0\n",
      "2  28914.0   30714.0\n",
      "3  33714.0   34314.0\n",
      "4  38514.0   39114.0\n",
      "5  48114.0   49314.0\n",
      "6  56514.0   58314.0\n",
      "7  61914.0   63114.0\n",
      "8  67314.0   67914.0\n",
      "OD bus stations of transactions: \n",
      "            CardID LineCode       FDate   Time  plat Station\n",
      "0       542446139        1  1398/06/23  24030  A145    3169\n",
      "1      2620656172        1  1398/06/23  24302  A145    3169\n",
      "2      3446252780        1  1398/06/23  26200  A145    1227\n",
      "3         7900260        1  1398/06/23  29677  A145    3169\n",
      "4       361857972        1  1398/06/23  29720  A145    3169\n",
      "...           ...      ...         ...    ...   ...     ...\n",
      "10377   361270868        1  1398/06/23  67801   M50    3169\n",
      "10378  3201555972        1  1398/06/23  67801   M50    3169\n",
      "10379   722018373        1  1398/06/23  67801   M50    3169\n",
      "10380  4265906562        1  1398/06/23  67802   M50    3169\n",
      "10381   722018373        1  1398/06/23  67802   M50    3169\n",
      "\n",
      "[10382 rows x 6 columns]\n",
      "transactions in line 1 plat N11\n",
      "ps: \n",
      "              CardID  LineCode       FDate   Time plat\n",
      "437140  3795042972         1  1398/06/23  23089  N11\n",
      "437141  2961795861         1  1398/06/23  23289  N11\n",
      "437142   725971127         1  1398/06/23  23290  N11\n",
      "437143   735949360         1  1398/06/23  23338  N11\n",
      "437144   397293146         1  1398/06/23  23502  N11\n",
      "...            ...       ...         ...    ...  ...\n",
      "435527  2045148238         1  1398/06/23  77948  N11\n",
      "435528  3445502892         1  1398/06/23  78014  N11\n",
      "435529  4278184898         1  1398/06/23  78170  N11\n",
      "435531  2504779764         1  1398/06/23  78182  N11\n",
      "435530  1360899146         1  1398/06/23  78198  N11\n",
      "\n",
      "[859 rows x 5 columns]\n",
      "first row of the selected chunck : \n",
      " [3795042972 1 '1398/06/23' 23089 'N11']\n",
      "859\n",
      "t0 = 23089\n",
      "ts = 78198\n",
      "time_intervals 92\n",
      "Origin destination interval view reindex \n",
      "     time_in  time_out\n",
      "0   23089.0   23689.0\n",
      "1   24289.0   26089.0\n",
      "2   28489.0   29089.0\n",
      "3   32089.0   34489.0\n",
      "4   38689.0   39289.0\n",
      "5   47689.0   48289.0\n",
      "6   51289.0   53689.0\n",
      "7   56089.0   57289.0\n",
      "8   60289.0   63289.0\n",
      "9   72889.0   74089.0\n",
      "10  77089.0   77689.0\n",
      "OD bus stations of transactions: \n",
      "            CardID LineCode       FDate   Time  plat Station\n",
      "0       542446139        1  1398/06/23  24030  A145    3169\n",
      "1      2620656172        1  1398/06/23  24302  A145    3169\n",
      "2      3446252780        1  1398/06/23  26200  A145    1227\n",
      "3         7900260        1  1398/06/23  29677  A145    3169\n",
      "4       361857972        1  1398/06/23  29720  A145    3169\n",
      "...           ...      ...         ...    ...   ...     ...\n",
      "11193  3631746780        1  1398/06/23  63267   N11    3169\n",
      "11194   174575478        1  1398/06/23  63267   N11    3169\n",
      "11195   174575478        1  1398/06/23  63269   N11    3169\n",
      "11196   537553070        1  1398/06/23  73858   N11    1227\n",
      "11197  3793218956        1  1398/06/23  77497   N11    3169\n",
      "\n",
      "[11198 rows x 6 columns]\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "transactions in line 1 plat N167\n",
      "ps: \n",
      "              CardID  LineCode       FDate   Time  plat\n",
      "427450  2125214116         1  1398/06/23  24384  N167\n",
      "427449   342924420         1  1398/06/23  24387  N167\n",
      "427451   981880539         1  1398/06/23  24525  N167\n",
      "427452   722104542         1  1398/06/23  24527  N167\n",
      "427453  2621516860         1  1398/06/23  24532  N167\n",
      "...            ...       ...         ...    ...   ...\n",
      "35843    722181276         1  1398/06/23  77585  N167\n",
      "35839   3405949380         1  1398/06/23  77587  N167\n",
      "35844   1001555662         1  1398/06/23  77587  N167\n",
      "35845   1001555662         1  1398/06/23  77588  N167\n",
      "35846   2741312580         1  1398/06/23  78364  N167\n",
      "\n",
      "[820 rows x 5 columns]\n",
      "first row of the selected chunck : \n",
      " [2125214116 1 '1398/06/23' 24384 'N167']\n",
      "820\n",
      "t0 = 24384\n",
      "ts = 78364\n",
      "time_intervals 90\n",
      "Origin destination interval view reindex \n",
      "     time_in  time_out\n",
      "0   24384.0   24984.0\n",
      "1   27384.0   27984.0\n",
      "2   30984.0   32784.0\n",
      "3   35184.0   36984.0\n",
      "4   40584.0   41184.0\n",
      "5   45384.0   45984.0\n",
      "6   48984.0   51384.0\n",
      "7   54384.0   54984.0\n",
      "8   56784.0   60384.0\n",
      "9   69384.0   70584.0\n",
      "10  74784.0   76584.0\n",
      "OD bus stations of transactions: \n",
      "            CardID LineCode       FDate   Time  plat Station\n",
      "0       542446139        1  1398/06/23  24030  A145    3169\n",
      "1      2620656172        1  1398/06/23  24302  A145    3169\n",
      "2      3446252780        1  1398/06/23  26200  A145    1227\n",
      "3         7900260        1  1398/06/23  29677  A145    3169\n",
      "4       361857972        1  1398/06/23  29720  A145    3169\n",
      "...           ...      ...         ...    ...   ...     ...\n",
      "11987   721919270        1  1398/06/23  76248  N167    3169\n",
      "11988  3206027748        1  1398/06/23  76419  N167    3169\n",
      "11989  1788568292        1  1398/06/23  76422  N167    3169\n",
      "11990  1788568292        1  1398/06/23  76564  N167    3169\n",
      "11991  1788568292        1  1398/06/23  76565  N167    3169\n",
      "\n",
      "[11992 rows x 6 columns]\n",
      "transactions in line 1 plat N54\n",
      "ps: \n",
      "              CardID  LineCode       FDate   Time plat\n",
      "109679  1001929550         1  1398/06/23  24329  N54\n",
      "109680  2045367806         1  1398/06/23  24339  N54\n",
      "109681  1000918846         1  1398/06/23  24364  N54\n",
      "109682  2741251444         1  1398/06/23  24576  N54\n",
      "109686  3679009148         1  1398/06/23  24576  N54\n",
      "...            ...       ...         ...    ...  ...\n",
      "248121  2741250900         1  1398/06/23  81976  N54\n",
      "248122  2541750334         1  1398/06/23  82144  N54\n",
      "248123  2541750334         1  1398/06/23  82146  N54\n",
      "248124  3649119572         1  1398/06/23  83174  N54\n",
      "248125  3649119572         1  1398/06/23  83176  N54\n",
      "\n",
      "[871 rows x 5 columns]\n",
      "first row of the selected chunck : \n",
      " [1001929550 1 '1398/06/23' 24329 'N54']\n",
      "871\n",
      "t0 = 24329\n",
      "ts = 83176\n",
      "time_intervals 98\n",
      "Origin destination interval view reindex \n",
      "     time_in  time_out\n",
      "0   24329.0   24929.0\n",
      "1   27329.0   27929.0\n",
      "2   30329.0   32729.0\n",
      "3   36329.0   36929.0\n",
      "4   41129.0   41729.0\n",
      "5   45329.0   46529.0\n",
      "6   50129.0   51929.0\n",
      "7   54329.0   55529.0\n",
      "8   58529.0   61529.0\n",
      "9   69929.0   71129.0\n",
      "10  74129.0   81329.0\n",
      "OD bus stations of transactions: \n",
      "            CardID LineCode       FDate   Time  plat Station\n",
      "0       542446139        1  1398/06/23  24030  A145    3169\n",
      "1      2620656172        1  1398/06/23  24302  A145    3169\n",
      "2      3446252780        1  1398/06/23  26200  A145    1227\n",
      "3         7900260        1  1398/06/23  29677  A145    3169\n",
      "4       361857972        1  1398/06/23  29720  A145    3169\n",
      "...           ...      ...         ...    ...   ...     ...\n",
      "12754   480084900        1  1398/06/23  80848   N54    3169\n",
      "12755   261881697        1  1398/06/23  80851   N54    3169\n",
      "12756   261881697        1  1398/06/23  80854   N54    3169\n",
      "12757   721844443        1  1398/06/23  81029   N54    3169\n",
      "12758   721844443        1  1398/06/23  81031   N54    3169\n",
      "\n",
      "[12759 rows x 6 columns]\n",
      "transactions in line 1 plat N77\n",
      "ps: \n",
      "              CardID  LineCode       FDate   Time plat\n",
      "332236  3180917550         1  1398/06/23  26905  N77\n",
      "332237  2658264780         1  1398/06/23  26919  N77\n",
      "332238  3152120814         1  1398/06/23  26933  N77\n",
      "332239  1360798042         1  1398/06/23  26936  N77\n",
      "332240  2590432404         1  1398/06/23  26955  N77\n",
      "...            ...       ...         ...    ...  ...\n",
      "386932  4266059938         1  1398/06/23  32843  N77\n",
      "386933  1407250245         1  1398/06/23  32845  N77\n",
      "386934  1407250245         1  1398/06/23  32846  N77\n",
      "386935  1598737700         1  1398/06/23  32851  N77\n",
      "386936  1407179025         1  1398/06/23  33307  N77\n",
      "\n",
      "[146 rows x 5 columns]\n",
      "first row of the selected chunck : \n",
      " [3180917550 1 '1398/06/23' 26905 'N77']\n",
      "146\n",
      "t0 = 26905\n",
      "ts = 33307\n",
      "time_intervals 11\n",
      "Origin destination interval view reindex \n",
      "    time_in  time_out\n",
      "0  26905.0   27505.0\n",
      "1  29905.0   31105.0\n",
      "OD bus stations of transactions: \n",
      "            CardID LineCode       FDate   Time  plat Station\n",
      "0       542446139        1  1398/06/23  24030  A145    3169\n",
      "1      2620656172        1  1398/06/23  24302  A145    3169\n",
      "2      3446252780        1  1398/06/23  26200  A145    1227\n",
      "3         7900260        1  1398/06/23  29677  A145    3169\n",
      "4       361857972        1  1398/06/23  29720  A145    3169\n",
      "...           ...      ...         ...    ...   ...     ...\n",
      "13474   210967787        1  1398/06/23  30961   N77    1227\n",
      "13475   210967787        1  1398/06/23  30962   N77    1227\n",
      "13476  3650200020        1  1398/06/23  31057   N77    1227\n",
      "13477  2115776132        1  1398/06/23  31059   N77    1227\n",
      "13478  2129801828        1  1398/06/23  31061   N77    1227\n",
      "\n",
      "[13479 rows x 6 columns]\n",
      "stations in a specefic bus line 4\n",
      "len-of-go stations: 15\n",
      "len-of-back stations: 13\n",
      "len-of-go back stations: 0\n",
      "first Station  [3194 '4' '1' 'go' '?????-4' 51.725886 32.693692 'od' 'normal' 'no'] 3194\n",
      "last Station  [2566 '4' '1' 'back' '????? ???-35-13-5-4' 51.691879 32.678663 'od'\n",
      " 'normal' 'no']\n",
      "['A41' 'F143' 'M32' 'M69' 'N32' 'N85' 'N86']\n",
      "transactions in line 4 plat A41\n",
      "ps: \n",
      "              CardID  LineCode       FDate   Time plat\n",
      "610200  3555123457         4  1398/06/23  49452  A41\n",
      "610201  4057924509         4  1398/06/23  49823  A41\n",
      "610202  2742155044         4  1398/06/23  51146  A41\n",
      "610209   737305312         4  1398/06/23  51146  A41\n",
      "610210  1957809908         4  1398/06/23  51148  A41\n",
      "...            ...       ...         ...    ...  ...\n",
      "610783  3405924757         4  1398/06/23  73620  A41\n",
      "610784   261077665         4  1398/06/23  73625  A41\n",
      "610785  4275729938         4  1398/06/23  73629  A41\n",
      "610786  2123163076         4  1398/06/23  73632  A41\n",
      "610794   537741934         4  1398/06/23  75003  A41\n",
      "\n",
      "[138 rows x 5 columns]\n",
      "first row of the selected chunck : \n",
      " [3555123457 4 '1398/06/23' 49452 'A41']\n",
      "138\n",
      "t0 = 49452\n",
      "ts = 75003\n",
      "time_intervals 43\n",
      "Origin destination interval view reindex \n",
      "     time_in  time_out\n",
      "0   49452.0   50052.0\n",
      "1   50652.0   51252.0\n",
      "2   51852.0   52452.0\n",
      "3   53052.0   54252.0\n",
      "4   55452.0   56052.0\n",
      "5   56652.0   58452.0\n",
      "6   59652.0   60252.0\n",
      "7   60852.0   63252.0\n",
      "8   65652.0   69252.0\n",
      "9   70452.0   71052.0\n",
      "10  71652.0   72852.0\n",
      "11  73452.0   74052.0\n",
      "12  74652.0   75252.0\n",
      "OD bus stations of transactions: \n",
      "            CardID LineCode       FDate   Time  plat Station\n",
      "0       542446139        1  1398/06/23  24030  A145    3169\n",
      "1      2620656172        1  1398/06/23  24302  A145    3169\n",
      "2      3446252780        1  1398/06/23  26200  A145    1227\n",
      "3         7900260        1  1398/06/23  29677  A145    3169\n",
      "4       361857972        1  1398/06/23  29720  A145    3169\n",
      "...           ...      ...         ...    ...   ...     ...\n",
      "13612  3405924757        4  1398/06/23  73620   A41    2566\n",
      "13613   261077665        4  1398/06/23  73625   A41    2566\n",
      "13614  4275729938        4  1398/06/23  73629   A41    2566\n",
      "13615  2123163076        4  1398/06/23  73632   A41    2566\n",
      "13616   537741934        4  1398/06/23  75003   A41    3194\n",
      "\n",
      "[13617 rows x 6 columns]\n",
      "transactions in line 4 plat F143\n",
      "ps: \n",
      "              CardID  LineCode       FDate   Time  plat\n",
      "222340  3791978124         4  1398/06/23  24718  F143\n",
      "222341   427308734         4  1398/06/23  24766  F143\n",
      "222342  3184027070         4  1398/06/23  24769  F143\n",
      "222343   428493230         4  1398/06/23  24771  F143\n",
      "222344  2498674564         4  1398/06/23  24775  F143\n",
      "...            ...       ...         ...    ...   ...\n",
      "132974  3405914288         4  1398/06/23  73577  F143\n",
      "132975  2855075790         4  1398/06/23  73692  F143\n",
      "132976  2741552644         4  1398/06/23  74260  F143\n",
      "132977  4278387810         4  1398/06/23  75748  F143\n",
      "132978  4265672658         4  1398/06/23  75944  F143\n",
      "\n",
      "[557 rows x 5 columns]\n",
      "first row of the selected chunck : \n",
      " [3791978124 4 '1398/06/23' 24718 'F143']\n",
      "557\n",
      "t0 = 24718\n",
      "ts = 75944\n",
      "time_intervals 85\n",
      "Origin destination interval view reindex \n",
      "     time_in  time_out\n",
      "0   24718.0   25318.0\n",
      "1   27118.0   28318.0\n",
      "2   29518.0   30118.0\n",
      "3   31318.0   31918.0\n",
      "4   46318.0   46918.0\n",
      "5   49918.0   50518.0\n",
      "6   51118.0   51718.0\n",
      "7   52318.0   53518.0\n",
      "8   57118.0   57718.0\n",
      "9   60118.0   60718.0\n",
      "10  75118.0   75718.0\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "OD bus stations of transactions: \n",
      "            CardID LineCode       FDate   Time  plat Station\n",
      "0       542446139        1  1398/06/23  24030  A145    3169\n",
      "1      2620656172        1  1398/06/23  24302  A145    3169\n",
      "2      3446252780        1  1398/06/23  26200  A145    1227\n",
      "3         7900260        1  1398/06/23  29677  A145    3169\n",
      "4       361857972        1  1398/06/23  29720  A145    3169\n",
      "...           ...      ...         ...    ...   ...     ...\n",
      "13715  3794558028        4  1398/06/23  57484  F143    3194\n",
      "13716   344261892        4  1398/06/23  57485  F143    3194\n",
      "13717  2123471780        4  1398/06/23  57486  F143    3194\n",
      "13718   299437931        4  1398/06/23  60174  F143    2566\n",
      "13719  3104791182        4  1398/06/23  60546  F143    2566\n",
      "\n",
      "[13720 rows x 6 columns]\n",
      "transactions in line 4 plat M32\n",
      "ps: \n",
      "              CardID  LineCode       FDate   Time plat\n",
      "183330  2742412836         4  1398/06/23  22432  M32\n",
      "183332  3151006366         4  1398/06/23  22450  M32\n",
      "183331   869399428         4  1398/06/23  22509  M32\n",
      "183333  2048254594         4  1398/06/23  22545  M32\n",
      "183334  3206596796         4  1398/06/23  22808  M32\n",
      "...            ...       ...         ...    ...  ...\n",
      "106185   869450747         4  1398/06/23  79586  M32\n",
      "106186   869450747         4  1398/06/23  79587  M32\n",
      "106187   262546817         4  1398/06/23  79625  M32\n",
      "106188  1590256148         4  1398/06/23  80160  M32\n",
      "106189  1832224605         4  1398/06/23  80170  M32\n",
      "\n",
      "[532 rows x 5 columns]\n",
      "first row of the selected chunck : \n",
      " [2742412836 4 '1398/06/23' 22432 'M32']\n",
      "532\n",
      "t0 = 22432\n",
      "ts = 80170\n",
      "time_intervals 96\n",
      "Origin destination interval view reindex \n",
      "     time_in  time_out\n",
      "0   22432.0   23032.0\n",
      "1   23632.0   24232.0\n",
      "2   24832.0   26032.0\n",
      "3   28432.0   29032.0\n",
      "4   32632.0   33232.0\n",
      "5   47632.0   48232.0\n",
      "6   51232.0   51832.0\n",
      "7   52432.0   53032.0\n",
      "8   57832.0   58432.0\n",
      "9   61432.0   62032.0\n",
      "10  65632.0   66832.0\n",
      "11  72832.0   78232.0\n",
      "OD bus stations of transactions: \n",
      "            CardID LineCode       FDate   Time  plat Station\n",
      "0       542446139        1  1398/06/23  24030  A145    3169\n",
      "1      2620656172        1  1398/06/23  24302  A145    3169\n",
      "2      3446252780        1  1398/06/23  26200  A145    1227\n",
      "3         7900260        1  1398/06/23  29677  A145    3169\n",
      "4       361857972        1  1398/06/23  29720  A145    3169\n",
      "...           ...      ...         ...    ...   ...     ...\n",
      "14240   263131649        4  1398/06/23  77648   M32    2566\n",
      "14241  3179660750        4  1398/06/23  77869   M32    2566\n",
      "14242  2507966036        4  1398/06/23  78057   M32    2566\n",
      "14243  3553311804        4  1398/06/23  78212   M32    2566\n",
      "14244   722095965        4  1398/06/23  78220   M32    2566\n",
      "\n",
      "[14245 rows x 6 columns]\n",
      "transactions in line 4 plat M69\n",
      "ps: \n",
      "              CardID  LineCode       FDate   Time plat\n",
      "132981  3793032476         4  1398/06/23  23978  M69\n",
      "132983  2125656100         4  1398/06/23  24194  M69\n",
      "132982  3553270492         4  1398/06/23  24200  M69\n",
      "132984   722076754         4  1398/06/23  24297  M69\n",
      "132985  2526758386         4  1398/06/23  24487  M69\n",
      "...            ...       ...         ...    ...  ...\n",
      "307760  2741101716         4  1398/06/23  76617  M69\n",
      "307762   721886691         4  1398/06/23  76628  M69\n",
      "307761   721830338         4  1398/06/23  76642  M69\n",
      "307763   992173406         4  1398/06/23  76680  M69\n",
      "307764  2740743220         4  1398/06/23  77230  M69\n",
      "\n",
      "[555 rows x 5 columns]\n",
      "first row of the selected chunck : \n",
      " [3793032476 4 '1398/06/23' 23978 'M69']\n",
      "555\n",
      "t0 = 23978\n",
      "ts = 77230\n",
      "time_intervals 89\n",
      "Origin destination interval view reindex \n",
      "     time_in  time_out\n",
      "0   23978.0   24578.0\n",
      "1   26978.0   27578.0\n",
      "2   30578.0   31178.0\n",
      "3   45578.0   46178.0\n",
      "4   52178.0   52778.0\n",
      "5   53978.0   54578.0\n",
      "6   59978.0   60578.0\n",
      "7   63578.0   64178.0\n",
      "8   64778.0   65378.0\n",
      "9   67178.0   68378.0\n",
      "10  71378.0   71978.0\n",
      "OD bus stations of transactions: \n",
      "            CardID LineCode       FDate   Time  plat Station\n",
      "0       542446139        1  1398/06/23  24030  A145    3169\n",
      "1      2620656172        1  1398/06/23  24302  A145    3169\n",
      "2      3446252780        1  1398/06/23  26200  A145    1227\n",
      "3         7900260        1  1398/06/23  29677  A145    3169\n",
      "4       361857972        1  1398/06/23  29720  A145    3169\n",
      "...           ...      ...         ...    ...   ...     ...\n",
      "14742   869235065        4  1398/06/23  65314   M69    3194\n",
      "14743   721910035        4  1398/06/23  65319   M69    3194\n",
      "14744  2741846292        4  1398/06/23  65338   M69    3194\n",
      "14745  4270712578        4  1398/06/23  68289   M69    2566\n",
      "14746  2124184724        4  1398/06/23  71843   M69    3194\n",
      "\n",
      "[14747 rows x 6 columns]\n",
      "transactions in line 4 plat N32\n",
      "ps: \n",
      "              CardID  LineCode       FDate   Time plat\n",
      "64158   1528850062         4  1398/06/23  23615  N32\n",
      "64159   3183224046         4  1398/06/23  23675  N32\n",
      "64162    177891126         4  1398/06/23  23676  N32\n",
      "64160    721805566         4  1398/06/23  23730  N32\n",
      "64161    203138268         4  1398/06/23  23777  N32\n",
      "...            ...       ...         ...    ...  ...\n",
      "455058  2044864286         4  1398/06/23  75579  N32\n",
      "455052  2742293908         4  1398/06/23  75589  N32\n",
      "455059  3445473980         4  1398/06/23  76450  N32\n",
      "455060  3445473980         4  1398/06/23  76451  N32\n",
      "455061  2044319038         4  1398/06/23  76581  N32\n",
      "\n",
      "[406 rows x 5 columns]\n",
      "first row of the selected chunck : \n",
      " [1528850062 4 '1398/06/23' 23615 'N32']\n",
      "406\n",
      "t0 = 23615\n",
      "ts = 76581\n",
      "time_intervals 88\n",
      "Origin destination interval view reindex \n",
      "     time_in  time_out\n",
      "0   23615.0   24215.0\n",
      "1   25415.0   27215.0\n",
      "2   30215.0   30815.0\n",
      "3   33815.0   34415.0\n",
      "4   36215.0   39215.0\n",
      "5   45215.0   50015.0\n",
      "6   51815.0   52415.0\n",
      "7   55415.0   56015.0\n",
      "8   59015.0   59615.0\n",
      "9   60815.0   61415.0\n",
      "10  62615.0   63215.0\n",
      "11  66215.0   66815.0\n",
      "12  69815.0   71015.0\n",
      "OD bus stations of transactions: \n",
      "            CardID LineCode       FDate   Time  plat Station\n",
      "0       542446139        1  1398/06/23  24030  A145    3169\n",
      "1      2620656172        1  1398/06/23  24302  A145    3169\n",
      "2      3446252780        1  1398/06/23  26200  A145    1227\n",
      "3         7900260        1  1398/06/23  29677  A145    3169\n",
      "4       361857972        1  1398/06/23  29720  A145    3169\n",
      "...           ...      ...         ...    ...   ...     ...\n",
      "15230  2138012845        4  1398/06/23  70538   N32    3194\n",
      "15231  3183997166        4  1398/06/23  70820   N32    3194\n",
      "15232  3180291982        4  1398/06/23  70887   N32    3194\n",
      "15233  3794180044        4  1398/06/23  70961   N32    3194\n",
      "15234   233459258        4  1398/06/23  70977   N32    3194\n",
      "\n",
      "[15235 rows x 6 columns]\n",
      "transactions in line 4 plat N85\n",
      "ps: \n",
      "             CardID  LineCode       FDate   Time plat\n",
      "82756   211040492         4  1398/06/23  22917  N85\n",
      "82757   721921419         4  1398/06/23  22973  N85\n",
      "82758   185130390         4  1398/06/23  22977  N85\n",
      "82760  3556218337         4  1398/06/23  23042  N85\n",
      "82759  1598804404         4  1398/06/23  23083  N85\n",
      "...           ...       ...         ...    ...  ...\n",
      "70423   235851722         4  1398/06/23  74736  N85\n",
      "70424  2045268478         4  1398/06/23  74741  N85\n",
      "73141  2045268478         4  1398/06/23  74742  N85\n",
      "73142  2045268478         4  1398/06/23  74744  N85\n",
      "73143  4266616578         4  1398/06/23  74777  N85\n",
      "\n",
      "[524 rows x 5 columns]\n",
      "first row of the selected chunck : \n",
      " [211040492 4 '1398/06/23' 22917 'N85']\n",
      "524\n",
      "t0 = 22917\n",
      "ts = 74777\n",
      "time_intervals 86\n",
      "Origin destination interval view reindex \n",
      "     time_in  time_out\n",
      "0   22917.0   23517.0\n",
      "1   24117.0   24717.0\n",
      "2   25317.0   26517.0\n",
      "3   28917.0   30117.0\n",
      "4   33117.0   33717.0\n",
      "5   49317.0   49917.0\n",
      "6   51117.0   52317.0\n",
      "7   52917.0   53517.0\n",
      "8   54717.0   55317.0\n",
      "9   58317.0   59517.0\n",
      "10  61917.0   62517.0\n",
      "11  69117.0   69717.0\n",
      "12  73317.0   73917.0\n",
      "OD bus stations of transactions: \n",
      "            CardID LineCode       FDate   Time  plat Station\n",
      "0       542446139        1  1398/06/23  24030  A145    3169\n",
      "1      2620656172        1  1398/06/23  24302  A145    3169\n",
      "2      3446252780        1  1398/06/23  26200  A145    1227\n",
      "3         7900260        1  1398/06/23  29677  A145    3169\n",
      "4       361857972        1  1398/06/23  29720  A145    3169\n",
      "...           ...      ...         ...    ...   ...     ...\n",
      "15582  3555655633        4  1398/06/23  69707   N85    2566\n",
      "15583  3649797924        4  1398/06/23  73407   N85    3194\n",
      "15584  3649797924        4  1398/06/23  73409   N85    3194\n",
      "15585  1001377406        4  1398/06/23  73411   N85    3194\n",
      "15586  2116160212        4  1398/06/23  73479   N85    3194\n",
      "\n",
      "[15587 rows x 6 columns]\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "transactions in line 4 plat N86\n",
      "ps: \n",
      "              CardID  LineCode       FDate   Time plat\n",
      "208436  3207635477         4  1398/06/23  23174  N86\n",
      "208437   262767825         4  1398/06/23  24696  N86\n",
      "208438   428048542         4  1398/06/23  25326  N86\n",
      "208439   721927538         4  1398/06/23  25377  N86\n",
      "208440   722114626         4  1398/06/23  25381  N86\n",
      "...            ...       ...         ...    ...  ...\n",
      "284410  1835092029         4  1398/06/23  77119  N86\n",
      "284412  3108929845         4  1398/06/23  77418  N86\n",
      "284413  3108929845         4  1398/06/23  77420  N86\n",
      "284414  2137591661         4  1398/06/23  77530  N86\n",
      "284411  3258050813         4  1398/06/23  77575  N86\n",
      "\n",
      "[585 rows x 5 columns]\n",
      "first row of the selected chunck : \n",
      " [3207635477 4 '1398/06/23' 23174 'N86']\n",
      "585\n",
      "t0 = 23174\n",
      "ts = 77575\n",
      "time_intervals 91\n",
      "Origin destination interval view reindex \n",
      "    time_in  time_out\n",
      "0  23174.0   24974.0\n",
      "1  27974.0   28574.0\n",
      "2  32174.0   32774.0\n",
      "3  53774.0   54374.0\n",
      "4  58574.0   59174.0\n",
      "5  64574.0   65174.0\n",
      "6  72974.0   73574.0\n",
      "7  75974.0   76574.0\n",
      "OD bus stations of transactions: \n",
      "            CardID LineCode       FDate   Time  plat Station\n",
      "0       542446139        1  1398/06/23  24030  A145    3169\n",
      "1      2620656172        1  1398/06/23  24302  A145    3169\n",
      "2      3446252780        1  1398/06/23  26200  A145    1227\n",
      "3         7900260        1  1398/06/23  29677  A145    3169\n",
      "4       361857972        1  1398/06/23  29720  A145    3169\n",
      "...           ...      ...         ...    ...   ...     ...\n",
      "16062   262755521        4  1398/06/23  76151   N86    2566\n",
      "16063   262755521        4  1398/06/23  76152   N86    2566\n",
      "16064   262755521        4  1398/06/23  76154   N86    2566\n",
      "16065   429531966        4  1398/06/23  76358   N86    2566\n",
      "16066   429531966        4  1398/06/23  76360   N86    2566\n",
      "\n",
      "[16067 rows x 6 columns]\n",
      "stations in a specefic bus line 5\n",
      "len-of-go stations: 20\n",
      "len-of-back stations: 20\n",
      "len-of-go back stations: 0\n",
      "first Station  [3852 '5' '1' 'go' '???-149-5' 51.755775 32.703288 'od' 'normal' 'no'] 3852\n",
      "last Station  [2566 '5' '1' 'back' '????? ???-35-13-5-4' 51.691879 32.678663 'od'\n",
      " 'normal' 'no']\n",
      "['A142' 'A51' 'B118' 'B52' 'E106' 'E166' 'E213' 'E26' 'F20' 'F64' 'N35']\n",
      "transactions in line 5 plat A142\n",
      "ps: \n",
      "              CardID  LineCode       FDate   Time  plat\n",
      "180965  2677271700         5  1398/06/23  23180  A142\n",
      "180966  2677271700         5  1398/06/23  23181  A142\n",
      "180967  4266587874         5  1398/06/23  24765  A142\n",
      "180968   805724146         5  1398/06/23  24784  A142\n",
      "180969  3648623908         5  1398/06/23  24827  A142\n",
      "...            ...       ...         ...    ...   ...\n",
      "576225  1371217246         5  1398/06/23  74874  A142\n",
      "576226  3153061854         5  1398/06/23  75188  A142\n",
      "576227  3153061854         5  1398/06/23  75189  A142\n",
      "576228  3792571340         5  1398/06/23  75239  A142\n",
      "576229  3792571340         5  1398/06/23  75240  A142\n",
      "\n",
      "[519 rows x 5 columns]\n",
      "first row of the selected chunck : \n",
      " [2677271700 5 '1398/06/23' 23180 'A142']\n",
      "519\n",
      "t0 = 23180\n",
      "ts = 75240\n",
      "time_intervals 87\n",
      "Origin destination interval view reindex \n",
      "     time_in  time_out\n",
      "0   23180.0   23780.0\n",
      "1   24380.0   24980.0\n",
      "2   29780.0   30380.0\n",
      "3   35180.0   35780.0\n",
      "4   38180.0   38780.0\n",
      "5   41180.0   41780.0\n",
      "6   47180.0   47780.0\n",
      "7   51380.0   57980.0\n",
      "8   63380.0   63980.0\n",
      "9   66380.0   66980.0\n",
      "10  69980.0   70580.0\n",
      "11  72980.0   73580.0\n",
      "OD bus stations of transactions: \n",
      "            CardID LineCode       FDate   Time  plat Station\n",
      "0       542446139        1  1398/06/23  24030  A145    3169\n",
      "1      2620656172        1  1398/06/23  24302  A145    3169\n",
      "2      3446252780        1  1398/06/23  26200  A145    1227\n",
      "3         7900260        1  1398/06/23  29677  A145    3169\n",
      "4       361857972        1  1398/06/23  29720  A145    3169\n",
      "...           ...      ...         ...    ...   ...     ...\n",
      "16677   262864753        5  1398/06/23  73202  A142    2566\n",
      "16678  3258040893        5  1398/06/23  73421  A142    2566\n",
      "16679  2052389890        5  1398/06/23  73448  A142    2566\n",
      "16680  3792571340        5  1398/06/23  73534  A142    2566\n",
      "16681  1529682318        5  1398/06/23  73564  A142    2566\n",
      "\n",
      "[16682 rows x 6 columns]\n",
      "transactions in line 5 plat A51\n",
      "ps: \n",
      "              CardID  LineCode       FDate   Time plat\n",
      "487951  2620652492         5  1398/06/23  23256  A51\n",
      "487952  3997195028         5  1398/06/23  23705  A51\n",
      "487953  4275381042         5  1398/06/23  23707  A51\n",
      "487954   722251184         5  1398/06/23  23714  A51\n",
      "668669   722251184         5  1398/06/23  23715  A51\n",
      "...            ...       ...         ...    ...  ...\n",
      "489728  2129727156         5  1398/06/23  76092  A51\n",
      "489729  4245086919         5  1398/06/23  76412  A51\n",
      "489730   722270604         5  1398/06/23  76800  A51\n",
      "489731  2681767550         5  1398/06/23  77010  A51\n",
      "489732   261113521         5  1398/06/23  77459  A51\n",
      "\n",
      "[564 rows x 5 columns]\n",
      "first row of the selected chunck : \n",
      " [2620652492 5 '1398/06/23' 23256 'A51']\n",
      "564\n",
      "t0 = 23256\n",
      "ts = 77459\n",
      "time_intervals 90\n",
      "Origin destination interval view reindex \n",
      "    time_in  time_out\n",
      "0  23256.0   23856.0\n",
      "1  31056.0   31656.0\n",
      "2  43056.0   43656.0\n",
      "3  48456.0   49056.0\n",
      "4  53256.0   54456.0\n",
      "5  59856.0   60456.0\n",
      "6  65856.0   66456.0\n",
      "7  71856.0   73056.0\n",
      "8  73656.0   74256.0\n",
      "9  74856.0   76056.0\n",
      "OD bus stations of transactions: \n",
      "            CardID LineCode       FDate   Time  plat Station\n",
      "0       542446139        1  1398/06/23  24030  A145    3169\n",
      "1      2620656172        1  1398/06/23  24302  A145    3169\n",
      "2      3446252780        1  1398/06/23  26200  A145    1227\n",
      "3         7900260        1  1398/06/23  29677  A145    3169\n",
      "4       361857972        1  1398/06/23  29720  A145    3169\n",
      "...           ...      ...         ...    ...   ...     ...\n",
      "17076  4270251954        5  1398/06/23  75671   A51    2566\n",
      "17077  1598991604        5  1398/06/23  75674   A51    2566\n",
      "17078  1598991604        5  1398/06/23  75732   A51    2566\n",
      "17079  3180840718        5  1398/06/23  75859   A51    2566\n",
      "17080  1524384724        5  1398/06/23  76008   A51    2566\n",
      "\n",
      "[17081 rows x 6 columns]\n",
      "transactions in line 5 plat B118\n",
      "ps: \n",
      "              CardID  LineCode       FDate   Time  plat\n",
      "127295  2124085700         5  1398/06/23  24823  B118\n",
      "127296   173526932         5  1398/06/23  25310  B118\n",
      "127297   176657270         5  1398/06/23  25679  B118\n",
      "127298  2239122753         5  1398/06/23  25947  B118\n",
      "127299  3558518705         5  1398/06/23  26244  B118\n",
      "...            ...       ...         ...    ...   ...\n",
      "127725  1765294676         5  1398/06/23  46011  B118\n",
      "127728  3997004260         5  1398/06/23  46095  B118\n",
      "127729  3997004260         5  1398/06/23  46096  B118\n",
      "127730   425709982         5  1398/06/23  46194  B118\n",
      "127731  1528435742         5  1398/06/23  46309  B118\n",
      "\n",
      "[86 rows x 5 columns]\n",
      "first row of the selected chunck : \n",
      " [2124085700 5 '1398/06/23' 24823 'B118']\n",
      "86\n",
      "t0 = 24823\n",
      "ts = 46309\n",
      "time_intervals 36\n",
      "Origin destination interval view reindex \n",
      "    time_in  time_out\n",
      "0  24823.0   25423.0\n",
      "1  27223.0   27823.0\n",
      "2  30223.0   35023.0\n",
      "3  36223.0   36823.0\n",
      "4  40423.0   41623.0\n",
      "5  43423.0   44023.0\n",
      "6  44623.0   45223.0\n",
      "OD bus stations of transactions: \n",
      "            CardID LineCode       FDate   Time  plat Station\n",
      "0       542446139        1  1398/06/23  24030  A145    3169\n",
      "1      2620656172        1  1398/06/23  24302  A145    3169\n",
      "2      3446252780        1  1398/06/23  26200  A145    1227\n",
      "3         7900260        1  1398/06/23  29677  A145    3169\n",
      "4       361857972        1  1398/06/23  29720  A145    3169\n",
      "...           ...      ...         ...    ...   ...     ...\n",
      "17625  3151407886        5  1398/06/23  43677  B118    2566\n",
      "17626  3151407886        5  1398/06/23  43679  B118    2566\n",
      "17627  4276256690        5  1398/06/23  43868  B118    2566\n",
      "17628  2497942701        5  1398/06/23  45010  B118    3852\n",
      "17629  2497942701        5  1398/06/23  45011  B118    3852\n",
      "\n",
      "[17630 rows x 6 columns]\n",
      "transactions in line 5 plat B52\n",
      "ps: \n",
      "              CardID  LineCode       FDate   Time plat\n",
      "395005   722077229         5  1398/06/23  21166  B52\n",
      "395006  3154040414         5  1398/06/23  21670  B52\n",
      "395007  2052199794         5  1398/06/23  22356  B52\n",
      "395008  2505049508         5  1398/06/23  22959  B52\n",
      "395009   361341252         5  1398/06/23  22964  B52\n",
      "...            ...       ...         ...    ...  ...\n",
      "526811   736297856         5  1398/06/23  72552  B52\n",
      "526812  1833278253         5  1398/06/23  72565  B52\n",
      "526813   484359412         5  1398/06/23  72716  B52\n",
      "526814  2232480691         5  1398/06/23  72839  B52\n",
      "526815   722240554         5  1398/06/23  73103  B52\n",
      "\n",
      "[561 rows x 5 columns]\n",
      "first row of the selected chunck : \n",
      " [722077229 5 '1398/06/23' 21166 'B52']\n",
      "561\n",
      "t0 = 21166\n",
      "ts = 73103\n",
      "time_intervals 87\n",
      "Origin destination interval view reindex \n",
      "    time_in  time_out\n",
      "0  21166.0   21766.0\n",
      "1  28366.0   28966.0\n",
      "2  33166.0   34366.0\n",
      "3  36766.0   37366.0\n",
      "4  45766.0   46366.0\n",
      "5  46966.0   47566.0\n",
      "6  61966.0   63166.0\n",
      "7  64966.0   65566.0\n",
      "8  67966.0   68566.0\n",
      "9  70966.0   71566.0\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "OD bus stations of transactions: \n",
      "            CardID LineCode       FDate   Time  plat Station\n",
      "0       542446139        1  1398/06/23  24030  A145    3169\n",
      "1      2620656172        1  1398/06/23  24302  A145    3169\n",
      "2      3446252780        1  1398/06/23  26200  A145    1227\n",
      "3         7900260        1  1398/06/23  29677  A145    3169\n",
      "4       361857972        1  1398/06/23  29720  A145    3169\n",
      "...           ...      ...         ...    ...   ...     ...\n",
      "17747  2047877874        5  1398/06/23  71511   B52    2566\n",
      "17748   262657697        5  1398/06/23  71513   B52    2566\n",
      "17749  1283444062        5  1398/06/23  71522   B52    2566\n",
      "17750  3444965916        5  1398/06/23  71525   B52    2566\n",
      "17751  2118117428        5  1398/06/23  71545   B52    2566\n",
      "\n",
      "[17752 rows x 6 columns]\n",
      "transactions in line 5 plat E106\n",
      "ps: \n",
      "              CardID  LineCode       FDate   Time  plat\n",
      "271774  2677645508         5  1398/06/23  50440  E106\n",
      "271772  1407219819         5  1398/06/23  50454  E106\n",
      "271778   721866188         5  1398/06/23  50985  E106\n",
      "271781   261709857         5  1398/06/23  51108  E106\n",
      "271783  3257799197         5  1398/06/23  51110  E106\n",
      "...            ...       ...         ...    ...   ...\n",
      "222841  2961880773         5  1398/06/23  74200  E106\n",
      "222844  3258464269         5  1398/06/23  74263  E106\n",
      "222846  2239172196         5  1398/06/23  74622  E106\n",
      "228544  2239172196         5  1398/06/23  74624  E106\n",
      "228545   722206368         5  1398/06/23  74641  E106\n",
      "\n",
      "[128 rows x 5 columns]\n",
      "first row of the selected chunck : \n",
      " [2677645508 5 '1398/06/23' 50440 'E106']\n",
      "128\n",
      "t0 = 50440\n",
      "ts = 74641\n",
      "time_intervals 40\n",
      "Origin destination interval view reindex \n",
      "    time_in  time_out\n",
      "0  50440.0   51040.0\n",
      "1  52840.0   54040.0\n",
      "2  54640.0   56440.0\n",
      "3  57040.0   59440.0\n",
      "4  61840.0   64240.0\n",
      "5  67240.0   69640.0\n",
      "6  71440.0   72040.0\n",
      "7  72640.0   74440.0\n",
      "OD bus stations of transactions: \n",
      "            CardID LineCode       FDate   Time  plat Station\n",
      "0       542446139        1  1398/06/23  24030  A145    3169\n",
      "1      2620656172        1  1398/06/23  24302  A145    3169\n",
      "2      3446252780        1  1398/06/23  26200  A145    1227\n",
      "3         7900260        1  1398/06/23  29677  A145    3169\n",
      "4       361857972        1  1398/06/23  29720  A145    3169\n",
      "...           ...      ...         ...    ...   ...     ...\n",
      "18192  2136925661        5  1398/06/23  74191  E106    2566\n",
      "18193  2044812526        5  1398/06/23  74194  E106    2566\n",
      "18194  2961880773        5  1398/06/23  74198  E106    2566\n",
      "18195  2961880773        5  1398/06/23  74200  E106    2566\n",
      "18196  3258464269        5  1398/06/23  74263  E106    2566\n",
      "\n",
      "[18197 rows x 6 columns]\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "C:\\Users\\esmaeli.h\\AppData\\Local\\Temp/ipykernel_12452/1949912630.py:257: ConvergenceWarning: Number of distinct clusters (17) found smaller than n_clusters (19). Possibly due to duplicate points in X.\n",
      "  kmeans = KMeans(n_clusters=len(filter_go_stations)-1,random_state=0).fit(partial_times.to_numpy())\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "transactions in line 5 plat E166\n",
      "ps: \n",
      "              CardID  LineCode       FDate   Time  plat\n",
      "161179  3997583556         5  1398/06/23  22875  E166\n",
      "161180   722142994         5  1398/06/23  23976  E166\n",
      "161181   722173246         5  1398/06/23  23979  E166\n",
      "161182  2233929731         5  1398/06/23  24192  E166\n",
      "161183  1788518292         5  1398/06/23  24349  E166\n",
      "...            ...       ...         ...    ...   ...\n",
      "222332   869263674         5  1398/06/23  75312  E166\n",
      "222333  2741605748         5  1398/06/23  75503  E166\n",
      "222335   869263674         5  1398/06/23  75597  E166\n",
      "222334  1595436916         5  1398/06/23  75719  E166\n",
      "222336  2137648237         5  1398/06/23  75957  E166\n",
      "\n",
      "[441 rows x 5 columns]\n",
      "first row of the selected chunck : \n",
      " [3997583556 5 '1398/06/23' 22875 'E166']\n",
      "441\n",
      "t0 = 22875\n",
      "ts = 75957\n",
      "time_intervals 88\n",
      "Origin destination interval view reindex \n",
      "     time_in  time_out\n",
      "0   22875.0   24075.0\n",
      "1   26475.0   27075.0\n",
      "2   28875.0   30075.0\n",
      "3   33675.0   35475.0\n",
      "4   40275.0   40875.0\n",
      "5   45675.0   46275.0\n",
      "6   50475.0   51675.0\n",
      "7   52875.0   54675.0\n",
      "8   56475.0   57675.0\n",
      "9   59475.0   60675.0\n",
      "10  62475.0   63075.0\n",
      "11  65475.0   66075.0\n",
      "12  67275.0   67875.0\n",
      "13  69075.0   69675.0\n",
      "14  74475.0   75675.0\n",
      "OD bus stations of transactions: \n",
      "            CardID LineCode       FDate   Time  plat Station\n",
      "0       542446139        1  1398/06/23  24030  A145    3169\n",
      "1      2620656172        1  1398/06/23  24302  A145    3169\n",
      "2      3446252780        1  1398/06/23  26200  A145    1227\n",
      "3         7900260        1  1398/06/23  29677  A145    3169\n",
      "4       361857972        1  1398/06/23  29720  A145    3169\n",
      "...           ...      ...         ...    ...   ...     ...\n",
      "18337   721882937        5  1398/06/23  69421  E166    2566\n",
      "18338   176881990        5  1398/06/23  69537  E166    2566\n",
      "18339   869263674        5  1398/06/23  75312  E166    3852\n",
      "18340  2741605748        5  1398/06/23  75503  E166    3852\n",
      "18341   869263674        5  1398/06/23  75597  E166    3852\n",
      "\n",
      "[18342 rows x 6 columns]\n",
      "transactions in line 5 plat E213\n",
      "ps: \n",
      "              CardID  LineCode       FDate   Time  plat\n",
      "605748   362447300         5  1398/06/23  66734  E213\n",
      "605749   362447300         5  1398/06/23  66735  E213\n",
      "605750  3206485740         5  1398/06/23  67019  E213\n",
      "605751  3206485740         5  1398/06/23  67021  E213\n",
      "605753  3553698604         5  1398/06/23  67215  E213\n",
      "605754  3553698604         5  1398/06/23  67216  E213\n",
      "605752   361406532         5  1398/06/23  67218  E213\n",
      "605755   262193793         5  1398/06/23  67367  E213\n",
      "first row of the selected chunck : \n",
      " [362447300 5 '1398/06/23' 66734 'E213']\n",
      "8\n",
      "t0 = 66734\n",
      "ts = 67367\n",
      "time_intervals 1\n",
      "Origin destination interval view reindex \n",
      "    time_in  time_out\n",
      "0  66734.0   67334.0\n",
      "OD bus stations of transactions: \n",
      "            CardID LineCode       FDate   Time  plat Station\n",
      "0       542446139        1  1398/06/23  24030  A145    3169\n",
      "1      2620656172        1  1398/06/23  24302  A145    3169\n",
      "2      3446252780        1  1398/06/23  26200  A145    1227\n",
      "3         7900260        1  1398/06/23  29677  A145    3169\n",
      "4       361857972        1  1398/06/23  29720  A145    3169\n",
      "...           ...      ...         ...    ...   ...     ...\n",
      "18617  3206485740        5  1398/06/23  67019  E213    3852\n",
      "18618  3206485740        5  1398/06/23  67021  E213    3852\n",
      "18619  3553698604        5  1398/06/23  67215  E213    3852\n",
      "18620  3553698604        5  1398/06/23  67216  E213    3852\n",
      "18621   361406532        5  1398/06/23  67218  E213    3852\n",
      "\n",
      "[18622 rows x 6 columns]\n",
      "transactions in line 5 plat E26\n",
      "ps: \n",
      "              CardID  LineCode       FDate   Time plat\n",
      "102357  4058103789         5  1398/06/23  49019  E26\n",
      "102359  4058103789         5  1398/06/23  49021  E26\n",
      "102361  1598658068         5  1398/06/23  50177  E26\n",
      "102363   234432154         5  1398/06/23  50181  E26\n",
      "102365   900885844         5  1398/06/23  50183  E26\n",
      "...            ...       ...         ...    ...  ...\n",
      "291217  2136914861         5  1398/06/23  67956  E26\n",
      "291219  1788984852         5  1398/06/23  67960  E26\n",
      "291220  2123669540         5  1398/06/23  67963  E26\n",
      "291222    72811050         5  1398/06/23  67966  E26\n",
      "291223  2053061250         5  1398/06/23  67971  E26\n",
      "\n",
      "[106 rows x 5 columns]\n",
      "first row of the selected chunck : \n",
      " [4058103789 5 '1398/06/23' 49019 'E26']\n",
      "106\n",
      "t0 = 49019\n",
      "ts = 67971\n",
      "time_intervals 32\n",
      "Origin destination interval view reindex \n",
      "    time_in  time_out\n",
      "0  49019.0   49619.0\n",
      "1  51419.0   53819.0\n",
      "2  55619.0   58619.0\n",
      "3  59819.0   62219.0\n",
      "4  62819.0   63419.0\n",
      "5  64619.0   68219.0\n",
      "OD bus stations of transactions: \n",
      "            CardID LineCode       FDate   Time  plat Station\n",
      "0       542446139        1  1398/06/23  24030  A145    3169\n",
      "1      2620656172        1  1398/06/23  24302  A145    3169\n",
      "2      3446252780        1  1398/06/23  26200  A145    1227\n",
      "3         7900260        1  1398/06/23  29677  A145    3169\n",
      "4       361857972        1  1398/06/23  29720  A145    3169\n",
      "...           ...      ...         ...    ...   ...     ...\n",
      "18647  2136914861        5  1398/06/23  67956   E26    2566\n",
      "18648  1788984852        5  1398/06/23  67960   E26    2566\n",
      "18649  2123669540        5  1398/06/23  67963   E26    2566\n",
      "18650    72811050        5  1398/06/23  67966   E26    2566\n",
      "18651  2053061250        5  1398/06/23  67971   E26    2566\n",
      "\n",
      "[18652 rows x 6 columns]\n",
      "transactions in line 5 plat F20\n",
      "ps: \n",
      "              CardID  LineCode       FDate   Time plat\n",
      "179560  2741035348         5  1398/06/23  24339  F20\n",
      "179561  2741035348         5  1398/06/23  24341  F20\n",
      "179564  1368154366         5  1398/06/23  24382  F20\n",
      "179565  2239108522         5  1398/06/23  24384  F20\n",
      "179566  1835522349         5  1398/06/23  24434  F20\n",
      "...            ...       ...         ...    ...  ...\n",
      "2575    3701350597         5  1398/06/23  74926  F20\n",
      "2576    3555264433         5  1398/06/23  75148  F20\n",
      "2577    3405801314         5  1398/06/23  75413  F20\n",
      "2578     177186758         5  1398/06/23  75430  F20\n",
      "2579    3791930460         5  1398/06/23  75838  F20\n",
      "\n",
      "[420 rows x 5 columns]\n",
      "first row of the selected chunck : \n",
      " [2741035348 5 '1398/06/23' 24339 'F20']\n",
      "420\n",
      "t0 = 24339\n",
      "ts = 75838\n",
      "time_intervals 86\n",
      "Origin destination interval view reindex \n",
      "     time_in  time_out\n",
      "0   24339.0   24939.0\n",
      "1   27339.0   27939.0\n",
      "2   32739.0   33339.0\n",
      "3   38139.0   44739.0\n",
      "4   47139.0   47739.0\n",
      "5   52539.0   53139.0\n",
      "6   57339.0   59139.0\n",
      "7   63939.0   64539.0\n",
      "8   66939.0   67539.0\n",
      "9   70539.0   71139.0\n",
      "10  71739.0   72339.0\n",
      "11  73539.0   74139.0\n",
      "OD bus stations of transactions: \n",
      "            CardID LineCode       FDate   Time  plat Station\n",
      "0       542446139        1  1398/06/23  24030  A145    3169\n",
      "1      2620656172        1  1398/06/23  24302  A145    3169\n",
      "2      3446252780        1  1398/06/23  26200  A145    1227\n",
      "3         7900260        1  1398/06/23  29677  A145    3169\n",
      "4       361857972        1  1398/06/23  29720  A145    3169\n",
      "...           ...      ...         ...    ...   ...     ...\n",
      "18746  2182668403        5  1398/06/23  73972   F20    2566\n",
      "18747   212082828        5  1398/06/23  74032   F20    2566\n",
      "18748   645660829        5  1398/06/23  74076   F20    2566\n",
      "18749  3208088404        5  1398/06/23  74088   F20    2566\n",
      "18750   980833403        5  1398/06/23  74114   F20    2566\n",
      "\n",
      "[18751 rows x 6 columns]\n",
      "transactions in line 5 plat F64\n",
      "ps: \n",
      "              CardID  LineCode       FDate   Time plat\n",
      "472722  3701453333         5  1398/06/23  53323  F64\n",
      "566860   428782174         5  1398/06/23  53509  F64\n",
      "566862  2855853822         5  1398/06/23  53511  F64\n",
      "566865  4241197959         5  1398/06/23  53514  F64\n",
      "472724   181399606         5  1398/06/23  53516  F64\n",
      "...            ...       ...         ...    ...  ...\n",
      "621928  2115585188         5  1398/06/23  75927  F64\n",
      "621930  3152145230         5  1398/06/23  75939  F64\n",
      "621932  2498472820         5  1398/06/23  75956  F64\n",
      "621935  2053184946         5  1398/06/23  77434  F64\n",
      "621938  2053184946         5  1398/06/23  77436  F64\n",
      "\n",
      "[141 rows x 5 columns]\n",
      "first row of the selected chunck : \n",
      " [3701453333 5 '1398/06/23' 53323 'F64']\n",
      "141\n",
      "t0 = 53323\n",
      "ts = 77436\n",
      "time_intervals 40\n",
      "Origin destination interval view reindex \n",
      "    time_in  time_out\n",
      "0  53323.0   53923.0\n",
      "1  54523.0   56923.0\n",
      "2  57523.0   58123.0\n",
      "3  59323.0   62923.0\n",
      "4  63523.0   65323.0\n",
      "5  66523.0   67123.0\n",
      "6  68323.0   70123.0\n",
      "7  70723.0   71323.0\n",
      "8  73123.0   76123.0\n",
      "9  76723.0   77323.0\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "OD bus stations of transactions: \n",
      "            CardID LineCode       FDate   Time  plat Station\n",
      "0       542446139        1  1398/06/23  24030  A145    3169\n",
      "1      2620656172        1  1398/06/23  24302  A145    3169\n",
      "2      3446252780        1  1398/06/23  26200  A145    1227\n",
      "3         7900260        1  1398/06/23  29677  A145    3169\n",
      "4       361857972        1  1398/06/23  29720  A145    3169\n",
      "...           ...      ...         ...    ...   ...     ...\n",
      "19136  1778416228        5  1398/06/23  75886   F64    3852\n",
      "19137  2115585188        5  1398/06/23  75924   F64    3852\n",
      "19138  2115585188        5  1398/06/23  75927   F64    3852\n",
      "19139  3152145230        5  1398/06/23  75939   F64    3852\n",
      "19140  2498472820        5  1398/06/23  75956   F64    3852\n",
      "\n",
      "[19141 rows x 6 columns]\n",
      "transactions in line 5 plat N35\n",
      "ps: \n",
      "              CardID  LineCode       FDate   Time plat\n",
      "562799  3259312301         5  1398/06/23  22160  N35\n",
      "562800  2125649716         5  1398/06/23  22163  N35\n",
      "562801   173760214         5  1398/06/23  22165  N35\n",
      "562802  1001405534         5  1398/06/23  22168  N35\n",
      "562803   645293309         5  1398/06/23  22170  N35\n",
      "...            ...       ...         ...    ...  ...\n",
      "646721   646120909         5  1398/06/23  76249  N35\n",
      "646722   386756954         5  1398/06/23  76253  N35\n",
      "646723  2508451492         5  1398/06/23  76586  N35\n",
      "646724  2508451492         5  1398/06/23  76587  N35\n",
      "646725  1407238323         5  1398/06/23  77011  N35\n",
      "\n",
      "[534 rows x 5 columns]\n",
      "first row of the selected chunck : \n",
      " [3259312301 5 '1398/06/23' 22160 'N35']\n",
      "534\n",
      "t0 = 22160\n",
      "ts = 77011\n",
      "time_intervals 91\n",
      "Origin destination interval view reindex \n",
      "    time_in  time_out\n",
      "0  22160.0   22760.0\n",
      "1  30560.0   31160.0\n",
      "2  36560.0   37160.0\n",
      "3  47360.0   54560.0\n",
      "4  58760.0   59960.0\n",
      "5  65360.0   65960.0\n",
      "6  68360.0   68960.0\n",
      "7  71360.0   72560.0\n",
      "8  74360.0   74960.0\n",
      "OD bus stations of transactions: \n",
      "            CardID LineCode       FDate   Time  plat Station\n",
      "0       542446139        1  1398/06/23  24030  A145    3169\n",
      "1      2620656172        1  1398/06/23  24302  A145    3169\n",
      "2      3446252780        1  1398/06/23  26200  A145    1227\n",
      "3         7900260        1  1398/06/23  29677  A145    3169\n",
      "4       361857972        1  1398/06/23  29720  A145    3169\n",
      "...           ...      ...         ...    ...   ...     ...\n",
      "19207  1832092237        5  1398/06/23  74948   N35    3852\n",
      "19208  1832092237        5  1398/06/23  74949   N35    3852\n",
      "19209  1360777354        5  1398/06/23  74953   N35    3852\n",
      "19210   805840994        5  1398/06/23  74956   N35    3852\n",
      "19211   805840994        5  1398/06/23  74957   N35    3852\n",
      "\n",
      "[19212 rows x 6 columns]\n",
      "stations in a specefic bus line 6\n",
      "len-of-go stations: 0\n",
      "len-of-back stations: 0\n",
      "len-of-go back stations: 0\n",
      "stations in a specefic bus line 7\n",
      "len-of-go stations: 20\n",
      "len-of-back stations: 26\n",
      "len-of-go back stations: 0\n",
      "first Station  [3892 '7' '1' 'go' '????????? ????-7' 51.680567 32.724565 'od' 'normal'\n",
      " 'no'] 3892\n",
      "last Station  [1190 '7' '1' 'back' '?????? ???????-7' 51.672303 32.67666 'od' 'normal'\n",
      " 'yes']\n",
      "['A131' 'A134' 'D96' 'E193' 'E224' 'E241' 'F28' 'F35' 'F71' 'F86' 'M89'\n",
      " 'N17' 'N33']\n",
      "transactions in line 7 plat A131\n",
      "ps: \n",
      "              CardID  LineCode       FDate   Time  plat\n",
      "223610  2138417645         7  1398/06/23  21684  A131\n",
      "223612   981872875         7  1398/06/23  23709  A131\n",
      "223613   981872875         7  1398/06/23  23903  A131\n",
      "223615  4265964002         7  1398/06/23  24212  A131\n",
      "223616   426029054         7  1398/06/23  24573  A131\n",
      "...            ...       ...         ...    ...   ...\n",
      "269956   980505051         7  1398/06/23  74790  A131\n",
      "269959   203011724         7  1398/06/23  74939  A131\n",
      "269960  2742943428         7  1398/06/23  74943  A131\n",
      "269961   179124566         7  1398/06/23  75027  A131\n",
      "269962   179124566         7  1398/06/23  75028  A131\n",
      "\n",
      "[247 rows x 5 columns]\n",
      "first row of the selected chunck : \n",
      " [2138417645 7 '1398/06/23' 21684 'A131']\n",
      "247\n",
      "t0 = 21684\n",
      "ts = 75028\n",
      "time_intervals 89\n",
      "Origin destination interval view reindex \n",
      "     time_in  time_out\n",
      "0   21684.0   24084.0\n",
      "1   25884.0   27084.0\n",
      "2   28884.0   33084.0\n",
      "3   35484.0   36684.0\n",
      "4   37284.0   37884.0\n",
      "5   42084.0   43884.0\n",
      "6   44484.0   45084.0\n",
      "7   46284.0   46884.0\n",
      "8   47484.0   48684.0\n",
      "9   49884.0   51084.0\n",
      "10  54084.0   55284.0\n",
      "11  55884.0   56484.0\n",
      "12  57084.0   59484.0\n",
      "13  61284.0   61884.0\n",
      "14  62484.0   63084.0\n",
      "15  63684.0   65484.0\n",
      "16  72084.0   74484.0\n",
      "OD bus stations of transactions: \n",
      "            CardID LineCode       FDate   Time  plat Station\n",
      "0       542446139        1  1398/06/23  24030  A145    3169\n",
      "1      2620656172        1  1398/06/23  24302  A145    3169\n",
      "2      3446252780        1  1398/06/23  26200  A145    1227\n",
      "3         7900260        1  1398/06/23  29677  A145    3169\n",
      "4       361857972        1  1398/06/23  29720  A145    3169\n",
      "...           ...      ...         ...    ...   ...     ...\n",
      "19721   399826581        7  1398/06/23  74276  A131    3892\n",
      "19722   399826581        7  1398/06/23  74278  A131    3892\n",
      "19723   399826581        7  1398/06/23  74281  A131    3892\n",
      "19724   399826581        7  1398/06/23  74283  A131    3892\n",
      "19725  1595315124        7  1398/06/23  74388  A131    3892\n",
      "\n",
      "[19726 rows x 6 columns]\n",
      "transactions in line 7 plat A134\n",
      "ps: \n",
      "              CardID  LineCode       FDate   Time  plat\n",
      "224081  4276201010         7  1398/06/23  22268  A134\n",
      "224082   426460142         7  1398/06/23  23476  A134\n",
      "224083  2239152299         7  1398/06/23  24969  A134\n",
      "224084  2183544963         7  1398/06/23  25079  A134\n",
      "224085   722142749         7  1398/06/23  25183  A134\n",
      "...            ...       ...         ...    ...   ...\n",
      "269681   869281628         7  1398/06/23  72986  A134\n",
      "269684  3630152620         7  1398/06/23  73094  A134\n",
      "269685   261473809         7  1398/06/23  73133  A134\n",
      "269682   262773297         7  1398/06/23  73162  A134\n",
      "269687  2741612612         7  1398/06/23  73717  A134\n",
      "\n",
      "[331 rows x 5 columns]\n",
      "first row of the selected chunck : \n",
      " [4276201010 7 '1398/06/23' 22268 'A134']\n",
      "331\n",
      "t0 = 22268\n",
      "ts = 73717\n",
      "time_intervals 86\n",
      "Origin destination interval view reindex \n",
      "     time_in  time_out\n",
      "0   22268.0   24068.0\n",
      "1   24668.0   25268.0\n",
      "2   27668.0   28868.0\n",
      "3   31268.0   31868.0\n",
      "4   34868.0   36068.0\n",
      "5   38468.0   39068.0\n",
      "6   40868.0   41468.0\n",
      "7   42068.0   43868.0\n",
      "8   49268.0   49868.0\n",
      "9   53468.0   54068.0\n",
      "10  56468.0   57668.0\n",
      "11  60068.0   60668.0\n",
      "12  63068.0   64868.0\n",
      "13  69668.0   70268.0\n",
      "14  70868.0   72668.0\n",
      "OD bus stations of transactions: \n",
      "            CardID LineCode       FDate   Time  plat Station\n",
      "0       542446139        1  1398/06/23  24030  A145    3169\n",
      "1      2620656172        1  1398/06/23  24302  A145    3169\n",
      "2      3446252780        1  1398/06/23  26200  A145    1227\n",
      "3         7900260        1  1398/06/23  29677  A145    3169\n",
      "4       361857972        1  1398/06/23  29720  A145    3169\n",
      "...           ...      ...         ...    ...   ...     ...\n",
      "19936   483226180        7  1398/06/23  69966  A134    1190\n",
      "19937  3679911004        7  1398/06/23  69997  A134    1190\n",
      "19938  1598218164        7  1398/06/23  70139  A134    1190\n",
      "19939  2743126036        7  1398/06/23  72209  A134    3892\n",
      "19940  4270771906        7  1398/06/23  72416  A134    3892\n",
      "\n",
      "[19941 rows x 6 columns]\n",
      "transactions in line 7 plat D96\n",
      "ps: \n",
      "              CardID  LineCode       FDate   Time plat\n",
      "258555  1832897709         7  1398/06/23  22633  D96\n",
      "258559   721750580         7  1398/06/23  22675  D96\n",
      "258564  4266658562         7  1398/06/23  22689  D96\n",
      "258561   736199584         7  1398/06/23  22847  D96\n",
      "258569  2680238686         7  1398/06/23  22847  D96\n",
      "...            ...       ...         ...    ...  ...\n",
      "244018  2117378132         7  1398/06/23  76450  D96\n",
      "244023  1002324663         7  1398/06/23  76450  D96\n",
      "244019  4266036354         7  1398/06/23  76543  D96\n",
      "244025  2044433694         7  1398/06/23  76715  D96\n",
      "244027  3630050060         7  1398/06/23  76808  D96\n",
      "\n",
      "[300 rows x 5 columns]\n",
      "first row of the selected chunck : \n",
      " [1832897709 7 '1398/06/23' 22633 'D96']\n",
      "300\n",
      "t0 = 22633\n",
      "ts = 76808\n",
      "time_intervals 90\n",
      "Origin destination interval view reindex \n",
      "     time_in  time_out\n",
      "0   22633.0   23233.0\n",
      "1   23833.0   24433.0\n",
      "2   25033.0   26833.0\n",
      "3   28633.0   29233.0\n",
      "4   32833.0   33433.0\n",
      "5   35233.0   36433.0\n",
      "6   37633.0   38233.0\n",
      "7   39433.0   40633.0\n",
      "8   43633.0   44233.0\n",
      "9   46633.0   47833.0\n",
      "10  50233.0   50833.0\n",
      "11  53833.0   55633.0\n",
      "12  57433.0   58033.0\n",
      "13  60433.0   62233.0\n",
      "14  64033.0   64633.0\n",
      "15  67033.0   68833.0\n",
      "16  70633.0   71833.0\n",
      "17  74233.0   76033.0\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "OD bus stations of transactions: \n",
      "            CardID LineCode       FDate   Time  plat Station\n",
      "0       542446139        1  1398/06/23  24030  A145    3169\n",
      "1      2620656172        1  1398/06/23  24302  A145    3169\n",
      "2      3446252780        1  1398/06/23  26200  A145    1227\n",
      "3         7900260        1  1398/06/23  29677  A145    3169\n",
      "4       361857972        1  1398/06/23  29720  A145    3169\n",
      "...           ...      ...         ...    ...   ...     ...\n",
      "20181   982627595        7  1398/06/23  71738   D96    3892\n",
      "20182  3793968332        7  1398/06/23  71740   D96    3892\n",
      "20183   869225269        7  1398/06/23  75828   D96    1190\n",
      "20184   869225269        7  1398/06/23  75830   D96    1190\n",
      "20185  2855321630        7  1398/06/23  75853   D96    1190\n",
      "\n",
      "[20186 rows x 6 columns]\n",
      "transactions in line 7 plat E193\n",
      "ps: \n",
      "              CardID  LineCode       FDate   Time  plat\n",
      "153247  2506338212         7  1398/06/23  21617  E193\n",
      "153250   257010929         7  1398/06/23  23672  E193\n",
      "153253  3794511052         7  1398/06/23  23726  E193\n",
      "153262  3206451172         7  1398/06/23  23976  E193\n",
      "153265  1279639358         7  1398/06/23  23981  E193\n",
      "...            ...       ...         ...    ...   ...\n",
      "243320   721878369         7  1398/06/23  77126  E193\n",
      "243323   177192214         7  1398/06/23  77508  E193\n",
      "243326  1527179886         7  1398/06/23  77678  E193\n",
      "243330   428473902         7  1398/06/23  77928  E193\n",
      "243917  2506338212         7  1398/06/23  79286  E193\n",
      "\n",
      "[343 rows x 5 columns]\n",
      "first row of the selected chunck : \n",
      " [2506338212 7 '1398/06/23' 21617 'E193']\n",
      "343\n",
      "t0 = 21617\n",
      "ts = 79286\n",
      "time_intervals 96\n",
      "Origin destination interval view reindex \n",
      "     time_in  time_out\n",
      "0   21617.0   24017.0\n",
      "1   25217.0   25817.0\n",
      "2   26417.0   28217.0\n",
      "3   33017.0   33617.0\n",
      "4   36617.0   37817.0\n",
      "5   39617.0   40217.0\n",
      "6   42017.0   42617.0\n",
      "7   48017.0   48617.0\n",
      "8   54017.0   55217.0\n",
      "9   57617.0   58217.0\n",
      "10  61217.0   62417.0\n",
      "11  68417.0   69617.0\n",
      "12  72617.0   73217.0\n",
      "13  75617.0   76217.0\n",
      "14  78617.0   79217.0\n",
      "OD bus stations of transactions: \n",
      "            CardID LineCode       FDate   Time  plat Station\n",
      "0       542446139        1  1398/06/23  24030  A145    3169\n",
      "1      2620656172        1  1398/06/23  24302  A145    3169\n",
      "2      3446252780        1  1398/06/23  26200  A145    1227\n",
      "3         7900260        1  1398/06/23  29677  A145    3169\n",
      "4       361857972        1  1398/06/23  29720  A145    3169\n",
      "...           ...      ...         ...    ...   ...     ...\n",
      "20304  3672977842        7  1398/06/23  73048  E193    3892\n",
      "20305   479948884        7  1398/06/23  73051  E193    3892\n",
      "20306  3254566173        7  1398/06/23  73065  E193    3892\n",
      "20307  4276238962        7  1398/06/23  75966  E193    1190\n",
      "20308  4276238962        7  1398/06/23  75967  E193    1190\n",
      "\n",
      "[20309 rows x 6 columns]\n",
      "transactions in line 7 plat E224\n",
      "ps: \n",
      "              CardID  LineCode       FDate   Time  plat\n",
      "83903    361129956         7  1398/06/23  24454  E224\n",
      "83904    722023604         7  1398/06/23  24985  E224\n",
      "83907    721959933         7  1398/06/23  24999  E224\n",
      "83910    343041972         7  1398/06/23  25058  E224\n",
      "83913    869265401         7  1398/06/23  25158  E224\n",
      "...            ...       ...         ...    ...   ...\n",
      "254767   203118636         7  1398/06/23  74481  E224\n",
      "254773  2229724515         7  1398/06/23  74609  E224\n",
      "254769  4265937346         7  1398/06/23  74745  E224\n",
      "254775  1361071386         7  1398/06/23  75023  E224\n",
      "254777  2497788109         7  1398/06/23  75257  E224\n",
      "\n",
      "[299 rows x 5 columns]\n",
      "first row of the selected chunck : \n",
      " [361129956 7 '1398/06/23' 24454 'E224']\n",
      "299\n",
      "t0 = 24454\n",
      "ts = 75257\n",
      "time_intervals 85\n",
      "Origin destination interval view reindex \n",
      "     time_in  time_out\n",
      "0   24454.0   25054.0\n",
      "1   28654.0   30454.0\n",
      "2   34654.0   35254.0\n",
      "3   35854.0   36454.0\n",
      "4   39454.0   40654.0\n",
      "5   43654.0   44854.0\n",
      "6   48454.0   49654.0\n",
      "7   50254.0   50854.0\n",
      "8   51454.0   53254.0\n",
      "9   55654.0   56254.0\n",
      "10  58654.0   59254.0\n",
      "11  64654.0   66454.0\n",
      "12  69454.0   70054.0\n",
      "13  72454.0   74254.0\n",
      "OD bus stations of transactions: \n",
      "            CardID LineCode       FDate   Time  plat Station\n",
      "0       542446139        1  1398/06/23  24030  A145    3169\n",
      "1      2620656172        1  1398/06/23  24302  A145    3169\n",
      "2      3446252780        1  1398/06/23  26200  A145    1227\n",
      "3         7900260        1  1398/06/23  29677  A145    3169\n",
      "4       361857972        1  1398/06/23  29720  A145    3169\n",
      "...           ...      ...         ...    ...   ...     ...\n",
      "20610   235721146        7  1398/06/23  69742  E224    3892\n",
      "20611   235656474        7  1398/06/23  69744  E224    3892\n",
      "20612   721789129        7  1398/06/23  69817  E224    3892\n",
      "20613  1799082596        7  1398/06/23  69962  E224    3892\n",
      "20614  2742816276        7  1398/06/23  74064  E224    1190\n",
      "\n",
      "[20615 rows x 6 columns]\n",
      "transactions in line 7 plat E241\n",
      "ps: \n",
      "              CardID  LineCode       FDate   Time  plat\n",
      "310231  4266075938         7  1398/06/23  21149  E241\n",
      "310232  3405886268         7  1398/06/23  21703  E241\n",
      "310233  3405886268         7  1398/06/23  21705  E241\n",
      "310234  3107233893         7  1398/06/23  21820  E241\n",
      "310236  4266573218         7  1398/06/23  21822  E241\n",
      "...            ...       ...         ...    ...   ...\n",
      "186073  2962290389         7  1398/06/23  75863  E241\n",
      "186074   721765789         7  1398/06/23  75864  E241\n",
      "186075  3405923767         7  1398/06/23  75871  E241\n",
      "186076  2124316980         7  1398/06/23  76025  E241\n",
      "186077  1834677805         7  1398/06/23  76027  E241\n",
      "\n",
      "[288 rows x 5 columns]\n",
      "first row of the selected chunck : \n",
      " [4266075938 7 '1398/06/23' 21149 'E241']\n",
      "288\n",
      "t0 = 21149\n",
      "ts = 76027\n",
      "time_intervals 91\n",
      "Origin destination interval view reindex \n",
      "     time_in  time_out\n",
      "0   21149.0   21749.0\n",
      "1   22949.0   24749.0\n",
      "2   27149.0   28349.0\n",
      "3   30149.0   31949.0\n",
      "4   34349.0   34949.0\n",
      "5   37949.0   38549.0\n",
      "6   41549.0   42149.0\n",
      "7   43349.0   44549.0\n",
      "8   45149.0   46349.0\n",
      "9   48749.0   49349.0\n",
      "10  51149.0   52349.0\n",
      "11  54749.0   55949.0\n",
      "12  57149.0   60149.0\n",
      "13  62549.0   63149.0\n",
      "14  64949.0   67349.0\n",
      "15  69749.0   70949.0\n",
      "16  71549.0   73949.0\n",
      "17  74549.0   75149.0\n",
      "OD bus stations of transactions: \n",
      "            CardID LineCode       FDate   Time  plat Station\n",
      "0       542446139        1  1398/06/23  24030  A145    3169\n",
      "1      2620656172        1  1398/06/23  24302  A145    3169\n",
      "2      3446252780        1  1398/06/23  26200  A145    1227\n",
      "3         7900260        1  1398/06/23  29677  A145    3169\n",
      "4       361857972        1  1398/06/23  29720  A145    3169\n",
      "...           ...      ...         ...    ...   ...     ...\n",
      "20860   809382482        7  1398/06/23  70805  E241    1190\n",
      "20861  2239161549        7  1398/06/23  70910  E241    1190\n",
      "20862  3152876830        7  1398/06/23  73557  E241    3892\n",
      "20863   174545846        7  1398/06/23  74627  E241    1190\n",
      "20864  2740601460        7  1398/06/23  74849  E241    1190\n",
      "\n",
      "[20865 rows x 6 columns]\n",
      "transactions in line 7 plat F28\n",
      "ps: \n",
      "              CardID  LineCode       FDate   Time plat\n",
      "121390  3631500956         7  1398/06/23  22685  F28\n",
      "121391   721954425         7  1398/06/23  23291  F28\n",
      "121392   262238401         7  1398/06/23  23706  F28\n",
      "121393   183854358         7  1398/06/23  23864  F28\n",
      "121394  1765269796         7  1398/06/23  25279  F28\n",
      "121395   869433333         7  1398/06/23  25333  F28\n",
      "first row of the selected chunck : \n",
      " [3631500956 7 '1398/06/23' 22685 'F28']\n",
      "6\n",
      "t0 = 22685\n",
      "ts = 25333\n",
      "time_intervals 4\n",
      "Origin destination interval view reindex \n",
      "    time_in  time_out\n",
      "0  22685.0   23885.0\n",
      "1  24485.0   25085.0\n",
      "OD bus stations of transactions: \n",
      "            CardID LineCode       FDate   Time  plat Station\n",
      "0       542446139        1  1398/06/23  24030  A145    3169\n",
      "1      2620656172        1  1398/06/23  24302  A145    3169\n",
      "2      3446252780        1  1398/06/23  26200  A145    1227\n",
      "3         7900260        1  1398/06/23  29677  A145    3169\n",
      "4       361857972        1  1398/06/23  29720  A145    3169\n",
      "...           ...      ...         ...    ...   ...     ...\n",
      "20939  3631344476        7  1398/06/23  67474  E241    1190\n",
      "20940  3631500956        7  1398/06/23  22685   F28    3892\n",
      "20941   721954425        7  1398/06/23  23291   F28    3892\n",
      "20942   262238401        7  1398/06/23  23706   F28    3892\n",
      "20943   183854358        7  1398/06/23  23864   F28    3892\n",
      "\n",
      "[20944 rows x 6 columns]\n",
      "transactions in line 7 plat F35\n",
      "ps: \n",
      "              CardID  LineCode       FDate   Time plat\n",
      "62534    869252902         7  1398/06/23  24168  F35\n",
      "62535    983316971         7  1398/06/23  25906  F35\n",
      "62536    983316971         7  1398/06/23  25907  F35\n",
      "62537    721792352         7  1398/06/23  27318  F35\n",
      "62538    721792352         7  1398/06/23  27533  F35\n",
      "...            ...       ...         ...    ...  ...\n",
      "153696  1838094381         7  1398/06/23  73434  F35\n",
      "153697  1838094381         7  1398/06/23  73436  F35\n",
      "153698  2116284804         7  1398/06/23  74136  F35\n",
      "153699   209356891         7  1398/06/23  74793  F35\n",
      "153700   645342925         7  1398/06/23  74796  F35\n",
      "\n",
      "[221 rows x 5 columns]\n",
      "first row of the selected chunck : \n",
      " [869252902 7 '1398/06/23' 24168 'F35']\n",
      "221\n",
      "t0 = 24168\n",
      "ts = 74796\n",
      "time_intervals 84\n",
      "Origin destination interval view reindex \n",
      "     time_in  time_out\n",
      "0   24168.0   25968.0\n",
      "1   26568.0   27768.0\n",
      "2   28968.0   31368.0\n",
      "3   36768.0   40968.0\n",
      "4   42768.0   43368.0\n",
      "5   44568.0   47568.0\n",
      "6   50568.0   53568.0\n",
      "7   54768.0   57168.0\n",
      "8   58368.0   59568.0\n",
      "9   61968.0   63768.0\n",
      "10  69168.0   70368.0\n",
      "11  73368.0   73968.0\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "OD bus stations of transactions: \n",
      "            CardID LineCode       FDate   Time  plat Station\n",
      "0       542446139        1  1398/06/23  24030  A145    3169\n",
      "1      2620656172        1  1398/06/23  24302  A145    3169\n",
      "2      3446252780        1  1398/06/23  26200  A145    1227\n",
      "3         7900260        1  1398/06/23  29677  A145    3169\n",
      "4       361857972        1  1398/06/23  29720  A145    3169\n",
      "...           ...      ...         ...    ...   ...     ...\n",
      "20979  3794511052        7  1398/06/23  63763   F35    1190\n",
      "20980  3793843244        7  1398/06/23  63768   F35    1190\n",
      "20981   721754689        7  1398/06/23  69919   F35    3892\n",
      "20982  1838094381        7  1398/06/23  73434   F35    1190\n",
      "20983  1838094381        7  1398/06/23  73436   F35    1190\n",
      "\n",
      "[20984 rows x 6 columns]\n",
      "transactions in line 7 plat F71\n",
      "ps: \n",
      "              CardID  LineCode       FDate   Time plat\n",
      "17515   3677677100         7  1398/06/23  22495  F71\n",
      "17516   3445539228         7  1398/06/23  22644  F71\n",
      "17518   1529608286         7  1398/06/23  22716  F71\n",
      "17517   2138068557         7  1398/06/23  22890  F71\n",
      "17520   3150763582         7  1398/06/23  23045  F71\n",
      "...            ...       ...         ...    ...  ...\n",
      "200002  3107527365         7  1398/06/23  71839  F71\n",
      "200004  3207848612         7  1398/06/23  71885  F71\n",
      "200005  3213088132         7  1398/06/23  71964  F71\n",
      "200003  3648682708         7  1398/06/23  71965  F71\n",
      "200006  1291757326         7  1398/06/23  72678  F71\n",
      "\n",
      "[368 rows x 5 columns]\n",
      "first row of the selected chunck : \n",
      " [3677677100 7 '1398/06/23' 22495 'F71']\n",
      "368\n",
      "t0 = 22495\n",
      "ts = 72678\n",
      "time_intervals 84\n",
      "Origin destination interval view reindex \n",
      "     time_in  time_out\n",
      "0   22495.0   23095.0\n",
      "1   25495.0   27895.0\n",
      "2   31495.0   32095.0\n",
      "3   32695.0   33295.0\n",
      "4   39895.0   41095.0\n",
      "5   44095.0   45295.0\n",
      "6   48295.0   48895.0\n",
      "7   51295.0   51895.0\n",
      "8   54295.0   56695.0\n",
      "9   57295.0   57895.0\n",
      "10  58495.0   59095.0\n",
      "11  60895.0   62095.0\n",
      "12  62695.0   63295.0\n",
      "13  67495.0   70495.0\n",
      "OD bus stations of transactions: \n",
      "            CardID LineCode       FDate   Time  plat Station\n",
      "0       542446139        1  1398/06/23  24030  A145    3169\n",
      "1      2620656172        1  1398/06/23  24302  A145    3169\n",
      "2      3446252780        1  1398/06/23  26200  A145    1227\n",
      "3         7900260        1  1398/06/23  29677  A145    3169\n",
      "4       361857972        1  1398/06/23  29720  A145    3169\n",
      "...           ...      ...         ...    ...   ...     ...\n",
      "21169  3152576622        7  1398/06/23  70053   F71    1190\n",
      "21170  1000832958        7  1398/06/23  70055   F71    1190\n",
      "21171  1775658228        7  1398/06/23  70059   F71    1190\n",
      "21172  1775658228        7  1398/06/23  70060   F71    1190\n",
      "21173   263170865        7  1398/06/23  70324   F71    1190\n",
      "\n",
      "[21174 rows x 6 columns]\n",
      "transactions in line 7 plat F86\n",
      "ps: \n",
      "              CardID  LineCode       FDate   Time plat\n",
      "94142   3256340637         7  1398/06/23  24819  F86\n",
      "94143   4246477687         7  1398/06/23  26324  F86\n",
      "94145   2740542980         7  1398/06/23  26325  F86\n",
      "94144    998430638         7  1398/06/23  26382  F86\n",
      "94146    261357809         7  1398/06/23  26464  F86\n",
      "...            ...       ...         ...    ...  ...\n",
      "215757  3178819358         7  1398/06/23  68666  F86\n",
      "215758  4275725586         7  1398/06/23  68667  F86\n",
      "215759   736316336         7  1398/06/23  69328  F86\n",
      "215760  1113765122         7  1398/06/23  69803  F86\n",
      "215761  3256340637         7  1398/06/23  71288  F86\n",
      "\n",
      "[305 rows x 5 columns]\n",
      "first row of the selected chunck : \n",
      " [3256340637 7 '1398/06/23' 24819 'F86']\n",
      "305\n",
      "t0 = 24819\n",
      "ts = 71288\n",
      "time_intervals 77\n",
      "Origin destination interval view reindex \n",
      "     time_in  time_out\n",
      "0   24819.0   26619.0\n",
      "1   27219.0   27819.0\n",
      "2   30219.0   31419.0\n",
      "3   36819.0   37419.0\n",
      "4   45219.0   45819.0\n",
      "5   46419.0   47619.0\n",
      "6   49419.0   50019.0\n",
      "7   52419.0   53019.0\n",
      "8   53619.0   54219.0\n",
      "9   55419.0   56619.0\n",
      "10  58419.0   59619.0\n",
      "11  65619.0   66219.0\n",
      "12  70419.0   71019.0\n",
      "OD bus stations of transactions: \n",
      "            CardID LineCode       FDate   Time  plat Station\n",
      "0       542446139        1  1398/06/23  24030  A145    3169\n",
      "1      2620656172        1  1398/06/23  24302  A145    3169\n",
      "2      3446252780        1  1398/06/23  26200  A145    1227\n",
      "3         7900260        1  1398/06/23  29677  A145    3169\n",
      "4       361857972        1  1398/06/23  29720  A145    3169\n",
      "...           ...      ...         ...    ...   ...     ...\n",
      "21487  2501954020        7  1398/06/23  56402   F86    1190\n",
      "21488  4058516125        7  1398/06/23  56562   F86    1190\n",
      "21489  4058516125        7  1398/06/23  56564   F86    1190\n",
      "21490   212382412        7  1398/06/23  59443   F86    3892\n",
      "21491  3405891123        7  1398/06/23  66058   F86    1190\n",
      "\n",
      "[21492 rows x 6 columns]\n",
      "transactions in line 7 plat M89\n",
      "ps: \n",
      "              CardID  LineCode       FDate   Time plat\n",
      "529890  2665297452         7  1398/06/23  23728  M89\n",
      "529891  3405926435         7  1398/06/23  23906  M89\n",
      "529892  3678062748         7  1398/06/23  24435  M89\n",
      "529893  1408584537         7  1398/06/23  24474  M89\n",
      "529894  1003068439         7  1398/06/23  24689  M89\n",
      "...            ...       ...         ...    ...  ...\n",
      "529885  3791719548         7  1398/06/23  75385  M89\n",
      "529886  3791719548         7  1398/06/23  75387  M89\n",
      "529887  3791719548         7  1398/06/23  75389  M89\n",
      "529888  3791719548         7  1398/06/23  75391  M89\n",
      "529889  3791719548         7  1398/06/23  75393  M89\n",
      "\n",
      "[359 rows x 5 columns]\n",
      "first row of the selected chunck : \n",
      " [2665297452 7 '1398/06/23' 23728 'M89']\n",
      "359\n",
      "t0 = 23728\n",
      "ts = 75393\n",
      "time_intervals 86\n",
      "Origin destination interval view reindex \n",
      "     time_in  time_out\n",
      "0   23728.0   24328.0\n",
      "1   27328.0   27928.0\n",
      "2   28528.0   29728.0\n",
      "3   35128.0   36328.0\n",
      "4   38728.0   39328.0\n",
      "5   42328.0   43528.0\n",
      "6   49528.0   51328.0\n",
      "7   53128.0   54928.0\n",
      "8   56728.0   59128.0\n",
      "9   60928.0   61528.0\n",
      "10  63328.0   65728.0\n",
      "11  68128.0   68728.0\n",
      "12  71728.0   72928.0\n",
      "OD bus stations of transactions: \n",
      "            CardID LineCode       FDate   Time  plat Station\n",
      "0       542446139        1  1398/06/23  24030  A145    3169\n",
      "1      2620656172        1  1398/06/23  24302  A145    3169\n",
      "2      3446252780        1  1398/06/23  26200  A145    1227\n",
      "3         7900260        1  1398/06/23  29677  A145    3169\n",
      "4       361857972        1  1398/06/23  29720  A145    3169\n",
      "...           ...      ...         ...    ...   ...     ...\n",
      "21767  2482037748        7  1398/06/23  72690   M89    3892\n",
      "21768   869238896        7  1398/06/23  72694   M89    3892\n",
      "21769   869238896        7  1398/06/23  72695   M89    3892\n",
      "21770  3445695020        7  1398/06/23  72814   M89    3892\n",
      "21771  3445695020        7  1398/06/23  72815   M89    3892\n",
      "\n",
      "[21772 rows x 6 columns]\n",
      "transactions in line 7 plat N17\n",
      "ps: \n",
      "              CardID  LineCode       FDate   Time plat\n",
      "269973  2125546580         7  1398/06/23  21940  N17\n",
      "269974  1001721774         7  1398/06/23  22086  N17\n",
      "269975  1371941774         7  1398/06/23  22193  N17\n",
      "269976   721787086         7  1398/06/23  22284  N17\n",
      "269977   638449083         7  1398/06/23  22287  N17\n",
      "...            ...       ...         ...    ...  ...\n",
      "83538   3676122242         7  1398/06/23  74247  N17\n",
      "83541   3676122242         7  1398/06/23  74248  N17\n",
      "83544   3676122242         7  1398/06/23  74252  N17\n",
      "269971  3145255547         7  1398/06/23  76212  N17\n",
      "269972  3145255547         7  1398/06/23  76215  N17\n",
      "\n",
      "[288 rows x 5 columns]\n",
      "first row of the selected chunck : \n",
      " [2125546580 7 '1398/06/23' 21940 'N17']\n",
      "288\n",
      "t0 = 21940\n",
      "ts = 76215\n",
      "time_intervals 90\n",
      "Origin destination interval view reindex \n",
      "     time_in  time_out\n",
      "0   21940.0   22540.0\n",
      "1   24340.0   25540.0\n",
      "2   28540.0   29140.0\n",
      "3   30940.0   31540.0\n",
      "4   32140.0   32740.0\n",
      "5   35140.0   35740.0\n",
      "6   37540.0   38140.0\n",
      "7   39340.0   39940.0\n",
      "8   41740.0   42340.0\n",
      "9   43540.0   44140.0\n",
      "10  45340.0   46540.0\n",
      "11  49540.0   50740.0\n",
      "12  52540.0   54940.0\n",
      "13  56740.0   57340.0\n",
      "14  59740.0   61540.0\n",
      "15  66940.0   69340.0\n",
      "16  69940.0   70540.0\n",
      "17  74140.0   74740.0\n",
      "18  75340.0   75940.0\n",
      "OD bus stations of transactions: \n",
      "            CardID LineCode       FDate   Time  plat Station\n",
      "0       542446139        1  1398/06/23  24030  A145    3169\n",
      "1      2620656172        1  1398/06/23  24302  A145    3169\n",
      "2      3446252780        1  1398/06/23  26200  A145    1227\n",
      "3         7900260        1  1398/06/23  29677  A145    3169\n",
      "4       361857972        1  1398/06/23  29720  A145    3169\n",
      "...           ...      ...         ...    ...   ...     ...\n",
      "22037  1372068670        7  1398/06/23  70398   N17    3892\n",
      "22038  1372068670        7  1398/06/23  70400   N17    3892\n",
      "22039  3676122242        7  1398/06/23  74247   N17    1190\n",
      "22040  3676122242        7  1398/06/23  74248   N17    1190\n",
      "22041  3676122242        7  1398/06/23  74252   N17    1190\n",
      "\n",
      "[22042 rows x 6 columns]\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "transactions in line 7 plat N33\n",
      "ps: \n",
      "              CardID  LineCode       FDate   Time plat\n",
      "224077   209535947         7  1398/06/23  22482  N33\n",
      "224078   233610490         7  1398/06/23  23033  N33\n",
      "224079   983032827         7  1398/06/23  24318  N33\n",
      "224080  2677110340         7  1398/06/23  24570  N33\n",
      "12096   2681069924         7  1398/06/23  24666  N33\n",
      "...            ...       ...         ...    ...  ...\n",
      "157582  2044800798         7  1398/06/23  73285  N33\n",
      "157583  3151504398         7  1398/06/23  73444  N33\n",
      "157585  3180722382         7  1398/06/23  74065  N33\n",
      "157587  1415605833         7  1398/06/23  74115  N33\n",
      "157589  1415605833         7  1398/06/23  74120  N33\n",
      "\n",
      "[304 rows x 5 columns]\n",
      "first row of the selected chunck : \n",
      " [209535947 7 '1398/06/23' 22482 'N33']\n",
      "304\n",
      "t0 = 22482\n",
      "ts = 74120\n",
      "time_intervals 86\n",
      "Origin destination interval view reindex \n",
      "     time_in  time_out\n",
      "0   22482.0   23082.0\n",
      "1   23682.0   24882.0\n",
      "2   26682.0   27882.0\n",
      "3   33882.0   35082.0\n",
      "4   37482.0   38082.0\n",
      "5   39882.0   40482.0\n",
      "6   41082.0   42282.0\n",
      "7   45282.0   45882.0\n",
      "8   48282.0   50682.0\n",
      "9   52482.0   53682.0\n",
      "10  54282.0   54882.0\n",
      "11  55482.0   56682.0\n",
      "12  61482.0   63882.0\n",
      "13  69882.0   71082.0\n",
      "14  71682.0   72282.0\n",
      "OD bus stations of transactions: \n",
      "            CardID LineCode       FDate   Time  plat Station\n",
      "0       542446139        1  1398/06/23  24030  A145    3169\n",
      "1      2620656172        1  1398/06/23  24302  A145    3169\n",
      "2      3446252780        1  1398/06/23  26200  A145    1227\n",
      "3         7900260        1  1398/06/23  29677  A145    3169\n",
      "4       361857972        1  1398/06/23  29720  A145    3169\n",
      "...           ...      ...         ...    ...   ...     ...\n",
      "22185   473855866        7  1398/06/23  72027   N33    3892\n",
      "22186   473855866        7  1398/06/23  72029   N33    3892\n",
      "22187  3183295902        7  1398/06/23  72053   N33    3892\n",
      "22188  3632406700        7  1398/06/23  72128   N33    3892\n",
      "22189   177890806        7  1398/06/23  72146   N33    3892\n",
      "\n",
      "[22190 rows x 6 columns]\n",
      "stations in a specefic bus line 8\n",
      "len-of-go stations: 27\n",
      "len-of-back stations: 29\n",
      "len-of-go back stations: 0\n",
      "first Station  [2795 '8' '1' 'go' '????? ???? ???????-8' 51.659265 32.714976 'od'\n",
      " 'normal' 'no'] 2795\n",
      "last Station  [4098 '8' '1' 'back' '?????? ???? ???-8' 51.601799 32.714051 'od' 'normal'\n",
      " 'yes']\n",
      "['A38' 'E110' 'E16' 'F29' 'M67' 'N118' 'N193']\n",
      "transactions in line 8 plat A38\n",
      "ps: \n",
      "             CardID  LineCode       FDate   Time plat\n",
      "34149  2741556692         8  1398/06/23  45078  A38\n",
      "34150  2741556692         8  1398/06/23  45093  A38\n",
      "34151  4058185485         8  1398/06/23  46052  A38\n",
      "34152  2586880548         8  1398/06/23  46236  A38\n",
      "34153  2586880548         8  1398/06/23  46238  A38\n",
      "34154  1002990359         8  1398/06/23  46548  A38\n",
      "34155  2678204772         8  1398/06/23  46836  A38\n",
      "34156  3180585534         8  1398/06/23  51175  A38\n",
      "34742   722230963         8  1398/06/23  51176  A38\n",
      "34743   722230963         8  1398/06/23  51178  A38\n",
      "34744  4245076823         8  1398/06/23  51184  A38\n",
      "34745   260895089         8  1398/06/23  51187  A38\n",
      "34746  3405862938         8  1398/06/23  51199  A38\n",
      "34747   185840310         8  1398/06/23  51220  A38\n",
      "34748  3792856204         8  1398/06/23  51236  A38\n",
      "34749  3405913593         8  1398/06/23  51240  A38\n",
      "34751  4241087991         8  1398/06/23  51306  A38\n",
      "34750   474082586         8  1398/06/23  51307  A38\n",
      "34752  4241087991         8  1398/06/23  51307  A38\n",
      "34753   996793278         8  1398/06/23  52176  A38\n",
      "34754  4058050157         8  1398/06/23  52351  A38\n",
      "34755  2742586260         8  1398/06/23  52570  A38\n",
      "first row of the selected chunck : \n",
      " [2741556692 8 '1398/06/23' 45078 'A38']\n",
      "22\n",
      "t0 = 45078\n",
      "ts = 52570\n",
      "time_intervals 12\n",
      "Origin destination interval view reindex \n",
      "    time_in  time_out\n",
      "0  45078.0   45678.0\n",
      "1  47478.0   51678.0\n",
      "OD bus stations of transactions: \n",
      "            CardID LineCode       FDate   Time  plat Station\n",
      "0       542446139        1  1398/06/23  24030  A145    3169\n",
      "1      2620656172        1  1398/06/23  24302  A145    3169\n",
      "2      3446252780        1  1398/06/23  26200  A145    1227\n",
      "3         7900260        1  1398/06/23  29677  A145    3169\n",
      "4       361857972        1  1398/06/23  29720  A145    3169\n",
      "...           ...      ...         ...    ...   ...     ...\n",
      "22341  3792856204        8  1398/06/23  51236   A38    4098\n",
      "22342  3405913593        8  1398/06/23  51240   A38    4098\n",
      "22343  4241087991        8  1398/06/23  51306   A38    4098\n",
      "22344   474082586        8  1398/06/23  51307   A38    4098\n",
      "22345  4241087991        8  1398/06/23  51307   A38    4098\n",
      "\n",
      "[22346 rows x 6 columns]\n",
      "transactions in line 8 plat E110\n",
      "ps: \n",
      "              CardID  LineCode       FDate   Time  plat\n",
      "87675   1595024276         8  1398/06/23  55214  E110\n",
      "61133    285538139         8  1398/06/23  56241  E110\n",
      "286308   285538139         8  1398/06/23  56243  E110\n",
      "31862    285538139         8  1398/06/23  56244  E110\n",
      "123672   285538139         8  1398/06/23  56245  E110\n",
      "...            ...       ...         ...    ...   ...\n",
      "239118  2116677428         8  1398/06/23  74253  E110\n",
      "51970    176073622         8  1398/06/23  74650  E110\n",
      "51976   4059365485         8  1398/06/23  74685  E110\n",
      "51981   2590579828         8  1398/06/23  74793  E110\n",
      "51985    722100105         8  1398/06/23  74899  E110\n",
      "\n",
      "[138 rows x 5 columns]\n",
      "first row of the selected chunck : \n",
      " [1595024276 8 '1398/06/23' 55214 'E110']\n",
      "138\n",
      "t0 = 55214\n",
      "ts = 74899\n",
      "time_intervals 33\n",
      "Origin destination interval view reindex \n",
      "    time_in  time_out\n",
      "0  55214.0   56414.0\n",
      "1  60014.0   60614.0\n",
      "2  66614.0   67214.0\n",
      "3  73814.0   74414.0\n",
      "OD bus stations of transactions: \n",
      "            CardID LineCode       FDate   Time  plat Station\n",
      "0       542446139        1  1398/06/23  24030  A145    3169\n",
      "1      2620656172        1  1398/06/23  24302  A145    3169\n",
      "2      3446252780        1  1398/06/23  26200  A145    1227\n",
      "3         7900260        1  1398/06/23  29677  A145    3169\n",
      "4       361857972        1  1398/06/23  29720  A145    3169\n",
      "...           ...      ...         ...    ...   ...     ...\n",
      "22363   878738924        8  1398/06/23  74237  E110    4098\n",
      "22364  3224569348        8  1398/06/23  74241  E110    4098\n",
      "22365  1595089796        8  1398/06/23  74242  E110    4098\n",
      "22366  3630062060        8  1398/06/23  74248  E110    4098\n",
      "22367  2116677428        8  1398/06/23  74253  E110    4098\n",
      "\n",
      "[22368 rows x 6 columns]\n",
      "transactions in line 8 plat E16\n",
      "ps: \n",
      "              CardID  LineCode       FDate   Time plat\n",
      "100661   722073571         8  1398/06/23  25471  E16\n",
      "100662  2052767682         8  1398/06/23  26588  E16\n",
      "100663  2960620021         8  1398/06/23  26654  E16\n",
      "100664  4270482514         8  1398/06/23  26657  E16\n",
      "100665  1832120621         8  1398/06/23  26687  E16\n",
      "...            ...       ...         ...    ...  ...\n",
      "74637    722029293         8  1398/06/23  58140  E16\n",
      "74638    722029293         8  1398/06/23  58142  E16\n",
      "74639    722029293         8  1398/06/23  58174  E16\n",
      "74640    722041904         8  1398/06/23  58261  E16\n",
      "74641   2117338644         8  1398/06/23  59066  E16\n",
      "\n",
      "[231 rows x 5 columns]\n",
      "first row of the selected chunck : \n",
      " [722073571 8 '1398/06/23' 25471 'E16']\n",
      "231\n",
      "t0 = 25471\n",
      "ts = 59066\n",
      "time_intervals 56\n",
      "Origin destination interval view reindex \n",
      "    time_in  time_out\n",
      "0  25471.0   26671.0\n",
      "1  28471.0   29671.0\n",
      "2  34471.0   35071.0\n",
      "3  47671.0   48271.0\n",
      "4  48871.0   49471.0\n",
      "5  56671.0   57271.0\n",
      "6  57871.0   58471.0\n",
      "OD bus stations of transactions: \n",
      "            CardID LineCode       FDate   Time  plat Station\n",
      "0       542446139        1  1398/06/23  24030  A145    3169\n",
      "1      2620656172        1  1398/06/23  24302  A145    3169\n",
      "2      3446252780        1  1398/06/23  26200  A145    1227\n",
      "3         7900260        1  1398/06/23  29677  A145    3169\n",
      "4       361857972        1  1398/06/23  29720  A145    3169\n",
      "...           ...      ...         ...    ...   ...     ...\n",
      "22475  3405945341        8  1398/06/23  57211   E16    4098\n",
      "22476   722029293        8  1398/06/23  58140   E16    2795\n",
      "22477   722029293        8  1398/06/23  58142   E16    2795\n",
      "22478   722029293        8  1398/06/23  58174   E16    2795\n",
      "22479   722041904        8  1398/06/23  58261   E16    2795\n",
      "\n",
      "[22480 rows x 6 columns]\n",
      "transactions in line 8 plat F29\n",
      "ps: \n",
      "              CardID  LineCode       FDate   Time plat\n",
      "156931  1527472174         8  1398/06/23  26485  F29\n",
      "156933  2124333108         8  1398/06/23  26895  F29\n",
      "156935  3445517388         8  1398/06/23  26895  F29\n",
      "156946  4269546354         8  1398/06/23  27140  F29\n",
      "156937  3206863605         8  1398/06/23  27142  F29\n",
      "...            ...       ...         ...    ...  ...\n",
      "115471   736993264         8  1398/06/23  72343  F29\n",
      "115472  2855677566         8  1398/06/23  72363  F29\n",
      "115473  2138598653         8  1398/06/23  72369  F29\n",
      "115474  3154138846         8  1398/06/23  72558  F29\n",
      "115475  2586850500         8  1398/06/23  72724  F29\n",
      "\n",
      "[299 rows x 5 columns]\n",
      "first row of the selected chunck : \n",
      " [1527472174 8 '1398/06/23' 26485 'F29']\n",
      "299\n",
      "t0 = 26485\n",
      "ts = 72724\n",
      "time_intervals 77\n",
      "Origin destination interval view reindex \n",
      "     time_in  time_out\n",
      "0   26485.0   27085.0\n",
      "1   28285.0   29485.0\n",
      "2   31285.0   31885.0\n",
      "3   33685.0   34285.0\n",
      "4   44485.0   45085.0\n",
      "5   52285.0   52885.0\n",
      "6   55285.0   55885.0\n",
      "7   57085.0   57685.0\n",
      "8   62485.0   63685.0\n",
      "9   64285.0   64885.0\n",
      "10  66085.0   67285.0\n",
      "11  67885.0   69085.0\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "OD bus stations of transactions: \n",
      "            CardID LineCode       FDate   Time  plat Station\n",
      "0       542446139        1  1398/06/23  24030  A145    3169\n",
      "1      2620656172        1  1398/06/23  24302  A145    3169\n",
      "2      3446252780        1  1398/06/23  26200  A145    1227\n",
      "3         7900260        1  1398/06/23  29677  A145    3169\n",
      "4       361857972        1  1398/06/23  29720  A145    3169\n",
      "...           ...      ...         ...    ...   ...     ...\n",
      "22716  3603757292        8  1398/06/23  67087   F29    2795\n",
      "22717  3603757292        8  1398/06/23  67088   F29    2795\n",
      "22718  3183294014        8  1398/06/23  67261   F29    2795\n",
      "22719  3183294014        8  1398/06/23  67272   F29    2795\n",
      "22720  2239177134        8  1398/06/23  68735   F29    4098\n",
      "\n",
      "[22721 rows x 6 columns]\n",
      "transactions in line 8 plat M67\n",
      "ps: \n",
      "              CardID  LineCode       FDate   Time plat\n",
      "329291  2740952420         8  1398/06/23  21922  M67\n",
      "329292   235094554         8  1398/06/23  22528  M67\n",
      "329293   474082586         8  1398/06/23  22746  M67\n",
      "329294   261283905         8  1398/06/23  22850  M67\n",
      "357581  2854994862         8  1398/06/23  22903  M67\n",
      "...            ...       ...         ...    ...  ...\n",
      "655078   991421550         8  1398/06/23  67977  M67\n",
      "655079  2504250180         8  1398/06/23  67981  M67\n",
      "655080  2504250180         8  1398/06/23  67983  M67\n",
      "655082  3405937853         8  1398/06/23  68307  M67\n",
      "655083  2129789460         8  1398/06/23  68319  M67\n",
      "\n",
      "[319 rows x 5 columns]\n",
      "first row of the selected chunck : \n",
      " [2740952420 8 '1398/06/23' 21922 'M67']\n",
      "319\n",
      "t0 = 21922\n",
      "ts = 68319\n",
      "time_intervals 77\n",
      "Origin destination interval view reindex \n",
      "     time_in  time_out\n",
      "0   21922.0   23122.0\n",
      "1   24322.0   24922.0\n",
      "2   25522.0   26722.0\n",
      "3   29722.0   30322.0\n",
      "4   31522.0   32122.0\n",
      "5   45922.0   46522.0\n",
      "6   47122.0   48322.0\n",
      "7   50722.0   51322.0\n",
      "8   51922.0   52522.0\n",
      "9   53122.0   53722.0\n",
      "10  54922.0   55522.0\n",
      "11  58522.0   59722.0\n",
      "12  61522.0   62122.0\n",
      "13  63922.0   64522.0\n",
      "OD bus stations of transactions: \n",
      "            CardID LineCode       FDate   Time  plat Station\n",
      "0       542446139        1  1398/06/23  24030  A145    3169\n",
      "1      2620656172        1  1398/06/23  24302  A145    3169\n",
      "2      3446252780        1  1398/06/23  26200  A145    1227\n",
      "3         7900260        1  1398/06/23  29677  A145    3169\n",
      "4       361857972        1  1398/06/23  29720  A145    3169\n",
      "...           ...      ...         ...    ...   ...     ...\n",
      "22946  2741936468        8  1398/06/23  61883   M67    2795\n",
      "22947  2137827981        8  1398/06/23  61897   M67    2795\n",
      "22948  1001202958        8  1398/06/23  64097   M67    4098\n",
      "22949   262874081        8  1398/06/23  64286   M67    4098\n",
      "22950  2190512259        8  1398/06/23  64296   M67    4098\n",
      "\n",
      "[22951 rows x 6 columns]\n",
      "transactions in line 8 plat N118\n",
      "ps: \n",
      "              CardID  LineCode       FDate   Time  plat\n",
      "291056  3405920394         8  1398/06/23  23734  N118\n",
      "291058  1530718094         8  1398/06/23  23736  N118\n",
      "291060  2741483460         8  1398/06/23  23839  N118\n",
      "291062  4265832978         8  1398/06/23  23989  N118\n",
      "291072   178022342         8  1398/06/23  25235  N118\n",
      "...            ...       ...         ...    ...   ...\n",
      "51901    996599662         8  1398/06/23  73116  N118\n",
      "51909    996599662         8  1398/06/23  73125  N118\n",
      "51912   1593545524         8  1398/06/23  73492  N118\n",
      "51914    182052166         8  1398/06/23  74221  N118\n",
      "51915    182158662         8  1398/06/23  74746  N118\n",
      "\n",
      "[363 rows x 5 columns]\n",
      "first row of the selected chunck : \n",
      " [3405920394 8 '1398/06/23' 23734 'N118']\n",
      "363\n",
      "t0 = 23734\n",
      "ts = 74746\n",
      "time_intervals 85\n",
      "Origin destination interval view reindex \n",
      "     time_in  time_out\n",
      "0   23734.0   24334.0\n",
      "1   24934.0   25534.0\n",
      "2   26734.0   27934.0\n",
      "3   30334.0   30934.0\n",
      "4   32734.0   33334.0\n",
      "5   46534.0   47134.0\n",
      "6   50734.0   58534.0\n",
      "7   60334.0   61534.0\n",
      "8   63934.0   64534.0\n",
      "9   69934.0   70534.0\n",
      "10  72334.0   73534.0\n",
      "11  74134.0   74734.0\n",
      "OD bus stations of transactions: \n",
      "            CardID LineCode       FDate   Time  plat Station\n",
      "0       542446139        1  1398/06/23  24030  A145    3169\n",
      "1      2620656172        1  1398/06/23  24302  A145    3169\n",
      "2      3446252780        1  1398/06/23  26200  A145    1227\n",
      "3         7900260        1  1398/06/23  29677  A145    3169\n",
      "4       361857972        1  1398/06/23  29720  A145    3169\n",
      "...           ...      ...         ...    ...   ...     ...\n",
      "23148   996599662        8  1398/06/23  73114  N118    2795\n",
      "23149   996599662        8  1398/06/23  73116  N118    2795\n",
      "23150   996599662        8  1398/06/23  73125  N118    2795\n",
      "23151  1593545524        8  1398/06/23  73492  N118    2795\n",
      "23152   182052166        8  1398/06/23  74221  N118    4098\n",
      "\n",
      "[23153 rows x 6 columns]\n",
      "transactions in line 8 plat N193\n",
      "ps: \n",
      "              CardID  LineCode       FDate   Time  plat\n",
      "210194  2741326932         8  1398/06/23  23272  N193\n",
      "210195  1524504964         8  1398/06/23  25570  N193\n",
      "210196  1789049316         8  1398/06/23  26065  N193\n",
      "210197  1527774270         8  1398/06/23  26287  N193\n",
      "210198  1832021901         8  1398/06/23  26383  N193\n",
      "...            ...       ...         ...    ...   ...\n",
      "297404  2504718148         8  1398/06/23  37584  N193\n",
      "297405  3678326060         8  1398/06/23  37743  N193\n",
      "297406  1294419694         8  1398/06/23  37876  N193\n",
      "297407  2122903956         8  1398/06/23  38196  N193\n",
      "297408   710321909         8  1398/06/23  38278  N193\n",
      "\n",
      "[104 rows x 5 columns]\n",
      "first row of the selected chunck : \n",
      " [2741326932 8 '1398/06/23' 23272 'N193']\n",
      "104\n",
      "t0 = 23272\n",
      "ts = 38278\n",
      "time_intervals 25\n",
      "Origin destination interval view reindex \n",
      "    time_in  time_out\n",
      "0  23272.0   25672.0\n",
      "1  29872.0   30472.0\n",
      "2  32872.0   33472.0\n",
      "OD bus stations of transactions: \n",
      "            CardID LineCode       FDate   Time  plat Station\n",
      "0       542446139        1  1398/06/23  24030  A145    3169\n",
      "1      2620656172        1  1398/06/23  24302  A145    3169\n",
      "2      3446252780        1  1398/06/23  26200  A145    1227\n",
      "3         7900260        1  1398/06/23  29677  A145    3169\n",
      "4       361857972        1  1398/06/23  29720  A145    3169\n",
      "...           ...      ...         ...    ...   ...     ...\n",
      "23429  4256495924        8  1398/06/23  30111  N193    4098\n",
      "23430  2044281134        8  1398/06/23  30132  N193    4098\n",
      "23431  2541701278        8  1398/06/23  33405  N193    2795\n",
      "23432   721778957        8  1398/06/23  33409  N193    2795\n",
      "23433  1775787204        8  1398/06/23  33415  N193    2795\n",
      "\n",
      "[23434 rows x 6 columns]\n",
      "stations in a specefic bus line 9\n",
      "len-of-go stations: 15\n",
      "len-of-back stations: 18\n",
      "len-of-go back stations: 0\n",
      "first Station  [1101 '9' '1' 'go' '????? ??????  ??????-57-9' 51.651086 32.674353 'od'\n",
      " 'normal' 'no'] 1101\n",
      "last Station  [1236 '9' '1' 'back' '????????' 51.670191 32.645674 'od' 'normal' 'no']\n",
      "['A35' 'A38' 'A45' 'A50' 'B125' 'B63' 'B75' 'E12' 'E126' 'F97' 'M198'\n",
      " 'N111' 'N179']\n",
      "transactions in line 9 plat A35\n",
      "ps: \n",
      "              CardID  LineCode       FDate   Time plat\n",
      "258394  1371471310         9  1398/06/23  21276  A35\n",
      "258397  2541767790         9  1398/06/23  21292  A35\n",
      "258401  3405959025         9  1398/06/23  21502  A35\n",
      "258403  3793630108         9  1398/06/23  21618  A35\n",
      "258407   982395099         9  1398/06/23  21799  A35\n",
      "...            ...       ...         ...    ...  ...\n",
      "250522  1834861821         9  1398/06/23  76062  A35\n",
      "250539   473904858         9  1398/06/23  76676  A35\n",
      "250541   428358638         9  1398/06/23  76693  A35\n",
      "250545   428358638         9  1398/06/23  76696  A35\n",
      "250549  2855486382         9  1398/06/23  76895  A35\n",
      "\n",
      "[655 rows x 5 columns]\n",
      "first row of the selected chunck : \n",
      " [1371471310 9 '1398/06/23' 21276 'A35']\n",
      "655\n",
      "t0 = 21276\n",
      "ts = 76895\n",
      "time_intervals 93\n",
      "Origin destination interval view reindex \n",
      "     time_in  time_out\n",
      "0   21276.0   21876.0\n",
      "1   22476.0   23676.0\n",
      "2   24876.0   25476.0\n",
      "3   26676.0   27276.0\n",
      "4   30876.0   31476.0\n",
      "5   33276.0   33876.0\n",
      "6   35676.0   37476.0\n",
      "7   41676.0   42876.0\n",
      "8   47676.0   48876.0\n",
      "9   50676.0   51276.0\n",
      "10  53076.0   53676.0\n",
      "11  55476.0   56076.0\n",
      "12  59076.0   60876.0\n",
      "13  62676.0   63276.0\n",
      "14  66276.0   66876.0\n",
      "15  67476.0   68076.0\n",
      "16  69876.0   70476.0\n",
      "17  72876.0   74676.0\n",
      "OD bus stations of transactions: \n",
      "            CardID LineCode       FDate   Time  plat Station\n",
      "0       542446139        1  1398/06/23  24030  A145    3169\n",
      "1      2620656172        1  1398/06/23  24302  A145    3169\n",
      "2      3446252780        1  1398/06/23  26200  A145    1227\n",
      "3         7900260        1  1398/06/23  29677  A145    3169\n",
      "4       361857972        1  1398/06/23  29720  A145    3169\n",
      "...           ...      ...         ...    ...   ...     ...\n",
      "23580  3180447998        9  1398/06/23  74549   A35    1236\n",
      "23581  3180447998        9  1398/06/23  74555   A35    1236\n",
      "23582  3180447998        9  1398/06/23  74557   A35    1236\n",
      "23583  3180447998        9  1398/06/23  74558   A35    1236\n",
      "23584  3180447998        9  1398/06/23  74573   A35    1236\n",
      "\n",
      "[23585 rows x 6 columns]\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "transactions in line 9 plat A38\n",
      "ps: \n",
      "              CardID  LineCode       FDate   Time plat\n",
      "52325   1415282297         9  1398/06/23  23981  A38\n",
      "52326   1530450158         9  1398/06/23  23993  A38\n",
      "52324    721777747         9  1398/06/23  23996  A38\n",
      "52327   3205593637         9  1398/06/23  24298  A38\n",
      "52329   3997385396         9  1398/06/23  24496  A38\n",
      "...            ...       ...         ...    ...  ...\n",
      "156960  2507966036         9  1398/06/23  75211  A38\n",
      "156782  3180060270         9  1398/06/23  75213  A38\n",
      "156783   869375920         9  1398/06/23  75217  A38\n",
      "156961  2680010126         9  1398/06/23  75218  A38\n",
      "156962   722233216         9  1398/06/23  75780  A38\n",
      "\n",
      "[519 rows x 5 columns]\n",
      "first row of the selected chunck : \n",
      " [1415282297 9 '1398/06/23' 23981 'A38']\n",
      "519\n",
      "t0 = 23981\n",
      "ts = 75780\n",
      "time_intervals 86\n",
      "Origin destination interval view reindex \n",
      "     time_in  time_out\n",
      "0   23981.0   24581.0\n",
      "1   25781.0   26381.0\n",
      "2   29381.0   29981.0\n",
      "3   31781.0   32381.0\n",
      "4   39581.0   40181.0\n",
      "5   42581.0   43781.0\n",
      "6   45581.0   47381.0\n",
      "7   49181.0   56981.0\n",
      "8   57581.0   58781.0\n",
      "9   59981.0   60581.0\n",
      "10  62381.0   62981.0\n",
      "11  64181.0   64781.0\n",
      "12  65981.0   66581.0\n",
      "13  68981.0   69581.0\n",
      "14  70181.0   70781.0\n",
      "OD bus stations of transactions: \n",
      "            CardID LineCode       FDate   Time  plat Station\n",
      "0       542446139        1  1398/06/23  24030  A145    3169\n",
      "1      2620656172        1  1398/06/23  24302  A145    3169\n",
      "2      3446252780        1  1398/06/23  26200  A145    1227\n",
      "3         7900260        1  1398/06/23  29677  A145    3169\n",
      "4       361857972        1  1398/06/23  29720  A145    3169\n",
      "...           ...      ...         ...    ...   ...     ...\n",
      "24174   428971646        9  1398/06/23  70557   A38    1101\n",
      "24175  3792896076        9  1398/06/23  70566   A38    1101\n",
      "24176  2116163044        9  1398/06/23  70624   A38    1101\n",
      "24177  2116163044        9  1398/06/23  70625   A38    1101\n",
      "24178   869432141        9  1398/06/23  70667   A38    1101\n",
      "\n",
      "[24179 rows x 6 columns]\n",
      "transactions in line 9 plat A45\n",
      "ps: \n",
      "              CardID  LineCode       FDate   Time plat\n",
      "1490     869428283         9  1398/06/23  22315  A45\n",
      "1491    3405796161         9  1398/06/23  23277  A45\n",
      "1492     427492606         9  1398/06/23  23282  A45\n",
      "1493    2620539148         9  1398/06/23  23286  A45\n",
      "1494     641436026         9  1398/06/23  23304  A45\n",
      "...            ...       ...         ...    ...  ...\n",
      "527759  3254323885         9  1398/06/23  75583  A45\n",
      "527760   722040059         9  1398/06/23  75735  A45\n",
      "683913  3679850812         9  1398/06/23  77052  A45\n",
      "683914  3679850812         9  1398/06/23  77054  A45\n",
      "1489    3679850812         9  1398/06/23  77056  A45\n",
      "\n",
      "[619 rows x 5 columns]\n",
      "first row of the selected chunck : \n",
      " [869428283 9 '1398/06/23' 22315 'A45']\n",
      "619\n",
      "t0 = 22315\n",
      "ts = 77056\n",
      "time_intervals 91\n",
      "Origin destination interval view reindex \n",
      "     time_in  time_out\n",
      "0   22315.0   23515.0\n",
      "1   24715.0   25915.0\n",
      "2   28915.0   29515.0\n",
      "3   33715.0   34315.0\n",
      "4   36115.0   36715.0\n",
      "5   38515.0   39715.0\n",
      "6   42115.0   42715.0\n",
      "7   45115.0   46315.0\n",
      "8   48715.0   49915.0\n",
      "9   58915.0   59515.0\n",
      "10  61915.0   62515.0\n",
      "11  64915.0   66115.0\n",
      "12  68515.0   69115.0\n",
      "13  73315.0   75715.0\n",
      "OD bus stations of transactions: \n",
      "            CardID LineCode       FDate   Time  plat Station\n",
      "0       542446139        1  1398/06/23  24030  A145    3169\n",
      "1      2620656172        1  1398/06/23  24302  A145    3169\n",
      "2      3446252780        1  1398/06/23  26200  A145    1227\n",
      "3         7900260        1  1398/06/23  29677  A145    3169\n",
      "4       361857972        1  1398/06/23  29720  A145    3169\n",
      "...           ...      ...         ...    ...   ...     ...\n",
      "24539  3258187325        9  1398/06/23  69081   A45    1101\n",
      "24540  2855449086        9  1398/06/23  69084   A45    1101\n",
      "24541  3558370625        9  1398/06/23  75235   A45    1236\n",
      "24542  3209508724        9  1398/06/23  75239   A45    1236\n",
      "24543  3254323885        9  1398/06/23  75583   A45    1236\n",
      "\n",
      "[24544 rows x 6 columns]\n",
      "transactions in line 9 plat A50\n",
      "ps: \n",
      "             CardID  LineCode       FDate   Time plat\n",
      "93837   361128148         9  1398/06/23  23570  A50\n",
      "93840  4076011338         9  1398/06/23  23815  A50\n",
      "93843  2232726499         9  1398/06/23  24009  A50\n",
      "93845  2498396580         9  1398/06/23  24127  A50\n",
      "93852  3151529918         9  1398/06/23  25493  A50\n",
      "...           ...       ...         ...    ...  ...\n",
      "57067  2854907582         9  1398/06/23  73835  A50\n",
      "56816  3794531772         9  1398/06/23  73856  A50\n",
      "56819  3794531772         9  1398/06/23  73861  A50\n",
      "56822  4058067789         9  1398/06/23  73864  A50\n",
      "57077  3297768274         9  1398/06/23  74139  A50\n",
      "\n",
      "[393 rows x 5 columns]\n",
      "first row of the selected chunck : \n",
      " [361128148 9 '1398/06/23' 23570 'A50']\n",
      "393\n",
      "t0 = 23570\n",
      "ts = 74139\n",
      "time_intervals 84\n",
      "Origin destination interval view reindex \n",
      "    time_in  time_out\n",
      "0  23570.0   24170.0\n",
      "1  24770.0   25970.0\n",
      "2  27170.0   42770.0\n",
      "3  43970.0   45770.0\n",
      "4  48170.0   48770.0\n",
      "5  50570.0   51170.0\n",
      "6  57770.0   61370.0\n",
      "7  63170.0   63770.0\n",
      "8  66770.0   67370.0\n",
      "9  70370.0   71570.0\n",
      "OD bus stations of transactions: \n",
      "            CardID LineCode       FDate   Time  plat Station\n",
      "0       542446139        1  1398/06/23  24030  A145    3169\n",
      "1      2620656172        1  1398/06/23  24302  A145    3169\n",
      "2      3446252780        1  1398/06/23  26200  A145    1227\n",
      "3         7900260        1  1398/06/23  29677  A145    3169\n",
      "4       361857972        1  1398/06/23  29720  A145    3169\n",
      "...           ...      ...         ...    ...   ...     ...\n",
      "25130   537277758        9  1398/06/23  67368   A50    1101\n",
      "25131   537277758        9  1398/06/23  67369   A50    1101\n",
      "25132  3214408068        9  1398/06/23  71563   A50    1236\n",
      "25133  3214408068        9  1398/06/23  71564   A50    1236\n",
      "25134   983279211        9  1398/06/23  71570   A50    1236\n",
      "\n",
      "[25135 rows x 6 columns]\n",
      "transactions in line 9 plat B125\n",
      "ps: \n",
      "             CardID  LineCode       FDate   Time  plat\n",
      "23610  2590266660         9  1398/06/23  22839  B125\n",
      "23613   262301569         9  1398/06/23  23311  B125\n",
      "23616  2137100509         9  1398/06/23  23313  B125\n",
      "23620  2665053916         9  1398/06/23  23463  B125\n",
      "23622  2137892141         9  1398/06/23  23520  B125\n",
      "...           ...       ...         ...    ...   ...\n",
      "83698  3792736012         9  1398/06/23  74667  B125\n",
      "83700  3792736012         9  1398/06/23  74669  B125\n",
      "83693  3405880037         9  1398/06/23  74670  B125\n",
      "23602  3792427324         9  1398/06/23  74948  B125\n",
      "23606  3792427324         9  1398/06/23  74955  B125\n",
      "\n",
      "[419 rows x 5 columns]\n",
      "first row of the selected chunck : \n",
      " [2590266660 9 '1398/06/23' 22839 'B125']\n",
      "419\n",
      "t0 = 22839\n",
      "ts = 74955\n",
      "time_intervals 87\n",
      "Origin destination interval view reindex \n",
      "     time_in  time_out\n",
      "0   22839.0   23439.0\n",
      "1   24639.0   25239.0\n",
      "2   26439.0   27039.0\n",
      "3   28839.0   29439.0\n",
      "4   30639.0   31239.0\n",
      "5   33039.0   33639.0\n",
      "6   35439.0   36039.0\n",
      "7   37839.0   39039.0\n",
      "8   41439.0   42039.0\n",
      "9   43839.0   45639.0\n",
      "10  47439.0   57639.0\n",
      "11  58239.0   59439.0\n",
      "12  61239.0   61839.0\n",
      "13  64239.0   64839.0\n",
      "14  65439.0   66039.0\n",
      "15  67239.0   68439.0\n",
      "16  70839.0   72639.0\n",
      "OD bus stations of transactions: \n",
      "            CardID LineCode       FDate   Time  plat Station\n",
      "0       542446139        1  1398/06/23  24030  A145    3169\n",
      "1      2620656172        1  1398/06/23  24302  A145    3169\n",
      "2      3446252780        1  1398/06/23  26200  A145    1227\n",
      "3         7900260        1  1398/06/23  29677  A145    3169\n",
      "4       361857972        1  1398/06/23  29720  A145    3169\n",
      "...           ...      ...         ...    ...   ...     ...\n",
      "25507  4075695514        9  1398/06/23  72418  B125    1101\n",
      "25508   645532397        9  1398/06/23  72514  B125    1101\n",
      "25509  1001271886        9  1398/06/23  72577  B125    1101\n",
      "25510  1001271886        9  1398/06/23  72578  B125    1101\n",
      "25511  3556748833        9  1398/06/23  72598  B125    1101\n",
      "\n",
      "[25512 rows x 6 columns]\n",
      "transactions in line 9 plat B63\n",
      "ps: \n",
      "              CardID  LineCode       FDate   Time plat\n",
      "247152   173298292         9  1398/06/23  29367  B63\n",
      "247153  1594633380         9  1398/06/23  29368  B63\n",
      "247156   164198052         9  1398/06/23  29989  B63\n",
      "first row of the selected chunck : \n",
      " [173298292 9 '1398/06/23' 29367 'B63']\n",
      "3\n",
      "t0 = 29367\n",
      "ts = 29989\n",
      "time_intervals 1\n",
      "Origin destination interval view reindex \n",
      "    time_in  time_out\n",
      "0  29367.0   29967.0\n",
      "OD bus stations of transactions: \n",
      "            CardID LineCode       FDate   Time  plat Station\n",
      "0       542446139        1  1398/06/23  24030  A145    3169\n",
      "1      2620656172        1  1398/06/23  24302  A145    3169\n",
      "2      3446252780        1  1398/06/23  26200  A145    1227\n",
      "3         7900260        1  1398/06/23  29677  A145    3169\n",
      "4       361857972        1  1398/06/23  29720  A145    3169\n",
      "...           ...      ...         ...    ...   ...     ...\n",
      "25688   869341237        9  1398/06/23  68501  B125    1153\n",
      "25689  1000886126        9  1398/06/23  68610  B125    1153\n",
      "25690   869341237        9  1398/06/23  68501  B125    1236\n",
      "25691   173298292        9  1398/06/23  29367   B63    1101\n",
      "25692  1594633380        9  1398/06/23  29368   B63    1101\n",
      "\n",
      "[25693 rows x 6 columns]\n",
      "transactions in line 9 plat B75\n",
      "ps: \n",
      "              CardID  LineCode       FDate   Time plat\n",
      "386756  2680854004         9  1398/06/23  26834  B75\n",
      "386757   725701703         9  1398/06/23  27005  B75\n",
      "386758   721849162         9  1398/06/23  27187  B75\n",
      "386759  1835468173         9  1398/06/23  27283  B75\n",
      "386760  2742913556         9  1398/06/23  27287  B75\n",
      "...            ...       ...         ...    ...  ...\n",
      "476282  4241666583         9  1398/06/23  74680  B75\n",
      "476283   262447425         9  1398/06/23  74832  B75\n",
      "476284  2125722420         9  1398/06/23  74905  B75\n",
      "476285   869313015         9  1398/06/23  74909  B75\n",
      "476286   233560234         9  1398/06/23  75110  B75\n",
      "\n",
      "[373 rows x 5 columns]\n",
      "first row of the selected chunck : \n",
      " [2680854004 9 '1398/06/23' 26834 'B75']\n",
      "373\n",
      "t0 = 26834\n",
      "ts = 75110\n",
      "time_intervals 80\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Origin destination interval view reindex \n",
      "    time_in  time_out\n",
      "0  26834.0   27434.0\n",
      "1  31634.0   32834.0\n",
      "2  45434.0   46034.0\n",
      "3  46634.0   47834.0\n",
      "4  50234.0   52034.0\n",
      "5  54434.0   67634.0\n",
      "6  69434.0   70034.0\n",
      "7  71234.0   73034.0\n",
      "OD bus stations of transactions: \n",
      "            CardID LineCode       FDate   Time  plat Station\n",
      "0       542446139        1  1398/06/23  24030  A145    3169\n",
      "1      2620656172        1  1398/06/23  24302  A145    3169\n",
      "2      3446252780        1  1398/06/23  26200  A145    1227\n",
      "3         7900260        1  1398/06/23  29677  A145    3169\n",
      "4       361857972        1  1398/06/23  29720  A145    3169\n",
      "...           ...      ...         ...    ...   ...     ...\n",
      "25772  3603847068        9  1398/06/23  72947   B75    1236\n",
      "25773  3547468900        9  1398/06/23  72949   B75    1236\n",
      "25774  2117576004        9  1398/06/23  72950   B75    1236\n",
      "25775  3254399821        9  1398/06/23  72953   B75    1236\n",
      "25776  3405785110        9  1398/06/23  72974   B75    1236\n",
      "\n",
      "[25777 rows x 6 columns]\n",
      "transactions in line 9 plat E12\n",
      "ps: \n",
      "              CardID  LineCode       FDate   Time plat\n",
      "302349  1835079197         9  1398/06/23  22280  E12\n",
      "302350  4266152178         9  1398/06/23  22552  E12\n",
      "302351  1776233348         9  1398/06/23  22833  E12\n",
      "302352  4266358914         9  1398/06/23  23800  E12\n",
      "302353  1765688948         9  1398/06/23  23848  E12\n",
      "...            ...       ...         ...    ...  ...\n",
      "376     1594900308         9  1398/06/23  49156  E12\n",
      "377     2740498612         9  1398/06/23  50022  E12\n",
      "378     2136771725         9  1398/06/23  50148  E12\n",
      "379     3791945948         9  1398/06/23  50296  E12\n",
      "483     3152925582         9  1398/06/23  50303  E12\n",
      "\n",
      "[295 rows x 5 columns]\n",
      "first row of the selected chunck : \n",
      " [1835079197 9 '1398/06/23' 22280 'E12']\n",
      "295\n",
      "t0 = 22280\n",
      "ts = 50303\n",
      "time_intervals 47\n",
      "Origin destination interval view reindex \n",
      "    time_in  time_out\n",
      "0  22280.0   22880.0\n",
      "1  23480.0   24080.0\n",
      "2  25880.0   26480.0\n",
      "3  27680.0   28880.0\n",
      "4  32480.0   33680.0\n",
      "5  42680.0   44480.0\n",
      "6  46880.0   48080.0\n",
      "7  49880.0   50480.0\n",
      "OD bus stations of transactions: \n",
      "            CardID LineCode       FDate   Time  plat Station\n",
      "0       542446139        1  1398/06/23  24030  A145    3169\n",
      "1      2620656172        1  1398/06/23  24302  A145    3169\n",
      "2      3446252780        1  1398/06/23  26200  A145    1227\n",
      "3         7900260        1  1398/06/23  29677  A145    3169\n",
      "4       361857972        1  1398/06/23  29720  A145    3169\n",
      "...           ...      ...         ...    ...   ...     ...\n",
      "26059  3151342622        9  1398/06/23  48032   E12    1101\n",
      "26060  2740498612        9  1398/06/23  50022   E12    1236\n",
      "26061  2136771725        9  1398/06/23  50148   E12    1236\n",
      "26062  3791945948        9  1398/06/23  50296   E12    1236\n",
      "26063  3152925582        9  1398/06/23  50303   E12    1236\n",
      "\n",
      "[26064 rows x 6 columns]\n",
      "transactions in line 9 plat E126\n",
      "ps: \n",
      "              CardID  LineCode       FDate   Time  plat\n",
      "212637  2239166222         9  1398/06/23  58940  E126\n",
      "212640  2239166222         9  1398/06/23  58941  E126\n",
      "212643  4276382754         9  1398/06/23  59014  E126\n",
      "212646  3630918460         9  1398/06/23  59057  E126\n",
      "212648  2049357394         9  1398/06/23  59077  E126\n",
      "...            ...       ...         ...    ...   ...\n",
      "272841  1530497902         9  1398/06/23  78782  E126\n",
      "272844  1530497902         9  1398/06/23  78783  E126\n",
      "272847   721771463         9  1398/06/23  78790  E126\n",
      "272851   869269097         9  1398/06/23  78794  E126\n",
      "23465   3258220221         9  1398/06/23  78796  E126\n",
      "\n",
      "[255 rows x 5 columns]\n",
      "first row of the selected chunck : \n",
      " [2239166222 9 '1398/06/23' 58940 'E126']\n",
      "255\n",
      "t0 = 58940\n",
      "ts = 78796\n",
      "time_intervals 33\n",
      "Origin destination interval view reindex \n",
      "    time_in  time_out\n",
      "0  58940.0   59540.0\n",
      "1  60740.0   61940.0\n",
      "2  63740.0   64340.0\n",
      "3  66140.0   67340.0\n",
      "4  70940.0   72740.0\n",
      "5  75140.0   75740.0\n",
      "6  76340.0   76940.0\n",
      "OD bus stations of transactions: \n",
      "            CardID LineCode       FDate   Time  plat Station\n",
      "0       542446139        1  1398/06/23  24030  A145    3169\n",
      "1      2620656172        1  1398/06/23  24302  A145    3169\n",
      "2      3446252780        1  1398/06/23  26200  A145    1227\n",
      "3         7900260        1  1398/06/23  29677  A145    3169\n",
      "4       361857972        1  1398/06/23  29720  A145    3169\n",
      "...           ...      ...         ...    ...   ...     ...\n",
      "26371  3206588892        9  1398/06/23  76870  E126    1101\n",
      "26372  3206588892        9  1398/06/23  76874  E126    1101\n",
      "26373  3206588892        9  1398/06/23  76876  E126    1101\n",
      "26374   980500427        9  1398/06/23  76885  E126    1101\n",
      "26375  4270861650        9  1398/06/23  76889  E126    1101\n",
      "\n",
      "[26376 rows x 6 columns]\n",
      "transactions in line 9 plat F97\n",
      "ps: \n",
      "              CardID  LineCode       FDate   Time plat\n",
      "125920   342711940         9  1398/06/23  23537  F97\n",
      "125921  2741283540         9  1398/06/23  24242  F97\n",
      "125922  2239123694         9  1398/06/23  25622  F97\n",
      "125923  3178795582         9  1398/06/23  25763  F97\n",
      "125924  1002679207         9  1398/06/23  25841  F97\n",
      "...            ...       ...         ...    ...  ...\n",
      "186852  3106793925         9  1398/06/23  54684  F97\n",
      "125865   479991684         9  1398/06/23  57733  F97\n",
      "125866   479991684         9  1398/06/23  57737  F97\n",
      "125867   479991684         9  1398/06/23  57740  F97\n",
      "125919   479991684         9  1398/06/23  57757  F97\n",
      "\n",
      "[251 rows x 5 columns]\n",
      "first row of the selected chunck : \n",
      " [342711940 9 '1398/06/23' 23537 'F97']\n",
      "251\n",
      "t0 = 23537\n",
      "ts = 57757\n",
      "time_intervals 57\n",
      "Origin destination interval view reindex \n",
      "    time_in  time_out\n",
      "0  23537.0   24737.0\n",
      "1  25337.0   25937.0\n",
      "2  27737.0   28937.0\n",
      "3  30737.0   31937.0\n",
      "4  34337.0   34937.0\n",
      "5  41537.0   42137.0\n",
      "6  44537.0   45737.0\n",
      "7  48137.0   48737.0\n",
      "8  52937.0   53537.0\n",
      "9  55337.0   57737.0\n",
      "OD bus stations of transactions: \n",
      "            CardID LineCode       FDate   Time  plat Station\n",
      "0       542446139        1  1398/06/23  24030  A145    3169\n",
      "1      2620656172        1  1398/06/23  24302  A145    3169\n",
      "2      3446252780        1  1398/06/23  26200  A145    1227\n",
      "3         7900260        1  1398/06/23  29677  A145    3169\n",
      "4       361857972        1  1398/06/23  29720  A145    3169\n",
      "...           ...      ...         ...    ...   ...     ...\n",
      "26576  2498031533        9  1398/06/23  48678   F97    1236\n",
      "26577  2122809380        9  1398/06/23  53284   F97    1101\n",
      "26578  4265587842        9  1398/06/23  53489   F97    1101\n",
      "26579   479991684        9  1398/06/23  57733   F97    1236\n",
      "26580   479991684        9  1398/06/23  57737   F97    1236\n",
      "\n",
      "[26581 rows x 6 columns]\n",
      "transactions in line 9 plat M198\n",
      "ps: \n",
      "              CardID  LineCode       FDate   Time  plat\n",
      "268937  2138127661         9  1398/06/23  23137  M198\n",
      "268940  4278467794         9  1398/06/23  23370  M198\n",
      "268943  2503018212         9  1398/06/23  23551  M198\n",
      "268948  2585794100         9  1398/06/23  24541  M198\n",
      "268950  2585794100         9  1398/06/23  24542  M198\n",
      "...            ...       ...         ...    ...   ...\n",
      "23481    721750059         9  1398/06/23  75236  M198\n",
      "23485    736404512         9  1398/06/23  75336  M198\n",
      "23487    736404512         9  1398/06/23  75337  M198\n",
      "23483   3444860572         9  1398/06/23  75411  M198\n",
      "23489   1296143582         9  1398/06/23  75413  M198\n",
      "\n",
      "[456 rows x 5 columns]\n",
      "first row of the selected chunck : \n",
      " [2138127661 9 '1398/06/23' 23137 'M198']\n",
      "456\n",
      "t0 = 23137\n",
      "ts = 75413\n",
      "time_intervals 87\n",
      "Origin destination interval view reindex \n",
      "     time_in  time_out\n",
      "0   23137.0   23737.0\n",
      "1   24337.0   24937.0\n",
      "2   26137.0   26737.0\n",
      "3   30337.0   32137.0\n",
      "4   35737.0   36337.0\n",
      "5   41137.0   41737.0\n",
      "6   44137.0   45337.0\n",
      "7   50137.0   58537.0\n",
      "8   62137.0   62737.0\n",
      "9   68737.0   69937.0\n",
      "10  71737.0   73537.0\n",
      "OD bus stations of transactions: \n",
      "            CardID LineCode       FDate   Time  plat Station\n",
      "0       542446139        1  1398/06/23  24030  A145    3169\n",
      "1      2620656172        1  1398/06/23  24302  A145    3169\n",
      "2      3446252780        1  1398/06/23  26200  A145    1227\n",
      "3         7900260        1  1398/06/23  29677  A145    3169\n",
      "4       361857972        1  1398/06/23  29720  A145    3169\n",
      "...           ...      ...         ...    ...   ...     ...\n",
      "26799  2239171716        9  1398/06/23  73144  M198    1101\n",
      "26800  2239171716        9  1398/06/23  73146  M198    1101\n",
      "26801  3631418076        9  1398/06/23  73149  M198    1101\n",
      "26802  3405852314        9  1398/06/23  73237  M198    1101\n",
      "26803  3672836594        9  1398/06/23  73424  M198    1101\n",
      "\n",
      "[26804 rows x 6 columns]\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "transactions in line 9 plat N111\n",
      "ps: \n",
      "              CardID  LineCode       FDate   Time  plat\n",
      "646733  2239181717         9  1398/06/23  24171  N111\n",
      "646734   183854358         9  1398/06/23  24255  N111\n",
      "646735  1459053573         9  1398/06/23  24718  N111\n",
      "647656  4057391789         9  1398/06/23  24806  N111\n",
      "647657  4057391789         9  1398/06/23  24807  N111\n",
      "...            ...       ...         ...    ...   ...\n",
      "36034    428302478         9  1398/06/23  76000  N111\n",
      "36024   2116284804         9  1398/06/23  76014  N111\n",
      "36035   3184054270         9  1398/06/23  76039  N111\n",
      "36036   3181038686         9  1398/06/23  76045  N111\n",
      "36037   3181038686         9  1398/06/23  76046  N111\n",
      "\n",
      "[507 rows x 5 columns]\n",
      "first row of the selected chunck : \n",
      " [2239181717 9 '1398/06/23' 24171 'N111']\n",
      "507\n",
      "t0 = 24171\n",
      "ts = 76046\n",
      "time_intervals 86\n",
      "Origin destination interval view reindex \n",
      "     time_in  time_out\n",
      "0   24171.0   24771.0\n",
      "1   25971.0   26571.0\n",
      "2   29571.0   30171.0\n",
      "3   34371.0   35571.0\n",
      "4   37371.0   37971.0\n",
      "5   39771.0   40971.0\n",
      "6   43371.0   44571.0\n",
      "7   46971.0   47571.0\n",
      "8   49371.0   50571.0\n",
      "9   54771.0   55371.0\n",
      "10  56571.0   57171.0\n",
      "11  60771.0   62571.0\n",
      "12  64371.0   64971.0\n",
      "13  67971.0   69171.0\n",
      "14  70971.0   73371.0\n",
      "OD bus stations of transactions: \n",
      "            CardID LineCode       FDate   Time  plat Station\n",
      "0       542446139        1  1398/06/23  24030  A145    3169\n",
      "1      2620656172        1  1398/06/23  24302  A145    3169\n",
      "2      3446252780        1  1398/06/23  26200  A145    1227\n",
      "3         7900260        1  1398/06/23  29677  A145    3169\n",
      "4       361857972        1  1398/06/23  29720  A145    3169\n",
      "...           ...      ...         ...    ...   ...     ...\n",
      "27268  3680328156        9  1398/06/23  69101  N111    1236\n",
      "27269   480492692        9  1398/06/23  69165  N111    1236\n",
      "27270  2124461972        9  1398/06/23  73025  N111    1101\n",
      "27271  2124461972        9  1398/06/23  73026  N111    1101\n",
      "27272  2124461972        9  1398/06/23  73028  N111    1101\n",
      "\n",
      "[27273 rows x 6 columns]\n",
      "transactions in line 9 plat N179\n",
      "ps: \n",
      "               CardID  LineCode       FDate   Time  plat\n",
      "554349   3206560972         9  1398/06/23  23741  N179\n",
      "554352    721805690         9  1398/06/23  24132  N179\n",
      "554361   3629866380         9  1398/06/23  25767  N179\n",
      "554353   3794586236         9  1398/06/23  25819  N179\n",
      "554355   3794586236         9  1398/06/23  25821  N179\n",
      "...             ...       ...         ...    ...   ...\n",
      "1751684  2680858516         9  1398/06/23  70949  N179\n",
      "1751687  3555350913         9  1398/06/23  71075  N179\n",
      "1751690  3152513214         9  1398/06/23  71080  N179\n",
      "1752221  4279375938         9  1398/06/23  71234  N179\n",
      "1752224  4279375938         9  1398/06/23  71237  N179\n",
      "\n",
      "[560 rows x 5 columns]\n",
      "first row of the selected chunck : \n",
      " [3206560972 9 '1398/06/23' 23741 'N179']\n",
      "560\n",
      "t0 = 23741\n",
      "ts = 71237\n",
      "time_intervals 79\n",
      "Origin destination interval view reindex \n",
      "     time_in  time_out\n",
      "0   23741.0   24341.0\n",
      "1   24941.0   26141.0\n",
      "2   27341.0   27941.0\n",
      "3   29141.0   29741.0\n",
      "4   32141.0   32741.0\n",
      "5   39941.0   40541.0\n",
      "6   42941.0   43541.0\n",
      "7   45941.0   47141.0\n",
      "8   48941.0   49541.0\n",
      "9   54941.0   55541.0\n",
      "10  56741.0   57941.0\n",
      "11  60341.0   60941.0\n",
      "12  63941.0   65141.0\n",
      "13  67541.0   68741.0\n",
      "14  69341.0   69941.0\n",
      "OD bus stations of transactions: \n",
      "            CardID LineCode       FDate   Time  plat Station\n",
      "0       542446139        1  1398/06/23  24030  A145    3169\n",
      "1      2620656172        1  1398/06/23  24302  A145    3169\n",
      "2      3446252780        1  1398/06/23  26200  A145    1227\n",
      "3         7900260        1  1398/06/23  29677  A145    3169\n",
      "4       361857972        1  1398/06/23  29720  A145    3169\n",
      "...           ...      ...         ...    ...   ...     ...\n",
      "27711  1371656766        9  1398/06/23  69590  N179    1101\n",
      "27712  4265829970        9  1398/06/23  69856  N179    1101\n",
      "27713  4265829970        9  1398/06/23  69858  N179    1101\n",
      "27714  3206543860        9  1398/06/23  69871  N179    1101\n",
      "27715  3648586212        9  1398/06/23  69893  N179    1101\n",
      "\n",
      "[27716 rows x 6 columns]\n",
      "stations in a specefic bus line 10\n",
      "len-of-go stations: 32\n",
      "len-of-back stations: 29\n",
      "len-of-go back stations: 0\n",
      "first Station  [1880 '10' '1' 'go' '?????? ??? ??????? -10' 51.690769 32.683341 'od'\n",
      " 'normal' 'yes'] 1880\n",
      "last Station  [2120 '10' '1' 'back' '????? ????-10' 51.636784 32.623979 'od' 'normal'\n",
      " 'no']\n",
      "['A144' 'A17' 'A31' 'A38' 'D49' 'D52' 'E187' 'F11' 'F118' 'F150' 'F152'\n",
      " 'F153' 'F21' 'F81' 'M39' 'N190']\n",
      "transactions in line 10 plat A144\n",
      "ps: \n",
      "              CardID  LineCode       FDate   Time  plat\n",
      "183752  3183284110        10  1398/06/23  23966  A144\n",
      "183753  2506230708        10  1398/06/23  23978  A144\n",
      "183754  1788724388        10  1398/06/23  23980  A144\n",
      "183755  4241310951        10  1398/06/23  23980  A144\n",
      "183756  3648981300        10  1398/06/23  23991  A144\n",
      "...            ...       ...         ...    ...   ...\n",
      "264136  1407202850        10  1398/06/23  78650  A144\n",
      "264137  2740619220        10  1398/06/23  78952  A144\n",
      "264138  2743254772        10  1398/06/23  78960  A144\n",
      "264139  2743254772        10  1398/06/23  78962  A144\n",
      "264140  3648802020        10  1398/06/23  79408  A144\n",
      "\n",
      "[535 rows x 5 columns]\n",
      "first row of the selected chunck : \n",
      " [3183284110 10 '1398/06/23' 23966 'A144']\n",
      "535\n",
      "t0 = 23966\n",
      "ts = 79408\n",
      "time_intervals 92\n",
      "Origin destination interval view reindex \n",
      "    time_in  time_out\n",
      "0  23966.0   24566.0\n",
      "1  29966.0   31766.0\n",
      "2  34766.0   35366.0\n",
      "3  39566.0   40766.0\n",
      "4  44966.0   45566.0\n",
      "5  49166.0   59366.0\n",
      "6  67166.0   70166.0\n",
      "7  74966.0   76166.0\n",
      "OD bus stations of transactions: \n",
      "            CardID LineCode       FDate   Time  plat Station\n",
      "0       542446139        1  1398/06/23  24030  A145    3169\n",
      "1      2620656172        1  1398/06/23  24302  A145    3169\n",
      "2      3446252780        1  1398/06/23  26200  A145    1227\n",
      "3         7900260        1  1398/06/23  29677  A145    3169\n",
      "4       361857972        1  1398/06/23  29720  A145    3169\n",
      "...           ...      ...         ...    ...   ...     ...\n",
      "28147  3178720958       10  1398/06/23  59354  A144    2120\n",
      "28148   177378582       10  1398/06/23  69962  A144    1880\n",
      "28149   261663969       10  1398/06/23  75757  A144    2120\n",
      "28150   262995937       10  1398/06/23  75818  A144    2120\n",
      "28151  1000635694       10  1398/06/23  75914  A144    2120\n",
      "\n",
      "[28152 rows x 6 columns]\n",
      "transactions in line 10 plat A17\n",
      "ps: \n",
      "              CardID  LineCode       FDate   Time plat\n",
      "70834    361294516        10  1398/06/23  23518  A17\n",
      "70835   2122416580        10  1398/06/23  24685  A17\n",
      "70836   1360801962        10  1398/06/23  24689  A17\n",
      "70837    722175500        10  1398/06/23  24691  A17\n",
      "70838   4275690466        10  1398/06/23  24727  A17\n",
      "...            ...       ...         ...    ...  ...\n",
      "295955  4265561714        10  1398/06/23  76817  A17\n",
      "295952  3650179076        10  1398/06/23  76824  A17\n",
      "295956   392223306        10  1398/06/23  76825  A17\n",
      "295957   722110476        10  1398/06/23  77429  A17\n",
      "295958  2044054510        10  1398/06/23  77433  A17\n",
      "\n",
      "[548 rows x 5 columns]\n",
      "first row of the selected chunck : \n",
      " [361294516 10 '1398/06/23' 23518 'A17']\n",
      "548\n",
      "t0 = 23518\n",
      "ts = 77433\n",
      "time_intervals 90\n",
      "Origin destination interval view reindex \n",
      "    time_in  time_out\n",
      "0  23518.0   24718.0\n",
      "1  30718.0   32518.0\n",
      "2  35518.0   36718.0\n",
      "3  40318.0   41518.0\n",
      "4  50518.0   58318.0\n",
      "5  66118.0   68518.0\n",
      "6  73318.0   74518.0\n",
      "7  75118.0   75718.0\n",
      "OD bus stations of transactions: \n",
      "            CardID LineCode       FDate   Time  plat Station\n",
      "0       542446139        1  1398/06/23  24030  A145    3169\n",
      "1      2620656172        1  1398/06/23  24302  A145    3169\n",
      "2      3446252780        1  1398/06/23  26200  A145    1227\n",
      "3         7900260        1  1398/06/23  29677  A145    3169\n",
      "4       361857972        1  1398/06/23  29720  A145    3169\n",
      "...           ...      ...         ...    ...   ...     ...\n",
      "28623  2053303330       10  1398/06/23  75338   A17    2120\n",
      "28624   980910155       10  1398/06/23  75342   A17    2120\n",
      "28625   721745795       10  1398/06/23  75507   A17    2120\n",
      "28626  3405902179       10  1398/06/23  75537   A17    2120\n",
      "28627  3405902179       10  1398/06/23  75542   A17    2120\n",
      "\n",
      "[28628 rows x 6 columns]\n",
      "transactions in line 10 plat A31\n",
      "ps: \n",
      "              CardID  LineCode       FDate   Time plat\n",
      "181267  3630346460        10  1398/06/23  22808  A31\n",
      "181268   301414731        10  1398/06/23  23095  A31\n",
      "181446   174465620        10  1398/06/23  23235  A31\n",
      "181447   737010128        10  1398/06/23  23238  A31\n",
      "181448  4059389629        10  1398/06/23  23241  A31\n",
      "...            ...       ...         ...    ...  ...\n",
      "278371  1292942798        10  1398/06/23  77438  A31\n",
      "278369  2586552564        10  1398/06/23  77504  A31\n",
      "278372  2183514659        10  1398/06/23  77952  A31\n",
      "278373  3678053116        10  1398/06/23  78010  A31\n",
      "278374  3678053116        10  1398/06/23  78011  A31\n",
      "\n",
      "[635 rows x 5 columns]\n",
      "first row of the selected chunck : \n",
      " [3630346460 10 '1398/06/23' 22808 'A31']\n",
      "635\n",
      "t0 = 22808\n",
      "ts = 78011\n",
      "time_intervals 92\n",
      "Origin destination interval view reindex \n",
      "     time_in  time_out\n",
      "0   22808.0   23408.0\n",
      "1   25208.0   25808.0\n",
      "2   28208.0   30008.0\n",
      "3   32408.0   33608.0\n",
      "4   37208.0   39008.0\n",
      "5   42608.0   43208.0\n",
      "6   48008.0   50408.0\n",
      "7   52808.0   53408.0\n",
      "8   56408.0   57608.0\n",
      "9   60608.0   61208.0\n",
      "10  65408.0   67208.0\n",
      "11  72008.0   73208.0\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "OD bus stations of transactions: \n",
      "            CardID LineCode       FDate   Time  plat Station\n",
      "0       542446139        1  1398/06/23  24030  A145    3169\n",
      "1      2620656172        1  1398/06/23  24302  A145    3169\n",
      "2      3446252780        1  1398/06/23  26200  A145    1227\n",
      "3         7900260        1  1398/06/23  29677  A145    3169\n",
      "4       361857972        1  1398/06/23  29720  A145    3169\n",
      "...           ...      ...         ...    ...   ...     ...\n",
      "29201  1592609092       10  1398/06/23  67191   A31    1880\n",
      "29202  3405914889       10  1398/06/23  67196   A31    1880\n",
      "29203   211076091       10  1398/06/23  73081   A31    2120\n",
      "29204   211076091       10  1398/06/23  73083   A31    2120\n",
      "29205   429286430       10  1398/06/23  73174   A31    2120\n",
      "\n",
      "[29206 rows x 6 columns]\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "C:\\Users\\esmaeli.h\\AppData\\Local\\Temp/ipykernel_12452/1949912630.py:257: ConvergenceWarning: Number of distinct clusters (29) found smaller than n_clusters (31). Possibly due to duplicate points in X.\n",
      "  kmeans = KMeans(n_clusters=len(filter_go_stations)-1,random_state=0).fit(partial_times.to_numpy())\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "transactions in line 10 plat A38\n",
      "ps: \n",
      "              CardID  LineCode       FDate   Time plat\n",
      "31536   1407238691        10  1398/06/23  21485  A38\n",
      "31537    212442444        10  1398/06/23  21488  A38\n",
      "31538    986213915        10  1398/06/23  21490  A38\n",
      "31539   3630858204        10  1398/06/23  21495  A38\n",
      "31540   1593053860        10  1398/06/23  21569  A38\n",
      "...            ...       ...         ...    ...  ...\n",
      "183744  2621511276        10  1398/06/23  76081  A38\n",
      "183745   426880766        10  1398/06/23  76084  A38\n",
      "183746   211076091        10  1398/06/23  76095  A38\n",
      "183747   211076091        10  1398/06/23  76096  A38\n",
      "183748   361201700        10  1398/06/23  76229  A38\n",
      "\n",
      "[1113 rows x 5 columns]\n",
      "first row of the selected chunck : \n",
      " [1407238691 10 '1398/06/23' 21485 'A38']\n",
      "1113\n",
      "t0 = 21485\n",
      "ts = 76229\n",
      "time_intervals 91\n",
      "Origin destination interval view reindex \n",
      "    time_in  time_out\n",
      "0  21485.0   22085.0\n",
      "1  23885.0   25085.0\n",
      "2  27485.0   28685.0\n",
      "3  31685.0   32885.0\n",
      "4  35885.0   37085.0\n",
      "5  41285.0   41885.0\n",
      "6  46685.0   47885.0\n",
      "7  70685.0   71885.0\n",
      "OD bus stations of transactions: \n",
      "            CardID LineCode       FDate   Time  plat Station\n",
      "0       542446139        1  1398/06/23  24030  A145    3169\n",
      "1      2620656172        1  1398/06/23  24302  A145    3169\n",
      "2      3446252780        1  1398/06/23  26200  A145    1227\n",
      "3         7900260        1  1398/06/23  29677  A145    3169\n",
      "4       361857972        1  1398/06/23  29720  A145    3169\n",
      "...           ...      ...         ...    ...   ...     ...\n",
      "29739  3559195137       10  1398/06/23  71756   A38    2120\n",
      "29740  3559195137       10  1398/06/23  71766   A38    2120\n",
      "29741   721867011       10  1398/06/23  71835   A38    2120\n",
      "29742  3630607996       10  1398/06/23  71841   A38    2120\n",
      "29743   262616673       10  1398/06/23  71843   A38    2120\n",
      "\n",
      "[29744 rows x 6 columns]\n",
      "transactions in line 10 plat D49\n",
      "ps: \n",
      "              CardID  LineCode       FDate   Time plat\n",
      "232267  4275724242        10  1398/06/23  23864  D49\n",
      "232268   235855034        10  1398/06/23  23931  D49\n",
      "232269   235870906        10  1398/06/23  23940  D49\n",
      "232270  2620376700        10  1398/06/23  24068  D49\n",
      "232271  3153133198        10  1398/06/23  24087  D49\n",
      "...            ...       ...         ...    ...  ...\n",
      "119387  3677500076        10  1398/06/23  80482  D49\n",
      "119388   211447820        10  1398/06/23  80487  D49\n",
      "119389  2482395988        10  1398/06/23  80637  D49\n",
      "119390  1578154757        10  1398/06/23  80798  D49\n",
      "119391  1578154757        10  1398/06/23  80799  D49\n",
      "\n",
      "[591 rows x 5 columns]\n",
      "first row of the selected chunck : \n",
      " [4275724242 10 '1398/06/23' 23864 'D49']\n",
      "591\n",
      "t0 = 23864\n",
      "ts = 80799\n",
      "time_intervals 95\n",
      "Origin destination interval view reindex \n",
      "    time_in  time_out\n",
      "0  23864.0   24464.0\n",
      "1  26264.0   27464.0\n",
      "2  31064.0   31664.0\n",
      "3  35264.0   35864.0\n",
      "4  39464.0   40664.0\n",
      "5  45464.0   46064.0\n",
      "6  53864.0   54464.0\n",
      "7  61664.0   64064.0\n",
      "8  68264.0   68864.0\n",
      "9  74264.0   79064.0\n",
      "OD bus stations of transactions: \n",
      "            CardID LineCode       FDate   Time  plat Station\n",
      "0       542446139        1  1398/06/23  24030  A145    3169\n",
      "1      2620656172        1  1398/06/23  24302  A145    3169\n",
      "2      3446252780        1  1398/06/23  26200  A145    1227\n",
      "3         7900260        1  1398/06/23  29677  A145    3169\n",
      "4       361857972        1  1398/06/23  29720  A145    3169\n",
      "...           ...      ...         ...    ...   ...     ...\n",
      "30711   181084022       10  1398/06/23  68635   D49    1880\n",
      "30712  3630316252       10  1398/06/23  68798   D49    1880\n",
      "30713   645809485       10  1398/06/23  78899   D49    2120\n",
      "30714  2741554260       10  1398/06/23  78903   D49    2120\n",
      "30715  3675952290       10  1398/06/23  78912   D49    2120\n",
      "\n",
      "[30716 rows x 6 columns]\n",
      "transactions in line 10 plat D52\n",
      "ps: \n",
      "              CardID  LineCode       FDate   Time plat\n",
      "52745   2621506812        10  1398/06/23  22274  D52\n",
      "52746   2048290626        10  1398/06/23  22308  D52\n",
      "52744    981253883        10  1398/06/23  22365  D52\n",
      "52747   2505207940        10  1398/06/23  22937  D52\n",
      "52748   3101778926        10  1398/06/23  23109  D52\n",
      "...            ...       ...         ...    ...  ...\n",
      "239686  3675184130        10  1398/06/23  71674  D52\n",
      "239687  3701526805        10  1398/06/23  72078  D52\n",
      "239688  3701526805        10  1398/06/23  72080  D52\n",
      "239689   212796939        10  1398/06/23  72081  D52\n",
      "239690   212796939        10  1398/06/23  72083  D52\n",
      "\n",
      "[540 rows x 5 columns]\n",
      "first row of the selected chunck : \n",
      " [2621506812 10 '1398/06/23' 22274 'D52']\n",
      "540\n",
      "t0 = 22274\n",
      "ts = 72083\n",
      "time_intervals 83\n",
      "Origin destination interval view reindex \n",
      "     time_in  time_out\n",
      "0   22274.0   22874.0\n",
      "1   24674.0   25874.0\n",
      "2   28274.0   29474.0\n",
      "3   31874.0   33674.0\n",
      "4   37274.0   37874.0\n",
      "5   42074.0   43274.0\n",
      "6   46874.0   48074.0\n",
      "7   51674.0   54074.0\n",
      "8   56474.0   57074.0\n",
      "9   60074.0   63074.0\n",
      "10  70274.0   70874.0\n",
      "OD bus stations of transactions: \n",
      "            CardID LineCode       FDate   Time  plat Station\n",
      "0       542446139        1  1398/06/23  24030  A145    3169\n",
      "1      2620656172        1  1398/06/23  24302  A145    3169\n",
      "2      3446252780        1  1398/06/23  26200  A145    1227\n",
      "3         7900260        1  1398/06/23  29677  A145    3169\n",
      "4       361857972        1  1398/06/23  29720  A145    3169\n",
      "...           ...      ...         ...    ...   ...     ...\n",
      "31330  2232499699       10  1398/06/23  70562   D52    1880\n",
      "31331  1001730686       10  1398/06/23  70564   D52    1880\n",
      "31332  1527745710       10  1398/06/23  70566   D52    1880\n",
      "31333  2621594940       10  1398/06/23  70567   D52    1880\n",
      "31334   361140836       10  1398/06/23  70567   D52    1880\n",
      "\n",
      "[31335 rows x 6 columns]\n",
      "transactions in line 10 plat E187\n",
      "ps: \n",
      "              CardID  LineCode       FDate   Time  plat\n",
      "284416   721938700        10  1398/06/23  22565  E187\n",
      "284415  4279439426        10  1398/06/23  22673  E187\n",
      "284417   537659822        10  1398/06/23  23192  E187\n",
      "284418  1799009076        10  1398/06/23  23306  E187\n",
      "284420   722125333        10  1398/06/23  23943  E187\n",
      "...            ...       ...         ...    ...   ...\n",
      "93815   3207876837        10  1398/06/23  77959  E187\n",
      "93816   3207876837        10  1398/06/23  77961  E187\n",
      "93817   3207876837        10  1398/06/23  77962  E187\n",
      "122232   980949531        10  1398/06/23  77966  E187\n",
      "122233  1610848811        10  1398/06/23  78098  E187\n",
      "\n",
      "[569 rows x 5 columns]\n",
      "first row of the selected chunck : \n",
      " [721938700 10 '1398/06/23' 22565 'E187']\n",
      "569\n",
      "t0 = 22565\n",
      "ts = 78098\n",
      "time_intervals 93\n",
      "Origin destination interval view reindex \n",
      "     time_in  time_out\n",
      "0   22565.0   23165.0\n",
      "1   24965.0   26165.0\n",
      "2   28565.0   29765.0\n",
      "3   32765.0   33965.0\n",
      "4   37565.0   38765.0\n",
      "5   42365.0   43565.0\n",
      "6   47765.0   48365.0\n",
      "7   50165.0   50765.0\n",
      "8   51965.0   56765.0\n",
      "9   60365.0   63365.0\n",
      "10  67565.0   68165.0\n",
      "11  70565.0   71165.0\n",
      "12  73565.0   75965.0\n",
      "13  76565.0   77165.0\n",
      "OD bus stations of transactions: \n",
      "            CardID LineCode       FDate   Time  plat Station\n",
      "0       542446139        1  1398/06/23  24030  A145    3169\n",
      "1      2620656172        1  1398/06/23  24302  A145    3169\n",
      "2      3446252780        1  1398/06/23  26200  A145    1227\n",
      "3         7900260        1  1398/06/23  29677  A145    3169\n",
      "4       361857972        1  1398/06/23  29720  A145    3169\n",
      "...           ...      ...         ...    ...   ...     ...\n",
      "31745  3794568572       10  1398/06/23  76738  E187    2120\n",
      "31746  1527145902       10  1398/06/23  76742  E187    2120\n",
      "31747   985193899       10  1398/06/23  76915  E187    2120\n",
      "31748   869358599       10  1398/06/23  76921  E187    2120\n",
      "31749   869358599       10  1398/06/23  76923  E187    2120\n",
      "\n",
      "[31750 rows x 6 columns]\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "C:\\Users\\esmaeli.h\\AppData\\Local\\Temp/ipykernel_12452/1949912630.py:257: ConvergenceWarning: Number of distinct clusters (30) found smaller than n_clusters (31). Possibly due to duplicate points in X.\n",
      "  kmeans = KMeans(n_clusters=len(filter_go_stations)-1,random_state=0).fit(partial_times.to_numpy())\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "transactions in line 10 plat F11\n",
      "ps: \n",
      "              CardID  LineCode       FDate   Time plat\n",
      "489733   722180694        10  1398/06/23  24140  F11\n",
      "489734   735796352        10  1398/06/23  24609  F11\n",
      "489735  2184013075        10  1398/06/23  25092  F11\n",
      "489736  3794585164        10  1398/06/23  25097  F11\n",
      "489737  3405812449        10  1398/06/23  25497  F11\n",
      "...            ...       ...         ...    ...  ...\n",
      "561962  3800412581        10  1398/06/23  74224  F11\n",
      "561963  2491623476        10  1398/06/23  74296  F11\n",
      "561964  2491623476        10  1398/06/23  74297  F11\n",
      "561965   645933501        10  1398/06/23  74321  F11\n",
      "561966  3630415132        10  1398/06/23  74331  F11\n",
      "\n",
      "[522 rows x 5 columns]\n",
      "first row of the selected chunck : \n",
      " [722180694 10 '1398/06/23' 24140 'F11']\n",
      "522\n",
      "t0 = 24140\n",
      "ts = 74331\n",
      "time_intervals 84\n",
      "Origin destination interval view reindex \n",
      "    time_in  time_out\n",
      "0  24140.0   24740.0\n",
      "1  27140.0   28340.0\n",
      "2  31340.0   31940.0\n",
      "3  35540.0   36740.0\n",
      "4  40340.0   41540.0\n",
      "5  45740.0   47540.0\n",
      "6  51140.0   51740.0\n",
      "7  55340.0   58940.0\n",
      "8  63140.0   65540.0\n",
      "9  69740.0   70340.0\n",
      "OD bus stations of transactions: \n",
      "            CardID LineCode       FDate   Time  plat Station\n",
      "0       542446139        1  1398/06/23  24030  A145    3169\n",
      "1      2620656172        1  1398/06/23  24302  A145    3169\n",
      "2      3446252780        1  1398/06/23  26200  A145    1227\n",
      "3         7900260        1  1398/06/23  29677  A145    3169\n",
      "4       361857972        1  1398/06/23  29720  A145    3169\n",
      "...           ...      ...         ...    ...   ...     ...\n",
      "32153  2741491236       10  1398/06/23  65514   F11    1880\n",
      "32154  2741491236       10  1398/06/23  65517   F11    1880\n",
      "32155  4276147154       10  1398/06/23  65527   F11    1880\n",
      "32156   335812521       10  1398/06/23  65536   F11    1880\n",
      "32157  3258325533       10  1398/06/23  70279   F11    2120\n",
      "\n",
      "[32158 rows x 6 columns]\n",
      "transactions in line 10 plat F118\n",
      "ps: \n",
      "              CardID  LineCode       FDate   Time  plat\n",
      "288541   537127451        10  1398/06/23  23674  F118\n",
      "288542  1530224574        10  1398/06/23  23871  F118\n",
      "288543  4057481645        10  1398/06/23  24009  F118\n",
      "288544   261139169        10  1398/06/23  24636  F118\n",
      "288546   808910578        10  1398/06/23  25075  F118\n",
      "...            ...       ...         ...    ...   ...\n",
      "95493   3207545013        10  1398/06/23  75753  F118\n",
      "95494   3207545013        10  1398/06/23  75754  F118\n",
      "95495    721942894        10  1398/06/23  76135  F118\n",
      "95496    721942894        10  1398/06/23  76136  F118\n",
      "95497   3253986317        10  1398/06/23  76272  F118\n",
      "\n",
      "[598 rows x 5 columns]\n",
      "first row of the selected chunck : \n",
      " [537127451 10 '1398/06/23' 23674 'F118']\n",
      "598\n",
      "t0 = 23674\n",
      "ts = 76272\n",
      "time_intervals 88\n",
      "Origin destination interval view reindex \n",
      "    time_in  time_out\n",
      "0  23674.0   24274.0\n",
      "1  26074.0   27274.0\n",
      "2  30274.0   31474.0\n",
      "3  34474.0   35674.0\n",
      "4  39274.0   40474.0\n",
      "5  44074.0   45274.0\n",
      "6  49474.0   50674.0\n",
      "7  54274.0   60874.0\n",
      "8  69874.0   72274.0\n",
      "OD bus stations of transactions: \n",
      "            CardID LineCode       FDate   Time  plat Station\n",
      "0       542446139        1  1398/06/23  24030  A145    3169\n",
      "1      2620656172        1  1398/06/23  24302  A145    3169\n",
      "2      3446252780        1  1398/06/23  26200  A145    1227\n",
      "3         7900260        1  1398/06/23  29677  A145    3169\n",
      "4       361857972        1  1398/06/23  29720  A145    3169\n",
      "...           ...      ...         ...    ...   ...     ...\n",
      "32614  2505777588       10  1398/06/23  71847  F118    1880\n",
      "32615   722161774       10  1398/06/23  71850  F118    1880\n",
      "32616  1002987543       10  1398/06/23  71887  F118    1880\n",
      "32617     8075428       10  1398/06/23  72159  F118    1880\n",
      "32618  3759400981       10  1398/06/23  72207  F118    1880\n",
      "\n",
      "[32619 rows x 6 columns]\n",
      "transactions in line 10 plat F150\n",
      "ps: \n",
      "              CardID  LineCode       FDate   Time  plat\n",
      "169653  2190529299        10  1398/06/23  24528  F150\n",
      "169654  3445023676        10  1398/06/23  24588  F150\n",
      "169655  1407187497        10  1398/06/23  24599  F150\n",
      "169656  2962313493        10  1398/06/23  24609  F150\n",
      "169657  3445552108        10  1398/06/23  24791  F150\n",
      "...            ...       ...         ...    ...   ...\n",
      "203662  3207531428        10  1398/06/23  48437  F150\n",
      "203663  4266191266        10  1398/06/23  48451  F150\n",
      "203664    73846554        10  1398/06/23  48889  F150\n",
      "203665   737243792        10  1398/06/23  49002  F150\n",
      "203666   721726461        10  1398/06/23  49100  F150\n",
      "\n",
      "[298 rows x 5 columns]\n",
      "first row of the selected chunck : \n",
      " [2190529299 10 '1398/06/23' 24528 'F150']\n",
      "298\n",
      "t0 = 24528\n",
      "ts = 49100\n",
      "time_intervals 41\n",
      "Origin destination interval view reindex \n",
      "    time_in  time_out\n",
      "0  24528.0   25128.0\n",
      "1  26928.0   27528.0\n",
      "2  30528.0   31728.0\n",
      "3  35328.0   36528.0\n",
      "4  40128.0   41328.0\n",
      "5  45528.0   46128.0\n",
      "OD bus stations of transactions: \n",
      "            CardID LineCode       FDate   Time  plat Station\n",
      "0       542446139        1  1398/06/23  24030  A145    3169\n",
      "1      2620656172        1  1398/06/23  24302  A145    3169\n",
      "2      3446252780        1  1398/06/23  26200  A145    1227\n",
      "3         7900260        1  1398/06/23  29677  A145    3169\n",
      "4       361857972        1  1398/06/23  29720  A145    3169\n",
      "...           ...      ...         ...    ...   ...     ...\n",
      "33130  2115807796       10  1398/06/23  45938  F150    2120\n",
      "33131   427394430       10  1398/06/23  46037  F150    2120\n",
      "33132  2138370637       10  1398/06/23  46056  F150    2120\n",
      "33133   722176974       10  1398/06/23  46063  F150    2120\n",
      "33134   722176974       10  1398/06/23  46064  F150    2120\n",
      "\n",
      "[33135 rows x 6 columns]\n",
      "transactions in line 10 plat F152\n",
      "ps: \n",
      "              CardID  LineCode       FDate   Time  plat\n",
      "368488   721767890        10  1398/06/23  23535  F152\n",
      "368489  2122350116        10  1398/06/23  23635  F152\n",
      "368490   209797083        10  1398/06/23  23637  F152\n",
      "368491  1845291940        10  1398/06/23  23883  F152\n",
      "368492  1528220094        10  1398/06/23  23885  F152\n",
      "...            ...       ...         ...    ...   ...\n",
      "394999   869454475        10  1398/06/23  78231  F152\n",
      "395001  4270854066        10  1398/06/23  78236  F152\n",
      "395002   234159242        10  1398/06/23  78249  F152\n",
      "395003   234159242        10  1398/06/23  78250  F152\n",
      "395004   234159242        10  1398/06/23  78253  F152\n",
      "\n",
      "[540 rows x 5 columns]\n",
      "first row of the selected chunck : \n",
      " [721767890 10 '1398/06/23' 23535 'F152']\n",
      "540\n",
      "t0 = 23535\n",
      "ts = 78253\n",
      "time_intervals 91\n",
      "Origin destination interval view reindex \n",
      "    time_in  time_out\n",
      "0  23535.0   24135.0\n",
      "1  24735.0   26535.0\n",
      "2  28935.0   30735.0\n",
      "3  33735.0   34335.0\n",
      "4  37935.0   38535.0\n",
      "5  39135.0   39735.0\n",
      "6  43335.0   43935.0\n",
      "7  48135.0   58935.0\n",
      "8  66735.0   69135.0\n",
      "9  74535.0   75135.0\n",
      "OD bus stations of transactions: \n",
      "            CardID LineCode       FDate   Time  plat Station\n",
      "0       542446139        1  1398/06/23  24030  A145    3169\n",
      "1      2620656172        1  1398/06/23  24302  A145    3169\n",
      "2      3446252780        1  1398/06/23  26200  A145    1227\n",
      "3         7900260        1  1398/06/23  29677  A145    3169\n",
      "4       361857972        1  1398/06/23  29720  A145    3169\n",
      "...           ...      ...         ...    ...   ...     ...\n",
      "33410   998412542       10  1398/06/23  68814  F152    1880\n",
      "33411   869249650       10  1398/06/23  68995  F152    1880\n",
      "33412   998372510       10  1398/06/23  69123  F152    1880\n",
      "33413   537614846       10  1398/06/23  74964  F152    2120\n",
      "33414   722230245       10  1398/06/23  75034  F152    2120\n",
      "\n",
      "[33415 rows x 6 columns]\n",
      "transactions in line 10 plat F153\n",
      "ps: \n",
      "              CardID  LineCode       FDate   Time  plat\n",
      "290644  3792858044        10  1398/06/23  22265  F153\n",
      "290645  4245402279        10  1398/06/23  22281  F153\n",
      "290646  3446054796        10  1398/06/23  22370  F153\n",
      "290647   721780474        10  1398/06/23  22376  F153\n",
      "290648  2497830461        10  1398/06/23  22378  F153\n",
      "...            ...       ...         ...    ...   ...\n",
      "167516  1775568244        10  1398/06/23  76048  F153\n",
      "167517  3208287317        10  1398/06/23  76053  F153\n",
      "167518  3208287317        10  1398/06/23  76054  F153\n",
      "167519   427322862        10  1398/06/23  76061  F153\n",
      "167520  3179255582        10  1398/06/23  76199  F153\n",
      "\n",
      "[615 rows x 5 columns]\n",
      "first row of the selected chunck : \n",
      " [3792858044 10 '1398/06/23' 22265 'F153']\n",
      "615\n",
      "t0 = 22265\n",
      "ts = 76199\n",
      "time_intervals 90\n",
      "Origin destination interval view reindex \n",
      "    time_in  time_out\n",
      "0  22265.0   22865.0\n",
      "1  24665.0   25265.0\n",
      "2  27665.0   29465.0\n",
      "3  33065.0   33665.0\n",
      "4  36665.0   37865.0\n",
      "5  42065.0   42665.0\n",
      "6  46865.0   49265.0\n",
      "7  54065.0   54665.0\n",
      "8  64265.0   66665.0\n",
      "9  71465.0   72065.0\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "OD bus stations of transactions: \n",
      "            CardID LineCode       FDate   Time  plat Station\n",
      "0       542446139        1  1398/06/23  24030  A145    3169\n",
      "1      2620656172        1  1398/06/23  24302  A145    3169\n",
      "2      3446252780        1  1398/06/23  26200  A145    1227\n",
      "3         7900260        1  1398/06/23  29677  A145    3169\n",
      "4       361857972        1  1398/06/23  29720  A145    3169\n",
      "...           ...      ...         ...    ...   ...     ...\n",
      "33870  2504415940       10  1398/06/23  66410  F153    1880\n",
      "33871  2138022765       10  1398/06/23  66559  F153    1880\n",
      "33872  2138022765       10  1398/06/23  66561  F153    1880\n",
      "33873  3800412581       10  1398/06/23  66627  F153    1880\n",
      "33874  3179900590       10  1398/06/23  72064  F153    2120\n",
      "\n",
      "[33875 rows x 6 columns]\n",
      "transactions in line 10 plat F21\n",
      "ps: \n",
      "              CardID  LineCode       FDate   Time plat\n",
      "66139   2050154450        10  1398/06/23  21982  F21\n",
      "66138   3178797134        10  1398/06/23  21988  F21\n",
      "66140    869244930        10  1398/06/23  22214  F21\n",
      "66141    869437031        10  1398/06/23  22467  F21\n",
      "66142   2138894861        10  1398/06/23  22951  F21\n",
      "...            ...       ...         ...    ...  ...\n",
      "202051  2504365796        10  1398/06/23  77631  F21\n",
      "202052  3180415134        10  1398/06/23  78145  F21\n",
      "202053   210510635        10  1398/06/23  78388  F21\n",
      "202054   722025436        10  1398/06/23  78815  F21\n",
      "202055   722025436        10  1398/06/23  78817  F21\n",
      "\n",
      "[551 rows x 5 columns]\n",
      "first row of the selected chunck : \n",
      " [2050154450 10 '1398/06/23' 21982 'F21']\n",
      "551\n",
      "t0 = 21982\n",
      "ts = 78817\n",
      "time_intervals 95\n",
      "Origin destination interval view reindex \n",
      "     time_in  time_out\n",
      "0   21982.0   22582.0\n",
      "1   23782.0   25582.0\n",
      "2   27382.0   28582.0\n",
      "3   31582.0   33382.0\n",
      "4   36982.0   37582.0\n",
      "5   41182.0   42382.0\n",
      "6   45982.0   47182.0\n",
      "7   50782.0   52582.0\n",
      "8   59182.0   64582.0\n",
      "9   68782.0   69982.0\n",
      "10  74782.0   75982.0\n",
      "OD bus stations of transactions: \n",
      "            CardID LineCode       FDate   Time  plat Station\n",
      "0       542446139        1  1398/06/23  24030  A145    3169\n",
      "1      2620656172        1  1398/06/23  24302  A145    3169\n",
      "2      3446252780        1  1398/06/23  26200  A145    1227\n",
      "3         7900260        1  1398/06/23  29677  A145    3169\n",
      "4       361857972        1  1398/06/23  29720  A145    3169\n",
      "...           ...      ...         ...    ...   ...     ...\n",
      "34443  2660064300       10  1398/06/23  69918   F21    2120\n",
      "34444  3678600252       10  1398/06/23  69979   F21    2120\n",
      "34445  2183594707       10  1398/06/23  75755   F21    1880\n",
      "34446  2743061652       10  1398/06/23  75923   F21    1880\n",
      "34447  2743061652       10  1398/06/23  75924   F21    1880\n",
      "\n",
      "[34448 rows x 6 columns]\n",
      "transactions in line 10 plat F81\n",
      "ps: \n",
      "              CardID  LineCode       FDate   Time plat\n",
      "180125   174470710        10  1398/06/23  22965  F81\n",
      "180126   262655745        10  1398/06/23  23047  F81\n",
      "2614    2743286420        10  1398/06/23  23071  F81\n",
      "2615       8126324        10  1398/06/23  23380  F81\n",
      "2617     212106684        10  1398/06/23  24001  F81\n",
      "...            ...       ...         ...    ...  ...\n",
      "262617   425572798        10  1398/06/23  75843  F81\n",
      "262618   425572798        10  1398/06/23  75845  F81\n",
      "262619  1528052318        10  1398/06/23  75848  F81\n",
      "262620  1528052318        10  1398/06/23  75849  F81\n",
      "262621   721824308        10  1398/06/23  76138  F81\n",
      "\n",
      "[513 rows x 5 columns]\n",
      "first row of the selected chunck : \n",
      " [174470710 10 '1398/06/23' 22965 'F81']\n",
      "513\n",
      "t0 = 22965\n",
      "ts = 76138\n",
      "time_intervals 89\n",
      "Origin destination interval view reindex \n",
      "    time_in  time_out\n",
      "0  22965.0   23565.0\n",
      "1  25365.0   26565.0\n",
      "2  29565.0   30165.0\n",
      "3  33165.0   34365.0\n",
      "4  37965.0   39165.0\n",
      "5  43365.0   43965.0\n",
      "6  48165.0   48765.0\n",
      "7  52965.0   62565.0\n",
      "8  71565.0   73965.0\n",
      "OD bus stations of transactions: \n",
      "            CardID LineCode       FDate   Time  plat Station\n",
      "0       542446139        1  1398/06/23  24030  A145    3169\n",
      "1      2620656172        1  1398/06/23  24302  A145    3169\n",
      "2      3446252780        1  1398/06/23  26200  A145    1227\n",
      "3         7900260        1  1398/06/23  29677  A145    3169\n",
      "4       361857972        1  1398/06/23  29720  A145    3169\n",
      "...           ...      ...         ...    ...   ...     ...\n",
      "34911  3210962628       10  1398/06/23  73750   F81    1880\n",
      "34912  3210962628       10  1398/06/23  73753   F81    1880\n",
      "34913  3210962628       10  1398/06/23  73754   F81    1880\n",
      "34914  1835172829       10  1398/06/23  73775   F81    1880\n",
      "34915  3214387012       10  1398/06/23  73954   F81    1880\n",
      "\n",
      "[34916 rows x 6 columns]\n",
      "transactions in line 10 plat M39\n",
      "ps: \n",
      "              CardID  LineCode       FDate   Time plat\n",
      "2586    3405812918        10  1398/06/23  23662  M39\n",
      "2587    1291951998        10  1398/06/23  23669  M39\n",
      "2588    1282774350        10  1398/06/23  23689  M39\n",
      "2589    1459323397        10  1398/06/23  23706  M39\n",
      "2590    3672247186        10  1398/06/23  23764  M39\n",
      "...            ...       ...         ...    ...  ...\n",
      "185138   980664491        10  1398/06/23  78466  M39\n",
      "185139   721772361        10  1398/06/23  78638  M39\n",
      "185140  3793639404        10  1398/06/23  78691  M39\n",
      "66133   1529727326        10  1398/06/23  78705  M39\n",
      "66134   1529727326        10  1398/06/23  78706  M39\n",
      "\n",
      "[620 rows x 5 columns]\n",
      "first row of the selected chunck : \n",
      " [3405812918 10 '1398/06/23' 23662 'M39']\n",
      "620\n",
      "t0 = 23662\n",
      "ts = 78706\n",
      "time_intervals 92\n",
      "Origin destination interval view reindex \n",
      "     time_in  time_out\n",
      "0   23662.0   24262.0\n",
      "1   26062.0   26662.0\n",
      "2   29062.0   30862.0\n",
      "3   34462.0   35062.0\n",
      "4   38662.0   39862.0\n",
      "5   44062.0   44662.0\n",
      "6   48862.0   50662.0\n",
      "7   57262.0   60262.0\n",
      "8   68662.0   71062.0\n",
      "9   75262.0   75862.0\n",
      "10  76462.0   77062.0\n",
      "OD bus stations of transactions: \n",
      "            CardID LineCode       FDate   Time  plat Station\n",
      "0       542446139        1  1398/06/23  24030  A145    3169\n",
      "1      2620656172        1  1398/06/23  24302  A145    3169\n",
      "2      3446252780        1  1398/06/23  26200  A145    1227\n",
      "3         7900260        1  1398/06/23  29677  A145    3169\n",
      "4       361857972        1  1398/06/23  29720  A145    3169\n",
      "...           ...      ...         ...    ...   ...     ...\n",
      "35379   262649313       10  1398/06/23  70996   M39    1880\n",
      "35380  2239137458       10  1398/06/23  71051   M39    1880\n",
      "35381   262995937       10  1398/06/23  75794   M39    2120\n",
      "35382  2136868989       10  1398/06/23  76920   M39    1880\n",
      "35383  2136868989       10  1398/06/23  76922   M39    1880\n",
      "\n",
      "[35384 rows x 6 columns]\n",
      "transactions in line 10 plat N190\n",
      "ps: \n",
      "              CardID  LineCode       FDate   Time  plat\n",
      "208198  1002837975        10  1398/06/23  23696  N190\n",
      "208199  2541198334        10  1398/06/23  23718  N190\n",
      "208200   212343195        10  1398/06/23  23730  N190\n",
      "208201  1002837975        10  1398/06/23  23956  N190\n",
      "208202   429562158        10  1398/06/23  23964  N190\n",
      "...            ...       ...         ...    ...   ...\n",
      "288781  3794177196        10  1398/06/23  79712  N190\n",
      "288782   721913334        10  1398/06/23  79889  N190\n",
      "288783  2239191606        10  1398/06/23  80254  N190\n",
      "288784  2239191606        10  1398/06/23  80255  N190\n",
      "288785   998485054        10  1398/06/23  80375  N190\n",
      "\n",
      "[359 rows x 5 columns]\n",
      "first row of the selected chunck : \n",
      " [1002837975 10 '1398/06/23' 23696 'N190']\n",
      "359\n",
      "t0 = 23696\n",
      "ts = 80375\n",
      "time_intervals 94\n",
      "Origin destination interval view reindex \n",
      "     time_in  time_out\n",
      "0   23696.0   24296.0\n",
      "1   24896.0   25496.0\n",
      "2   26096.0   27296.0\n",
      "3   30296.0   31496.0\n",
      "4   33896.0   35696.0\n",
      "5   39296.0   39896.0\n",
      "6   44096.0   45296.0\n",
      "7   49496.0   71696.0\n",
      "8   75896.0   77096.0\n",
      "9   78296.0   78896.0\n",
      "10  79496.0   80096.0\n",
      "OD bus stations of transactions: \n",
      "            CardID LineCode       FDate   Time  plat Station\n",
      "0       542446139        1  1398/06/23  24030  A145    3169\n",
      "1      2620656172        1  1398/06/23  24302  A145    3169\n",
      "2      3446252780        1  1398/06/23  26200  A145    1227\n",
      "3         7900260        1  1398/06/23  29677  A145    3169\n",
      "4       361857972        1  1398/06/23  29720  A145    3169\n",
      "...           ...      ...         ...    ...   ...     ...\n",
      "35955  4059430141       10  1398/06/23  78876  N190    2120\n",
      "35956   736397104       10  1398/06/23  78879  N190    2120\n",
      "35957  2115853956       10  1398/06/23  79695  N190    1880\n",
      "35958  3794177196       10  1398/06/23  79712  N190    1880\n",
      "35959   721913334       10  1398/06/23  79889  N190    1880\n",
      "\n",
      "[35960 rows x 6 columns]\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "stations in a specefic bus line 11\n",
      "len-of-go stations: 0\n",
      "len-of-back stations: 0\n",
      "len-of-go back stations: 0\n",
      "stations in a specefic bus line 12\n",
      "len-of-go stations: 33\n",
      "len-of-back stations: 32\n",
      "len-of-go back stations: 0\n",
      "first Station  [1455 '12' '1' 'go' '???? ????-12' 51.649917 32.6924 'od' 'normal' 'no'] 1455\n",
      "last Station  [3765 '12' '1' 'back' '????? ???-12' 51.618278 32.650167 'od' 'normal'\n",
      " 'no']\n",
      "['F106' 'M34' 'N13' 'N72']\n",
      "transactions in line 12 plat F106\n",
      "ps: \n",
      "              CardID  LineCode       FDate   Time  plat\n",
      "372719   480245140        12  1398/06/23  24753  F106\n",
      "372720   646009005        12  1398/06/23  24761  F106\n",
      "372721   427264782        12  1398/06/23  25039  F106\n",
      "372722  3700962645        12  1398/06/23  25040  F106\n",
      "372723  2239159182        12  1398/06/23  25140  F106\n",
      "...            ...       ...         ...    ...   ...\n",
      "508896  3211775460        12  1398/06/23  73131  F106\n",
      "508897  2621609548        12  1398/06/23  73462  F106\n",
      "508898  2855453726        12  1398/06/23  73871  F106\n",
      "508899   869226274        12  1398/06/23  73878  F106\n",
      "508900  3678901852        12  1398/06/23  74801  F106\n",
      "\n",
      "[164 rows x 5 columns]\n",
      "first row of the selected chunck : \n",
      " [480245140 12 '1398/06/23' 24753 'F106']\n",
      "164\n",
      "t0 = 24753\n",
      "ts = 74801\n",
      "time_intervals 83\n",
      "Origin destination interval view reindex \n",
      "     time_in  time_out\n",
      "0   24753.0   25353.0\n",
      "1   26553.0   27153.0\n",
      "2   30753.0   31353.0\n",
      "3   33753.0   36153.0\n",
      "4   37353.0   37953.0\n",
      "5   39153.0   40353.0\n",
      "6   42753.0   43953.0\n",
      "7   48753.0   49353.0\n",
      "8   50553.0   51153.0\n",
      "9   52353.0   54753.0\n",
      "10  56553.0   57753.0\n",
      "11  58353.0   58953.0\n",
      "12  59553.0   61953.0\n",
      "13  69753.0   70353.0\n",
      "14  71553.0   73353.0\n",
      "OD bus stations of transactions: \n",
      "            CardID LineCode       FDate   Time  plat Station\n",
      "0       542446139        1  1398/06/23  24030  A145    3169\n",
      "1      2620656172        1  1398/06/23  24302  A145    3169\n",
      "2      3446252780        1  1398/06/23  26200  A145    1227\n",
      "3         7900260        1  1398/06/23  29677  A145    3169\n",
      "4       361857972        1  1398/06/23  29720  A145    3169\n",
      "...           ...      ...         ...    ...   ...     ...\n",
      "36256  3631135660       12  1398/06/23  61931  F106    1455\n",
      "36257   179517446       12  1398/06/23  61935  F106    1455\n",
      "36258  3405936595       12  1398/06/23  61936  F106    1455\n",
      "36259  3649832372       12  1398/06/23  70171  F106    3765\n",
      "36260  3211775460       12  1398/06/23  73131  F106    1455\n",
      "\n",
      "[36261 rows x 6 columns]\n",
      "transactions in line 12 plat M34\n",
      "ps: \n",
      "              CardID  LineCode       FDate   Time plat\n",
      "132911   722208151        12  1398/06/23  23510  M34\n",
      "132913  1003367383        12  1398/06/23  23832  M34\n",
      "133198   426449038        12  1398/06/23  24150  M34\n",
      "133200  2124247444        12  1398/06/23  24300  M34\n",
      "133201  3179235614        12  1398/06/23  24537  M34\n",
      "...            ...       ...         ...    ...  ...\n",
      "69760   3152462734        12  1398/06/23  71966  M34\n",
      "69762   1529554622        12  1398/06/23  72319  M34\n",
      "69765   1265807694        12  1398/06/23  72373  M34\n",
      "69767   1265807694        12  1398/06/23  72425  M34\n",
      "69763   3678599484        12  1398/06/23  72464  M34\n",
      "\n",
      "[167 rows x 5 columns]\n",
      "first row of the selected chunck : \n",
      " [722208151 12 '1398/06/23' 23510 'M34']\n",
      "167\n",
      "t0 = 23510\n",
      "ts = 72464\n",
      "time_intervals 82\n",
      "Origin destination interval view reindex \n",
      "     time_in  time_out\n",
      "0   23510.0   24110.0\n",
      "1   28910.0   30710.0\n",
      "2   33710.0   34910.0\n",
      "3   36710.0   37910.0\n",
      "4   39110.0   39710.0\n",
      "5   41510.0   42110.0\n",
      "6   43910.0   45110.0\n",
      "7   46910.0   47510.0\n",
      "8   49910.0   50510.0\n",
      "9   51110.0   51710.0\n",
      "10  52310.0   52910.0\n",
      "11  53510.0   54110.0\n",
      "12  55310.0   57710.0\n",
      "13  59510.0   61310.0\n",
      "14  62510.0   63110.0\n",
      "15  66710.0   67910.0\n",
      "16  70310.0   71510.0\n",
      "OD bus stations of transactions: \n",
      "            CardID LineCode       FDate   Time  plat Station\n",
      "0       542446139        1  1398/06/23  24030  A145    3169\n",
      "1      2620656172        1  1398/06/23  24302  A145    3169\n",
      "2      3446252780        1  1398/06/23  26200  A145    1227\n",
      "3         7900260        1  1398/06/23  29677  A145    3169\n",
      "4       361857972        1  1398/06/23  29720  A145    3169\n",
      "...           ...      ...         ...    ...   ...     ...\n",
      "36302   721830765       12  1398/06/23  62750   M34    1455\n",
      "36303  1283447758       12  1398/06/23  67860   M34    3765\n",
      "36304  1001881902       12  1398/06/23  71236   M34    1455\n",
      "36305  1001881902       12  1398/06/23  71238   M34    1455\n",
      "36306  1001881902       12  1398/06/23  71256   M34    1455\n",
      "\n",
      "[36307 rows x 6 columns]\n",
      "transactions in line 12 plat N13\n",
      "ps: \n",
      "             CardID  LineCode       FDate   Time plat\n",
      "22224  3152753982        12  1398/06/23  22083  N13\n",
      "22225  1001489646        12  1398/06/23  22196  N13\n",
      "22226  3258031485        12  1398/06/23  26174  N13\n",
      "22227  2742930772        12  1398/06/23  26319  N13\n",
      "22229  1837541773        12  1398/06/23  26345  N13\n",
      "22230  1837541773        12  1398/06/23  26348  N13\n",
      "22228   645607693        12  1398/06/23  26470  N13\n",
      "22231  2508340948        12  1398/06/23  28344  N13\n",
      "22232   177038262        12  1398/06/23  29032  N13\n",
      "22233   262407681        12  1398/06/23  29242  N13\n",
      "22234   262407681        12  1398/06/23  29243  N13\n",
      "22235   426199790        12  1398/06/23  29446  N13\n",
      "22236  2125288244        12  1398/06/23  29549  N13\n",
      "22237  1776030212        12  1398/06/23  29850  N13\n",
      "22238   722228889        12  1398/06/23  30065  N13\n",
      "22239  1001637230        12  1398/06/23  30155  N13\n",
      "22240   175012180        12  1398/06/23  30471  N13\n",
      "22241  1528052302        12  1398/06/23  32824  N13\n",
      "22242  1528052302        12  1398/06/23  32825  N13\n",
      "22243  4270397666        12  1398/06/23  33022  N13\n",
      "22244  2587473428        12  1398/06/23  33039  N13\n",
      "22245  1003682391        12  1398/06/23  33284  N13\n",
      "22246  1003682391        12  1398/06/23  33285  N13\n",
      "22247  1613730517        12  1398/06/23  33361  N13\n",
      "22248  3152539886        12  1398/06/23  33948  N13\n",
      "22249  4265527874        12  1398/06/23  33950  N13\n",
      "22250  1000684270        12  1398/06/23  34090  N13\n",
      "22251  2137562397        12  1398/06/23  39849  N13\n",
      "22252   582475419        12  1398/06/23  44459  N13\n",
      "22253  3179335870        12  1398/06/23  44525  N13\n",
      "22254  2742371220        12  1398/06/23  44742  N13\n",
      "22255  2508002932        12  1398/06/23  44830  N13\n",
      "22256  2498436932        12  1398/06/23  44992  N13\n",
      "22257  2498436932        12  1398/06/23  44993  N13\n",
      "22258  1293934286        12  1398/06/23  45908  N13\n",
      "22259  3445683516        12  1398/06/23  46026  N13\n",
      "first row of the selected chunck : \n",
      " [3152753982 12 '1398/06/23' 22083 'N13']\n",
      "36\n",
      "t0 = 22083\n",
      "ts = 46026\n",
      "time_intervals 40\n",
      "Origin destination interval view reindex \n",
      "    time_in  time_out\n",
      "0  22083.0   22683.0\n",
      "1  23283.0   26283.0\n",
      "2  27483.0   28683.0\n",
      "3  31083.0   32883.0\n",
      "4  35283.0   40083.0\n",
      "5  40683.0   44883.0\n",
      "OD bus stations of transactions: \n",
      "            CardID LineCode       FDate   Time  plat Station\n",
      "0       542446139        1  1398/06/23  24030  A145    3169\n",
      "1      2620656172        1  1398/06/23  24302  A145    3169\n",
      "2      3446252780        1  1398/06/23  26200  A145    1227\n",
      "3         7900260        1  1398/06/23  29677  A145    3169\n",
      "4       361857972        1  1398/06/23  29720  A145    3169\n",
      "...           ...      ...         ...    ...   ...     ...\n",
      "36313  2137562397       12  1398/06/23  39849   N13    1455\n",
      "36314   582475419       12  1398/06/23  44459   N13    3765\n",
      "36315  3179335870       12  1398/06/23  44525   N13    3765\n",
      "36316  2742371220       12  1398/06/23  44742   N13    3765\n",
      "36317  2508002932       12  1398/06/23  44830   N13    3765\n",
      "\n",
      "[36318 rows x 6 columns]\n",
      "transactions in line 12 plat N72\n",
      "ps: \n",
      "              CardID  LineCode       FDate   Time plat\n",
      "269573   736677664        12  1398/06/23  21964  N72\n",
      "269574  3650284564        12  1398/06/23  23433  N72\n",
      "269576  1776067684        12  1398/06/23  23689  N72\n",
      "269577  2136813645        12  1398/06/23  24367  N72\n",
      "269578   722271504        12  1398/06/23  24931  N72\n",
      "...            ...       ...         ...    ...  ...\n",
      "212829   645754493        12  1398/06/23  73741  N72\n",
      "212830   983030107        12  1398/06/23  73785  N72\n",
      "212831   721968606        12  1398/06/23  73797  N72\n",
      "212832   721968606        12  1398/06/23  73799  N72\n",
      "212833  3258385773        12  1398/06/23  73827  N72\n",
      "\n",
      "[116 rows x 5 columns]\n",
      "first row of the selected chunck : \n",
      " [736677664 12 '1398/06/23' 21964 'N72']\n",
      "116\n",
      "t0 = 21964\n",
      "ts = 73827\n",
      "time_intervals 86\n",
      "Origin destination interval view reindex \n",
      "     time_in  time_out\n",
      "0   21964.0   23764.0\n",
      "1   24364.0   24964.0\n",
      "2   25564.0   27364.0\n",
      "3   27964.0   28564.0\n",
      "4   29164.0   29764.0\n",
      "5   30364.0   31564.0\n",
      "6   33964.0   35764.0\n",
      "7   36364.0   36964.0\n",
      "8   37564.0   38164.0\n",
      "9   39964.0   43564.0\n",
      "10  45364.0   47764.0\n",
      "11  48964.0   49564.0\n",
      "12  52564.0   54964.0\n",
      "13  55564.0   57964.0\n",
      "14  60364.0   61564.0\n",
      "15  63364.0   65764.0\n",
      "16  67564.0   68164.0\n",
      "17  71164.0   72364.0\n",
      "18  72964.0   73564.0\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "OD bus stations of transactions: \n",
      "            CardID LineCode       FDate   Time  plat Station\n",
      "0       542446139        1  1398/06/23  24030  A145    3169\n",
      "1      2620656172        1  1398/06/23  24302  A145    3169\n",
      "2      3446252780        1  1398/06/23  26200  A145    1227\n",
      "3         7900260        1  1398/06/23  29677  A145    3169\n",
      "4       361857972        1  1398/06/23  29720  A145    3169\n",
      "...           ...      ...         ...    ...   ...     ...\n",
      "36356  3557490481       12  1398/06/23  65425   N72    3765\n",
      "36357  3105824565       12  1398/06/23  65428   N72    3765\n",
      "36358  3178587614       12  1398/06/23  67999   N72    1455\n",
      "36359  2541119070       12  1398/06/23  71966   N72    3765\n",
      "36360  2124966212       12  1398/06/23  72271   N72    3765\n",
      "\n",
      "[36361 rows x 6 columns]\n",
      "stations in a specefic bus line 13\n",
      "len-of-go stations: 37\n",
      "len-of-back stations: 37\n",
      "len-of-go back stations: 0\n",
      "first Station  [1528 '13' '1' 'go' '???? ???? ??????????-13' 51.842533 32.704754 'od'\n",
      " 'normal' 'no'] 1528\n",
      "last Station  [2566 '13' '1' 'back' '????? ???-35-13-5-4' 51.691879 32.678663 'od'\n",
      " 'normal' 'no']\n",
      "['D79' 'E206' 'F27' 'M128' 'N115']\n",
      "transactions in line 13 plat D79\n",
      "ps: \n",
      "              CardID  LineCode       FDate   Time plat\n",
      "188165   721750374        13  1398/06/23  25771  D79\n",
      "188166   721750374        13  1398/06/23  25773  D79\n",
      "188162   982375595        13  1398/06/23  25815  D79\n",
      "188163  2741071908        13  1398/06/23  25865  D79\n",
      "188164  2741071908        13  1398/06/23  25866  D79\n",
      "...            ...       ...         ...    ...  ...\n",
      "92373      8052164        13  1398/06/23  72933  D79\n",
      "92374   3630349868        13  1398/06/23  72980  D79\n",
      "92375   3630349868        13  1398/06/23  72982  D79\n",
      "92376   3630349868        13  1398/06/23  72990  D79\n",
      "92377   1598908260        13  1398/06/23  73099  D79\n",
      "\n",
      "[290 rows x 5 columns]\n",
      "first row of the selected chunck : \n",
      " [721750374 13 '1398/06/23' 25771 'D79']\n",
      "290\n",
      "t0 = 25771\n",
      "ts = 73099\n",
      "time_intervals 79\n",
      "Origin destination interval view reindex \n",
      "     time_in  time_out\n",
      "0   25771.0   26371.0\n",
      "1   27571.0   29371.0\n",
      "2   31771.0   32971.0\n",
      "3   38971.0   40771.0\n",
      "4   43171.0   44371.0\n",
      "5   44971.0   45571.0\n",
      "6   47371.0   47971.0\n",
      "7   50371.0   53971.0\n",
      "8   55171.0   57571.0\n",
      "9   59371.0   62371.0\n",
      "10  64171.0   65971.0\n",
      "11  68371.0   70171.0\n",
      "12  70771.0   71371.0\n",
      "OD bus stations of transactions: \n",
      "            CardID LineCode       FDate   Time  plat Station\n",
      "0       542446139        1  1398/06/23  24030  A145    3169\n",
      "1      2620656172        1  1398/06/23  24302  A145    3169\n",
      "2      3446252780        1  1398/06/23  26200  A145    1227\n",
      "3         7900260        1  1398/06/23  29677  A145    3169\n",
      "4       361857972        1  1398/06/23  29720  A145    3169\n",
      "...           ...      ...         ...    ...   ...     ...\n",
      "36410   211439628       13  1398/06/23  65938   D79    1528\n",
      "36411  2123962932       13  1398/06/23  65939   D79    1528\n",
      "36412  1003626791       13  1398/06/23  65945   D79    1528\n",
      "36413  4278387810       13  1398/06/23  69789   D79    2566\n",
      "36414  3181184414       13  1398/06/23  71015   D79    1528\n",
      "\n",
      "[36415 rows x 6 columns]\n",
      "transactions in line 13 plat E206\n",
      "ps: \n",
      "              CardID  LineCode       FDate   Time  plat\n",
      "166448   722027566        13  1398/06/23  24404  E206\n",
      "166446   641418090        13  1398/06/23  24408  E206\n",
      "166449  1598678916        13  1398/06/23  24545  E206\n",
      "166447  3680251548        13  1398/06/23  24559  E206\n",
      "166451  3208142309        13  1398/06/23  24647  E206\n",
      "...            ...       ...         ...    ...   ...\n",
      "231779  2116627652        13  1398/06/23  71197  E206\n",
      "231780  2116627652        13  1398/06/23  71198  E206\n",
      "231781  3151761982        13  1398/06/23  71284  E206\n",
      "231782  2048391746        13  1398/06/23  71297  E206\n",
      "231783  2048391746        13  1398/06/23  71298  E206\n",
      "\n",
      "[237 rows x 5 columns]\n",
      "first row of the selected chunck : \n",
      " [722027566 13 '1398/06/23' 24404 'E206']\n",
      "237\n",
      "t0 = 24404\n",
      "ts = 71298\n",
      "time_intervals 78\n",
      "Origin destination interval view reindex \n",
      "     time_in  time_out\n",
      "0   24404.0   25004.0\n",
      "1   26204.0   27404.0\n",
      "2   29804.0   31604.0\n",
      "3   34004.0   35204.0\n",
      "4   35804.0   36404.0\n",
      "5   37604.0   38804.0\n",
      "6   41804.0   43004.0\n",
      "7   45404.0   46604.0\n",
      "8   48404.0   52004.0\n",
      "9   53804.0   55004.0\n",
      "10  56804.0   60404.0\n",
      "11  62804.0   63404.0\n",
      "12  66404.0   68804.0\n",
      "13  70004.0   70604.0\n",
      "OD bus stations of transactions: \n",
      "            CardID LineCode       FDate   Time  plat Station\n",
      "0       542446139        1  1398/06/23  24030  A145    3169\n",
      "1      2620656172        1  1398/06/23  24302  A145    3169\n",
      "2      3446252780        1  1398/06/23  26200  A145    1227\n",
      "3         7900260        1  1398/06/23  29677  A145    3169\n",
      "4       361857972        1  1398/06/23  29720  A145    3169\n",
      "...           ...      ...         ...    ...   ...     ...\n",
      "36534  4058822029       13  1398/06/23  70539  E206    2566\n",
      "36535  4058822029       13  1398/06/23  70540  E206    2566\n",
      "36536  2681010180       13  1398/06/23  70543  E206    2566\n",
      "36537  2681010180       13  1398/06/23  70545  E206    2566\n",
      "36538  1293184558       13  1398/06/23  70586  E206    2566\n",
      "\n",
      "[36539 rows x 6 columns]\n",
      "transactions in line 13 plat F27\n",
      "ps: \n",
      "              CardID  LineCode       FDate   Time plat\n",
      "300061  3405854457        13  1398/06/23  28047  F27\n",
      "300064  3207522036        13  1398/06/23  28070  F27\n",
      "300062  3630474460        13  1398/06/23  28234  F27\n",
      "300063  3630474460        13  1398/06/23  28236  F27\n",
      "300065   984235995        13  1398/06/23  28267  F27\n",
      "...            ...       ...         ...    ...  ...\n",
      "81567   2741548932        13  1398/06/23  76282  F27\n",
      "81570   2740682548        13  1398/06/23  76329  F27\n",
      "81571   2124246100        13  1398/06/23  76366  F27\n",
      "18725   2124246100        13  1398/06/23  76367  F27\n",
      "18726    721959204        13  1398/06/23  76466  F27\n",
      "\n",
      "[169 rows x 5 columns]\n",
      "first row of the selected chunck : \n",
      " [3405854457 13 '1398/06/23' 28047 'F27']\n",
      "169\n",
      "t0 = 28047\n",
      "ts = 76466\n",
      "time_intervals 81\n",
      "Origin destination interval view reindex \n",
      "    time_in  time_out\n",
      "0  28047.0   28647.0\n",
      "1  30447.0   47247.0\n",
      "2  50247.0   52047.0\n",
      "3  53247.0   55647.0\n",
      "4  58647.0   60447.0\n",
      "5  62847.0   65247.0\n",
      "6  65847.0   66447.0\n",
      "7  68247.0   68847.0\n",
      "8  72447.0   73047.0\n",
      "9  73647.0   74847.0\n",
      "OD bus stations of transactions: \n",
      "            CardID LineCode       FDate   Time  plat Station\n",
      "0       542446139        1  1398/06/23  24030  A145    3169\n",
      "1      2620656172        1  1398/06/23  24302  A145    3169\n",
      "2      3446252780        1  1398/06/23  26200  A145    1227\n",
      "3         7900260        1  1398/06/23  29677  A145    3169\n",
      "4       361857972        1  1398/06/23  29720  A145    3169\n",
      "...           ...      ...         ...    ...   ...     ...\n",
      "36561   483325940       13  1398/06/23  66398   F27    1528\n",
      "36562  2239084459       13  1398/06/23  66400   F27    1528\n",
      "36563   174716356       13  1398/06/23  68743   F27    2566\n",
      "36564  2507891380       13  1398/06/23  72680   F27    1528\n",
      "36565  2508028612       13  1398/06/23  74270   F27    2566\n",
      "\n",
      "[36566 rows x 6 columns]\n",
      "transactions in line 13 plat M128\n",
      "ps: \n",
      "              CardID  LineCode       FDate   Time  plat\n",
      "224748  3208381317        13  1398/06/23  26101  M128\n",
      "224749  2740825044        13  1398/06/23  26441  M128\n",
      "224752  3405825701        13  1398/06/23  26485  M128\n",
      "224750   722161163        13  1398/06/23  26490  M128\n",
      "224751  2680332164        13  1398/06/23  26495  M128\n",
      "...            ...       ...         ...    ...   ...\n",
      "223490  1407244478        13  1398/06/23  74748  M128\n",
      "223491  3604408140        13  1398/06/23  74799  M128\n",
      "223492  3604408140        13  1398/06/23  74801  M128\n",
      "223497  3646367828        13  1398/06/23  74847  M128\n",
      "223498   869383244        13  1398/06/23  74911  M128\n",
      "\n",
      "[254 rows x 5 columns]\n",
      "first row of the selected chunck : \n",
      " [3208381317 13 '1398/06/23' 26101 'M128']\n",
      "254\n",
      "t0 = 26101\n",
      "ts = 74911\n",
      "time_intervals 81\n",
      "Origin destination interval view reindex \n",
      "     time_in  time_out\n",
      "0   26101.0   26701.0\n",
      "1   28501.0   30301.0\n",
      "2   30901.0   32101.0\n",
      "3   33901.0   35701.0\n",
      "4   37501.0   38101.0\n",
      "5   39301.0   39901.0\n",
      "6   41101.0   43501.0\n",
      "7   45301.0   45901.0\n",
      "8   48901.0   50101.0\n",
      "9   51901.0   54901.0\n",
      "10  57301.0   58501.0\n",
      "11  60901.0   63301.0\n",
      "12  64501.0   65101.0\n",
      "13  66901.0   68101.0\n",
      "14  68701.0   69301.0\n",
      "15  69901.0   72901.0\n",
      "16  73501.0   74101.0\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "OD bus stations of transactions: \n",
      "            CardID LineCode       FDate   Time  plat Station\n",
      "0       542446139        1  1398/06/23  24030  A145    3169\n",
      "1      2620656172        1  1398/06/23  24302  A145    3169\n",
      "2      3446252780        1  1398/06/23  26200  A145    1227\n",
      "3         7900260        1  1398/06/23  29677  A145    3169\n",
      "4       361857972        1  1398/06/23  29720  A145    3169\n",
      "...           ...      ...         ...    ...   ...     ...\n",
      "36618   722124663       13  1398/06/23  69250  M128    1528\n",
      "36619  3109343765       13  1398/06/23  72855  M128    2566\n",
      "36620  3154216814       13  1398/06/23  73837  M128    1528\n",
      "36621  3672180754       13  1398/06/23  73838  M128    1528\n",
      "36622  4266426866       13  1398/06/23  73898  M128    1528\n",
      "\n",
      "[36623 rows x 6 columns]\n",
      "transactions in line 13 plat N115\n",
      "ps: \n",
      "              CardID  LineCode       FDate   Time  plat\n",
      "207427  3152424798        13  1398/06/23  22141  N115\n",
      "207428   869303468        13  1398/06/23  22779  N115\n",
      "207429  3183564590        13  1398/06/23  22798  N115\n",
      "207430  3648903540        13  1398/06/23  23006  N115\n",
      "207431   430418334        13  1398/06/23  23007  N115\n",
      "...            ...       ...         ...    ...   ...\n",
      "208429  2504549668        13  1398/06/23  69675  N115\n",
      "208430   428538766        13  1398/06/23  70668  N115\n",
      "208431  3405784705        13  1398/06/23  71869  N115\n",
      "208432   722146864        13  1398/06/23  71923  N115\n",
      "208433   645650189        13  1398/06/23  72609  N115\n",
      "\n",
      "[300 rows x 5 columns]\n",
      "first row of the selected chunck : \n",
      " [3152424798 13 '1398/06/23' 22141 'N115']\n",
      "300\n",
      "t0 = 22141\n",
      "ts = 72609\n",
      "time_intervals 84\n",
      "Origin destination interval view reindex \n",
      "     time_in  time_out\n",
      "0   22141.0   23341.0\n",
      "1   24541.0   25141.0\n",
      "2   28141.0   29941.0\n",
      "3   32341.0   33541.0\n",
      "4   35941.0   36541.0\n",
      "5   41341.0   41941.0\n",
      "6   43141.0   43741.0\n",
      "7   44341.0   44941.0\n",
      "8   46741.0   49141.0\n",
      "9   52141.0   52741.0\n",
      "10  53341.0   53941.0\n",
      "11  55141.0   58141.0\n",
      "12  61141.0   62941.0\n",
      "13  64741.0   65941.0\n",
      "14  66541.0   67741.0\n",
      "15  68341.0   68941.0\n",
      "16  71341.0   71941.0\n",
      "OD bus stations of transactions: \n",
      "            CardID LineCode       FDate   Time  plat Station\n",
      "0       542446139        1  1398/06/23  24030  A145    3169\n",
      "1      2620656172        1  1398/06/23  24302  A145    3169\n",
      "2      3446252780        1  1398/06/23  26200  A145    1227\n",
      "3         7900260        1  1398/06/23  29677  A145    3169\n",
      "4       361857972        1  1398/06/23  29720  A145    3169\n",
      "...           ...      ...         ...    ...   ...     ...\n",
      "36698  4266682098       13  1398/06/23  68622  N115    2566\n",
      "36699  2491843700       13  1398/06/23  68887  N115    2566\n",
      "36700  3555794257       13  1398/06/23  68891  N115    2566\n",
      "36701  3405784705       13  1398/06/23  71869  N115    1528\n",
      "36702   722146864       13  1398/06/23  71923  N115    1528\n",
      "\n",
      "[36703 rows x 6 columns]\n",
      "stations in a specefic bus line 14\n",
      "len-of-go stations: 20\n",
      "len-of-back stations: 18\n",
      "len-of-go back stations: 0\n",
      "first Station  [3349 '14' '1' 'go' '??? ????-14' 51.669465 32.602005 'od' 'normal' 'no'] 3349\n",
      "last Station  [2881 '14' '1' 'back' '?? ? ?? ??-62-61-14' 51.666285 32.642218 'od'\n",
      " 'normal' 'no']\n",
      "['A141' 'B66' 'D28' 'E120' 'F108' 'F173' 'M121' 'M205' 'M96' 'N71']\n",
      "transactions in line 14 plat A141\n",
      "ps: \n",
      "              CardID  LineCode       FDate   Time  plat\n",
      "229195  3649009684        14  1398/06/23  23626  A141\n",
      "229196   361282324        14  1398/06/23  23935  A141\n",
      "229199  3257418925        14  1398/06/23  23937  A141\n",
      "229198  3632366140        14  1398/06/23  24002  A141\n",
      "229200  2052421410        14  1398/06/23  24195  A141\n",
      "...            ...       ...         ...    ...   ...\n",
      "317763  2239142886        14  1398/06/23  73826  A141\n",
      "317764  3181414062        14  1398/06/23  73829  A141\n",
      "317766  3603757932        14  1398/06/23  74055  A141\n",
      "317767   536928267        14  1398/06/23  74071  A141\n",
      "317765   235263466        14  1398/06/23  74184  A141\n",
      "\n",
      "[218 rows x 5 columns]\n",
      "first row of the selected chunck : \n",
      " [3649009684 14 '1398/06/23' 23626 'A141']\n",
      "218\n",
      "t0 = 23626\n",
      "ts = 74184\n",
      "time_intervals 84\n",
      "Origin destination interval view reindex \n",
      "     time_in  time_out\n",
      "0   23626.0   24226.0\n",
      "1   24826.0   25426.0\n",
      "2   26026.0   28426.0\n",
      "3   31426.0   33826.0\n",
      "4   34426.0   35026.0\n",
      "5   36226.0   40426.0\n",
      "6   41026.0   42226.0\n",
      "7   44026.0   45226.0\n",
      "8   46426.0   47026.0\n",
      "9   48226.0   50626.0\n",
      "10  52426.0   53026.0\n",
      "11  54226.0   55426.0\n",
      "12  56626.0   58426.0\n",
      "13  59026.0   60826.0\n",
      "14  65026.0   65626.0\n",
      "15  67426.0   68626.0\n",
      "16  69226.0   69826.0\n",
      "17  72226.0   72826.0\n",
      "OD bus stations of transactions: \n",
      "            CardID LineCode       FDate   Time  plat Station\n",
      "0       542446139        1  1398/06/23  24030  A145    3169\n",
      "1      2620656172        1  1398/06/23  24302  A145    3169\n",
      "2      3446252780        1  1398/06/23  26200  A145    1227\n",
      "3         7900260        1  1398/06/23  29677  A145    3169\n",
      "4       361857972        1  1398/06/23  29720  A145    3169\n",
      "...           ...      ...         ...    ...   ...     ...\n",
      "36816  1598489236       14  1398/06/23  68487  A141    2881\n",
      "36817  1598489236       14  1398/06/23  68505  A141    2881\n",
      "36818  2136925213       14  1398/06/23  69358  A141    3349\n",
      "36819   426182478       14  1398/06/23  72638  A141    2881\n",
      "36820  2541595550       14  1398/06/23  72675  A141    2881\n",
      "\n",
      "[36821 rows x 6 columns]\n",
      "transactions in line 14 plat B66\n",
      "ps: \n",
      "              CardID  LineCode       FDate   Time plat\n",
      "648780  3208852740        14  1398/06/23  24995  B66\n",
      "648781   869223950        14  1398/06/23  25242  B66\n",
      "648782  3630118012        14  1398/06/23  25432  B66\n",
      "648783  3630118012        14  1398/06/23  25433  B66\n",
      "648784   474281706        14  1398/06/23  25464  B66\n",
      "...            ...       ...         ...    ...  ...\n",
      "5139    3647933812        14  1398/06/23  72413  B66\n",
      "5140    3631531148        14  1398/06/23  72423  B66\n",
      "5141    3208941236        14  1398/06/23  72432  B66\n",
      "324785  1001622382        14  1398/06/23  72437  B66\n",
      "324786  1001622382        14  1398/06/23  72439  B66\n",
      "\n",
      "[236 rows x 5 columns]\n",
      "first row of the selected chunck : \n",
      " [3208852740 14 '1398/06/23' 24995 'B66']\n",
      "236\n",
      "t0 = 24995\n",
      "ts = 72439\n",
      "time_intervals 79\n",
      "Origin destination interval view reindex \n",
      "     time_in  time_out\n",
      "0   24995.0   25595.0\n",
      "1   27395.0   27995.0\n",
      "2   29195.0   31595.0\n",
      "3   32795.0   33995.0\n",
      "4   34595.0   36395.0\n",
      "5   42995.0   44195.0\n",
      "6   45395.0   47195.0\n",
      "7   48395.0   51995.0\n",
      "8   53795.0   54395.0\n",
      "9   55595.0   57395.0\n",
      "10  58595.0   59195.0\n",
      "11  60995.0   62195.0\n",
      "12  64595.0   65195.0\n",
      "13  66995.0   68195.0\n",
      "14  69395.0   69995.0\n",
      "OD bus stations of transactions: \n",
      "            CardID LineCode       FDate   Time  plat Station\n",
      "0       542446139        1  1398/06/23  24030  A145    3169\n",
      "1      2620656172        1  1398/06/23  24302  A145    3169\n",
      "2      3446252780        1  1398/06/23  26200  A145    1227\n",
      "3         7900260        1  1398/06/23  29677  A145    3169\n",
      "4       361857972        1  1398/06/23  29720  A145    3169\n",
      "...           ...      ...         ...    ...   ...     ...\n",
      "36974  2137568141       14  1398/06/23  69822   B66    3349\n",
      "36975  1407247977       14  1398/06/23  69824   B66    3349\n",
      "36976  3630217340       14  1398/06/23  69856   B66    3349\n",
      "36977  2741905396       14  1398/06/23  69873   B66    3349\n",
      "36978  2741905396       14  1398/06/23  69877   B66    3349\n",
      "\n",
      "[36979 rows x 6 columns]\n",
      "transactions in line 14 plat D28\n",
      "ps: \n",
      "             CardID  LineCode       FDate   Time plat\n",
      "15902  3759959509        14  1398/06/23  59572  D28\n",
      "15903   646057885        14  1398/06/23  59574  D28\n",
      "first row of the selected chunck : \n",
      " [3759959509 14 '1398/06/23' 59572 'D28']\n",
      "2\n",
      "t0 = 59572\n",
      "ts = 59574\n",
      "time_intervals 0\n",
      "Origin destination interval view reindex \n",
      " Empty DataFrame\n",
      "Columns: [time_in, time_out]\n",
      "Index: []\n",
      "OD bus stations of transactions: \n",
      "            CardID LineCode       FDate   Time  plat Station\n",
      "0       542446139        1  1398/06/23  24030  A145    3169\n",
      "1      2620656172        1  1398/06/23  24302  A145    3169\n",
      "2      3446252780        1  1398/06/23  26200  A145    1227\n",
      "3         7900260        1  1398/06/23  29677  A145    3169\n",
      "4       361857972        1  1398/06/23  29720  A145    3169\n",
      "...           ...      ...         ...    ...   ...     ...\n",
      "37033  3792451100       14  1398/06/23  36662   B66    2881\n",
      "37034  3792085132       14  1398/06/23  36666   B66    2881\n",
      "37035  3178536766       14  1398/06/23  36854   B66    2881\n",
      "37036  4276360194       14  1398/06/23  37089   B66    2881\n",
      "37037   174603494       14  1398/06/23  37171   B66    2881\n",
      "\n",
      "[37038 rows x 6 columns]\n",
      "transactions in line 14 plat E120\n",
      "ps: \n",
      "              CardID  LineCode       FDate   Time  plat\n",
      "473589  2137403453        14  1398/06/23  48446  E120\n",
      "473590  3792989532        14  1398/06/23  48532  E120\n",
      "473591   179028294        14  1398/06/23  48777  E120\n",
      "473597  3675494802        14  1398/06/23  49215  E120\n",
      "473592  3209208500        14  1398/06/23  49218  E120\n",
      "...            ...       ...         ...    ...   ...\n",
      "499193   722256384        14  1398/06/23  73319  E120\n",
      "499194  3108661893        14  1398/06/23  73609  E120\n",
      "499195  2586273236        14  1398/06/23  73612  E120\n",
      "499196  2118147412        14  1398/06/23  73616  E120\n",
      "499197   297018219        14  1398/06/23  73625  E120\n",
      "\n",
      "[145 rows x 5 columns]\n",
      "first row of the selected chunck : \n",
      " [2137403453 14 '1398/06/23' 48446 'E120']\n",
      "145\n",
      "t0 = 48446\n",
      "ts = 73625\n",
      "time_intervals 42\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Origin destination interval view reindex \n",
      "    time_in  time_out\n",
      "0  48446.0   49046.0\n",
      "1  50246.0   50846.0\n",
      "2  52046.0   53246.0\n",
      "3  55646.0   56246.0\n",
      "4  57446.0   59246.0\n",
      "5  61046.0   61646.0\n",
      "6  69446.0   70046.0\n",
      "7  70646.0   72446.0\n",
      "OD bus stations of transactions: \n",
      "            CardID LineCode       FDate   Time  plat Station\n",
      "0       542446139        1  1398/06/23  24030  A145    3169\n",
      "1      2620656172        1  1398/06/23  24302  A145    3169\n",
      "2      3446252780        1  1398/06/23  26200  A145    1227\n",
      "3         7900260        1  1398/06/23  29677  A145    3169\n",
      "4       361857972        1  1398/06/23  29720  A145    3169\n",
      "...           ...      ...         ...    ...   ...     ...\n",
      "37058  1530459198       14  1398/06/23  69546  E120    3349\n",
      "37059  4275702562       14  1398/06/23  71878  E120    2881\n",
      "37060   869305149       14  1398/06/23  71932  E120    2881\n",
      "37061  3997119268       14  1398/06/23  72435  E120    2881\n",
      "37062  4256857316       14  1398/06/23  72440  E120    2881\n",
      "\n",
      "[37063 rows x 6 columns]\n",
      "transactions in line 14 plat F108\n",
      "ps: \n",
      "              CardID  LineCode       FDate   Time  plat\n",
      "445808  2680285998        14  1398/06/23  31203  F108\n",
      "445811  2482477604        14  1398/06/23  31518  F108\n",
      "445809  3446136172        14  1398/06/23  31521  F108\n",
      "445812   174981844        14  1398/06/23  31521  F108\n",
      "445813   721761238        14  1398/06/23  31524  F108\n",
      "...            ...       ...         ...    ...   ...\n",
      "541998  3791740748        14  1398/06/23  75619  F108\n",
      "568269  3630011436        14  1398/06/23  76598  F108\n",
      "568270  1370972014        14  1398/06/23  76607  F108\n",
      "568272  3151301966        14  1398/06/23  76839  F108\n",
      "568271  3184038366        14  1398/06/23  76840  F108\n",
      "\n",
      "[193 rows x 5 columns]\n",
      "first row of the selected chunck : \n",
      " [2680285998 14 '1398/06/23' 31203 'F108']\n",
      "193\n",
      "t0 = 31203\n",
      "ts = 76840\n",
      "time_intervals 76\n",
      "Origin destination interval view reindex \n",
      "     time_in  time_out\n",
      "0   31203.0   31803.0\n",
      "1   33603.0   34803.0\n",
      "2   35403.0   36603.0\n",
      "3   39003.0   39603.0\n",
      "4   40803.0   42003.0\n",
      "5   42603.0   43203.0\n",
      "6   44403.0   45003.0\n",
      "7   46803.0   48003.0\n",
      "8   51603.0   52803.0\n",
      "9   54603.0   55803.0\n",
      "10  56403.0   58803.0\n",
      "11  61203.0   61803.0\n",
      "12  64803.0   65403.0\n",
      "13  70203.0   70803.0\n",
      "14  73203.0   74403.0\n",
      "15  75003.0   75603.0\n",
      "OD bus stations of transactions: \n",
      "            CardID LineCode       FDate   Time  plat Station\n",
      "0       542446139        1  1398/06/23  24030  A145    3169\n",
      "1      2620656172        1  1398/06/23  24302  A145    3169\n",
      "2      3446252780        1  1398/06/23  26200  A145    1227\n",
      "3         7900260        1  1398/06/23  29677  A145    3169\n",
      "4       361857972        1  1398/06/23  29720  A145    3169\n",
      "...           ...      ...         ...    ...   ...     ...\n",
      "37173   982757643       14  1398/06/23  70800  F108    2881\n",
      "37174  2676788004       14  1398/06/23  73832  F108    3349\n",
      "37175   536988795       14  1398/06/23  75019  F108    2881\n",
      "37176   536988795       14  1398/06/23  75020  F108    2881\n",
      "37177   425884974       14  1398/06/23  75328  F108    2881\n",
      "\n",
      "[37178 rows x 6 columns]\n",
      "transactions in line 14 plat F173\n",
      "ps: \n",
      "              CardID  LineCode       FDate   Time  plat\n",
      "257478  2541491438        14  1398/06/23  54634  F173\n",
      "257479  2742309908        14  1398/06/23  54997  F173\n",
      "257480  1213800510        14  1398/06/23  55215  F173\n",
      "first row of the selected chunck : \n",
      " [2541491438 14 '1398/06/23' 54634 'F173']\n",
      "3\n",
      "t0 = 54634\n",
      "ts = 55215\n",
      "time_intervals 1\n",
      "Origin destination interval view reindex \n",
      "    time_in  time_out\n",
      "0  54634.0   55234.0\n",
      "OD bus stations of transactions: \n",
      "            CardID LineCode       FDate   Time  plat Station\n",
      "0       542446139        1  1398/06/23  24030  A145    3169\n",
      "1      2620656172        1  1398/06/23  24302  A145    3169\n",
      "2      3446252780        1  1398/06/23  26200  A145    1227\n",
      "3         7900260        1  1398/06/23  29677  A145    3169\n",
      "4       361857972        1  1398/06/23  29720  A145    3169\n",
      "...           ...      ...         ...    ...   ...     ...\n",
      "37271  2680254190       14  1398/06/23  65479  F108    2880\n",
      "37272  2680254190       14  1398/06/23  65479  F108    2881\n",
      "37273  2541491438       14  1398/06/23  54634  F173    3349\n",
      "37274  2742309908       14  1398/06/23  54997  F173    3349\n",
      "37275  1213800510       14  1398/06/23  55215  F173    3349\n",
      "\n",
      "[37276 rows x 6 columns]\n",
      "transactions in line 14 plat M121\n",
      "ps: \n",
      "              CardID  LineCode       FDate   Time  plat\n",
      "458187  1407187190        14  1398/06/23  24438  M121\n",
      "458188  2125921908        14  1398/06/23  24452  M121\n",
      "458189  1844789300        14  1398/06/23  25716  M121\n",
      "458190  2173051987        14  1398/06/23  26028  M121\n",
      "459742   169089796        14  1398/06/23  26370  M121\n",
      "...            ...       ...         ...    ...   ...\n",
      "488292  3678104780        14  1398/06/23  75995  M121\n",
      "488293  3678104780        14  1398/06/23  75996  M121\n",
      "488294  2123463508        14  1398/06/23  76080  M121\n",
      "488295  2497798957        14  1398/06/23  76135  M121\n",
      "458186   361713812        14  1398/06/23  76534  M121\n",
      "\n",
      "[230 rows x 5 columns]\n",
      "first row of the selected chunck : \n",
      " [1407187190 14 '1398/06/23' 24438 'M121']\n",
      "230\n",
      "t0 = 24438\n",
      "ts = 76534\n",
      "time_intervals 87\n",
      "Origin destination interval view reindex \n",
      "     time_in  time_out\n",
      "0   24438.0   25038.0\n",
      "1   25638.0   26238.0\n",
      "2   27438.0   29238.0\n",
      "3   33438.0   35238.0\n",
      "4   36438.0   37038.0\n",
      "5   38238.0   40038.0\n",
      "6   41238.0   42438.0\n",
      "7   44238.0   46038.0\n",
      "8   46638.0   48438.0\n",
      "9   49638.0   51438.0\n",
      "10  52638.0   53838.0\n",
      "11  54438.0   56238.0\n",
      "12  57438.0   58638.0\n",
      "13  59238.0   59838.0\n",
      "14  60438.0   61638.0\n",
      "15  63438.0   64038.0\n",
      "16  65838.0   66438.0\n",
      "17  68238.0   68838.0\n",
      "18  71238.0   71838.0\n",
      "19  72438.0   74838.0\n",
      "OD bus stations of transactions: \n",
      "            CardID LineCode       FDate   Time  plat Station\n",
      "0       542446139        1  1398/06/23  24030  A145    3169\n",
      "1      2620656172        1  1398/06/23  24302  A145    3169\n",
      "2      3446252780        1  1398/06/23  26200  A145    1227\n",
      "3         7900260        1  1398/06/23  29677  A145    3169\n",
      "4       361857972        1  1398/06/23  29720  A145    3169\n",
      "...           ...      ...         ...    ...   ...     ...\n",
      "37348  1527329438       14  1398/06/23  74474  M121    2881\n",
      "37349  1766265156       14  1398/06/23  74691  M121    2881\n",
      "37350   263099777       14  1398/06/23  74788  M121    2881\n",
      "37351  3977673844       14  1398/06/23  74797  M121    2881\n",
      "37352  3977673844       14  1398/06/23  74802  M121    2881\n",
      "\n",
      "[37353 rows x 6 columns]\n",
      "transactions in line 14 plat M205\n",
      "ps: \n",
      "              CardID  LineCode       FDate   Time  plat\n",
      "342934  3793139100        14  1398/06/23  23682  M205\n",
      "342932  1001520974        14  1398/06/23  23683  M205\n",
      "342935  3678586940        14  1398/06/23  23684  M205\n",
      "342933  3677898636        14  1398/06/23  23800  M205\n",
      "342936   175062598        14  1398/06/23  25586  M205\n",
      "342937   981944683        14  1398/06/23  25648  M205\n",
      "342938   212285675        14  1398/06/23  25666  M205\n",
      "342939  1765591828        14  1398/06/23  26223  M205\n",
      "342940  1834933309        14  1398/06/23  26488  M205\n",
      "342941  3559164881        14  1398/06/23  26522  M205\n",
      "342945  1845210020        14  1398/06/23  26783  M205\n",
      "342942   474149882        14  1398/06/23  26787  M205\n",
      "342943  1000594142        14  1398/06/23  26867  M205\n",
      "342944  2741682100        14  1398/06/23  26877  M205\n",
      "342946   869420950        14  1398/06/23  27211  M205\n",
      "342947   474072314        14  1398/06/23  27221  M205\n",
      "342948  3794998236        14  1398/06/23  27898  M205\n",
      "342949  3678041596        14  1398/06/23  28154  M205\n",
      "342950  3107539829        14  1398/06/23  28325  M205\n",
      "342951   180213444        14  1398/06/23  28534  M205\n",
      "342952  3630437772        14  1398/06/23  28540  M205\n",
      "342953  3547816660        14  1398/06/23  28547  M205\n",
      "376250  4059367997        14  1398/06/23  28607  M205\n",
      "376251  3183201278        14  1398/06/23  28623  M205\n",
      "376252  3648385732        14  1398/06/23  28773  M205\n",
      "376253  3207154308        14  1398/06/23  28776  M205\n",
      "376254   721968673        14  1398/06/23  28930  M205\n",
      "376257  3650138692        14  1398/06/23  31928  M205\n",
      "376255  3646987556        14  1398/06/23  32011  M205\n",
      "376256  3184038366        14  1398/06/23  32018  M205\n",
      "376258  2482312356        14  1398/06/23  32291  M205\n",
      "376259   262437377        14  1398/06/23  32373  M205\n",
      "376260  2500919828        14  1398/06/23  32375  M205\n",
      "376261  2585544180        14  1398/06/23  32558  M205\n",
      "376262  2234178243        14  1398/06/23  32744  M205\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "first row of the selected chunck : \n",
      " [3793139100 14 '1398/06/23' 23682 'M205']\n",
      "35\n",
      "t0 = 23682\n",
      "ts = 32744\n",
      "time_intervals 15\n",
      "Origin destination interval view reindex \n",
      "    time_in  time_out\n",
      "0  23682.0   24282.0\n",
      "1  24882.0   26082.0\n",
      "2  27882.0   28482.0\n",
      "3  29682.0   32082.0\n",
      "OD bus stations of transactions: \n",
      "            CardID LineCode       FDate   Time  plat Station\n",
      "0       542446139        1  1398/06/23  24030  A145    3169\n",
      "1      2620656172        1  1398/06/23  24302  A145    3169\n",
      "2      3446252780        1  1398/06/23  26200  A145    1227\n",
      "3         7900260        1  1398/06/23  29677  A145    3169\n",
      "4       361857972        1  1398/06/23  29720  A145    3169\n",
      "...           ...      ...         ...    ...   ...     ...\n",
      "37403  3678041596       14  1398/06/23  28154  M205    3349\n",
      "37404  3107539829       14  1398/06/23  28325  M205    3349\n",
      "37405  3650138692       14  1398/06/23  31928  M205    2881\n",
      "37406  3646987556       14  1398/06/23  32011  M205    2881\n",
      "37407  3184038366       14  1398/06/23  32018  M205    2881\n",
      "\n",
      "[37408 rows x 6 columns]\n",
      "transactions in line 14 plat M96\n",
      "ps: \n",
      "              CardID  LineCode       FDate   Time plat\n",
      "356059  3445577900        14  1398/06/23  21894  M96\n",
      "356060  3446114700        14  1398/06/23  23202  M96\n",
      "356061  3446114700        14  1398/06/23  23203  M96\n",
      "356062  3631250924        14  1398/06/23  23207  M96\n",
      "356063  2855446014        14  1398/06/23  24072  M96\n",
      "...            ...       ...         ...    ...  ...\n",
      "411593  2855887614        14  1398/06/23  68576  M96\n",
      "411594  2228124019        14  1398/06/23  68581  M96\n",
      "411595  3209729028        14  1398/06/23  68585  M96\n",
      "411596  2502153300        14  1398/06/23  68591  M96\n",
      "411597   869441620        14  1398/06/23  69031  M96\n",
      "\n",
      "[303 rows x 5 columns]\n",
      "first row of the selected chunck : \n",
      " [3445577900 14 '1398/06/23' 21894 'M96']\n",
      "303\n",
      "t0 = 21894\n",
      "ts = 69031\n",
      "time_intervals 79\n",
      "Origin destination interval view reindex \n",
      "     time_in  time_out\n",
      "0   21894.0   23694.0\n",
      "1   25494.0   27294.0\n",
      "2   29094.0   29694.0\n",
      "3   31494.0   33294.0\n",
      "4   37494.0   38094.0\n",
      "5   40494.0   41094.0\n",
      "6   43494.0   44094.0\n",
      "7   47694.0   49494.0\n",
      "8   50094.0   51894.0\n",
      "9   53094.0   54294.0\n",
      "10  56094.0   57294.0\n",
      "11  57894.0   59694.0\n",
      "12  63894.0   65094.0\n",
      "OD bus stations of transactions: \n",
      "            CardID LineCode       FDate   Time  plat Station\n",
      "0       542446139        1  1398/06/23  24030  A145    3169\n",
      "1      2620656172        1  1398/06/23  24302  A145    3169\n",
      "2      3446252780        1  1398/06/23  26200  A145    1227\n",
      "3         7900260        1  1398/06/23  29677  A145    3169\n",
      "4       361857972        1  1398/06/23  29720  A145    3169\n",
      "...           ...      ...         ...    ...   ...     ...\n",
      "37460  3258161485       14  1398/06/23  57188   M96    3349\n",
      "37461  2052475426       14  1398/06/23  59693   M96    2881\n",
      "37462  2137955149       14  1398/06/23  64923   M96    3349\n",
      "37463  1578012933       14  1398/06/23  64931   M96    3349\n",
      "37464  4276520978       14  1398/06/23  64970   M96    3349\n",
      "\n",
      "[37465 rows x 6 columns]\n",
      "transactions in line 14 plat N71\n",
      "ps: \n",
      "              CardID  LineCode       FDate   Time plat\n",
      "535849  2741550020        14  1398/06/23  29818  N71\n",
      "535850  3791746236        14  1398/06/23  30286  N71\n",
      "535851   428319326        14  1398/06/23  30596  N71\n",
      "535852   428319326        14  1398/06/23  30598  N71\n",
      "535853  3997073412        14  1398/06/23  30614  N71\n",
      "...            ...       ...         ...    ...  ...\n",
      "587438  1958046884        14  1398/06/23  72720  N71\n",
      "587439  1360468794        14  1398/06/23  73377  N71\n",
      "587440   980592955        14  1398/06/23  73637  N71\n",
      "587988  1764877972        14  1398/06/23  75736  N71\n",
      "587989  1764877972        14  1398/06/23  75738  N71\n",
      "\n",
      "[217 rows x 5 columns]\n",
      "first row of the selected chunck : \n",
      " [2741550020 14 '1398/06/23' 29818 'N71']\n",
      "217\n",
      "t0 = 29818\n",
      "ts = 75738\n",
      "time_intervals 77\n",
      "Origin destination interval view reindex \n",
      "     time_in  time_out\n",
      "0   29818.0   30418.0\n",
      "1   32218.0   33418.0\n",
      "2   34618.0   35218.0\n",
      "3   40018.0   40618.0\n",
      "4   43018.0   43618.0\n",
      "5   44818.0   46618.0\n",
      "6   47818.0   48418.0\n",
      "7   50218.0   59818.0\n",
      "8   61018.0   61618.0\n",
      "9   63418.0   64018.0\n",
      "10  68818.0   70018.0\n",
      "11  71818.0   73018.0\n",
      "12  74818.0   76018.0\n",
      "OD bus stations of transactions: \n",
      "            CardID LineCode       FDate   Time  plat Station\n",
      "0       542446139        1  1398/06/23  24030  A145    3169\n",
      "1      2620656172        1  1398/06/23  24302  A145    3169\n",
      "2      3446252780        1  1398/06/23  26200  A145    1227\n",
      "3         7900260        1  1398/06/23  29677  A145    3169\n",
      "4       361857972        1  1398/06/23  29720  A145    3169\n",
      "...           ...      ...         ...    ...   ...     ...\n",
      "37648  3792994828       14  1398/06/23  72491   N71    2881\n",
      "37649   362347428       14  1398/06/23  72551   N71    2881\n",
      "37650  1958046884       14  1398/06/23  72720   N71    2881\n",
      "37651  1764877972       14  1398/06/23  75736   N71    3349\n",
      "37652  1764877972       14  1398/06/23  75738   N71    3349\n",
      "\n",
      "[37653 rows x 6 columns]\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "C:\\Users\\esmaeli.h\\AppData\\Local\\Temp/ipykernel_12452/1949912630.py:257: ConvergenceWarning: Number of distinct clusters (18) found smaller than n_clusters (19). Possibly due to duplicate points in X.\n",
      "  kmeans = KMeans(n_clusters=len(filter_go_stations)-1,random_state=0).fit(partial_times.to_numpy())\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "stations in a specefic bus line 16\n",
      "len-of-go stations: 54\n",
      "len-of-back stations: 50\n",
      "len-of-go back stations: 0\n",
      "first Station  [3359 '16' '1' 'go' '????? ???? ????? (??) ??????' 51.648219 32.77208 'od'\n",
      " 'normal' 'no'] 3359\n",
      "last Station  [3534 '16' '1' 'back' '?????? ??? ??? ??? ?? -16-72' 51.623781 32.611096\n",
      " 'od' 'normal' 'yes']\n",
      "['A65' 'B39' 'C17' 'C24' 'D47' 'E131' 'E132' 'E188' 'E33' 'E92' 'F149'\n",
      " 'F176' 'M45' 'M77' 'N175' 'N182' 'N82']\n",
      "transactions in line 16 plat A65\n",
      "ps: \n",
      "              CardID  LineCode       FDate   Time plat\n",
      "191020  1407242318        16  1398/06/23  22922  A65\n",
      "191021  1407242318        16  1398/06/23  22923  A65\n",
      "191022  1407242318        16  1398/06/23  22925  A65\n",
      "191023  1832155517        16  1398/06/23  23344  A65\n",
      "191024  1835115709        16  1398/06/23  23723  A65\n",
      "...            ...       ...         ...    ...  ...\n",
      "246275  1598754836        16  1398/06/23  76046  A65\n",
      "246277  3256344717        16  1398/06/23  76047  A65\n",
      "246276   429204638        16  1398/06/23  76048  A65\n",
      "246278  3556080497        16  1398/06/23  76684  A65\n",
      "246279  3258302077        16  1398/06/23  76705  A65\n",
      "\n",
      "[561 rows x 5 columns]\n",
      "first row of the selected chunck : \n",
      " [1407242318 16 '1398/06/23' 22922 'A65']\n",
      "561\n",
      "t0 = 22922\n",
      "ts = 76705\n",
      "time_intervals 90\n",
      "Origin destination interval view reindex \n",
      "    time_in  time_out\n",
      "0  22922.0   23522.0\n",
      "1  30722.0   31922.0\n",
      "2  36722.0   37322.0\n",
      "3  41522.0   42122.0\n",
      "4  47522.0   48122.0\n",
      "5  52922.0   54122.0\n",
      "6  57722.0   58922.0\n",
      "7  59522.0   60122.0\n",
      "8  63722.0   64922.0\n",
      "OD bus stations of transactions: \n",
      "            CardID LineCode       FDate   Time  plat Station\n",
      "0       542446139        1  1398/06/23  24030  A145    3169\n",
      "1      2620656172        1  1398/06/23  24302  A145    3169\n",
      "2      3446252780        1  1398/06/23  26200  A145    1227\n",
      "3         7900260        1  1398/06/23  29677  A145    3169\n",
      "4       361857972        1  1398/06/23  29720  A145    3169\n",
      "...           ...      ...         ...    ...   ...     ...\n",
      "37819  1591990884       16  1398/06/23  60083   A65    3534\n",
      "37820   173565446       16  1398/06/23  60103   A65    3534\n",
      "37821   112220947       16  1398/06/23  64806   A65    3359\n",
      "37822   112220947       16  1398/06/23  64808   A65    3359\n",
      "37823  2491608132       16  1398/06/23  64813   A65    3359\n",
      "\n",
      "[37824 rows x 6 columns]\n",
      "transactions in line 16 plat B39\n",
      "ps: \n",
      "              CardID  LineCode       FDate   Time plat\n",
      "694749  2118199204        16  1398/06/23  21840  B39\n",
      "694747  1529388686        16  1398/06/23  21898  B39\n",
      "694748  1529388686        16  1398/06/23  21901  B39\n",
      "694750  1360469354        16  1398/06/23  22287  B39\n",
      "694753   183519510        16  1398/06/23  22561  B39\n",
      "...            ...       ...         ...    ...  ...\n",
      "325086  1265929054        16  1398/06/23  74640  B39\n",
      "325087   808237026        16  1398/06/23  74761  B39\n",
      "325088   622939781        16  1398/06/23  75015  B39\n",
      "325089   721852829        16  1398/06/23  75311  B39\n",
      "325090   261678049        16  1398/06/23  75559  B39\n",
      "\n",
      "[673 rows x 5 columns]\n",
      "first row of the selected chunck : \n",
      " [2118199204 16 '1398/06/23' 21840 'B39']\n",
      "673\n",
      "t0 = 21840\n",
      "ts = 75559\n",
      "time_intervals 90\n",
      "Origin destination interval view reindex \n",
      "    time_in  time_out\n",
      "0  21840.0   22440.0\n",
      "1  29640.0   30840.0\n",
      "2  35040.0   35640.0\n",
      "3  40440.0   41040.0\n",
      "4  44640.0   45240.0\n",
      "5  46440.0   47640.0\n",
      "6  51840.0   53040.0\n",
      "7  57240.0   57840.0\n",
      "8  62040.0   63840.0\n",
      "9  70440.0   71040.0\n",
      "OD bus stations of transactions: \n",
      "            CardID LineCode       FDate   Time  plat Station\n",
      "0       542446139        1  1398/06/23  24030  A145    3169\n",
      "1      2620656172        1  1398/06/23  24302  A145    3169\n",
      "2      3446252780        1  1398/06/23  26200  A145    1227\n",
      "3         7900260        1  1398/06/23  29677  A145    3169\n",
      "4       361857972        1  1398/06/23  29720  A145    3169\n",
      "...           ...      ...         ...    ...   ...     ...\n",
      "38021  3650032516       16  1398/06/23  70924   B39    3534\n",
      "38022  2122879860       16  1398/06/23  70981   B39    3534\n",
      "38023  3207109301       16  1398/06/23  70986   B39    3534\n",
      "38024   341866404       16  1398/06/23  71040   B39    3534\n",
      "38025  3647960756       16  1398/06/23  71040   B39    3534\n",
      "\n",
      "[38026 rows x 6 columns]\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "C:\\Users\\esmaeli.h\\AppData\\Local\\Temp/ipykernel_12452/1949912630.py:257: ConvergenceWarning: Number of distinct clusters (38) found smaller than n_clusters (53). Possibly due to duplicate points in X.\n",
      "  kmeans = KMeans(n_clusters=len(filter_go_stations)-1,random_state=0).fit(partial_times.to_numpy())\n",
      "C:\\Users\\esmaeli.h\\AppData\\Local\\Temp/ipykernel_12452/1949912630.py:257: ConvergenceWarning: Number of distinct clusters (44) found smaller than n_clusters (53). Possibly due to duplicate points in X.\n",
      "  kmeans = KMeans(n_clusters=len(filter_go_stations)-1,random_state=0).fit(partial_times.to_numpy())\n",
      "C:\\Users\\esmaeli.h\\AppData\\Local\\Temp/ipykernel_12452/1949912630.py:257: ConvergenceWarning: Number of distinct clusters (50) found smaller than n_clusters (53). Possibly due to duplicate points in X.\n",
      "  kmeans = KMeans(n_clusters=len(filter_go_stations)-1,random_state=0).fit(partial_times.to_numpy())\n",
      "C:\\Users\\esmaeli.h\\AppData\\Local\\Temp/ipykernel_12452/1949912630.py:257: ConvergenceWarning: Number of distinct clusters (38) found smaller than n_clusters (53). Possibly due to duplicate points in X.\n",
      "  kmeans = KMeans(n_clusters=len(filter_go_stations)-1,random_state=0).fit(partial_times.to_numpy())\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "transactions in line 16 plat C17\n",
      "ps: \n",
      "              CardID  LineCode       FDate   Time plat\n",
      "395301   974049029        16  1398/06/23  25396  C17\n",
      "395302  2186625571        16  1398/06/23  25419  C17\n",
      "395303  3650276820        16  1398/06/23  25580  C17\n",
      "395311   869189766        16  1398/06/23  25583  C17\n",
      "395304   300339451        16  1398/06/23  25655  C17\n",
      "...            ...       ...         ...    ...  ...\n",
      "498324  1765073604        16  1398/06/23  75224  C17\n",
      "498325  2741003524        16  1398/06/23  75306  C17\n",
      "498326  3211385044        16  1398/06/23  75309  C17\n",
      "498327  3211385044        16  1398/06/23  75311  C17\n",
      "498328  2239180494        16  1398/06/23  75459  C17\n",
      "\n",
      "[652 rows x 5 columns]\n",
      "first row of the selected chunck : \n",
      " [974049029 16 '1398/06/23' 25396 'C17']\n",
      "652\n",
      "t0 = 25396\n",
      "ts = 75459\n",
      "time_intervals 83\n",
      "Origin destination interval view reindex \n",
      "    time_in  time_out\n",
      "0  25396.0   25996.0\n",
      "1  27196.0   27796.0\n",
      "2  28996.0   29596.0\n",
      "3  34396.0   34996.0\n",
      "4  45796.0   46996.0\n",
      "5  48796.0   49396.0\n",
      "6  51796.0   52396.0\n",
      "7  55996.0   57196.0\n",
      "8  61396.0   63196.0\n",
      "OD bus stations of transactions: \n",
      "            CardID LineCode       FDate   Time  plat Station\n",
      "0       542446139        1  1398/06/23  24030  A145    3169\n",
      "1      2620656172        1  1398/06/23  24302  A145    3169\n",
      "2      3446252780        1  1398/06/23  26200  A145    1227\n",
      "3         7900260        1  1398/06/23  29677  A145    3169\n",
      "4       361857972        1  1398/06/23  29720  A145    3169\n",
      "...           ...      ...         ...    ...   ...     ...\n",
      "38550   982215179       16  1398/06/23  63139   C17    3359\n",
      "38551   982215179       16  1398/06/23  63141   C17    3359\n",
      "38552   722069581       16  1398/06/23  63170   C17    3359\n",
      "38553  1527413214       16  1398/06/23  63183   C17    3359\n",
      "38554  3676033714       16  1398/06/23  63193   C17    3359\n",
      "\n",
      "[38555 rows x 6 columns]\n",
      "transactions in line 16 plat C24\n",
      "ps: \n",
      "              CardID  LineCode       FDate   Time plat\n",
      "477306  1407180371        16  1398/06/23  23689  C24\n",
      "477307  3180772910        16  1398/06/23  23809  C24\n",
      "477308  1598754836        16  1398/06/23  23833  C24\n",
      "477309  3631660988        16  1398/06/23  23839  C24\n",
      "477310   980529963        16  1398/06/23  23845  C24\n",
      "...            ...       ...         ...    ...  ...\n",
      "349242  2117446468        16  1398/06/23  77838  C24\n",
      "349245  2045027742        16  1398/06/23  77844  C24\n",
      "349246  4275744850        16  1398/06/23  78343  C24\n",
      "349247  4075883306        16  1398/06/23  78352  C24\n",
      "349248  4075883306        16  1398/06/23  78354  C24\n",
      "\n",
      "[655 rows x 5 columns]\n",
      "first row of the selected chunck : \n",
      " [1407180371 16 '1398/06/23' 23689 'C24']\n",
      "655\n",
      "t0 = 23689\n",
      "ts = 78354\n",
      "time_intervals 91\n",
      "Origin destination interval view reindex \n",
      "    time_in  time_out\n",
      "0  23689.0   24289.0\n",
      "1  30889.0   32689.0\n",
      "2  37489.0   38089.0\n",
      "3  47089.0   47689.0\n",
      "4  48889.0   50689.0\n",
      "5  54289.0   55489.0\n",
      "6  59089.0   61489.0\n",
      "7  74089.0   74689.0\n",
      "OD bus stations of transactions: \n",
      "            CardID LineCode       FDate   Time  plat Station\n",
      "0       542446139        1  1398/06/23  24030  A145    3169\n",
      "1      2620656172        1  1398/06/23  24302  A145    3169\n",
      "2      3446252780        1  1398/06/23  26200  A145    1227\n",
      "3         7900260        1  1398/06/23  29677  A145    3169\n",
      "4       361857972        1  1398/06/23  29720  A145    3169\n",
      "...           ...      ...         ...    ...   ...     ...\n",
      "38814   483291076       16  1398/06/23  74386   C24    3534\n",
      "38815  2526758322       16  1398/06/23  74390   C24    3534\n",
      "38816  2966385022       16  1398/06/23  74394   C24    3534\n",
      "38817  2742597108       16  1398/06/23  74401   C24    3534\n",
      "38818  3555383457       16  1398/06/23  74575   C24    3534\n",
      "\n",
      "[38819 rows x 6 columns]\n",
      "transactions in line 16 plat D47\n",
      "ps: \n",
      "              CardID  LineCode       FDate   Time plat\n",
      "525881  1527093406        16  1398/06/23  22569  D47\n",
      "525882   984978411        16  1398/06/23  22570  D47\n",
      "525883  1786605556        16  1398/06/23  22574  D47\n",
      "525884   426156686        16  1398/06/23  22928  D47\n",
      "525885  3205908540        16  1398/06/23  23198  D47\n",
      "...            ...       ...         ...    ...  ...\n",
      "568055  1415211545        16  1398/06/23  61971  D47\n",
      "568056  1612021003        16  1398/06/23  62140  D47\n",
      "568057   261312737        16  1398/06/23  62338  D47\n",
      "568058  2541796990        16  1398/06/23  62725  D47\n",
      "568531   983893387        16  1398/06/23  63457  D47\n",
      "\n",
      "[504 rows x 5 columns]\n",
      "first row of the selected chunck : \n",
      " [1527093406 16 '1398/06/23' 22569 'D47']\n",
      "504\n",
      "t0 = 22569\n",
      "ts = 63457\n",
      "time_intervals 68\n",
      "Origin destination interval view reindex \n",
      "    time_in  time_out\n",
      "0  22569.0   23169.0\n",
      "1  24969.0   27369.0\n",
      "2  29769.0   30369.0\n",
      "3  30969.0   32769.0\n",
      "4  41769.0   42369.0\n",
      "5  47169.0   48369.0\n",
      "6  51369.0   53769.0\n",
      "7  57369.0   58569.0\n",
      "OD bus stations of transactions: \n",
      "            CardID LineCode       FDate   Time  plat Station\n",
      "0       542446139        1  1398/06/23  24030  A145    3169\n",
      "1      2620656172        1  1398/06/23  24302  A145    3169\n",
      "2      3446252780        1  1398/06/23  26200  A145    1227\n",
      "3         7900260        1  1398/06/23  29677  A145    3169\n",
      "4       361857972        1  1398/06/23  29720  A145    3169\n",
      "...           ...      ...         ...    ...   ...     ...\n",
      "39343  3405859559       16  1398/06/23  53564   D47    3359\n",
      "39344  1832039069       16  1398/06/23  53751   D47    3359\n",
      "39345  4265656178       16  1398/06/23  53759   D47    3359\n",
      "39346   638449819       16  1398/06/23  58541   D47    3534\n",
      "39347   174593124       16  1398/06/23  58545   D47    3534\n",
      "\n",
      "[39348 rows x 6 columns]\n",
      "transactions in line 16 plat E131\n",
      "ps: \n",
      "              CardID  LineCode       FDate   Time  plat\n",
      "518478  3679033948        16  1398/06/23  21122  E131\n",
      "518480  1598454900        16  1398/06/23  21133  E131\n",
      "518479  2505494660        16  1398/06/23  21156  E131\n",
      "518481   722103202        16  1398/06/23  21295  E131\n",
      "518482   261750785        16  1398/06/23  21485  E131\n",
      "...            ...       ...         ...    ...   ...\n",
      "378132  3632003628        16  1398/06/23  78989  E131\n",
      "378133  3996686244        16  1398/06/23  79013  E131\n",
      "378134  3996686244        16  1398/06/23  79016  E131\n",
      "378135  1506100542        16  1398/06/23  80191  E131\n",
      "378136  4270484322        16  1398/06/23  80475  E131\n",
      "\n",
      "[319 rows x 5 columns]\n",
      "first row of the selected chunck : \n",
      " [3679033948 16 '1398/06/23' 21122 'E131']\n",
      "319\n",
      "t0 = 21122\n",
      "ts = 80475\n",
      "time_intervals 99\n",
      "Origin destination interval view reindex \n",
      "    time_in  time_out\n",
      "0  21122.0   21722.0\n",
      "1  23522.0   39722.0\n",
      "2  48722.0   49922.0\n",
      "3  53522.0   54722.0\n",
      "4  58922.0   60122.0\n",
      "5  64922.0   68522.0\n",
      "6  70922.0   78722.0\n",
      "7  79922.0   80522.0\n",
      "OD bus stations of transactions: \n",
      "            CardID LineCode       FDate   Time  plat Station\n",
      "0       542446139        1  1398/06/23  24030  A145    3169\n",
      "1      2620656172        1  1398/06/23  24302  A145    3169\n",
      "2      3446252780        1  1398/06/23  26200  A145    1227\n",
      "3         7900260        1  1398/06/23  29677  A145    3169\n",
      "4       361857972        1  1398/06/23  29720  A145    3169\n",
      "...           ...      ...         ...    ...   ...     ...\n",
      "39711   869289554       16  1398/06/23  78497  E131    3359\n",
      "39712   869289554       16  1398/06/23  78499  E131    3359\n",
      "39713  1001731070       16  1398/06/23  78568  E131    3359\n",
      "39714  1506100542       16  1398/06/23  80191  E131    3534\n",
      "39715  4270484322       16  1398/06/23  80475  E131    3534\n",
      "\n",
      "[39716 rows x 6 columns]\n",
      "transactions in line 16 plat E132\n",
      "ps: \n",
      "              CardID  LineCode       FDate   Time  plat\n",
      "622253  4266223186        16  1398/06/23  24101  E132\n",
      "622255  4059067741        16  1398/06/23  24623  E132\n",
      "622254  3254607373        16  1398/06/23  24630  E132\n",
      "622258  3630391500        16  1398/06/23  24918  E132\n",
      "622256  3105821013        16  1398/06/23  24919  E132\n",
      "...            ...       ...         ...    ...   ...\n",
      "19528   1615796773        16  1398/06/23  78317  E132\n",
      "19529   1615796773        16  1398/06/23  78318  E132\n",
      "19530   1775757636        16  1398/06/23  78341  E132\n",
      "19531   1775757636        16  1398/06/23  78343  E132\n",
      "19532   4057520525        16  1398/06/23  78527  E132\n",
      "\n",
      "[511 rows x 5 columns]\n",
      "first row of the selected chunck : \n",
      " [4266223186 16 '1398/06/23' 24101 'E132']\n",
      "511\n",
      "t0 = 24101\n",
      "ts = 78527\n",
      "time_intervals 91\n",
      "Origin destination interval view reindex \n",
      "     time_in  time_out\n",
      "0   24101.0   24701.0\n",
      "1   27701.0   29501.0\n",
      "2   32501.0   33101.0\n",
      "3   33701.0   34301.0\n",
      "4   39101.0   39701.0\n",
      "5   44501.0   45701.0\n",
      "6   47501.0   48101.0\n",
      "7   49301.0   51101.0\n",
      "8   54701.0   57101.0\n",
      "9   60701.0   62501.0\n",
      "10  64301.0   64901.0\n",
      "11  67901.0   68501.0\n",
      "12  70901.0   71501.0\n",
      "13  74501.0   77501.0\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "OD bus stations of transactions: \n",
      "            CardID LineCode       FDate   Time  plat Station\n",
      "0       542446139        1  1398/06/23  24030  A145    3169\n",
      "1      2620656172        1  1398/06/23  24302  A145    3169\n",
      "2      3446252780        1  1398/06/23  26200  A145    1227\n",
      "3         7900260        1  1398/06/23  29677  A145    3169\n",
      "4       361857972        1  1398/06/23  29720  A145    3169\n",
      "...           ...      ...         ...    ...   ...     ...\n",
      "39961   991318910       16  1398/06/23  67947  E132    3534\n",
      "39962  3405836368       16  1398/06/23  70937  E132    3359\n",
      "39963  3405836368       16  1398/06/23  70938  E132    3359\n",
      "39964  1776059940       16  1398/06/23  71239  E132    3359\n",
      "39965  1831764349       16  1398/06/23  77303  E132    3534\n",
      "\n",
      "[39966 rows x 6 columns]\n",
      "transactions in line 16 plat E188\n",
      "ps: \n",
      "              CardID  LineCode       FDate   Time  plat\n",
      "255879  3701223205        16  1398/06/23  23200  E188\n",
      "255880  3649896852        16  1398/06/23  23684  E188\n",
      "255881   261010033        16  1398/06/23  23949  E188\n",
      "255882  2541610878        16  1398/06/23  24115  E188\n",
      "255883  2182853651        16  1398/06/23  24118  E188\n",
      "...            ...       ...         ...    ...   ...\n",
      "306801    83465770        16  1398/06/23  76437  E188\n",
      "306802  3180927550        16  1398/06/23  77468  E188\n",
      "306803  3180927550        16  1398/06/23  77470  E188\n",
      "306804  3547397492        16  1398/06/23  77472  E188\n",
      "306805   722068738        16  1398/06/23  77481  E188\n",
      "\n",
      "[578 rows x 5 columns]\n",
      "first row of the selected chunck : \n",
      " [3701223205 16 '1398/06/23' 23200 'E188']\n",
      "578\n",
      "t0 = 23200\n",
      "ts = 77481\n",
      "time_intervals 90\n",
      "Origin destination interval view reindex \n",
      "    time_in  time_out\n",
      "0  23200.0   23800.0\n",
      "1  31600.0   33400.0\n",
      "2  37600.0   38200.0\n",
      "3  43600.0   44200.0\n",
      "4  52600.0   55000.0\n",
      "5  58000.0   60400.0\n",
      "6  71800.0   72400.0\n",
      "OD bus stations of transactions: \n",
      "            CardID LineCode       FDate   Time  plat Station\n",
      "0       542446139        1  1398/06/23  24030  A145    3169\n",
      "1      2620656172        1  1398/06/23  24302  A145    3169\n",
      "2      3446252780        1  1398/06/23  26200  A145    1227\n",
      "3         7900260        1  1398/06/23  29677  A145    3169\n",
      "4       361857972        1  1398/06/23  29720  A145    3169\n",
      "...           ...      ...         ...    ...   ...     ...\n",
      "40070   174495894       16  1398/06/23  60295  E188    3534\n",
      "40071   869273147       16  1398/06/23  60313  E188    3534\n",
      "40072   234090538       16  1398/06/23  60325  E188    3534\n",
      "40073   721789399       16  1398/06/23  60396  E188    3534\n",
      "40074  3794336108       16  1398/06/23  72196  E188    3359\n",
      "\n",
      "[40075 rows x 6 columns]\n",
      "transactions in line 16 plat E33\n",
      "ps: \n",
      "              CardID  LineCode       FDate   Time plat\n",
      "31640    984989403        16  1398/06/23  21480  E33\n",
      "31641   2741546132        16  1398/06/23  21519  E33\n",
      "31642   4245614967        16  1398/06/23  21522  E33\n",
      "31643   2740492148        16  1398/06/23  21686  E33\n",
      "31644    984167035        16  1398/06/23  21689  E33\n",
      "...            ...       ...         ...    ...  ...\n",
      "181893  2741470596        16  1398/06/23  80195  E33\n",
      "181894  2235598131        16  1398/06/23  80204  E33\n",
      "181895  3180261614        16  1398/06/23  80208  E33\n",
      "181896  4265772914        16  1398/06/23  80213  E33\n",
      "181897   262138913        16  1398/06/23  80223  E33\n",
      "\n",
      "[659 rows x 5 columns]\n",
      "first row of the selected chunck : \n",
      " [984989403 16 '1398/06/23' 21480 'E33']\n",
      "659\n",
      "t0 = 21480\n",
      "ts = 80223\n",
      "time_intervals 98\n",
      "Origin destination interval view reindex \n",
      "     time_in  time_out\n",
      "0   21480.0   22080.0\n",
      "1   23880.0   26280.0\n",
      "2   28680.0   29280.0\n",
      "3   29880.0   30480.0\n",
      "4   34680.0   35280.0\n",
      "5   40080.0   40680.0\n",
      "6   50280.0   52680.0\n",
      "7   56280.0   58080.0\n",
      "8   61680.0   63480.0\n",
      "9   66480.0   67680.0\n",
      "10  70680.0   71280.0\n",
      "11  72480.0   73080.0\n",
      "12  76680.0   78480.0\n",
      "OD bus stations of transactions: \n",
      "            CardID LineCode       FDate   Time  plat Station\n",
      "0       542446139        1  1398/06/23  24030  A145    3169\n",
      "1      2620656172        1  1398/06/23  24302  A145    3169\n",
      "2      3446252780        1  1398/06/23  26200  A145    1227\n",
      "3         7900260        1  1398/06/23  29677  A145    3169\n",
      "4       361857972        1  1398/06/23  29720  A145    3169\n",
      "...           ...      ...         ...    ...   ...     ...\n",
      "40665  2672030100       16  1398/06/23  72777   E33    3534\n",
      "40666  1957864852       16  1398/06/23  72778   E33    3534\n",
      "40667  3996949540       16  1398/06/23  72785   E33    3534\n",
      "40668  3646330420       16  1398/06/23  72838   E33    3534\n",
      "40669  1527993998       16  1398/06/23  78349   E33    3359\n",
      "\n",
      "[40670 rows x 6 columns]\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "C:\\Users\\esmaeli.h\\AppData\\Local\\Temp/ipykernel_12452/1949912630.py:257: ConvergenceWarning: Number of distinct clusters (51) found smaller than n_clusters (53). Possibly due to duplicate points in X.\n",
      "  kmeans = KMeans(n_clusters=len(filter_go_stations)-1,random_state=0).fit(partial_times.to_numpy())\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "transactions in line 16 plat E92\n",
      "ps: \n",
      "              CardID  LineCode       FDate   Time plat\n",
      "165083  3208398756        16  1398/06/23  21960  E92\n",
      "165084   362595940        16  1398/06/23  22320  E92\n",
      "165085  3678723036        16  1398/06/23  22320  E92\n",
      "165086   362176644        16  1398/06/23  22440  E92\n",
      "165087  1786570612        16  1398/06/23  23042  E92\n",
      "...            ...       ...         ...    ...  ...\n",
      "37982   3791821500        16  1398/06/23  75093  E92\n",
      "37983   3791821500        16  1398/06/23  75094  E92\n",
      "37984   4246204199        16  1398/06/23  75480  E92\n",
      "37985   3631770460        16  1398/06/23  75516  E92\n",
      "37986    362739092        16  1398/06/23  75722  E92\n",
      "\n",
      "[509 rows x 5 columns]\n",
      "first row of the selected chunck : \n",
      " [3208398756 16 '1398/06/23' 21960 'E92']\n",
      "509\n",
      "t0 = 21960\n",
      "ts = 75722\n",
      "time_intervals 90\n",
      "Origin destination interval view reindex \n",
      "    time_in  time_out\n",
      "0  21960.0   22560.0\n",
      "1  24960.0   26760.0\n",
      "2  30960.0   31560.0\n",
      "3  40560.0   42360.0\n",
      "4  51960.0   53760.0\n",
      "5  56160.0   58560.0\n",
      "6  63360.0   65160.0\n",
      "OD bus stations of transactions: \n",
      "            CardID LineCode       FDate   Time  plat Station\n",
      "0       542446139        1  1398/06/23  24030  A145    3169\n",
      "1      2620656172        1  1398/06/23  24302  A145    3169\n",
      "2      3446252780        1  1398/06/23  26200  A145    1227\n",
      "3         7900260        1  1398/06/23  29677  A145    3169\n",
      "4       361857972        1  1398/06/23  29720  A145    3169\n",
      "...           ...      ...         ...    ...   ...     ...\n",
      "41034  2124498212       16  1398/06/23  64958   E92    3359\n",
      "41035  1530006270       16  1398/06/23  65040   E92    3359\n",
      "41036  1527492718       16  1398/06/23  65145   E92    3359\n",
      "41037  2962326821       16  1398/06/23  65156   E92    3359\n",
      "41038  2962326821       16  1398/06/23  65158   E92    3359\n",
      "\n",
      "[41039 rows x 6 columns]\n",
      "transactions in line 16 plat F149\n",
      "ps: \n",
      "              CardID  LineCode       FDate   Time  plat\n",
      "412202   721866177        16  1398/06/23  23954  F149\n",
      "412199  2741692884        16  1398/06/23  24001  F149\n",
      "412200  1416049385        16  1398/06/23  24011  F149\n",
      "412201  4265671714        16  1398/06/23  24037  F149\n",
      "412203  3701421317        16  1398/06/23  24284  F149\n",
      "...            ...       ...         ...    ...   ...\n",
      "442229  1797519195        16  1398/06/23  76872  F149\n",
      "442230  1797519195        16  1398/06/23  76873  F149\n",
      "442231  3208524917        16  1398/06/23  77188  F149\n",
      "442232  2681128340        16  1398/06/23  77191  F149\n",
      "442233  3555763137        16  1398/06/23  77376  F149\n",
      "\n",
      "[562 rows x 5 columns]\n",
      "first row of the selected chunck : \n",
      " [721866177 16 '1398/06/23' 23954 'F149']\n",
      "562\n",
      "t0 = 23954\n",
      "ts = 77376\n",
      "time_intervals 89\n",
      "Origin destination interval view reindex \n",
      "     time_in  time_out\n",
      "0   23954.0   24554.0\n",
      "1   26354.0   26954.0\n",
      "2   27554.0   28154.0\n",
      "3   31754.0   32354.0\n",
      "4   37154.0   37754.0\n",
      "5   41954.0   42554.0\n",
      "6   46754.0   47354.0\n",
      "7   47954.0   49754.0\n",
      "8   53954.0   55154.0\n",
      "9   58754.0   61154.0\n",
      "10  72554.0   73754.0\n",
      "OD bus stations of transactions: \n",
      "            CardID LineCode       FDate   Time  plat Station\n",
      "0       542446139        1  1398/06/23  24030  A145    3169\n",
      "1      2620656172        1  1398/06/23  24302  A145    3169\n",
      "2      3446252780        1  1398/06/23  26200  A145    1227\n",
      "3         7900260        1  1398/06/23  29677  A145    3169\n",
      "4       361857972        1  1398/06/23  29720  A145    3169\n",
      "...           ...      ...         ...    ...   ...     ...\n",
      "41288   261976497       16  1398/06/23  73207  F149    3359\n",
      "41289   335955113       16  1398/06/23  73706  F149    3359\n",
      "41290  4279130914       16  1398/06/23  73712  F149    3359\n",
      "41291   537622670       16  1398/06/23  73717  F149    3359\n",
      "41292  1407175854       16  1398/06/23  73743  F149    3359\n",
      "\n",
      "[41293 rows x 6 columns]\n",
      "transactions in line 16 plat F176\n",
      "ps: \n",
      "              CardID  LineCode       FDate   Time  plat\n",
      "24587    483197236        16  1398/06/23  21643  F176\n",
      "24588   1844788068        16  1398/06/23  21786  F176\n",
      "24589   1407227239        16  1398/06/23  21788  F176\n",
      "24590   3183392734        16  1398/06/23  21793  F176\n",
      "24591   3792323772        16  1398/06/23  21982  F176\n",
      "...            ...       ...         ...    ...   ...\n",
      "270347  3205962004        16  1398/06/23  27106  F176\n",
      "270348  3678944380        16  1398/06/23  27594  F176\n",
      "270349  2127980820        16  1398/06/23  27598  F176\n",
      "270350  3180942590        16  1398/06/23  27615  F176\n",
      "270351   982255787        16  1398/06/23  27694  F176\n",
      "\n",
      "[85 rows x 5 columns]\n",
      "first row of the selected chunck : \n",
      " [483197236 16 '1398/06/23' 21643 'F176']\n",
      "85\n",
      "t0 = 21643\n",
      "ts = 27694\n",
      "time_intervals 10\n",
      "Origin destination interval view reindex \n",
      "    time_in  time_out\n",
      "0  21643.0   22243.0\n",
      "1  22843.0   25243.0\n",
      "OD bus stations of transactions: \n",
      "            CardID LineCode       FDate   Time  plat Station\n",
      "0       542446139        1  1398/06/23  24030  A145    3169\n",
      "1      2620656172        1  1398/06/23  24302  A145    3169\n",
      "2      3446252780        1  1398/06/23  26200  A145    1227\n",
      "3         7900260        1  1398/06/23  29677  A145    3169\n",
      "4       361857972        1  1398/06/23  29720  A145    3169\n",
      "...           ...      ...         ...    ...   ...     ...\n",
      "41538   298896795       16  1398/06/23  25225  F176    3534\n",
      "41539   362255460       16  1398/06/23  25227  F176    3534\n",
      "41540   645894925       16  1398/06/23  25228  F176    3534\n",
      "41541  1844882452       16  1398/06/23  25230  F176    3534\n",
      "41542  1844882452       16  1398/06/23  25233  F176    3534\n",
      "\n",
      "[41543 rows x 6 columns]\n",
      "transactions in line 16 plat M45\n",
      "ps: \n",
      "              CardID  LineCode       FDate   Time plat\n",
      "23732   3701003973        16  1398/06/23  25317  M45\n",
      "23736   2116760644        16  1398/06/23  25372  M45\n",
      "23733    483291076        16  1398/06/23  25397  M45\n",
      "23737   3213252980        16  1398/06/23  25441  M45\n",
      "23738   3553255948        16  1398/06/23  25447  M45\n",
      "...            ...       ...         ...    ...  ...\n",
      "541959  3405775979        16  1398/06/23  77788  M45\n",
      "541960  3553245212        16  1398/06/23  78519  M45\n",
      "541961   721938476        16  1398/06/23  78708  M45\n",
      "541962  1595469748        16  1398/06/23  78940  M45\n",
      "541963  1595469748        16  1398/06/23  78942  M45\n",
      "\n",
      "[644 rows x 5 columns]\n",
      "first row of the selected chunck : \n",
      " [3701003973 16 '1398/06/23' 25317 'M45']\n",
      "644\n",
      "t0 = 25317\n",
      "ts = 78942\n",
      "time_intervals 89\n",
      "Origin destination interval view reindex \n",
      "    time_in  time_out\n",
      "0  25317.0   25917.0\n",
      "1  34317.0   37317.0\n",
      "2  42117.0   43917.0\n",
      "3  48717.0   49917.0\n",
      "4  54717.0   55917.0\n",
      "5  59517.0   61317.0\n",
      "6  69117.0   69717.0\n",
      "7  73317.0   73917.0\n",
      "OD bus stations of transactions: \n",
      "            CardID LineCode       FDate   Time  plat Station\n",
      "0       542446139        1  1398/06/23  24030  A145    3169\n",
      "1      2620656172        1  1398/06/23  24302  A145    3169\n",
      "2      3446252780        1  1398/06/23  26200  A145    1227\n",
      "3         7900260        1  1398/06/23  29677  A145    3169\n",
      "4       361857972        1  1398/06/23  29720  A145    3169\n",
      "...           ...      ...         ...    ...   ...     ...\n",
      "41600   175007204       16  1398/06/23  61175   M45    3534\n",
      "41601   175007204       16  1398/06/23  61176   M45    3534\n",
      "41602  3405793683       16  1398/06/23  61231   M45    3534\n",
      "41603  1831988493       16  1398/06/23  69502   M45    3359\n",
      "41604  4270486546       16  1398/06/23  73393   M45    3534\n",
      "\n",
      "[41605 rows x 6 columns]\n",
      "transactions in line 16 plat M77\n",
      "ps: \n",
      "              CardID  LineCode       FDate   Time plat\n",
      "107436   721805690        16  1398/06/23  22463  M77\n",
      "107439  2740897044        16  1398/06/23  22539  M77\n",
      "107437   260851601        16  1398/06/23  22661  M77\n",
      "107438   182281638        16  1398/06/23  22715  M77\n",
      "107440  3678326380        16  1398/06/23  22723  M77\n",
      "...            ...       ...         ...    ...  ...\n",
      "111598  3107414837        16  1398/06/23  75300  M77\n",
      "111599   980823723        16  1398/06/23  75940  M77\n",
      "111600  4266441346        16  1398/06/23  76143  M77\n",
      "111601  1595366708        16  1398/06/23  76147  M77\n",
      "111602  4240980023        16  1398/06/23  76279  M77\n",
      "\n",
      "[604 rows x 5 columns]\n",
      "first row of the selected chunck : \n",
      " [721805690 16 '1398/06/23' 22463 'M77']\n",
      "604\n",
      "t0 = 22463\n",
      "ts = 76279\n",
      "time_intervals 90\n",
      "Origin destination interval view reindex \n",
      "     time_in  time_out\n",
      "0   22463.0   23063.0\n",
      "1   24863.0   25463.0\n",
      "2   26063.0   26663.0\n",
      "3   30263.0   30863.0\n",
      "4   35663.0   36263.0\n",
      "5   40463.0   41063.0\n",
      "6   47663.0   48263.0\n",
      "7   52463.0   53663.0\n",
      "8   57263.0   58463.0\n",
      "9   63263.0   64463.0\n",
      "10  71663.0   72263.0\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "OD bus stations of transactions: \n",
      "            CardID LineCode       FDate   Time  plat Station\n",
      "0       542446139        1  1398/06/23  24030  A145    3169\n",
      "1      2620656172        1  1398/06/23  24302  A145    3169\n",
      "2      3446252780        1  1398/06/23  26200  A145    1227\n",
      "3         7900260        1  1398/06/23  29677  A145    3169\n",
      "4       361857972        1  1398/06/23  29720  A145    3169\n",
      "...           ...      ...         ...    ...   ...     ...\n",
      "42081  3675838978       16  1398/06/23  71974   M77    3359\n",
      "42082   869207812       16  1398/06/23  72009   M77    3359\n",
      "42083  3154110686       16  1398/06/23  72181   M77    3359\n",
      "42084  3154110686       16  1398/06/23  72183   M77    3359\n",
      "42085   209217739       16  1398/06/23  72262   M77    3359\n",
      "\n",
      "[42086 rows x 6 columns]\n",
      "transactions in line 16 plat N175\n",
      "ps: \n",
      "              CardID  LineCode       FDate   Time  plat\n",
      "19533    722026046        16  1398/06/23  24986  N175\n",
      "19534   4245655767        16  1398/06/23  25010  N175\n",
      "19535   3776341285        16  1398/06/23  25050  N175\n",
      "19536   3678660844        16  1398/06/23  25185  N175\n",
      "19537    235388138        16  1398/06/23  25193  N175\n",
      "...            ...       ...         ...    ...   ...\n",
      "401487  3108941109        16  1398/06/23  74457  N175\n",
      "401488  3108941109        16  1398/06/23  74458  N175\n",
      "401489  3108941109        16  1398/06/23  74460  N175\n",
      "401492  1832132429        16  1398/06/23  74669  N175\n",
      "401493  1294303150        16  1398/06/23  74691  N175\n",
      "\n",
      "[775 rows x 5 columns]\n",
      "first row of the selected chunck : \n",
      " [722026046 16 '1398/06/23' 24986 'N175']\n",
      "775\n",
      "t0 = 24986\n",
      "ts = 74691\n",
      "time_intervals 83\n",
      "Origin destination interval view reindex \n",
      "    time_in  time_out\n",
      "0  24986.0   25586.0\n",
      "1  33386.0   33986.0\n",
      "2  39386.0   39986.0\n",
      "3  50186.0   51986.0\n",
      "4  56186.0   56786.0\n",
      "5  60386.0   62786.0\n",
      "6  68186.0   68786.0\n",
      "OD bus stations of transactions: \n",
      "            CardID LineCode       FDate   Time  plat Station\n",
      "0       542446139        1  1398/06/23  24030  A145    3169\n",
      "1      2620656172        1  1398/06/23  24302  A145    3169\n",
      "2      3446252780        1  1398/06/23  26200  A145    1227\n",
      "3         7900260        1  1398/06/23  29677  A145    3169\n",
      "4       361857972        1  1398/06/23  29720  A145    3169\n",
      "...           ...      ...         ...    ...   ...     ...\n",
      "42557  1506100542       16  1398/06/23  68714  N175    3359\n",
      "42558   721866509       16  1398/06/23  68719  N175    3359\n",
      "42559   721866509       16  1398/06/23  68721  N175    3359\n",
      "42560  3629887020       16  1398/06/23  68756  N175    3359\n",
      "42561  2505334916       16  1398/06/23  68763  N175    3359\n",
      "\n",
      "[42562 rows x 6 columns]\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "C:\\Users\\esmaeli.h\\AppData\\Local\\Temp/ipykernel_12452/1949912630.py:257: ConvergenceWarning: Number of distinct clusters (51) found smaller than n_clusters (53). Possibly due to duplicate points in X.\n",
      "  kmeans = KMeans(n_clusters=len(filter_go_stations)-1,random_state=0).fit(partial_times.to_numpy())\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "transactions in line 16 plat N182\n",
      "ps: \n",
      "              CardID  LineCode       FDate   Time  plat\n",
      "182121  2115759012        16  1398/06/23  24558  N182\n",
      "182122  1611927099        16  1398/06/23  24634  N182\n",
      "182123  1214241278        16  1398/06/23  24765  N182\n",
      "182124  1001512366        16  1398/06/23  24800  N182\n",
      "182125     7976372        16  1398/06/23  24864  N182\n",
      "...            ...       ...         ...    ...   ...\n",
      "30250   3794439276        16  1398/06/23  78742  N182\n",
      "30251   4058606173        16  1398/06/23  78760  N182\n",
      "30252    113762131        16  1398/06/23  78880  N182\n",
      "30253    211121564        16  1398/06/23  79505  N182\n",
      "30254   2239139524        16  1398/06/23  79519  N182\n",
      "\n",
      "[632 rows x 5 columns]\n",
      "first row of the selected chunck : \n",
      " [2115759012 16 '1398/06/23' 24558 'N182']\n",
      "632\n",
      "t0 = 24558\n",
      "ts = 79519\n",
      "time_intervals 92\n",
      "Origin destination interval view reindex \n",
      "    time_in  time_out\n",
      "0  24558.0   25158.0\n",
      "1  32358.0   33558.0\n",
      "2  38358.0   38958.0\n",
      "3  49158.0   50958.0\n",
      "4  55158.0   56358.0\n",
      "5  59958.0   61758.0\n",
      "6  67758.0   68358.0\n",
      "7  74358.0   76158.0\n",
      "OD bus stations of transactions: \n",
      "            CardID LineCode       FDate   Time  plat Station\n",
      "0       542446139        1  1398/06/23  24030  A145    3169\n",
      "1      2620656172        1  1398/06/23  24302  A145    3169\n",
      "2      3446252780        1  1398/06/23  26200  A145    1227\n",
      "3         7900260        1  1398/06/23  29677  A145    3169\n",
      "4       361857972        1  1398/06/23  29720  A145    3169\n",
      "...           ...      ...         ...    ...   ...     ...\n",
      "43260   428643758       16  1398/06/23  68072  N182    3359\n",
      "43261  3793039004       16  1398/06/23  68078  N182    3359\n",
      "43262  3793039004       16  1398/06/23  68079  N182    3359\n",
      "43263   722149835       16  1398/06/23  75881  N182    3534\n",
      "43264  3700250021       16  1398/06/23  76010  N182    3534\n",
      "\n",
      "[43265 rows x 6 columns]\n",
      "transactions in line 16 plat N82\n",
      "ps: \n",
      "              CardID  LineCode       FDate   Time plat\n",
      "401494  1292414254        16  1398/06/23  22578  N82\n",
      "401495  2498055396        16  1398/06/23  22582  N82\n",
      "401496  2498055396        16  1398/06/23  22584  N82\n",
      "401497  4059717437        16  1398/06/23  23131  N82\n",
      "401498   474633386        16  1398/06/23  23244  N82\n",
      "...            ...       ...         ...    ...  ...\n",
      "515012  3553771932        16  1398/06/23  76122  N82\n",
      "515013   869289222        16  1398/06/23  76437  N82\n",
      "515014   361089700        16  1398/06/23  76649  N82\n",
      "515015   722263328        16  1398/06/23  76657  N82\n",
      "515016  2506152996        16  1398/06/23  76947  N82\n",
      "\n",
      "[584 rows x 5 columns]\n",
      "first row of the selected chunck : \n",
      " [1292414254 16 '1398/06/23' 22578 'N82']\n",
      "584\n",
      "t0 = 22578\n",
      "ts = 76947\n",
      "time_intervals 91\n",
      "Origin destination interval view reindex \n",
      "    time_in  time_out\n",
      "0  22578.0   23178.0\n",
      "1  25578.0   27378.0\n",
      "2  32178.0   32778.0\n",
      "3  42378.0   42978.0\n",
      "4  52578.0   54978.0\n",
      "5  57978.0   59778.0\n",
      "6  63978.0   64578.0\n",
      "OD bus stations of transactions: \n",
      "            CardID LineCode       FDate   Time  plat Station\n",
      "0       542446139        1  1398/06/23  24030  A145    3169\n",
      "1      2620656172        1  1398/06/23  24302  A145    3169\n",
      "2      3446252780        1  1398/06/23  26200  A145    1227\n",
      "3         7900260        1  1398/06/23  29677  A145    3169\n",
      "4       361857972        1  1398/06/23  29720  A145    3169\n",
      "...           ...      ...         ...    ...   ...     ...\n",
      "43815  3259207821       16  1398/06/23  59623   N82    3534\n",
      "43816   262363233       16  1398/06/23  59638   N82    3534\n",
      "43817  2742084452       16  1398/06/23  59708   N82    3534\n",
      "43818   869220211       16  1398/06/23  59734   N82    3534\n",
      "43819   646129597       16  1398/06/23  64533   N82    3359\n",
      "\n",
      "[43820 rows x 6 columns]\n",
      "stations in a specefic bus line 17\n",
      "len-of-go stations: 32\n",
      "len-of-back stations: 30\n",
      "len-of-go back stations: 0\n",
      "first Station  [1125 '17' '1' 'go' '????? ??????  ??????-17' 51.651299 32.675604 'od'\n",
      " 'normal' 'no'] 1125\n",
      "last Station  [1879 '17' '1' 'back' '?????? ??? ??????? -44-17' 51.690707 32.683393 'od'\n",
      " 'normal' 'yes']\n",
      "['A117' 'A126' 'A129' 'A38' 'F118' 'F183' 'F58' 'F74' 'M149' 'M153']\n",
      "transactions in line 17 plat A117\n",
      "ps: \n",
      "              CardID  LineCode       FDate   Time  plat\n",
      "255777  3405944883        17  1398/06/23  23135  A117\n",
      "255779   735918672        17  1398/06/23  23839  A117\n",
      "255781  2239115569        17  1398/06/23  24036  A117\n",
      "255783  3631444924        17  1398/06/23  24182  A117\n",
      "255785  1610910795        17  1398/06/23  25527  A117\n",
      "...            ...       ...         ...    ...   ...\n",
      "245225  2658364908        17  1398/06/23  76537  A117\n",
      "245227  2658364908        17  1398/06/23  76538  A117\n",
      "245224  2504873108        17  1398/06/23  76551  A117\n",
      "245229   722245364        17  1398/06/23  77208  A117\n",
      "245231   722245364        17  1398/06/23  77211  A117\n",
      "\n",
      "[338 rows x 5 columns]\n",
      "first row of the selected chunck : \n",
      " [3405944883 17 '1398/06/23' 23135 'A117']\n",
      "338\n",
      "t0 = 23135\n",
      "ts = 77211\n",
      "time_intervals 90\n",
      "Origin destination interval view reindex \n",
      "    time_in  time_out\n",
      "0  23135.0   24335.0\n",
      "1  24935.0   25535.0\n",
      "2  26135.0   32135.0\n",
      "3  42335.0   42935.0\n",
      "4  45935.0   46535.0\n",
      "5  53735.0   54335.0\n",
      "6  57335.0   58535.0\n",
      "7  64535.0   65135.0\n",
      "8  65735.0   66935.0\n",
      "9  74135.0   75935.0\n",
      "OD bus stations of transactions: \n",
      "            CardID LineCode       FDate   Time  plat Station\n",
      "0       542446139        1  1398/06/23  24030  A145    3169\n",
      "1      2620656172        1  1398/06/23  24302  A145    3169\n",
      "2      3446252780        1  1398/06/23  26200  A145    1227\n",
      "3         7900260        1  1398/06/23  29677  A145    3169\n",
      "4       361857972        1  1398/06/23  29720  A145    3169\n",
      "...           ...      ...         ...    ...   ...     ...\n",
      "44162   261515409       17  1398/06/23  75735  A117    1879\n",
      "44163  3791742012       17  1398/06/23  75783  A117    1879\n",
      "44164  3791742012       17  1398/06/23  75786  A117    1879\n",
      "44165  3791742012       17  1398/06/23  75789  A117    1879\n",
      "44166  3791742012       17  1398/06/23  75792  A117    1879\n",
      "\n",
      "[44167 rows x 6 columns]\n",
      "transactions in line 17 plat A126\n",
      "ps: \n",
      "              CardID  LineCode       FDate   Time  plat\n",
      "140396  4058544029        17  1398/06/23  21963  A126\n",
      "140397   677988222        17  1398/06/23  21975  A126\n",
      "140399  3405844396        17  1398/06/23  21991  A126\n",
      "140398  3701098885        17  1398/06/23  22084  A126\n",
      "140400  2665053916        17  1398/06/23  22288  A126\n",
      "...            ...       ...         ...    ...   ...\n",
      "22046   3179753550        17  1398/06/23  77618  A126\n",
      "22047   3679812428        17  1398/06/23  77904  A126\n",
      "22048   3631535836        17  1398/06/23  78203  A126\n",
      "22049   1001252478        17  1398/06/23  78223  A126\n",
      "22050   1001252478        17  1398/06/23  78224  A126\n",
      "\n",
      "[327 rows x 5 columns]\n",
      "first row of the selected chunck : \n",
      " [4058544029 17 '1398/06/23' 21963 'A126']\n",
      "327\n",
      "t0 = 21963\n",
      "ts = 78224\n",
      "time_intervals 94\n",
      "Origin destination interval view reindex \n",
      "     time_in  time_out\n",
      "0   21963.0   22563.0\n",
      "1   24363.0   24963.0\n",
      "2   30963.0   33963.0\n",
      "3   37563.0   38163.0\n",
      "4   39363.0   39963.0\n",
      "5   42963.0   43563.0\n",
      "6   47163.0   48363.0\n",
      "7   50763.0   53163.0\n",
      "8   54963.0   55563.0\n",
      "9   58563.0   59163.0\n",
      "10  60363.0   60963.0\n",
      "11  62163.0   63363.0\n",
      "12  66363.0   66963.0\n",
      "13  69963.0   70563.0\n",
      "14  75363.0   76563.0\n",
      "OD bus stations of transactions: \n",
      "            CardID LineCode       FDate   Time  plat Station\n",
      "0       542446139        1  1398/06/23  24030  A145    3169\n",
      "1      2620656172        1  1398/06/23  24302  A145    3169\n",
      "2      3446252780        1  1398/06/23  26200  A145    1227\n",
      "3         7900260        1  1398/06/23  29677  A145    3169\n",
      "4       361857972        1  1398/06/23  29720  A145    3169\n",
      "...           ...      ...         ...    ...   ...     ...\n",
      "44482   722219954       17  1398/06/23  63055  A126    1879\n",
      "44483  1832866685       17  1398/06/23  66657  A126    1125\n",
      "44484  1002584359       17  1398/06/23  70196  A126    1879\n",
      "44485  1002584359       17  1398/06/23  70198  A126    1879\n",
      "44486   300244059       17  1398/06/23  76100  A126    1125\n",
      "\n",
      "[44487 rows x 6 columns]\n",
      "transactions in line 17 plat A129\n",
      "ps: \n",
      "              CardID  LineCode       FDate   Time  plat\n",
      "251133  3630612060        17  1398/06/23  36146  A129\n",
      "251135  4265303426        17  1398/06/23  36151  A129\n",
      "251138   427358862        17  1398/06/23  36155  A129\n",
      "251141   710842181        17  1398/06/23  36254  A129\n",
      "251144  2680320126        17  1398/06/23  36295  A129\n",
      "...            ...       ...         ...    ...   ...\n",
      "258526  3257977901        17  1398/06/23  74541  A129\n",
      "258652  4257101252        17  1398/06/23  75759  A129\n",
      "258654  2500249428        17  1398/06/23  75887  A129\n",
      "258657  1832751565        17  1398/06/23  75901  A129\n",
      "258661  2491955636        17  1398/06/23  76069  A129\n",
      "\n",
      "[263 rows x 5 columns]\n",
      "first row of the selected chunck : \n",
      " [3630612060 17 '1398/06/23' 36146 'A129']\n",
      "263\n",
      "t0 = 36146\n",
      "ts = 76069\n",
      "time_intervals 67\n",
      "Origin destination interval view reindex \n",
      "     time_in  time_out\n",
      "0   36146.0   36746.0\n",
      "1   42746.0   43946.0\n",
      "2   46946.0   47546.0\n",
      "3   51146.0   51746.0\n",
      "4   55946.0   56546.0\n",
      "5   57746.0   58346.0\n",
      "6   61346.0   63146.0\n",
      "7   65546.0   66746.0\n",
      "8   69746.0   70346.0\n",
      "9   70946.0   74546.0\n",
      "10  75146.0   76346.0\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "OD bus stations of transactions: \n",
      "            CardID LineCode       FDate   Time  plat Station\n",
      "0       542446139        1  1398/06/23  24030  A145    3169\n",
      "1      2620656172        1  1398/06/23  24302  A145    3169\n",
      "2      3446252780        1  1398/06/23  26200  A145    1227\n",
      "3         7900260        1  1398/06/23  29677  A145    3169\n",
      "4       361857972        1  1398/06/23  29720  A145    3169\n",
      "...           ...      ...         ...    ...   ...     ...\n",
      "44626  3257977901       17  1398/06/23  74541  A129    1879\n",
      "44627  4257101252       17  1398/06/23  75759  A129    1125\n",
      "44628  2500249428       17  1398/06/23  75887  A129    1125\n",
      "44629  1832751565       17  1398/06/23  75901  A129    1125\n",
      "44630  2491955636       17  1398/06/23  76069  A129    1125\n",
      "\n",
      "[44631 rows x 6 columns]\n",
      "transactions in line 17 plat A38\n",
      "ps: \n",
      "              CardID  LineCode       FDate   Time plat\n",
      "594716   869183356        17  1398/06/23  34615  A38\n",
      "594717  1765663316        17  1398/06/23  34711  A38\n",
      "594718  4244666135        17  1398/06/23  35119  A38\n",
      "594719  2125450740        17  1398/06/23  35902  A38\n",
      "594722   342711444        17  1398/06/23  36005  A38\n",
      "...            ...       ...         ...    ...  ...\n",
      "621062  2044220734        17  1398/06/23  75073  A38\n",
      "621063  2044220734        17  1398/06/23  75074  A38\n",
      "621064   480361540        17  1398/06/23  75082  A38\n",
      "594714     3860247        17  1398/06/23  77221  A38\n",
      "594715     3860247        17  1398/06/23  77225  A38\n",
      "\n",
      "[182 rows x 5 columns]\n",
      "first row of the selected chunck : \n",
      " [869183356 17 '1398/06/23' 34615 'A38']\n",
      "182\n",
      "t0 = 34615\n",
      "ts = 77225\n",
      "time_intervals 71\n",
      "Origin destination interval view reindex \n",
      "     time_in  time_out\n",
      "0   34615.0   35215.0\n",
      "1   35815.0   36415.0\n",
      "2   37615.0   38815.0\n",
      "3   39415.0   40015.0\n",
      "4   41215.0   43015.0\n",
      "5   45415.0   46015.0\n",
      "6   49015.0   50215.0\n",
      "7   53215.0   53815.0\n",
      "8   59815.0   60415.0\n",
      "9   67015.0   68815.0\n",
      "10  70615.0   71815.0\n",
      "11  74815.0   75415.0\n",
      "12  76015.0   77215.0\n",
      "OD bus stations of transactions: \n",
      "            CardID LineCode       FDate   Time  plat Station\n",
      "0       542446139        1  1398/06/23  24030  A145    3169\n",
      "1      2620656172        1  1398/06/23  24302  A145    3169\n",
      "2      3446252780        1  1398/06/23  26200  A145    1227\n",
      "3         7900260        1  1398/06/23  29677  A145    3169\n",
      "4       361857972        1  1398/06/23  29720  A145    3169\n",
      "...           ...      ...         ...    ...   ...     ...\n",
      "44804  3446756748       17  1398/06/23  71783   A38    1125\n",
      "44805  3446756748       17  1398/06/23  71784   A38    1125\n",
      "44806  2044220734       17  1398/06/23  75073   A38    1879\n",
      "44807  2044220734       17  1398/06/23  75074   A38    1879\n",
      "44808   480361540       17  1398/06/23  75082   A38    1879\n",
      "\n",
      "[44809 rows x 6 columns]\n",
      "transactions in line 17 plat F118\n",
      "ps: \n",
      "              CardID  LineCode       FDate   Time  plat\n",
      "70307    182101878        17  1398/06/23  21739  F118\n",
      "70309   3675781090        17  1398/06/23  23338  F118\n",
      "70311    869432295        17  1398/06/23  23353  F118\n",
      "70313    426547486        17  1398/06/23  23493  F118\n",
      "70315   1371741054        17  1398/06/23  23576  F118\n",
      "...            ...       ...         ...    ...   ...\n",
      "245259  3792051628        17  1398/06/23  75207  F118\n",
      "245261   869409482        17  1398/06/23  75468  F118\n",
      "245645  3151283166        17  1398/06/23  76198  F118\n",
      "245647   174873766        17  1398/06/23  76249  F118\n",
      "245649   182101878        17  1398/06/23  77193  F118\n",
      "\n",
      "[323 rows x 5 columns]\n",
      "first row of the selected chunck : \n",
      " [182101878 17 '1398/06/23' 21739 'F118']\n",
      "323\n",
      "t0 = 21739\n",
      "ts = 77193\n",
      "time_intervals 92\n",
      "Origin destination interval view reindex \n",
      "     time_in  time_out\n",
      "0   21739.0   23539.0\n",
      "1   25939.0   26539.0\n",
      "2   28939.0   29539.0\n",
      "3   33739.0   34339.0\n",
      "4   36139.0   37339.0\n",
      "5   44539.0   45739.0\n",
      "6   46339.0   46939.0\n",
      "7   49939.0   50539.0\n",
      "8   51139.0   51739.0\n",
      "9   53539.0   54139.0\n",
      "10  55939.0   56539.0\n",
      "11  57139.0   57739.0\n",
      "12  58339.0   58939.0\n",
      "13  60739.0   61339.0\n",
      "14  64939.0   65539.0\n",
      "OD bus stations of transactions: \n",
      "            CardID LineCode       FDate   Time  plat Station\n",
      "0       542446139        1  1398/06/23  24030  A145    3169\n",
      "1      2620656172        1  1398/06/23  24302  A145    3169\n",
      "2      3446252780        1  1398/06/23  26200  A145    1227\n",
      "3         7900260        1  1398/06/23  29677  A145    3169\n",
      "4       361857972        1  1398/06/23  29720  A145    3169\n",
      "...           ...      ...         ...    ...   ...     ...\n",
      "44915  3650148084       17  1398/06/23  65086  F118    1125\n",
      "44916  2743002772       17  1398/06/23  65255  F118    1125\n",
      "44917  2504418916       17  1398/06/23  65257  F118    1125\n",
      "44918  2742566820       17  1398/06/23  65408  F118    1125\n",
      "44919  2742566820       17  1398/06/23  65409  F118    1125\n",
      "\n",
      "[44920 rows x 6 columns]\n",
      "transactions in line 17 plat F183\n",
      "ps: \n",
      "              CardID  LineCode       FDate   Time  plat\n",
      "267456   176552742        17  1398/06/23  23467  F183\n",
      "267790  1280091550        17  1398/06/23  23777  F183\n",
      "267795  2182447059        17  1398/06/23  24377  F183\n",
      "267799  3152865822        17  1398/06/23  24402  F183\n",
      "267806  3632265932        17  1398/06/23  24404  F183\n",
      "...            ...       ...         ...    ...   ...\n",
      "4021    2239015831        17  1398/06/23  75559  F183\n",
      "44744    541818187        17  1398/06/23  75570  F183\n",
      "44746    261347457        17  1398/06/23  75571  F183\n",
      "267445   212938443        17  1398/06/23  78332  F183\n",
      "267451   212938443        17  1398/06/23  78334  F183\n",
      "\n",
      "[428 rows x 5 columns]\n",
      "first row of the selected chunck : \n",
      " [176552742 17 '1398/06/23' 23467 'F183']\n",
      "428\n",
      "t0 = 23467\n",
      "ts = 78334\n",
      "time_intervals 91\n",
      "Origin destination interval view reindex \n",
      "     time_in  time_out\n",
      "0   23467.0   24067.0\n",
      "1   31267.0   33067.0\n",
      "2   39667.0   40267.0\n",
      "3   43267.0   43867.0\n",
      "4   44467.0   45667.0\n",
      "5   48667.0   49267.0\n",
      "6   55867.0   57067.0\n",
      "7   63067.0   64267.0\n",
      "8   67267.0   67867.0\n",
      "9   70867.0   71467.0\n",
      "10  76267.0   78067.0\n",
      "OD bus stations of transactions: \n",
      "            CardID LineCode       FDate   Time  plat Station\n",
      "0       542446139        1  1398/06/23  24030  A145    3169\n",
      "1      2620656172        1  1398/06/23  24302  A145    3169\n",
      "2      3446252780        1  1398/06/23  26200  A145    1227\n",
      "3         7900260        1  1398/06/23  29677  A145    3169\n",
      "4       361857972        1  1398/06/23  29720  A145    3169\n",
      "...           ...      ...         ...    ...   ...     ...\n",
      "45034  1527290206       17  1398/06/23  64089  F183    1879\n",
      "45035  2138068077       17  1398/06/23  64144  F183    1879\n",
      "45036  4275797538       17  1398/06/23  67573  F183    1125\n",
      "45037   212938443       17  1398/06/23  71277  F183    1879\n",
      "45038   212938443       17  1398/06/23  71284  F183    1879\n",
      "\n",
      "[45039 rows x 6 columns]\n",
      "transactions in line 17 plat F58\n",
      "ps: \n",
      "              CardID  LineCode       FDate   Time plat\n",
      "200010   262746097        17  1398/06/23  22504  F58\n",
      "200011  3677314252        17  1398/06/23  22569  F58\n",
      "200012  2680249646        17  1398/06/23  22737  F58\n",
      "200013  4269757122        17  1398/06/23  24320  F58\n",
      "200014  3818755365        17  1398/06/23  24349  F58\n",
      "...            ...       ...         ...    ...  ...\n",
      "62528   2048183730        17  1398/06/23  74034  F58\n",
      "62529   1595092740        17  1398/06/23  74630  F58\n",
      "62530   3630152220        17  1398/06/23  75707  F58\n",
      "62531   4265949346        17  1398/06/23  77025  F58\n",
      "62532   2620497692        17  1398/06/23  77031  F58\n",
      "\n",
      "[367 rows x 5 columns]\n",
      "first row of the selected chunck : \n",
      " [262746097 17 '1398/06/23' 22504 'F58']\n",
      "367\n",
      "t0 = 22504\n",
      "ts = 77031\n",
      "time_intervals 91\n",
      "Origin destination interval view reindex \n",
      "     time_in  time_out\n",
      "0   22504.0   23104.0\n",
      "1   23704.0   24904.0\n",
      "2   26104.0   26704.0\n",
      "3   29104.0   30304.0\n",
      "4   36904.0   38104.0\n",
      "5   41104.0   42304.0\n",
      "6   45304.0   45904.0\n",
      "7   48304.0   48904.0\n",
      "8   52504.0   53104.0\n",
      "9   54904.0   56104.0\n",
      "10  62704.0   63904.0\n",
      "11  66904.0   67504.0\n",
      "12  75304.0   75904.0\n",
      "13  76504.0   77104.0\n",
      "OD bus stations of transactions: \n",
      "            CardID LineCode       FDate   Time  plat Station\n",
      "0       542446139        1  1398/06/23  24030  A145    3169\n",
      "1      2620656172        1  1398/06/23  24302  A145    3169\n",
      "2      3446252780        1  1398/06/23  26200  A145    1227\n",
      "3         7900260        1  1398/06/23  29677  A145    3169\n",
      "4       361857972        1  1398/06/23  29720  A145    3169\n",
      "...           ...      ...         ...    ...   ...     ...\n",
      "45382  2505267012       17  1398/06/23  67345   F58    1879\n",
      "45383   426782510       17  1398/06/23  67496   F58    1879\n",
      "45384  3630152220       17  1398/06/23  75707   F58    1125\n",
      "45385  4265949346       17  1398/06/23  77025   F58    1879\n",
      "45386  2620497692       17  1398/06/23  77031   F58    1879\n",
      "\n",
      "[45387 rows x 6 columns]\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "transactions in line 17 plat F74\n",
      "ps: \n",
      "             CardID  LineCode       FDate   Time plat\n",
      "12941  3178689630        17  1398/06/23  22268  F74\n",
      "12942  3206276532        17  1398/06/23  22316  F74\n",
      "12943   185516422        17  1398/06/23  22318  F74\n",
      "12944  3701184549        17  1398/06/23  22327  F74\n",
      "12945   809349810        17  1398/06/23  22608  F74\n",
      "...           ...       ...         ...    ...  ...\n",
      "76510  2181899075        17  1398/06/23  75089  F74\n",
      "76511  3204756117        17  1398/06/23  75210  F74\n",
      "76512  3204756117        17  1398/06/23  75211  F74\n",
      "75931  2672263012        17  1398/06/23  75212  F74\n",
      "76513  3445581388        17  1398/06/23  75861  F74\n",
      "\n",
      "[402 rows x 5 columns]\n",
      "first row of the selected chunck : \n",
      " [3178689630 17 '1398/06/23' 22268 'F74']\n",
      "402\n",
      "t0 = 22268\n",
      "ts = 75861\n",
      "time_intervals 89\n",
      "Origin destination interval view reindex \n",
      "     time_in  time_out\n",
      "0   22268.0   22868.0\n",
      "1   24668.0   25268.0\n",
      "2   35468.0   36668.0\n",
      "3   39668.0   40268.0\n",
      "4   43268.0   45068.0\n",
      "5   48068.0   48668.0\n",
      "6   49868.0   50468.0\n",
      "7   52268.0   56468.0\n",
      "8   57068.0   57668.0\n",
      "9   63068.0   64868.0\n",
      "10  69068.0   69668.0\n",
      "11  72068.0   72668.0\n",
      "OD bus stations of transactions: \n",
      "            CardID LineCode       FDate   Time  plat Station\n",
      "0       542446139        1  1398/06/23  24030  A145    3169\n",
      "1      2620656172        1  1398/06/23  24302  A145    3169\n",
      "2      3446252780        1  1398/06/23  26200  A145    1227\n",
      "3         7900260        1  1398/06/23  29677  A145    3169\n",
      "4       361857972        1  1398/06/23  29720  A145    3169\n",
      "...           ...      ...         ...    ...   ...     ...\n",
      "45600  3405909924       17  1398/06/23  69651   F74    1125\n",
      "45601  1834859181       17  1398/06/23  72102   F74    1879\n",
      "45602   721771013       17  1398/06/23  72229   F74    1879\n",
      "45603  2122747108       17  1398/06/23  72379   F74    1879\n",
      "45604   808688562       17  1398/06/23  72467   F74    1879\n",
      "\n",
      "[45605 rows x 6 columns]\n",
      "transactions in line 17 plat M149\n",
      "ps: \n",
      "              CardID  LineCode       FDate   Time  plat\n",
      "118466  3254116269        17  1398/06/23  22159  M149\n",
      "118468  2497944973        17  1398/06/23  22398  M149\n",
      "118470  1832078317        17  1398/06/23  22626  M149\n",
      "118473  1529691550        17  1398/06/23  23285  M149\n",
      "118484   722063692        17  1398/06/23  23489  M149\n",
      "...            ...       ...         ...    ...   ...\n",
      "161465  3405892246        17  1398/06/23  73915  M149\n",
      "128504  1000870190        17  1398/06/23  73916  M149\n",
      "128507  4255817252        17  1398/06/23  74008  M149\n",
      "128512   721943050        17  1398/06/23  74263  M149\n",
      "167558   721943050        17  1398/06/23  74265  M149\n",
      "\n",
      "[299 rows x 5 columns]\n",
      "first row of the selected chunck : \n",
      " [3254116269 17 '1398/06/23' 22159 'M149']\n",
      "299\n",
      "t0 = 22159\n",
      "ts = 74265\n",
      "time_intervals 87\n",
      "Origin destination interval view reindex \n",
      "    time_in  time_out\n",
      "0  22159.0   22759.0\n",
      "1  29359.0   31159.0\n",
      "2  35359.0   37759.0\n",
      "3  38359.0   38959.0\n",
      "4  40159.0   41359.0\n",
      "5  49159.0   53359.0\n",
      "6  64159.0   64759.0\n",
      "7  68359.0   69559.0\n",
      "8  71959.0   73759.0\n",
      "OD bus stations of transactions: \n",
      "            CardID LineCode       FDate   Time  plat Station\n",
      "0       542446139        1  1398/06/23  24030  A145    3169\n",
      "1      2620656172        1  1398/06/23  24302  A145    3169\n",
      "2      3446252780        1  1398/06/23  26200  A145    1227\n",
      "3         7900260        1  1398/06/23  29677  A145    3169\n",
      "4       361857972        1  1398/06/23  29720  A145    3169\n",
      "...           ...      ...         ...    ...   ...     ...\n",
      "45847  3445049100       17  1398/06/23  69323  M149    1879\n",
      "45848  3212811060       17  1398/06/23  69495  M149    1879\n",
      "45849  1776197060       17  1398/06/23  69557  M149    1879\n",
      "45850  1293403390       17  1398/06/23  73581  M149    1125\n",
      "45851  1293403390       17  1398/06/23  73582  M149    1125\n",
      "\n",
      "[45852 rows x 6 columns]\n",
      "transactions in line 17 plat M153\n",
      "ps: \n",
      "              CardID  LineCode       FDate   Time  plat\n",
      "291253  4279165266        17  1398/06/23  24491  M153\n",
      "291254  3205759492        17  1398/06/23  24632  M153\n",
      "291256  3795021964        17  1398/06/23  25264  M153\n",
      "291258  2589985764        17  1398/06/23  25351  M153\n",
      "291610  4255236452        17  1398/06/23  25352  M153\n",
      "...            ...       ...         ...    ...   ...\n",
      "238639   175890742        17  1398/06/23  75339  M153\n",
      "238640   174227542        17  1398/06/23  75855  M153\n",
      "238641  1368217134        17  1398/06/23  75856  M153\n",
      "238642  3700286293        17  1398/06/23  76125  M153\n",
      "238643  3700286293        17  1398/06/23  76126  M153\n",
      "\n",
      "[239 rows x 5 columns]\n",
      "first row of the selected chunck : \n",
      " [4279165266 17 '1398/06/23' 24491 'M153']\n",
      "239\n",
      "t0 = 24491\n",
      "ts = 76126\n",
      "time_intervals 86\n",
      "Origin destination interval view reindex \n",
      "     time_in  time_out\n",
      "0   24491.0   25091.0\n",
      "1   26291.0   27491.0\n",
      "2   31691.0   35291.0\n",
      "3   40691.0   43091.0\n",
      "4   45491.0   46091.0\n",
      "5   46691.0   48491.0\n",
      "6   50291.0   50891.0\n",
      "7   52691.0   62291.0\n",
      "8   67691.0   68291.0\n",
      "9   68891.0   70691.0\n",
      "10  74291.0   74891.0\n",
      "OD bus stations of transactions: \n",
      "            CardID LineCode       FDate   Time  plat Station\n",
      "0       542446139        1  1398/06/23  24030  A145    3169\n",
      "1      2620656172        1  1398/06/23  24302  A145    3169\n",
      "2      3446252780        1  1398/06/23  26200  A145    1227\n",
      "3         7900260        1  1398/06/23  29677  A145    3169\n",
      "4       361857972        1  1398/06/23  29720  A145    3169\n",
      "...           ...      ...         ...    ...   ...     ...\n",
      "46110  4269965602       17  1398/06/23  74700  M153    1125\n",
      "46111   361160196       17  1398/06/23  74711  M153    1125\n",
      "46112   361160196       17  1398/06/23  74713  M153    1125\n",
      "46113  2740752388       17  1398/06/23  74819  M153    1125\n",
      "46114  3604343468       17  1398/06/23  74869  M153    1125\n",
      "\n",
      "[46115 rows x 6 columns]\n",
      "stations in a specefic bus line 18\n",
      "len-of-go stations: 18\n",
      "len-of-back stations: 15\n",
      "len-of-go back stations: 0\n",
      "first Station  [3123 '18' '1' 'go' '?? ?? ?????' 51.616011 32.672223 'od' 'normal' 'no'] 3123\n",
      "last Station  [2735 '18' '1' 'back' '?????? ??? -????? 3' 51.649516 32.672842 'od'\n",
      " 'normal' 'yes']\n",
      "['A110' 'E110' 'E236' 'F70' 'F80' 'M116' 'N18']\n",
      "transactions in line 18 plat A110\n",
      "ps: \n",
      "              CardID  LineCode       FDate   Time  plat\n",
      "232194  3793144396        18  1398/06/23  21550  A110\n",
      "232185  1776121972        18  1398/06/23  21567  A110\n",
      "232190  2038374778        18  1398/06/23  21697  A110\n",
      "232541   722110177        18  1398/06/23  21888  A110\n",
      "232546   983030107        18  1398/06/23  24252  A110\n",
      "...            ...       ...         ...    ...   ...\n",
      "259628   289783131        18  1398/06/23  72303  A110\n",
      "259632   869442132        18  1398/06/23  73654  A110\n",
      "259635  1528492334        18  1398/06/23  74018  A110\n",
      "259639  2117878196        18  1398/06/23  74472  A110\n",
      "259992   737037216        18  1398/06/23  75871  A110\n",
      "\n",
      "[389 rows x 5 columns]\n",
      "first row of the selected chunck : \n",
      " [3793144396 18 '1398/06/23' 21550 'A110']\n",
      "389\n",
      "t0 = 21550\n",
      "ts = 75871\n",
      "time_intervals 91\n",
      "Origin destination interval view reindex \n",
      "     time_in  time_out\n",
      "0   21550.0   22150.0\n",
      "1   22750.0   24550.0\n",
      "2   26350.0   26950.0\n",
      "3   31750.0   32350.0\n",
      "4   36550.0   38350.0\n",
      "5   40150.0   40750.0\n",
      "6   44350.0   44950.0\n",
      "7   45550.0   46150.0\n",
      "8   47950.0   49150.0\n",
      "9   52750.0   53950.0\n",
      "10  55750.0   56950.0\n",
      "11  58150.0   59350.0\n",
      "12  64150.0   65350.0\n",
      "13  67150.0   67750.0\n",
      "14  70150.0   70750.0\n",
      "15  73150.0   73750.0\n",
      "16  75550.0   76150.0\n",
      "OD bus stations of transactions: \n",
      "            CardID LineCode       FDate   Time  plat Station\n",
      "0       542446139        1  1398/06/23  24030  A145    3169\n",
      "1      2620656172        1  1398/06/23  24302  A145    3169\n",
      "2      3446252780        1  1398/06/23  26200  A145    1227\n",
      "3         7900260        1  1398/06/23  29677  A145    3169\n",
      "4       361857972        1  1398/06/23  29720  A145    3169\n",
      "...           ...      ...         ...    ...   ...     ...\n",
      "46312   344382452       18  1398/06/23  67739  A110    2735\n",
      "46313   344382452       18  1398/06/23  67741  A110    2735\n",
      "46314  1529270254       18  1398/06/23  70444  A110    3123\n",
      "46315   869442132       18  1398/06/23  73654  A110    2735\n",
      "46316   737037216       18  1398/06/23  75871  A110    3123\n",
      "\n",
      "[46317 rows x 6 columns]\n",
      "transactions in line 18 plat E110\n",
      "ps: \n",
      "              CardID  LineCode       FDate   Time  plat\n",
      "177736   722109569        18  1398/06/23  22540  E110\n",
      "177740  1831437613        18  1398/06/23  24668  E110\n",
      "138613  1958056708        18  1398/06/23  24990  E110\n",
      "138615  3792121740        18  1398/06/23  25037  E110\n",
      "177742  1788554676        18  1398/06/23  25037  E110\n",
      "...            ...       ...         ...    ...   ...\n",
      "213276  3794849004        18  1398/06/23  53652  E110\n",
      "272975   981500795        18  1398/06/23  53932  E110\n",
      "87446    981500795        18  1398/06/23  53933  E110\n",
      "87664   2137857933        18  1398/06/23  54645  E110\n",
      "87669   2508874420        18  1398/06/23  54862  E110\n",
      "\n",
      "[189 rows x 5 columns]\n",
      "first row of the selected chunck : \n",
      " [722109569 18 '1398/06/23' 22540 'E110']\n",
      "189\n",
      "t0 = 22540\n",
      "ts = 54862\n",
      "time_intervals 54\n",
      "Origin destination interval view reindex \n",
      "    time_in  time_out\n",
      "0  22540.0   24940.0\n",
      "1  26140.0   26740.0\n",
      "2  27940.0   29140.0\n",
      "3  29740.0   30340.0\n",
      "4  30940.0   32140.0\n",
      "5  33340.0   34540.0\n",
      "6  36340.0   36940.0\n",
      "7  39940.0   40540.0\n",
      "8  48340.0   49540.0\n",
      "9  51340.0   53140.0\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "OD bus stations of transactions: \n",
      "            CardID LineCode       FDate   Time  plat Station\n",
      "0       542446139        1  1398/06/23  24030  A145    3169\n",
      "1      2620656172        1  1398/06/23  24302  A145    3169\n",
      "2      3446252780        1  1398/06/23  26200  A145    1227\n",
      "3         7900260        1  1398/06/23  29677  A145    3169\n",
      "4       361857972        1  1398/06/23  29720  A145    3169\n",
      "...           ...      ...         ...    ...   ...     ...\n",
      "46603   428691022       18  1398/06/23  52584  E110    2735\n",
      "46604   210030747       18  1398/06/23  52654  E110    2735\n",
      "46605  1957910964       18  1398/06/23  52921  E110    2735\n",
      "46606  1957910964       18  1398/06/23  52922  E110    2735\n",
      "46607   261283905       18  1398/06/23  53050  E110    2735\n",
      "\n",
      "[46608 rows x 6 columns]\n",
      "transactions in line 18 plat E236\n",
      "ps: \n",
      "              CardID  LineCode       FDate   Time  plat\n",
      "153393  2855132942        18  1398/06/23  21717  E236\n",
      "153394  3792142764        18  1398/06/23  23697  E236\n",
      "153395  2115784500        18  1398/06/23  23781  E236\n",
      "153396  3154302926        18  1398/06/23  23784  E236\n",
      "153397  1832863101        18  1398/06/23  23914  E236\n",
      "...            ...       ...         ...    ...   ...\n",
      "26718   1003721143        18  1398/06/23  73728  E236\n",
      "26719    869386654        18  1398/06/23  73734  E236\n",
      "26720    483277364        18  1398/06/23  73739  E236\n",
      "26721   2239165431        18  1398/06/23  73741  E236\n",
      "26722   3791997260        18  1398/06/23  73942  E236\n",
      "\n",
      "[343 rows x 5 columns]\n",
      "first row of the selected chunck : \n",
      " [2855132942 18 '1398/06/23' 21717 'E236']\n",
      "343\n",
      "t0 = 21717\n",
      "ts = 73942\n",
      "time_intervals 87\n",
      "Origin destination interval view reindex \n",
      "     time_in  time_out\n",
      "0   21717.0   24117.0\n",
      "1   25317.0   25917.0\n",
      "2   28317.0   28917.0\n",
      "3   30717.0   31317.0\n",
      "4   33117.0   34317.0\n",
      "5   39117.0   40917.0\n",
      "6   43917.0   45717.0\n",
      "7   46317.0   46917.0\n",
      "8   49917.0   51117.0\n",
      "9   52317.0   53517.0\n",
      "10  57117.0   57717.0\n",
      "11  58917.0   60117.0\n",
      "12  60717.0   61317.0\n",
      "13  63717.0   64317.0\n",
      "14  66117.0   67317.0\n",
      "15  69117.0   69717.0\n",
      "16  70917.0   72717.0\n",
      "OD bus stations of transactions: \n",
      "            CardID LineCode       FDate   Time  plat Station\n",
      "0       542446139        1  1398/06/23  24030  A145    3169\n",
      "1      2620656172        1  1398/06/23  24302  A145    3169\n",
      "2      3446252780        1  1398/06/23  26200  A145    1227\n",
      "3         7900260        1  1398/06/23  29677  A145    3169\n",
      "4       361857972        1  1398/06/23  29720  A145    3169\n",
      "...           ...      ...         ...    ...   ...     ...\n",
      "46825   235245978       18  1398/06/23  69549  E236    2735\n",
      "46826   177519462       18  1398/06/23  69554  E236    2735\n",
      "46827  3677605020       18  1398/06/23  69643  E236    2735\n",
      "46828  2239146474       18  1398/06/23  69681  E236    2735\n",
      "46829  2038374778       18  1398/06/23  72355  E236    3123\n",
      "\n",
      "[46830 rows x 6 columns]\n",
      "transactions in line 18 plat F70\n",
      "ps: \n",
      "              CardID  LineCode       FDate   Time plat\n",
      "137899  3553246940        18  1398/06/23  22409  F70\n",
      "137901  2586249076        18  1398/06/23  22557  F70\n",
      "137903  1776311460        18  1398/06/23  22622  F70\n",
      "137904  2498257316        18  1398/06/23  22745  F70\n",
      "137906  1789000644        18  1398/06/23  22748  F70\n",
      "...            ...       ...         ...    ...  ...\n",
      "176353  1002633655        18  1398/06/23  71907  F70\n",
      "176354  2137428061        18  1398/06/23  72075  F70\n",
      "176355  3154198382        18  1398/06/23  74077  F70\n",
      "176356  3154198382        18  1398/06/23  74079  F70\n",
      "176357  3154198382        18  1398/06/23  74080  F70\n",
      "\n",
      "[372 rows x 5 columns]\n",
      "first row of the selected chunck : \n",
      " [3553246940 18 '1398/06/23' 22409 'F70']\n",
      "372\n",
      "t0 = 22409\n",
      "ts = 74080\n",
      "time_intervals 86\n",
      "Origin destination interval view reindex \n",
      "     time_in  time_out\n",
      "0   22409.0   23009.0\n",
      "1   23609.0   25409.0\n",
      "2   27209.0   27809.0\n",
      "3   30209.0   30809.0\n",
      "4   35609.0   36209.0\n",
      "5   38009.0   38609.0\n",
      "6   40409.0   41609.0\n",
      "7   44009.0   44609.0\n",
      "8   46409.0   47009.0\n",
      "9   47609.0   48209.0\n",
      "10  49409.0   50009.0\n",
      "11  51209.0   52409.0\n",
      "12  56009.0   57809.0\n",
      "13  59009.0   59609.0\n",
      "14  60209.0   60809.0\n",
      "15  62009.0   63209.0\n",
      "16  68009.0   69209.0\n",
      "17  71009.0   71609.0\n",
      "18  72809.0   74009.0\n",
      "OD bus stations of transactions: \n",
      "            CardID LineCode       FDate   Time  plat Station\n",
      "0       542446139        1  1398/06/23  24030  A145    3169\n",
      "1      2620656172        1  1398/06/23  24302  A145    3169\n",
      "2      3446252780        1  1398/06/23  26200  A145    1227\n",
      "3         7900260        1  1398/06/23  29677  A145    3169\n",
      "4       361857972        1  1398/06/23  29720  A145    3169\n",
      "...           ...      ...         ...    ...   ...     ...\n",
      "47112   721968606       18  1398/06/23  71185   F70    2735\n",
      "47113   721968606       18  1398/06/23  71188   F70    2735\n",
      "47114  2497524989       18  1398/06/23  71406   F70    2735\n",
      "47115  3109099797       18  1398/06/23  71409   F70    2735\n",
      "47116  3793842620       18  1398/06/23  71492   F70    2735\n",
      "\n",
      "[47117 rows x 6 columns]\n",
      "transactions in line 18 plat F80\n",
      "ps: \n",
      "              CardID  LineCode       FDate   Time plat\n",
      "208277  2045044686        18  1398/06/23  21854  F80\n",
      "208279   996546110        18  1398/06/23  21943  F80\n",
      "208282  3405928662        18  1398/06/23  21947  F80\n",
      "208283  3553712716        18  1398/06/23  22020  F80\n",
      "208284  1531114286        18  1398/06/23  22022  F80\n",
      "...            ...       ...         ...    ...  ...\n",
      "271215  1837917133        18  1398/06/23  75600  F80\n",
      "271217  1788564612        18  1398/06/23  75627  F80\n",
      "83027   2497414653        18  1398/06/23  76236  F80\n",
      "83029   2743014596        18  1398/06/23  76350  F80\n",
      "83031   2743014596        18  1398/06/23  76353  F80\n",
      "\n",
      "[332 rows x 5 columns]\n",
      "first row of the selected chunck : \n",
      " [2045044686 18 '1398/06/23' 21854 'F80']\n",
      "332\n",
      "t0 = 21854\n",
      "ts = 76353\n",
      "time_intervals 91\n",
      "Origin destination interval view reindex \n",
      "     time_in  time_out\n",
      "0   21854.0   22454.0\n",
      "1   23054.0   24854.0\n",
      "2   26054.0   27254.0\n",
      "3   28454.0   29054.0\n",
      "4   29654.0   30254.0\n",
      "5   34454.0   35054.0\n",
      "6   36254.0   36854.0\n",
      "7   43454.0   44054.0\n",
      "8   45254.0   46454.0\n",
      "9   47054.0   47654.0\n",
      "10  48254.0   49454.0\n",
      "11  50654.0   52454.0\n",
      "12  53654.0   59654.0\n",
      "13  61454.0   62654.0\n",
      "14  66854.0   68054.0\n",
      "15  71654.0   73454.0\n",
      "16  74654.0   75854.0\n",
      "OD bus stations of transactions: \n",
      "            CardID LineCode       FDate   Time  plat Station\n",
      "0       542446139        1  1398/06/23  24030  A145    3169\n",
      "1      2620656172        1  1398/06/23  24302  A145    3169\n",
      "2      3446252780        1  1398/06/23  26200  A145    1227\n",
      "3         7900260        1  1398/06/23  29677  A145    3169\n",
      "4       361857972        1  1398/06/23  29720  A145    3169\n",
      "...           ...      ...         ...    ...   ...     ...\n",
      "47374  1831673005       18  1398/06/23  67992   F80    3123\n",
      "47375  2498057853       18  1398/06/23  73287   F80    2735\n",
      "47376  4278600594       18  1398/06/23  73297   F80    2735\n",
      "47377  1837917133       18  1398/06/23  75600   F80    3123\n",
      "47378  1788564612       18  1398/06/23  75627   F80    3123\n",
      "\n",
      "[47379 rows x 6 columns]\n",
      "transactions in line 18 plat M116\n",
      "ps: \n",
      "              CardID  LineCode       FDate   Time  plat\n",
      "244017   645363229        18  1398/06/23  23140  M116\n",
      "244020  2049371666        18  1398/06/23  23291  M116\n",
      "244022   869252902        18  1398/06/23  23303  M116\n",
      "244024   722222857        18  1398/06/23  23308  M116\n",
      "244026  3181038142        18  1398/06/23  23690  M116\n",
      "...            ...       ...         ...    ...   ...\n",
      "175124  4265617602        18  1398/06/23  75311  M116\n",
      "175127  4265617602        18  1398/06/23  75312  M116\n",
      "175131  4265617602        18  1398/06/23  75314  M116\n",
      "175136   982143451        18  1398/06/23  75350  M116\n",
      "175141  1592653604        18  1398/06/23  75556  M116\n",
      "\n",
      "[308 rows x 5 columns]\n",
      "first row of the selected chunck : \n",
      " [645363229 18 '1398/06/23' 23140 'M116']\n",
      "308\n",
      "t0 = 23140\n",
      "ts = 75556\n",
      "time_intervals 87\n",
      "Origin destination interval view reindex \n",
      "     time_in  time_out\n",
      "0   23140.0   23740.0\n",
      "1   24340.0   24940.0\n",
      "2   25540.0   26140.0\n",
      "3   27340.0   29140.0\n",
      "4   30340.0   32140.0\n",
      "5   33940.0   34540.0\n",
      "6   36340.0   36940.0\n",
      "7   41140.0   42340.0\n",
      "8   47140.0   48340.0\n",
      "9   50140.0   50740.0\n",
      "10  52540.0   53740.0\n",
      "11  57940.0   59140.0\n",
      "12  62740.0   63940.0\n",
      "13  68740.0   69340.0\n",
      "14  71740.0   72340.0\n",
      "15  73540.0   74140.0\n",
      "16  74740.0   75340.0\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "OD bus stations of transactions: \n",
      "            CardID LineCode       FDate   Time  plat Station\n",
      "0       542446139        1  1398/06/23  24030  A145    3169\n",
      "1      2620656172        1  1398/06/23  24302  A145    3169\n",
      "2      3446252780        1  1398/06/23  26200  A145    1227\n",
      "3         7900260        1  1398/06/23  29677  A145    3169\n",
      "4       361857972        1  1398/06/23  29720  A145    3169\n",
      "...           ...      ...         ...    ...   ...     ...\n",
      "47645  2743002772       18  1398/06/23  75228  M116    3123\n",
      "47646  3677634508       18  1398/06/23  75247  M116    3123\n",
      "47647  4265617602       18  1398/06/23  75311  M116    3123\n",
      "47648  4265617602       18  1398/06/23  75312  M116    3123\n",
      "47649  4265617602       18  1398/06/23  75314  M116    3123\n",
      "\n",
      "[47650 rows x 6 columns]\n",
      "transactions in line 18 plat N18\n",
      "ps: \n",
      "              CardID  LineCode       FDate   Time plat\n",
      "282327   361128148        18  1398/06/23  22631  N18\n",
      "282330   721968341        18  1398/06/23  22765  N18\n",
      "282331  2680423854        18  1398/06/23  24733  N18\n",
      "282334  2507983636        18  1398/06/23  24793  N18\n",
      "282337  3179779774        18  1398/06/23  24896  N18\n",
      "...            ...       ...         ...    ...  ...\n",
      "112009  3794335196        18  1398/06/23  74642  N18\n",
      "112011  3794335196        18  1398/06/23  74643  N18\n",
      "112016  3794335196        18  1398/06/23  74645  N18\n",
      "208249  2129031508        18  1398/06/23  74645  N18\n",
      "208254   721954382        18  1398/06/23  74911  N18\n",
      "\n",
      "[303 rows x 5 columns]\n",
      "first row of the selected chunck : \n",
      " [361128148 18 '1398/06/23' 22631 'N18']\n",
      "303\n",
      "t0 = 22631\n",
      "ts = 74911\n",
      "time_intervals 87\n",
      "Origin destination interval view reindex \n",
      "     time_in  time_out\n",
      "0   22631.0   23231.0\n",
      "1   23831.0   25031.0\n",
      "2   26231.0   27431.0\n",
      "3   29831.0   30431.0\n",
      "4   32231.0   32831.0\n",
      "5   35831.0   36431.0\n",
      "6   38231.0   38831.0\n",
      "7   43631.0   44231.0\n",
      "8   46631.0   47231.0\n",
      "9   49031.0   49631.0\n",
      "10  53831.0   56231.0\n",
      "11  59831.0   61031.0\n",
      "12  62231.0   62831.0\n",
      "13  64631.0   65831.0\n",
      "14  70031.0   73031.0\n",
      "15  73631.0   74231.0\n",
      "OD bus stations of transactions: \n",
      "            CardID LineCode       FDate   Time  plat Station\n",
      "0       542446139        1  1398/06/23  24030  A145    3169\n",
      "1      2620656172        1  1398/06/23  24302  A145    3169\n",
      "2      3446252780        1  1398/06/23  26200  A145    1227\n",
      "3         7900260        1  1398/06/23  29677  A145    3169\n",
      "4       361857972        1  1398/06/23  29720  A145    3169\n",
      "...           ...      ...         ...    ...   ...     ...\n",
      "47860   722169942       18  1398/06/23  72534   N18    3123\n",
      "47861   180216916       18  1398/06/23  72583   N18    3123\n",
      "47862  2541153726       18  1398/06/23  72653   N18    3123\n",
      "47863   361370324       18  1398/06/23  72730   N18    3123\n",
      "47864  2742823252       18  1398/06/23  73991   N18    2735\n",
      "\n",
      "[47865 rows x 6 columns]\n",
      "stations in a specefic bus line 19\n",
      "len-of-go stations: 13\n",
      "len-of-back stations: 11\n",
      "len-of-go back stations: 0\n",
      "first Station  [3201 '19' '1' 'go' '?????-19' 51.595205 32.724678 'od' 'normal' 'no'] 3201\n",
      "last Station  [4134 '19' '1' 'back' '?????? ???? ???-19' 51.601391 32.714326 'od'\n",
      " 'normal' 'yes']\n",
      "['A112' 'E238' 'E243' 'F40' 'F85' 'N58']\n",
      "transactions in line 19 plat A112\n",
      "ps: \n",
      "               CardID  LineCode       FDate   Time  plat\n",
      "2008932  3446841452        19  1398/06/23  23341  A112\n",
      "2008936   984192651        19  1398/06/23  26214  A112\n",
      "2008941  3792729036        19  1398/06/23  26219  A112\n",
      "2008945  3553780380        19  1398/06/23  26222  A112\n",
      "2008949   721807152        19  1398/06/23  26226  A112\n",
      "...             ...       ...         ...    ...   ...\n",
      "2008918   479991540        19  1398/06/23  46576  A112\n",
      "2008921   479991540        19  1398/06/23  46578  A112\n",
      "1254734   173466628        19  1398/06/23  46946  A112\n",
      "1254739   721899870        19  1398/06/23  47001  A112\n",
      "1321069   869422992        19  1398/06/23  47940  A112\n",
      "\n",
      "[70 rows x 5 columns]\n",
      "first row of the selected chunck : \n",
      " [3446841452 19 '1398/06/23' 23341 'A112']\n",
      "70\n",
      "t0 = 23341\n",
      "ts = 47940\n",
      "time_intervals 41\n",
      "Origin destination interval view reindex \n",
      "    time_in  time_out\n",
      "0  23341.0   26341.0\n",
      "1  28741.0   30541.0\n",
      "2  31741.0   33541.0\n",
      "3  35341.0   37741.0\n",
      "4  38941.0   41341.0\n",
      "5  41941.0   43741.0\n",
      "6  44341.0   44941.0\n",
      "7  46141.0   46741.0\n",
      "OD bus stations of transactions: \n",
      "            CardID LineCode       FDate   Time  plat Station\n",
      "0       542446139        1  1398/06/23  24030  A145    3169\n",
      "1      2620656172        1  1398/06/23  24302  A145    3169\n",
      "2      3446252780        1  1398/06/23  26200  A145    1227\n",
      "3         7900260        1  1398/06/23  29677  A145    3169\n",
      "4       361857972        1  1398/06/23  29720  A145    3169\n",
      "...           ...      ...         ...    ...   ...     ...\n",
      "48057  3631031948       19  1398/06/23  44476  A112    3201\n",
      "48058  3794419244       19  1398/06/23  44483  A112    3201\n",
      "48059   479991540       19  1398/06/23  46574  A112    4134\n",
      "48060   479991540       19  1398/06/23  46576  A112    4134\n",
      "48061   479991540       19  1398/06/23  46578  A112    4134\n",
      "\n",
      "[48062 rows x 6 columns]\n",
      "transactions in line 19 plat E238\n",
      "ps: \n",
      "              CardID  LineCode       FDate   Time  plat\n",
      "318392   721792900        19  1398/06/23  21634  E238\n",
      "318395  3631417932        19  1398/06/23  22054  E238\n",
      "318396   361346836        19  1398/06/23  22128  E238\n",
      "318400   721792900        19  1398/06/23  24519  E238\n",
      "318404   211032684        19  1398/06/23  25273  E238\n",
      "...            ...       ...         ...    ...   ...\n",
      "104552   641753210        19  1398/06/23  72460  E238\n",
      "104556   721792900        19  1398/06/23  74339  E238\n",
      "104564  2855164958        19  1398/06/23  74990  E238\n",
      "104568  2855164958        19  1398/06/23  74991  E238\n",
      "104581  3793413964        19  1398/06/23  74995  E238\n",
      "\n",
      "[168 rows x 5 columns]\n",
      "first row of the selected chunck : \n",
      " [721792900 19 '1398/06/23' 21634 'E238']\n",
      "168\n",
      "t0 = 21634\n",
      "ts = 74995\n",
      "time_intervals 89\n",
      "Origin destination interval view reindex \n",
      "     time_in  time_out\n",
      "0   21634.0   22234.0\n",
      "1   22834.0   24634.0\n",
      "2   25234.0   25834.0\n",
      "3   26434.0   27034.0\n",
      "4   28234.0   29434.0\n",
      "5   30034.0   30634.0\n",
      "6   31834.0   32434.0\n",
      "7   36034.0   36634.0\n",
      "8   40834.0   42034.0\n",
      "9   42634.0   44434.0\n",
      "10  45034.0   46234.0\n",
      "11  46834.0   48634.0\n",
      "12  51034.0   52234.0\n",
      "13  53434.0   54034.0\n",
      "14  55234.0   55834.0\n",
      "15  58234.0   58834.0\n",
      "16  62434.0   64234.0\n",
      "17  70834.0   71434.0\n",
      "18  72034.0   72634.0\n",
      "19  73234.0   74434.0\n",
      "OD bus stations of transactions: \n",
      "            CardID LineCode       FDate   Time  plat Station\n",
      "0       542446139        1  1398/06/23  24030  A145    3169\n",
      "1      2620656172        1  1398/06/23  24302  A145    3169\n",
      "2      3446252780        1  1398/06/23  26200  A145    1227\n",
      "3         7900260        1  1398/06/23  29677  A145    3169\n",
      "4       361857972        1  1398/06/23  29720  A145    3169\n",
      "...           ...      ...         ...    ...   ...     ...\n",
      "48113  2671445988       19  1398/06/23  72195  E238    3201\n",
      "48114  2671445988       19  1398/06/23  72196  E238    3201\n",
      "48115   641753210       19  1398/06/23  72459  E238    3201\n",
      "48116   641753210       19  1398/06/23  72460  E238    3201\n",
      "48117   721792900       19  1398/06/23  74339  E238    4134\n",
      "\n",
      "[48118 rows x 6 columns]\n",
      "transactions in line 19 plat E243\n",
      "ps: \n",
      "              CardID  LineCode       FDate   Time  plat\n",
      "216800  2677027396        19  1398/06/23  51463  E243\n",
      "247750  2677027396        19  1398/06/23  51465  E243\n",
      "247758  1832378861        19  1398/06/23  52119  E243\n",
      "247762   212090971        19  1398/06/23  52418  E243\n",
      "247764  4075792314        19  1398/06/23  52492  E243\n",
      "247765   710720117        19  1398/06/23  53169  E243\n",
      "247768  3793413964        19  1398/06/23  53439  E243\n",
      "247771  2116343124        19  1398/06/23  53541  E243\n",
      "247775   869253360        19  1398/06/23  53789  E243\n",
      "247779  1283963518        19  1398/06/23  54048  E243\n",
      "247783   262485121        19  1398/06/23  54195  E243\n",
      "247787   722141347        19  1398/06/23  55251  E243\n",
      "247790  2125314004        19  1398/06/23  55256  E243\n",
      "247793   105365155        19  1398/06/23  56091  E243\n",
      "247797   105365155        19  1398/06/23  56092  E243\n",
      "247801  2675845700        19  1398/06/23  56098  E243\n",
      "247805   645313645        19  1398/06/23  57470  E243\n",
      "250441  2742466532        19  1398/06/23  57599  E243\n",
      "250445  3631161260        19  1398/06/23  57643  E243\n",
      "250449  3631161260        19  1398/06/23  57645  E243\n",
      "250455   869280227        19  1398/06/23  58220  E243\n",
      "250458  3205752772        19  1398/06/23  58242  E243\n",
      "first row of the selected chunck : \n",
      " [2677027396 19 '1398/06/23' 51463 'E243']\n",
      "22\n",
      "t0 = 51463\n",
      "ts = 58242\n",
      "time_intervals 11\n",
      "Origin destination interval view reindex \n",
      "    time_in  time_out\n",
      "0  51463.0   52063.0\n",
      "1  55063.0   55663.0\n",
      "2  56863.0   58063.0\n",
      "OD bus stations of transactions: \n",
      "            CardID LineCode       FDate   Time  plat Station\n",
      "0       542446139        1  1398/06/23  24030  A145    3169\n",
      "1      2620656172        1  1398/06/23  24302  A145    3169\n",
      "2      3446252780        1  1398/06/23  26200  A145    1227\n",
      "3         7900260        1  1398/06/23  29677  A145    3169\n",
      "4       361857972        1  1398/06/23  29720  A145    3169\n",
      "...           ...      ...         ...    ...   ...     ...\n",
      "48212  2125314004       19  1398/06/23  55256  E243    4134\n",
      "48213   645313645       19  1398/06/23  57470  E243    3201\n",
      "48214  2742466532       19  1398/06/23  57599  E243    3201\n",
      "48215  3631161260       19  1398/06/23  57643  E243    3201\n",
      "48216  3631161260       19  1398/06/23  57645  E243    3201\n",
      "\n",
      "[48217 rows x 6 columns]\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "transactions in line 19 plat F40\n",
      "ps: \n",
      "              CardID  LineCode       FDate   Time plat\n",
      "120565   105365155        19  1398/06/23  23386  F40\n",
      "120566   105365155        19  1398/06/23  23387  F40\n",
      "120567  2482017508        19  1398/06/23  23463  F40\n",
      "120568  1831893597        19  1398/06/23  23546  F40\n",
      "120569   722141347        19  1398/06/23  23614  F40\n",
      "...            ...       ...         ...    ...  ...\n",
      "121385  1592142660        19  1398/06/23  48267  F40\n",
      "121386   721885463        19  1398/06/23  48955  F40\n",
      "121387   105449011        19  1398/06/23  49477  F40\n",
      "121388  3107390405        19  1398/06/23  50080  F40\n",
      "121389  2680044446        19  1398/06/23  50746  F40\n",
      "\n",
      "[120 rows x 5 columns]\n",
      "first row of the selected chunck : \n",
      " [105365155 19 '1398/06/23' 23386 'F40']\n",
      "120\n",
      "t0 = 23386\n",
      "ts = 50746\n",
      "time_intervals 46\n",
      "Origin destination interval view reindex \n",
      "    time_in  time_out\n",
      "0  23386.0   23986.0\n",
      "1  24586.0   25186.0\n",
      "2  27586.0   28186.0\n",
      "3  29386.0   32986.0\n",
      "4  33586.0   35386.0\n",
      "5  40786.0   41386.0\n",
      "6  43186.0   44386.0\n",
      "OD bus stations of transactions: \n",
      "            CardID LineCode       FDate   Time  plat Station\n",
      "0       542446139        1  1398/06/23  24030  A145    3169\n",
      "1      2620656172        1  1398/06/23  24302  A145    3169\n",
      "2      3446252780        1  1398/06/23  26200  A145    1227\n",
      "3         7900260        1  1398/06/23  29677  A145    3169\n",
      "4       361857972        1  1398/06/23  29720  A145    3169\n",
      "...           ...      ...         ...    ...   ...     ...\n",
      "48251  2507833780       19  1398/06/23  44306   F40    3201\n",
      "48252  2507833780       19  1398/06/23  44307   F40    3201\n",
      "48253  1832060765       19  1398/06/23  44309   F40    3201\n",
      "48254  2116969476       19  1398/06/23  44312   F40    3201\n",
      "48255   721814134       19  1398/06/23  44384   F40    3201\n",
      "\n",
      "[48256 rows x 6 columns]\n",
      "transactions in line 19 plat F85\n",
      "ps: \n",
      "              CardID  LineCode       FDate   Time plat\n",
      "525516  2482003188        19  1398/06/23  59282  F85\n",
      "525518   722248763        19  1398/06/23  59630  F85\n",
      "525520  1832425261        19  1398/06/23  59915  F85\n",
      "525522  2541424190        19  1398/06/23  60241  F85\n",
      "525524  3180167566        19  1398/06/23  60575  F85\n",
      "525525  2507902196        19  1398/06/23  60677  F85\n",
      "525526   869432901        19  1398/06/23  61303  F85\n",
      "525527  2138875517        19  1398/06/23  63229  F85\n",
      "525528  2482316180        19  1398/06/23  64297  F85\n",
      "525529  2482316180        19  1398/06/23  64302  F85\n",
      "525530  3649780628        19  1398/06/23  64389  F85\n",
      "525531   722229686        19  1398/06/23  64560  F85\n",
      "525532  3258186061        19  1398/06/23  64765  F85\n",
      "525533  2586270436        19  1398/06/23  64932  F85\n",
      "525534   362303764        19  1398/06/23  65394  F85\n",
      "525535   981177163        19  1398/06/23  66105  F85\n",
      "525536  2138679197        19  1398/06/23  66488  F85\n",
      "525537   721927696        19  1398/06/23  66638  F85\n",
      "525538  3630062476        19  1398/06/23  66716  F85\n",
      "525539  3154189358        19  1398/06/23  66867  F85\n",
      "525540   722060381        19  1398/06/23  66871  F85\n",
      "525541  4255067924        19  1398/06/23  66901  F85\n",
      "525542  2671445988        19  1398/06/23  67519  F85\n",
      "525543  2671445988        19  1398/06/23  67521  F85\n",
      "525545  2122742420        19  1398/06/23  67582  F85\n",
      "525544  3649890084        19  1398/06/23  67655  F85\n",
      "525546  3675824418        19  1398/06/23  68848  F85\n",
      "525547  2742194404        19  1398/06/23  68997  F85\n",
      "525548  2122672324        19  1398/06/23  69459  F85\n",
      "525549  2680696036        19  1398/06/23  69460  F85\n",
      "525550  3679121708        19  1398/06/23  69623  F85\n",
      "525551  3258186061        19  1398/06/23  70005  F85\n",
      "525552  2507902196        19  1398/06/23  70324  F85\n",
      "525553  3150981886        19  1398/06/23  70332  F85\n",
      "525554  2127954772        19  1398/06/23  70335  F85\n",
      "525555  4266577314        19  1398/06/23  71865  F85\n",
      "525556  4075792314        19  1398/06/23  72252  F85\n",
      "525557  1598735588        19  1398/06/23  73026  F85\n",
      "525558  1598735588        19  1398/06/23  73030  F85\n",
      "525559  1598735588        19  1398/06/23  73031  F85\n",
      "525560   537243307        19  1398/06/23  73232  F85\n",
      "525561  3258370685        19  1398/06/23  73232  F85\n",
      "526494   722126071        19  1398/06/23  73355  F85\n",
      "526495  2541424190        19  1398/06/23  73411  F85\n",
      "526496  1831893597        19  1398/06/23  73767  F85\n",
      "526498  2482316180        19  1398/06/23  73813  F85\n",
      "526499   869288278        19  1398/06/23  73819  F85\n",
      "526497  4265422578        19  1398/06/23  73982  F85\n",
      "526500  2740991604        19  1398/06/23  74077  F85\n",
      "first row of the selected chunck : \n",
      " [2482003188 19 '1398/06/23' 59282 'F85']\n",
      "49\n",
      "t0 = 59282\n",
      "ts = 74077\n",
      "time_intervals 25\n",
      "Origin destination interval view reindex \n",
      "    time_in  time_out\n",
      "0  59282.0   59882.0\n",
      "1  62282.0   63482.0\n",
      "2  64082.0   64682.0\n",
      "3  68282.0   68882.0\n",
      "4  71282.0   71882.0\n",
      "OD bus stations of transactions: \n",
      "            CardID LineCode       FDate   Time  plat Station\n",
      "0       542446139        1  1398/06/23  24030  A145    3169\n",
      "1      2620656172        1  1398/06/23  24302  A145    3169\n",
      "2      3446252780        1  1398/06/23  26200  A145    1227\n",
      "3         7900260        1  1398/06/23  29677  A145    3169\n",
      "4       361857972        1  1398/06/23  29720  A145    3169\n",
      "...           ...      ...         ...    ...   ...     ...\n",
      "48294  2482316180       19  1398/06/23  64302   F85    3201\n",
      "48295  3649780628       19  1398/06/23  64389   F85    3201\n",
      "48296   722229686       19  1398/06/23  64560   F85    3201\n",
      "48297  3675824418       19  1398/06/23  68848   F85    4134\n",
      "48298  4266577314       19  1398/06/23  71865   F85    3201\n",
      "\n",
      "[48299 rows x 6 columns]\n",
      "transactions in line 19 plat N58\n",
      "ps: \n",
      "              CardID  LineCode       FDate   Time plat\n",
      "257938  1832060765        19  1398/06/23  40905  N58\n",
      "257939  2507994116        19  1398/06/23  41263  N58\n",
      "257940  2507994116        19  1398/06/23  41264  N58\n",
      "257941  3446720220        19  1398/06/23  41657  N58\n",
      "257942  2045212126        19  1398/06/23  42206  N58\n",
      "257943  1592292100        19  1398/06/23  42404  N58\n",
      "257944   869253360        19  1398/06/23  43068  N58\n",
      "257945  3648914084        19  1398/06/23  43148  N58\n",
      "257946  3648914084        19  1398/06/23  43164  N58\n",
      "257947  3107390405        19  1398/06/23  43206  N58\n",
      "257948  3547385892        19  1398/06/23  43248  N58\n",
      "257949  3758187365        19  1398/06/23  43706  N58\n",
      "257950   990419998        19  1398/06/23  43766  N58\n",
      "257951   293923675        19  1398/06/23  43768  N58\n",
      "257952  3649780628        19  1398/06/23  44038  N58\n",
      "257953  3649780628        19  1398/06/23  44048  N58\n",
      "257954  1832378861        19  1398/06/23  44101  N58\n",
      "257955  3629847804        19  1398/06/23  44345  N58\n",
      "257957   869266930        19  1398/06/23  44788  N58\n",
      "257956   105449011        19  1398/06/23  44866  N58\n",
      "257958  2589920740        19  1398/06/23  45092  N58\n",
      "257959   869344004        19  1398/06/23  46616  N58\n",
      "257960   869344004        19  1398/06/23  46618  N58\n",
      "257961   869344004        19  1398/06/23  46621  N58\n",
      "257962  1002227687        19  1398/06/23  46678  N58\n",
      "257963  3794573388        19  1398/06/23  46734  N58\n",
      "257964  3794573388        19  1398/06/23  46735  N58\n",
      "257965  3794573388        19  1398/06/23  46737  N58\n",
      "257966   427670030        19  1398/06/23  46756  N58\n",
      "257967  2053168770        19  1398/06/23  46977  N58\n",
      "257968  2053168770        19  1398/06/23  46979  N58\n",
      "first row of the selected chunck : \n",
      " [1832060765 19 '1398/06/23' 40905 'N58']\n",
      "31\n",
      "t0 = 40905\n",
      "ts = 46979\n",
      "time_intervals 10\n",
      "Origin destination interval view reindex \n",
      "    time_in  time_out\n",
      "0  40905.0   41505.0\n",
      "1  45705.0   46905.0\n",
      "OD bus stations of transactions: \n",
      "            CardID LineCode       FDate   Time  plat Station\n",
      "0       542446139        1  1398/06/23  24030  A145    3169\n",
      "1      2620656172        1  1398/06/23  24302  A145    3169\n",
      "2      3446252780        1  1398/06/23  26200  A145    1227\n",
      "3         7900260        1  1398/06/23  29677  A145    3169\n",
      "4       361857972        1  1398/06/23  29720  A145    3169\n",
      "...           ...      ...         ...    ...   ...     ...\n",
      "48319  1002227687       19  1398/06/23  46678   N58    4134\n",
      "48320  3794573388       19  1398/06/23  46734   N58    4134\n",
      "48321  3794573388       19  1398/06/23  46735   N58    4134\n",
      "48322  3794573388       19  1398/06/23  46737   N58    4134\n",
      "48323   427670030       19  1398/06/23  46756   N58    4134\n",
      "\n",
      "[48324 rows x 6 columns]\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "stations in a specefic bus line 20\n",
      "len-of-go stations: 33\n",
      "len-of-back stations: 31\n",
      "len-of-go back stations: 0\n",
      "first Station  [1643 '20' '1' 'go' '???????-20' 51.650624 32.715316 'od' 'normal' 'no'] 1643\n",
      "last Station  [1882 '20' '1' 'back' '?????? ??? ??????? -20' 51.691336 32.683288 'od'\n",
      " 'normal' 'yes']\n",
      "['A166' 'E142' 'E46' 'F130' 'M133' 'M54' 'M56' 'M57' 'M86' 'N100' 'N106'\n",
      " 'N97']\n",
      "transactions in line 20 plat A166\n",
      "ps: \n",
      "              CardID  LineCode       FDate   Time  plat\n",
      "251719     8150548        20  1398/06/23  21721  A166\n",
      "251720  2742789108        20  1398/06/23  21768  A166\n",
      "251721  3630672924        20  1398/06/23  21823  A166\n",
      "251722  1764897204        20  1398/06/23  21858  A166\n",
      "251723   169069540        20  1398/06/23  21868  A166\n",
      "...            ...       ...         ...    ...   ...\n",
      "6789    3257740509        20  1398/06/23  75896  A166\n",
      "6788    2590553396        20  1398/06/23  75897  A166\n",
      "6790     391902282        20  1398/06/23  76524  A166\n",
      "251717   480377764        20  1398/06/23  77746  A166\n",
      "251718   480377764        20  1398/06/23  77748  A166\n",
      "\n",
      "[296 rows x 5 columns]\n",
      "first row of the selected chunck : \n",
      " [8150548 20 '1398/06/23' 21721 'A166']\n",
      "296\n",
      "t0 = 21721\n",
      "ts = 77748\n",
      "time_intervals 93\n",
      "Origin destination interval view reindex \n",
      "     time_in  time_out\n",
      "0   21721.0   22321.0\n",
      "1   24121.0   25321.0\n",
      "2   26521.0   29521.0\n",
      "3   31321.0   32521.0\n",
      "4   34921.0   36721.0\n",
      "5   39121.0   39721.0\n",
      "6   43321.0   43921.0\n",
      "7   46321.0   46921.0\n",
      "8   49321.0   51121.0\n",
      "9   52321.0   53521.0\n",
      "10  55321.0   58321.0\n",
      "11  60121.0   60721.0\n",
      "12  63721.0   65521.0\n",
      "13  67921.0   68521.0\n",
      "14  72121.0   72721.0\n",
      "15  74521.0   75121.0\n",
      "OD bus stations of transactions: \n",
      "            CardID LineCode       FDate   Time  plat Station\n",
      "0       542446139        1  1398/06/23  24030  A145    3169\n",
      "1      2620656172        1  1398/06/23  24302  A145    3169\n",
      "2      3446252780        1  1398/06/23  26200  A145    1227\n",
      "3         7900260        1  1398/06/23  29677  A145    3169\n",
      "4       361857972        1  1398/06/23  29720  A145    3169\n",
      "...           ...      ...         ...    ...   ...     ...\n",
      "48434  1632570693       20  1398/06/23  72670  A166    1643\n",
      "48435  2854973118       20  1398/06/23  72672  A166    1643\n",
      "48436  3444902044       20  1398/06/23  72673  A166    1643\n",
      "48437   179869894       20  1398/06/23  75025  A166    1882\n",
      "48438  1779969828       20  1398/06/23  75038  A166    1882\n",
      "\n",
      "[48439 rows x 6 columns]\n",
      "transactions in line 20 plat E142\n",
      "ps: \n",
      "              CardID  LineCode       FDate   Time  plat\n",
      "145362  2740809060        20  1398/06/23  67349  E142\n",
      "145364   805330802        20  1398/06/23  67459  E142\n",
      "145363   981865771        20  1398/06/23  67538  E142\n",
      "145365  4266173826        20  1398/06/23  67903  E142\n",
      "145366  4266173826        20  1398/06/23  67905  E142\n",
      "145367  3791893244        20  1398/06/23  67909  E142\n",
      "145368  3254647277        20  1398/06/23  68266  E142\n",
      "145369   721757516        20  1398/06/23  68868  E142\n",
      "145370  2587111700        20  1398/06/23  68872  E142\n",
      "145371  3792552844        20  1398/06/23  69461  E142\n",
      "145373  4266127026        20  1398/06/23  69561  E142\n",
      "145372  2675598756        20  1398/06/23  69564  E142\n",
      "145374  2742425540        20  1398/06/23  71446  E142\n",
      "145375  2590477796        20  1398/06/23  71567  E142\n",
      "145376  2590477796        20  1398/06/23  71570  E142\n",
      "145377   998352750        20  1398/06/23  71611  E142\n",
      "145378  3630868396        20  1398/06/23  72055  E142\n",
      "145379  1295072686        20  1398/06/23  72156  E142\n",
      "145380  4245466071        20  1398/06/23  72253  E142\n",
      "145382   736391360        20  1398/06/23  72386  E142\n",
      "145381  2239162812        20  1398/06/23  72553  E142\n",
      "145383  2676894036        20  1398/06/23  72840  E142\n",
      "145384   869232161        20  1398/06/23  73021  E142\n",
      "145385  1000870190        20  1398/06/23  73403  E142\n",
      "first row of the selected chunck : \n",
      " [2740809060 20 '1398/06/23' 67349 'E142']\n",
      "24\n",
      "t0 = 67349\n",
      "ts = 73403\n",
      "time_intervals 10\n",
      "Origin destination interval view reindex \n",
      "    time_in  time_out\n",
      "0  67349.0   67949.0\n",
      "1  70349.0   71549.0\n",
      "OD bus stations of transactions: \n",
      "            CardID LineCode       FDate   Time  plat Station\n",
      "0       542446139        1  1398/06/23  24030  A145    3169\n",
      "1      2620656172        1  1398/06/23  24302  A145    3169\n",
      "2      3446252780        1  1398/06/23  26200  A145    1227\n",
      "3         7900260        1  1398/06/23  29677  A145    3169\n",
      "4       361857972        1  1398/06/23  29720  A145    3169\n",
      "...           ...      ...         ...    ...   ...     ...\n",
      "48441   981865771       20  1398/06/23  67538  E142    1643\n",
      "48442  4266173826       20  1398/06/23  67903  E142    1643\n",
      "48443  4266173826       20  1398/06/23  67905  E142    1643\n",
      "48444  3791893244       20  1398/06/23  67909  E142    1643\n",
      "48445  2742425540       20  1398/06/23  71446  E142    1882\n",
      "\n",
      "[48446 rows x 6 columns]\n",
      "transactions in line 20 plat E46\n",
      "ps: \n",
      "              CardID  LineCode       FDate   Time plat\n",
      "79689   1611713275        20  1398/06/23  23506  E46\n",
      "79692   1280532638        20  1398/06/23  23572  E46\n",
      "79695   3791989084        20  1398/06/23  23688  E46\n",
      "79699   3631043388        20  1398/06/23  23942  E46\n",
      "79702   2742043268        20  1398/06/23  23948  E46\n",
      "...            ...       ...         ...    ...  ...\n",
      "137344  4276460786        20  1398/06/23  54534  E46\n",
      "137346  3183403294        20  1398/06/23  54733  E46\n",
      "137349   981935499        20  1398/06/23  54816  E46\n",
      "137352  3405953780        20  1398/06/23  55059  E46\n",
      "79686   3792427260        20  1398/06/23  57202  E46\n",
      "\n",
      "[169 rows x 5 columns]\n",
      "first row of the selected chunck : \n",
      " [1611713275 20 '1398/06/23' 23506 'E46']\n",
      "169\n",
      "t0 = 23506\n",
      "ts = 57202\n",
      "time_intervals 56\n",
      "Origin destination interval view reindex \n",
      "     time_in  time_out\n",
      "0   23506.0   24106.0\n",
      "1   25306.0   26506.0\n",
      "2   28306.0   31306.0\n",
      "3   32506.0   34906.0\n",
      "4   36706.0   38506.0\n",
      "5   40306.0   41506.0\n",
      "6   43306.0   44506.0\n",
      "7   46906.0   47506.0\n",
      "8   48106.0   48706.0\n",
      "9   51106.0   52306.0\n",
      "10  54106.0   54706.0\n",
      "11  55906.0   57106.0\n",
      "OD bus stations of transactions: \n",
      "            CardID LineCode       FDate   Time  plat Station\n",
      "0       542446139        1  1398/06/23  24030  A145    3169\n",
      "1      2620656172        1  1398/06/23  24302  A145    3169\n",
      "2      3446252780        1  1398/06/23  26200  A145    1227\n",
      "3         7900260        1  1398/06/23  29677  A145    3169\n",
      "4       361857972        1  1398/06/23  29720  A145    3169\n",
      "...           ...      ...         ...    ...   ...     ...\n",
      "48485  2481825812       20  1398/06/23  52194   E46    1882\n",
      "48486  3254022973       20  1398/06/23  52243   E46    1882\n",
      "48487   555424686       20  1398/06/23  52246   E46    1882\n",
      "48488  3152128382       20  1398/06/23  52250   E46    1882\n",
      "48489  4276460786       20  1398/06/23  54534   E46    1643\n",
      "\n",
      "[48490 rows x 6 columns]\n",
      "transactions in line 20 plat F130\n",
      "ps: \n",
      "              CardID  LineCode       FDate   Time  plat\n",
      "115275  3678870748        20  1398/06/23  25663  F130\n",
      "115276  3547466740        20  1398/06/23  25869  F130\n",
      "115277   998413406        20  1398/06/23  26033  F130\n",
      "115284  3180940974        20  1398/06/23  26131  F130\n",
      "115278  2137702525        20  1398/06/23  26132  F130\n",
      "...            ...       ...         ...    ...   ...\n",
      "483041   721754742        20  1398/06/23  74021  F130\n",
      "483040  2855291342        20  1398/06/23  74026  F130\n",
      "483042  2138946845        20  1398/06/23  74739  F130\n",
      "483043  3405793686        20  1398/06/23  74939  F130\n",
      "483044  3405793686        20  1398/06/23  74940  F130\n",
      "\n",
      "[313 rows x 5 columns]\n",
      "first row of the selected chunck : \n",
      " [3678870748 20 '1398/06/23' 25663 'F130']\n",
      "313\n",
      "t0 = 25663\n",
      "ts = 74940\n",
      "time_intervals 82\n",
      "Origin destination interval view reindex \n",
      "     time_in  time_out\n",
      "0   25663.0   26263.0\n",
      "1   28063.0   29263.0\n",
      "2   31063.0   32863.0\n",
      "3   35863.0   36463.0\n",
      "4   39463.0   40663.0\n",
      "5   43063.0   44263.0\n",
      "6   46063.0   48463.0\n",
      "7   50863.0   53263.0\n",
      "8   55063.0   55663.0\n",
      "9   57463.0   58063.0\n",
      "10  59863.0   62263.0\n",
      "11  64663.0   65263.0\n",
      "12  67663.0   69463.0\n",
      "13  72463.0   73063.0\n",
      "OD bus stations of transactions: \n",
      "            CardID LineCode       FDate   Time  plat Station\n",
      "0       542446139        1  1398/06/23  24030  A145    3169\n",
      "1      2620656172        1  1398/06/23  24302  A145    3169\n",
      "2      3446252780        1  1398/06/23  26200  A145    1227\n",
      "3         7900260        1  1398/06/23  29677  A145    3169\n",
      "4       361857972        1  1398/06/23  29720  A145    3169\n",
      "...           ...      ...         ...    ...   ...     ...\n",
      "48549   721819378       20  1398/06/23  72835  F130    1882\n",
      "48550  2587963844       20  1398/06/23  72877  F130    1882\n",
      "48551   256540177       20  1398/06/23  72926  F130    1882\n",
      "48552  2239181545       20  1398/06/23  72966  F130    1882\n",
      "48553  1835526317       20  1398/06/23  73004  F130    1882\n",
      "\n",
      "[48554 rows x 6 columns]\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "transactions in line 20 plat M133\n",
      "ps: \n",
      "              CardID  LineCode       FDate   Time  plat\n",
      "54009   3206493717        20  1398/06/23  22965  M133\n",
      "54010   2680571966        20  1398/06/23  22968  M133\n",
      "54012    722263773        20  1398/06/23  22971  M133\n",
      "54011   2123283332        20  1398/06/23  23086  M133\n",
      "54013   1360425722        20  1398/06/23  23177  M133\n",
      "...            ...       ...         ...    ...   ...\n",
      "265490  1526981230        20  1398/06/23  74408  M133\n",
      "265487  2680992580        20  1398/06/23  74506  M133\n",
      "265491  3553763420        20  1398/06/23  74507  M133\n",
      "265492   235086106        20  1398/06/23  74749  M133\n",
      "265493  3679901788        20  1398/06/23  74751  M133\n",
      "\n",
      "[305 rows x 5 columns]\n",
      "first row of the selected chunck : \n",
      " [3206493717 20 '1398/06/23' 22965 'M133']\n",
      "305\n",
      "t0 = 22965\n",
      "ts = 74751\n",
      "time_intervals 86\n",
      "Origin destination interval view reindex \n",
      "     time_in  time_out\n",
      "0   22965.0   23565.0\n",
      "1   24765.0   25965.0\n",
      "2   27765.0   28965.0\n",
      "3   32565.0   33765.0\n",
      "4   36165.0   37965.0\n",
      "5   39765.0   48165.0\n",
      "6   50565.0   52965.0\n",
      "7   57765.0   59565.0\n",
      "8   61365.0   62565.0\n",
      "9   65565.0   66765.0\n",
      "10  69165.0   69765.0\n",
      "11  73365.0   74565.0\n",
      "OD bus stations of transactions: \n",
      "            CardID LineCode       FDate   Time  plat Station\n",
      "0       542446139        1  1398/06/23  24030  A145    3169\n",
      "1      2620656172        1  1398/06/23  24302  A145    3169\n",
      "2      3446252780        1  1398/06/23  26200  A145    1227\n",
      "3         7900260        1  1398/06/23  29677  A145    3169\n",
      "4       361857972        1  1398/06/23  29720  A145    3169\n",
      "...           ...      ...         ...    ...   ...     ...\n",
      "48678  2740957268       20  1398/06/23  74403  M133    1882\n",
      "48679  1526981230       20  1398/06/23  74407  M133    1882\n",
      "48680  1526981230       20  1398/06/23  74408  M133    1882\n",
      "48681  2680992580       20  1398/06/23  74506  M133    1882\n",
      "48682  3553763420       20  1398/06/23  74507  M133    1882\n",
      "\n",
      "[48683 rows x 6 columns]\n",
      "transactions in line 20 plat M54\n",
      "ps: \n",
      "              CardID  LineCode       FDate   Time plat\n",
      "66605    721967772        20  1398/06/23  24221  M54\n",
      "66606    342995780        20  1398/06/23  24221  M54\n",
      "66607    721871377        20  1398/06/23  24223  M54\n",
      "66608   3648709620        20  1398/06/23  24226  M54\n",
      "66609   4275324930        20  1398/06/23  24228  M54\n",
      "...            ...       ...         ...    ...  ...\n",
      "499209  3217804261        20  1398/06/23  72460  M54\n",
      "499210   982903035        20  1398/06/23  72963  M54\n",
      "499211  1835451725        20  1398/06/23  72970  M54\n",
      "66603   3678712172        20  1398/06/23  74704  M54\n",
      "66604   3678712172        20  1398/06/23  74706  M54\n",
      "\n",
      "[258 rows x 5 columns]\n",
      "first row of the selected chunck : \n",
      " [721967772 20 '1398/06/23' 24221 'M54']\n",
      "258\n",
      "t0 = 24221\n",
      "ts = 74706\n",
      "time_intervals 84\n",
      "Origin destination interval view reindex \n",
      "     time_in  time_out\n",
      "0   24221.0   24821.0\n",
      "1   26621.0   27221.0\n",
      "2   29021.0   32021.0\n",
      "3   33821.0   41621.0\n",
      "4   44621.0   45821.0\n",
      "5   48221.0   49421.0\n",
      "6   51221.0   53021.0\n",
      "7   56021.0   56621.0\n",
      "8   57821.0   59621.0\n",
      "9   62021.0   63221.0\n",
      "10  64421.0   65021.0\n",
      "11  66221.0   67421.0\n",
      "12  69821.0   70421.0\n",
      "13  74021.0   74621.0\n",
      "OD bus stations of transactions: \n",
      "            CardID LineCode       FDate   Time  plat Station\n",
      "0       542446139        1  1398/06/23  24030  A145    3169\n",
      "1      2620656172        1  1398/06/23  24302  A145    3169\n",
      "2      3446252780        1  1398/06/23  26200  A145    1227\n",
      "3         7900260        1  1398/06/23  29677  A145    3169\n",
      "4       361857972        1  1398/06/23  29720  A145    3169\n",
      "...           ...      ...         ...    ...   ...     ...\n",
      "48788   172996918       20  1398/06/23  67339   M54    1882\n",
      "48789  2052207554       20  1398/06/23  70374   M54    1643\n",
      "48790  2052207554       20  1398/06/23  70375   M54    1643\n",
      "48791  2620627260       20  1398/06/23  70375   M54    1643\n",
      "48792  2680288606       20  1398/06/23  70381   M54    1643\n",
      "\n",
      "[48793 rows x 6 columns]\n",
      "transactions in line 20 plat M56\n",
      "ps: \n",
      "              CardID  LineCode       FDate   Time plat\n",
      "12237    556342782        20  1398/06/23  24790  M56\n",
      "12239   3677912348        20  1398/06/23  24792  M56\n",
      "12243    736682624        20  1398/06/23  24857  M56\n",
      "12249   4265658578        20  1398/06/23  24910  M56\n",
      "12252   3108835605        20  1398/06/23  24913  M56\n",
      "...            ...       ...         ...    ...  ...\n",
      "313961  2122830548        20  1398/06/23  73005  M56\n",
      "313966  2186398403        20  1398/06/23  73020  M56\n",
      "313968  2741755332        20  1398/06/23  73089  M56\n",
      "314660   262597585        20  1398/06/23  73766  M56\n",
      "314662   808529298        20  1398/06/23  76203  M56\n",
      "\n",
      "[277 rows x 5 columns]\n",
      "first row of the selected chunck : \n",
      " [556342782 20 '1398/06/23' 24790 'M56']\n",
      "277\n",
      "t0 = 24790\n",
      "ts = 76203\n",
      "time_intervals 86\n",
      "Origin destination interval view reindex \n",
      "     time_in  time_out\n",
      "0   24790.0   25390.0\n",
      "1   26590.0   27190.0\n",
      "2   29590.0   31990.0\n",
      "3   33790.0   34990.0\n",
      "4   37390.0   39190.0\n",
      "5   42190.0   42790.0\n",
      "6   45190.0   45790.0\n",
      "7   46990.0   48190.0\n",
      "8   48790.0   49990.0\n",
      "9   52390.0   54190.0\n",
      "10  55990.0   56590.0\n",
      "11  58990.0   60790.0\n",
      "12  63190.0   64390.0\n",
      "13  66190.0   67990.0\n",
      "14  70390.0   71590.0\n",
      "15  74590.0   76390.0\n",
      "OD bus stations of transactions: \n",
      "            CardID LineCode       FDate   Time  plat Station\n",
      "0       542446139        1  1398/06/23  24030  A145    3169\n",
      "1      2620656172        1  1398/06/23  24302  A145    3169\n",
      "2      3446252780        1  1398/06/23  26200  A145    1227\n",
      "3         7900260        1  1398/06/23  29677  A145    3169\n",
      "4       361857972        1  1398/06/23  29720  A145    3169\n",
      "...           ...      ...         ...    ...   ...     ...\n",
      "48869  2053063506       20  1398/06/23  71156   M56    1643\n",
      "48870  2138580285       20  1398/06/23  71370   M56    1643\n",
      "48871   982350635       20  1398/06/23  71376   M56    1643\n",
      "48872  2855819326       20  1398/06/23  71481   M56    1643\n",
      "48873   808529298       20  1398/06/23  76203   M56    1882\n",
      "\n",
      "[48874 rows x 6 columns]\n",
      "transactions in line 20 plat M57\n",
      "ps: \n",
      "              CardID  LineCode       FDate   Time plat\n",
      "139090   721779099        20  1398/06/23  21647  M57\n",
      "139094   429384862        20  1398/06/23  25342  M57\n",
      "127693   180473108        20  1398/06/23  25371  M57\n",
      "127694  1531126270        20  1398/06/23  25381  M57\n",
      "127695   428794334        20  1398/06/23  25384  M57\n",
      "...            ...       ...         ...    ...  ...\n",
      "170927  3258282909        20  1398/06/23  72728  M57\n",
      "170921   169069540        20  1398/06/23  72744  M57\n",
      "170929   342995780        20  1398/06/23  73769  M57\n",
      "170931  3209050628        20  1398/06/23  74580  M57\n",
      "170933   113967107        20  1398/06/23  75493  M57\n",
      "\n",
      "[315 rows x 5 columns]\n",
      "first row of the selected chunck : \n",
      " [721779099 20 '1398/06/23' 21647 'M57']\n",
      "315\n",
      "t0 = 21647\n",
      "ts = 75493\n",
      "time_intervals 90\n",
      "Origin destination interval view reindex \n",
      "     time_in  time_out\n",
      "0   21647.0   25847.0\n",
      "1   27647.0   28247.0\n",
      "2   30647.0   33047.0\n",
      "3   34847.0   36047.0\n",
      "4   38447.0   40247.0\n",
      "5   42047.0   42647.0\n",
      "6   46247.0   46847.0\n",
      "7   49847.0   50447.0\n",
      "8   53447.0   54647.0\n",
      "9   55847.0   57647.0\n",
      "10  60047.0   61847.0\n",
      "11  67847.0   69047.0\n",
      "12  71447.0   72047.0\n",
      "13  74447.0   75047.0\n",
      "OD bus stations of transactions: \n",
      "            CardID LineCode       FDate   Time  plat Station\n",
      "0       542446139        1  1398/06/23  24030  A145    3169\n",
      "1      2620656172        1  1398/06/23  24302  A145    3169\n",
      "2      3446252780        1  1398/06/23  26200  A145    1227\n",
      "3         7900260        1  1398/06/23  29677  A145    3169\n",
      "4       361857972        1  1398/06/23  29720  A145    3169\n",
      "...           ...      ...         ...    ...   ...     ...\n",
      "48940   722173009       20  1398/06/23  68664   M57    1882\n",
      "48941   262246881       20  1398/06/23  68765   M57    1882\n",
      "48942  2053130242       20  1398/06/23  71879   M57    1643\n",
      "48943   173244788       20  1398/06/23  71949   M57    1643\n",
      "48944  3209050628       20  1398/06/23  74580   M57    1882\n",
      "\n",
      "[48945 rows x 6 columns]\n",
      "transactions in line 20 plat M86\n",
      "ps: \n",
      "              CardID  LineCode       FDate   Time plat\n",
      "306174  3210010484        20  1398/06/23  22802  M86\n",
      "306176   981664267        20  1398/06/23  22934  M86\n",
      "306179   721901172        20  1398/06/23  22991  M86\n",
      "306185  1578154405        20  1398/06/23  22999  M86\n",
      "306188  3794584476        20  1398/06/23  23005  M86\n",
      "...            ...       ...         ...    ...  ...\n",
      "192859  1372045742        20  1398/06/23  76889  M86\n",
      "192911  3604358492        20  1398/06/23  76980  M86\n",
      "192913  3604358492        20  1398/06/23  76982  M86\n",
      "192921  2505504596        20  1398/06/23  77274  M86\n",
      "192915  2117623844        20  1398/06/23  77283  M86\n",
      "\n",
      "[275 rows x 5 columns]\n",
      "first row of the selected chunck : \n",
      " [3210010484 20 '1398/06/23' 22802 'M86']\n",
      "275\n",
      "t0 = 22802\n",
      "ts = 77283\n",
      "time_intervals 91\n",
      "Origin destination interval view reindex \n",
      "     time_in  time_out\n",
      "0   22802.0   23402.0\n",
      "1   24002.0   25202.0\n",
      "2   27002.0   30002.0\n",
      "3   31802.0   33602.0\n",
      "4   34802.0   37202.0\n",
      "5   39002.0   40202.0\n",
      "6   42602.0   44402.0\n",
      "7   46802.0   47402.0\n",
      "8   50402.0   51602.0\n",
      "9   52802.0   54002.0\n",
      "10  55802.0   58202.0\n",
      "11  59402.0   61802.0\n",
      "12  64802.0   65402.0\n",
      "13  68402.0   69002.0\n",
      "14  72602.0   73802.0\n",
      "15  74402.0   75002.0\n",
      "16  75602.0   77402.0\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "OD bus stations of transactions: \n",
      "            CardID LineCode       FDate   Time  plat Station\n",
      "0       542446139        1  1398/06/23  24030  A145    3169\n",
      "1      2620656172        1  1398/06/23  24302  A145    3169\n",
      "2      3446252780        1  1398/06/23  26200  A145    1227\n",
      "3         7900260        1  1398/06/23  29677  A145    3169\n",
      "4       361857972        1  1398/06/23  29720  A145    3169\n",
      "...           ...      ...         ...    ...   ...     ...\n",
      "49095  1372045742       20  1398/06/23  76889   M86    1643\n",
      "49096  3604358492       20  1398/06/23  76980   M86    1643\n",
      "49097  3604358492       20  1398/06/23  76982   M86    1643\n",
      "49098  2505504596       20  1398/06/23  77274   M86    1643\n",
      "49099  2117623844       20  1398/06/23  77283   M86    1643\n",
      "\n",
      "[49100 rows x 6 columns]\n",
      "transactions in line 20 plat N100\n",
      "ps: \n",
      "              CardID  LineCode       FDate   Time  plat\n",
      "216742   262169601        20  1398/06/23  23108  N100\n",
      "216743   582536635        20  1398/06/23  23135  N100\n",
      "216744  3152937694        20  1398/06/23  23139  N100\n",
      "247455  2116257748        20  1398/06/23  23863  N100\n",
      "247456  1598496548        20  1398/06/23  23983  N100\n",
      "...            ...       ...         ...    ...   ...\n",
      "216740    11316263        20  1398/06/23  75370  N100\n",
      "216741    11316263        20  1398/06/23  75372  N100\n",
      "117899  1295551006        20  1398/06/23  75706  N100\n",
      "117900  2499791636        20  1398/06/23  75708  N100\n",
      "117901  4059663229        20  1398/06/23  75711  N100\n",
      "\n",
      "[406 rows x 5 columns]\n",
      "first row of the selected chunck : \n",
      " [262169601 20 '1398/06/23' 23108 'N100']\n",
      "406\n",
      "t0 = 23108\n",
      "ts = 75711\n",
      "time_intervals 88\n",
      "Origin destination interval view reindex \n",
      "     time_in  time_out\n",
      "0   23108.0   23708.0\n",
      "1   24908.0   27308.0\n",
      "2   29108.0   29708.0\n",
      "3   32708.0   33908.0\n",
      "4   36308.0   37508.0\n",
      "5   40508.0   41108.0\n",
      "6   44108.0   44708.0\n",
      "7   48308.0   48908.0\n",
      "8   50708.0   51308.0\n",
      "9   54308.0   56108.0\n",
      "10  57908.0   58508.0\n",
      "11  61508.0   63308.0\n",
      "12  68708.0   70508.0\n",
      "13  72908.0   73508.0\n",
      "OD bus stations of transactions: \n",
      "            CardID LineCode       FDate   Time  plat Station\n",
      "0       542446139        1  1398/06/23  24030  A145    3169\n",
      "1      2620656172        1  1398/06/23  24302  A145    3169\n",
      "2      3446252780        1  1398/06/23  26200  A145    1227\n",
      "3         7900260        1  1398/06/23  29677  A145    3169\n",
      "4       361857972        1  1398/06/23  29720  A145    3169\n",
      "...           ...      ...         ...    ...   ...     ...\n",
      "49172  2502184068       20  1398/06/23  70333  N100    1643\n",
      "49173   722051852       20  1398/06/23  73157  N100    1882\n",
      "49174  3547509572       20  1398/06/23  73159  N100    1882\n",
      "49175   210631067       20  1398/06/23  73438  N100    1882\n",
      "49176  3547505732       20  1398/06/23  73504  N100    1882\n",
      "\n",
      "[49177 rows x 6 columns]\n",
      "transactions in line 20 plat N106\n",
      "ps: \n",
      "              CardID  LineCode       FDate   Time  plat\n",
      "139482  1528021662        20  1398/06/23  23982  N106\n",
      "139489  3630980140        20  1398/06/23  24567  N106\n",
      "139492   483119748        20  1398/06/23  27440  N106\n",
      "139494  3254548269        20  1398/06/23  27498  N106\n",
      "139500  3254548269        20  1398/06/23  27499  N106\n",
      "...            ...       ...         ...    ...   ...\n",
      "174199  1788469300        20  1398/06/23  76789  N106\n",
      "174201  1360733706        20  1398/06/23  76795  N106\n",
      "174204  1360733706        20  1398/06/23  76797  N106\n",
      "174194  1360966698        20  1398/06/23  76808  N106\n",
      "174206  2137602557        20  1398/06/23  76841  N106\n",
      "\n",
      "[336 rows x 5 columns]\n",
      "first row of the selected chunck : \n",
      " [1528021662 20 '1398/06/23' 23982 'N106']\n",
      "336\n",
      "t0 = 23982\n",
      "ts = 76841\n",
      "time_intervals 88\n",
      "Origin destination interval view reindex \n",
      "     time_in  time_out\n",
      "0   23982.0   24582.0\n",
      "1   25182.0   27582.0\n",
      "2   29982.0   30582.0\n",
      "3   32982.0   34782.0\n",
      "4   40782.0   41382.0\n",
      "5   44382.0   46182.0\n",
      "6   48582.0   49782.0\n",
      "7   51582.0   52182.0\n",
      "8   54582.0   56982.0\n",
      "9   59382.0   59982.0\n",
      "10  62382.0   64182.0\n",
      "11  70782.0   71382.0\n",
      "12  73782.0   74382.0\n",
      "OD bus stations of transactions: \n",
      "            CardID LineCode       FDate   Time  plat Station\n",
      "0       542446139        1  1398/06/23  24030  A145    3169\n",
      "1      2620656172        1  1398/06/23  24302  A145    3169\n",
      "2      3446252780        1  1398/06/23  26200  A145    1227\n",
      "3         7900260        1  1398/06/23  29677  A145    3169\n",
      "4       361857972        1  1398/06/23  29720  A145    3169\n",
      "...           ...      ...         ...    ...   ...     ...\n",
      "49298  1831896429       20  1398/06/23  64027  N106    1643\n",
      "49299  1831896429       20  1398/06/23  64029  N106    1643\n",
      "49300   177735014       20  1398/06/23  71243  N106    1882\n",
      "49301  1580875589       20  1398/06/23  74277  N106    1643\n",
      "49302  3678747340       20  1398/06/23  74335  N106    1643\n",
      "\n",
      "[49303 rows x 6 columns]\n",
      "transactions in line 20 plat N97\n",
      "ps: \n",
      "              CardID  LineCode       FDate   Time plat\n",
      "193060  4257121284        20  1398/06/23  24481  N97\n",
      "193072   736608368        20  1398/06/23  28210  N97\n",
      "193063  2962405349        20  1398/06/23  28318  N97\n",
      "193066  2962405349        20  1398/06/23  28320  N97\n",
      "193075   212925275        20  1398/06/23  28321  N97\n",
      "...            ...       ...         ...    ...  ...\n",
      "27051   1372015294        20  1398/06/23  65903  N97\n",
      "27055   1372015294        20  1398/06/23  65905  N97\n",
      "27057   1372015294        20  1398/06/23  65906  N97\n",
      "27060   1372015294        20  1398/06/23  65907  N97\n",
      "27062    172994998        20  1398/06/23  65950  N97\n",
      "\n",
      "[209 rows x 5 columns]\n",
      "first row of the selected chunck : \n",
      " [4257121284 20 '1398/06/23' 24481 'N97']\n",
      "209\n",
      "t0 = 24481\n",
      "ts = 65950\n",
      "time_intervals 69\n",
      "Origin destination interval view reindex \n",
      "     time_in  time_out\n",
      "0   24481.0   28681.0\n",
      "1   31081.0   31681.0\n",
      "2   33481.0   35881.0\n",
      "3   38281.0   38881.0\n",
      "4   41881.0   43081.0\n",
      "5   44881.0   46081.0\n",
      "6   49081.0   50881.0\n",
      "7   52081.0   52681.0\n",
      "8   55081.0   57481.0\n",
      "9   59281.0   60481.0\n",
      "10  62881.0   64681.0\n",
      "OD bus stations of transactions: \n",
      "            CardID LineCode       FDate   Time  plat Station\n",
      "0       542446139        1  1398/06/23  24030  A145    3169\n",
      "1      2620656172        1  1398/06/23  24302  A145    3169\n",
      "2      3446252780        1  1398/06/23  26200  A145    1227\n",
      "3         7900260        1  1398/06/23  29677  A145    3169\n",
      "4       361857972        1  1398/06/23  29720  A145    3169\n",
      "...           ...      ...         ...    ...   ...     ...\n",
      "49470   235863050       20  1398/06/23  64478   N97    1643\n",
      "49471  3791794652       20  1398/06/23  64606   N97    1643\n",
      "49472   396816730       20  1398/06/23  64613   N97    1643\n",
      "49473   396816730       20  1398/06/23  64615   N97    1643\n",
      "49474  4269852306       20  1398/06/23  64663   N97    1643\n",
      "\n",
      "[49475 rows x 6 columns]\n",
      "stations in a specefic bus line 22\n",
      "len-of-go stations: 23\n",
      "len-of-back stations: 26\n",
      "len-of-go back stations: 0\n",
      "first Station  [2218 '22' '1' 'go' '??????-22' 51.708411 32.702195 'od' 'normal' 'no'] 2218\n",
      "last Station  [1896 '22' '1' 'back' '?????? ??? -22' 51.64906 32.672988 'od' 'normal'\n",
      " 'yes']\n",
      "['C57' 'D55' 'D95' 'E109' 'E212' 'E36' 'E39' 'F121' 'F98' 'F99' 'N199'\n",
      " 'N37' 'N89']\n",
      "transactions in line 22 plat C57\n",
      "ps: \n",
      "              CardID  LineCode       FDate   Time plat\n",
      "545853   262145537        22  1398/06/23  23930  C57\n",
      "545854  3178747982        22  1398/06/23  24348  C57\n",
      "545856   174460980        22  1398/06/23  24410  C57\n",
      "545857  2509149892        22  1398/06/23  24412  C57\n",
      "545855   209217739        22  1398/06/23  24523  C57\n",
      "...            ...       ...         ...    ...  ...\n",
      "606138   869383874        22  1398/06/23  75686  C57\n",
      "606139  1765395972        22  1398/06/23  76857  C57\n",
      "606140  3203233556        22  1398/06/23  77068  C57\n",
      "545851   482738772        22  1398/06/23  77247  C57\n",
      "545852   482738772        22  1398/06/23  77256  C57\n",
      "\n",
      "[244 rows x 5 columns]\n",
      "first row of the selected chunck : \n",
      " [262145537 22 '1398/06/23' 23930 'C57']\n",
      "244\n",
      "t0 = 23930\n",
      "ts = 77256\n",
      "time_intervals 89\n",
      "Origin destination interval view reindex \n",
      "     time_in  time_out\n",
      "0   23930.0   24530.0\n",
      "1   25730.0   26930.0\n",
      "2   28130.0   31730.0\n",
      "3   35330.0   35930.0\n",
      "4   38930.0   41330.0\n",
      "5   45530.0   47930.0\n",
      "6   49730.0   54530.0\n",
      "7   55730.0   57530.0\n",
      "8   58730.0   59930.0\n",
      "9   62330.0   62930.0\n",
      "10  64730.0   65330.0\n",
      "11  67130.0   68330.0\n",
      "12  70130.0   70730.0\n",
      "13  71330.0   71930.0\n",
      "14  73730.0   75530.0\n",
      "15  76730.0   77330.0\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "OD bus stations of transactions: \n",
      "            CardID LineCode       FDate   Time  plat Station\n",
      "0       542446139        1  1398/06/23  24030  A145    3169\n",
      "1      2620656172        1  1398/06/23  24302  A145    3169\n",
      "2      3446252780        1  1398/06/23  26200  A145    1227\n",
      "3         7900260        1  1398/06/23  29677  A145    3169\n",
      "4       361857972        1  1398/06/23  29720  A145    3169\n",
      "...           ...      ...         ...    ...   ...     ...\n",
      "49526  2740708884       22  1398/06/23  75439   C57    2218\n",
      "49527  1765395972       22  1398/06/23  76857   C57    1896\n",
      "49528  3203233556       22  1398/06/23  77068   C57    1896\n",
      "49529   482738772       22  1398/06/23  77247   C57    1896\n",
      "49530   482738772       22  1398/06/23  77256   C57    1896\n",
      "\n",
      "[49531 rows x 6 columns]\n",
      "transactions in line 22 plat D55\n",
      "ps: \n",
      "              CardID  LineCode       FDate   Time plat\n",
      "304365  4244722439        22  1398/06/23  24515  D55\n",
      "304640  3649121396        22  1398/06/23  24629  D55\n",
      "304642  1360892858        22  1398/06/23  25160  D55\n",
      "304644  1360892858        22  1398/06/23  25162  D55\n",
      "304646   869225971        22  1398/06/23  25165  D55\n",
      "...            ...       ...         ...    ...  ...\n",
      "53794   3183388798        22  1398/06/23  72952  D55\n",
      "304359  3680380604        22  1398/06/23  73889  D55\n",
      "304363  3680380604        22  1398/06/23  73892  D55\n",
      "121725  2742025428        22  1398/06/23  74054  D55\n",
      "121729  3106640757        22  1398/06/23  74415  D55\n",
      "\n",
      "[186 rows x 5 columns]\n",
      "first row of the selected chunck : \n",
      " [4244722439 22 '1398/06/23' 24515 'D55']\n",
      "186\n",
      "t0 = 24515\n",
      "ts = 74415\n",
      "time_intervals 83\n",
      "Origin destination interval view reindex \n",
      "     time_in  time_out\n",
      "0   24515.0   25115.0\n",
      "1   27515.0   28715.0\n",
      "2   33515.0   34715.0\n",
      "3   36515.0   37115.0\n",
      "4   39515.0   40715.0\n",
      "5   41915.0   43715.0\n",
      "6   44315.0   44915.0\n",
      "7   46115.0   47315.0\n",
      "8   47915.0   48515.0\n",
      "9   49115.0   50315.0\n",
      "10  52115.0   53915.0\n",
      "11  55715.0   57515.0\n",
      "12  58715.0   59315.0\n",
      "13  61715.0   62915.0\n",
      "14  65315.0   65915.0\n",
      "15  67715.0   68315.0\n",
      "16  69515.0   70715.0\n",
      "17  71315.0   72515.0\n",
      "18  73715.0   74315.0\n",
      "OD bus stations of transactions: \n",
      "            CardID LineCode       FDate   Time  plat Station\n",
      "0       542446139        1  1398/06/23  24030  A145    3169\n",
      "1      2620656172        1  1398/06/23  24302  A145    3169\n",
      "2      3446252780        1  1398/06/23  26200  A145    1227\n",
      "3         7900260        1  1398/06/23  29677  A145    3169\n",
      "4       361857972        1  1398/06/23  29720  A145    3169\n",
      "...           ...      ...         ...    ...   ...     ...\n",
      "49684  4265633522       22  1398/06/23  70354   D55    2218\n",
      "49685   869384517       22  1398/06/23  72485   D55    1896\n",
      "49686  3680380604       22  1398/06/23  73889   D55    2218\n",
      "49687  3680380604       22  1398/06/23  73892   D55    2218\n",
      "49688  2742025428       22  1398/06/23  74054   D55    2218\n",
      "\n",
      "[49689 rows x 6 columns]\n",
      "transactions in line 22 plat D95\n",
      "ps: \n",
      "              CardID  LineCode       FDate   Time plat\n",
      "52868    212077083        22  1398/06/23  27449  D95\n",
      "52872   3630345388        22  1398/06/23  27573  D95\n",
      "52874   2239153977        22  1398/06/23  27574  D95\n",
      "52870    981919515        22  1398/06/23  27588  D95\n",
      "52877   3547102804        22  1398/06/23  27635  D95\n",
      "...            ...       ...         ...    ...  ...\n",
      "157522   721820218        22  1398/06/23  74132  D95\n",
      "157523   721820218        22  1398/06/23  74133  D95\n",
      "157525   980483483        22  1398/06/23  74161  D95\n",
      "157526  3792060668        22  1398/06/23  74229  D95\n",
      "52865   3603963084        22  1398/06/23  77846  D95\n",
      "\n",
      "[152 rows x 5 columns]\n",
      "first row of the selected chunck : \n",
      " [212077083 22 '1398/06/23' 27449 'D95']\n",
      "152\n",
      "t0 = 27449\n",
      "ts = 77846\n",
      "time_intervals 84\n",
      "Origin destination interval view reindex \n",
      "     time_in  time_out\n",
      "0   27449.0   28049.0\n",
      "1   32249.0   32849.0\n",
      "2   34649.0   44249.0\n",
      "3   45449.0   46649.0\n",
      "4   47849.0   48449.0\n",
      "5   50249.0   52049.0\n",
      "6   53849.0   65849.0\n",
      "7   68849.0   70049.0\n",
      "8   71849.0   72449.0\n",
      "9   73049.0   73649.0\n",
      "10  74849.0   77849.0\n",
      "OD bus stations of transactions: \n",
      "            CardID LineCode       FDate   Time  plat Station\n",
      "0       542446139        1  1398/06/23  24030  A145    3169\n",
      "1      2620656172        1  1398/06/23  24302  A145    3169\n",
      "2      3446252780        1  1398/06/23  26200  A145    1227\n",
      "3         7900260        1  1398/06/23  29677  A145    3169\n",
      "4       361857972        1  1398/06/23  29720  A145    3169\n",
      "...           ...      ...         ...    ...   ...     ...\n",
      "49775   181793046       22  1398/06/23  72005   D95    2218\n",
      "49776   479853508       22  1398/06/23  73088   D95    1896\n",
      "49777   479853508       22  1398/06/23  73090   D95    1896\n",
      "49778  3558294577       22  1398/06/23  73220   D95    1896\n",
      "49779  3603963084       22  1398/06/23  77846   D95    2218\n",
      "\n",
      "[49780 rows x 6 columns]\n",
      "transactions in line 22 plat E109\n",
      "ps: \n",
      "               CardID  LineCode       FDate   Time  plat\n",
      "2681432   262302561        22  1398/06/23  27150  E109\n",
      "2681424   483141140        22  1398/06/23  27151  E109\n",
      "2681436  2044524318        22  1398/06/23  27204  E109\n",
      "2681428  3108536165        22  1398/06/23  27206  E109\n",
      "2681440  3678700060        22  1398/06/23  27206  E109\n",
      "...             ...       ...         ...    ...   ...\n",
      "82649     721739092        22  1398/06/23  71804  E109\n",
      "82653    1000747134        22  1398/06/23  71917  E109\n",
      "82656    1000747134        22  1398/06/23  71919  E109\n",
      "82661    4245955303        22  1398/06/23  73680  E109\n",
      "82664    4256158260        22  1398/06/23  73708  E109\n",
      "\n",
      "[200 rows x 5 columns]\n",
      "first row of the selected chunck : \n",
      " [262302561 22 '1398/06/23' 27150 'E109']\n",
      "200\n",
      "t0 = 27150\n",
      "ts = 73708\n",
      "time_intervals 78\n",
      "Origin destination interval view reindex \n",
      "     time_in  time_out\n",
      "0   27150.0   27750.0\n",
      "1   29550.0   30150.0\n",
      "2   33150.0   34350.0\n",
      "3   38550.0   40350.0\n",
      "4   42150.0   43350.0\n",
      "5   43950.0   44550.0\n",
      "6   45150.0   46350.0\n",
      "7   48150.0   49350.0\n",
      "8   51150.0   52350.0\n",
      "9   54150.0   55350.0\n",
      "10  56550.0   58350.0\n",
      "11  59550.0   60750.0\n",
      "12  62550.0   64350.0\n",
      "13  66750.0   67350.0\n",
      "14  68550.0   69150.0\n",
      "15  69750.0   70950.0\n",
      "16  72750.0   73950.0\n",
      "OD bus stations of transactions: \n",
      "            CardID LineCode       FDate   Time  plat Station\n",
      "0       542446139        1  1398/06/23  24030  A145    3169\n",
      "1      2620656172        1  1398/06/23  24302  A145    3169\n",
      "2      3446252780        1  1398/06/23  26200  A145    1227\n",
      "3         7900260        1  1398/06/23  29677  A145    3169\n",
      "4       361857972        1  1398/06/23  29720  A145    3169\n",
      "...           ...      ...         ...    ...   ...     ...\n",
      "49898  3150893630       22  1398/06/23  70848  E109    1896\n",
      "49899   183597254       22  1398/06/23  70850  E109    1896\n",
      "49900  3150893630       22  1398/06/23  70851  E109    1896\n",
      "49901  4245955303       22  1398/06/23  73680  E109    2218\n",
      "49902  4256158260       22  1398/06/23  73708  E109    2218\n",
      "\n",
      "[49903 rows x 6 columns]\n",
      "transactions in line 22 plat E212\n",
      "ps: \n",
      "              CardID  LineCode       FDate   Time  plat\n",
      "178122  3208719780        22  1398/06/23  22405  E212\n",
      "279288  3676274722        22  1398/06/23  22630  E212\n",
      "279290   721981437        22  1398/06/23  22844  E212\n",
      "279293  3152083278        22  1398/06/23  23036  E212\n",
      "279299  3152083278        22  1398/06/23  23037  E212\n",
      "...            ...       ...         ...    ...   ...\n",
      "90801   3181065086        22  1398/06/23  74519  E212\n",
      "90803   3181065086        22  1398/06/23  74521  E212\n",
      "90806   3179320062        22  1398/06/23  75107  E212\n",
      "178116   267495846        22  1398/06/23  76756  E212\n",
      "178119   267495846        22  1398/06/23  76758  E212\n",
      "\n",
      "[186 rows x 5 columns]\n",
      "first row of the selected chunck : \n",
      " [3208719780 22 '1398/06/23' 22405 'E212']\n",
      "186\n",
      "t0 = 22405\n",
      "ts = 76758\n",
      "time_intervals 91\n",
      "Origin destination interval view reindex \n",
      "     time_in  time_out\n",
      "0   22405.0   23005.0\n",
      "1   24205.0   25405.0\n",
      "2   26005.0   27205.0\n",
      "3   29605.0   30805.0\n",
      "4   32605.0   33205.0\n",
      "5   36205.0   38005.0\n",
      "6   40405.0   41005.0\n",
      "7   41605.0   42205.0\n",
      "8   43405.0   45205.0\n",
      "9   47605.0   51805.0\n",
      "10  53005.0   54205.0\n",
      "11  54805.0   55405.0\n",
      "12  56605.0   57805.0\n",
      "13  59005.0   63805.0\n",
      "14  64405.0   66805.0\n",
      "15  68605.0   69805.0\n",
      "16  71605.0   74005.0\n",
      "17  75805.0   77005.0\n",
      "OD bus stations of transactions: \n",
      "            CardID LineCode       FDate   Time  plat Station\n",
      "0       542446139        1  1398/06/23  24030  A145    3169\n",
      "1      2620656172        1  1398/06/23  24302  A145    3169\n",
      "2      3446252780        1  1398/06/23  26200  A145    1227\n",
      "3         7900260        1  1398/06/23  29677  A145    3169\n",
      "4       361857972        1  1398/06/23  29720  A145    3169\n",
      "...           ...      ...         ...    ...   ...     ...\n",
      "49985  2585859636       22  1398/06/23  66741  E212    2218\n",
      "49986  3556943857       22  1398/06/23  69477  E212    1896\n",
      "49987  3677867756       22  1398/06/23  73988  E212    2218\n",
      "49988   267495846       22  1398/06/23  76756  E212    1896\n",
      "49989   267495846       22  1398/06/23  76758  E212    1896\n",
      "\n",
      "[49990 rows x 6 columns]\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "transactions in line 22 plat E36\n",
      "ps: \n",
      "              CardID  LineCode       FDate   Time plat\n",
      "137206   869450241        22  1398/06/23  25904  E36\n",
      "137207  3632000124        22  1398/06/23  25909  E36\n",
      "137208   174709958        22  1398/06/23  26058  E36\n",
      "137209  3152080606        22  1398/06/23  26117  E36\n",
      "137210  2116566356        22  1398/06/23  26151  E36\n",
      "...            ...       ...         ...    ...  ...\n",
      "80120    209169003        22  1398/06/23  70391  E36\n",
      "80122    981434555        22  1398/06/23  71195  E36\n",
      "80124    212891563        22  1398/06/23  71200  E36\n",
      "80244    982937803        22  1398/06/23  71201  E36\n",
      "80245   3553818188        22  1398/06/23  71242  E36\n",
      "\n",
      "[246 rows x 5 columns]\n",
      "first row of the selected chunck : \n",
      " [869450241 22 '1398/06/23' 25904 'E36']\n",
      "246\n",
      "t0 = 25904\n",
      "ts = 71242\n",
      "time_intervals 76\n",
      "Origin destination interval view reindex \n",
      "     time_in  time_out\n",
      "0   25904.0   26504.0\n",
      "1   28304.0   30104.0\n",
      "2   31904.0   33104.0\n",
      "3   34304.0   36704.0\n",
      "4   40304.0   42104.0\n",
      "5   43904.0   44504.0\n",
      "6   45104.0   45704.0\n",
      "7   47504.0   48704.0\n",
      "8   51104.0   51704.0\n",
      "9   53504.0   55904.0\n",
      "10  57704.0   58904.0\n",
      "11  60104.0   61304.0\n",
      "12  63104.0   64304.0\n",
      "13  66104.0   67304.0\n",
      "14  67904.0   68504.0\n",
      "15  69104.0   69704.0\n",
      "OD bus stations of transactions: \n",
      "            CardID LineCode       FDate   Time  plat Station\n",
      "0       542446139        1  1398/06/23  24030  A145    3169\n",
      "1      2620656172        1  1398/06/23  24302  A145    3169\n",
      "2      3446252780        1  1398/06/23  26200  A145    1227\n",
      "3         7900260        1  1398/06/23  29677  A145    3169\n",
      "4       361857972        1  1398/06/23  29720  A145    3169\n",
      "...           ...      ...         ...    ...   ...     ...\n",
      "50113  1407163732       22  1398/06/23  68213   E36    2218\n",
      "50114  1592711316       22  1398/06/23  68216   E36    2218\n",
      "50115  2741246692       22  1398/06/23  68221   E36    2218\n",
      "50116  2138833597       22  1398/06/23  68449   E36    2218\n",
      "50117   263199201       22  1398/06/23  69646   E36    1896\n",
      "\n",
      "[50118 rows x 6 columns]\n",
      "transactions in line 22 plat E39\n",
      "ps: \n",
      "              CardID  LineCode       FDate   Time plat\n",
      "216749   181759654        22  1398/06/23  27110  E39\n",
      "216754  2960732197        22  1398/06/23  27112  E39\n",
      "216758  3677186844        22  1398/06/23  27115  E39\n",
      "216762  2122549428        22  1398/06/23  27127  E39\n",
      "80922   1838255421        22  1398/06/23  27149  E39\n",
      "...            ...       ...         ...    ...  ...\n",
      "266366   722263970        22  1398/06/23  43365  E39\n",
      "80917   3792424620        22  1398/06/23  46782  E39\n",
      "266370   981351435        22  1398/06/23  47906  E39\n",
      "266374  3103792053        22  1398/06/23  47923  E39\n",
      "266378   738174128        22  1398/06/23  47933  E39\n",
      "\n",
      "[140 rows x 5 columns]\n",
      "first row of the selected chunck : \n",
      " [181759654 22 '1398/06/23' 27110 'E39']\n",
      "140\n",
      "t0 = 27110\n",
      "ts = 47933\n",
      "time_intervals 35\n",
      "Origin destination interval view reindex \n",
      "    time_in  time_out\n",
      "0  27110.0   27710.0\n",
      "1  33710.0   35510.0\n",
      "2  44510.0   46910.0\n",
      "3  47510.0   48110.0\n",
      "OD bus stations of transactions: \n",
      "            CardID LineCode       FDate   Time  plat Station\n",
      "0       542446139        1  1398/06/23  24030  A145    3169\n",
      "1      2620656172        1  1398/06/23  24302  A145    3169\n",
      "2      3446252780        1  1398/06/23  26200  A145    1227\n",
      "3         7900260        1  1398/06/23  29677  A145    3169\n",
      "4       361857972        1  1398/06/23  29720  A145    3169\n",
      "...           ...      ...         ...    ...   ...     ...\n",
      "50177  1833367869       22  1398/06/23  35308   E39    1896\n",
      "50178  3792424620       22  1398/06/23  46782   E39    2218\n",
      "50179   981351435       22  1398/06/23  47906   E39    1896\n",
      "50180  3103792053       22  1398/06/23  47923   E39    1896\n",
      "50181   738174128       22  1398/06/23  47933   E39    1896\n",
      "\n",
      "[50182 rows x 6 columns]\n",
      "transactions in line 22 plat F121\n",
      "ps: \n",
      "              CardID  LineCode       FDate   Time  plat\n",
      "260632  4059685581        22  1398/06/23  22873  F121\n",
      "7250    4059685581        22  1398/06/23  22875  F121\n",
      "7254    2136723469        22  1398/06/23  22900  F121\n",
      "7258    4266012082        22  1398/06/23  22951  F121\n",
      "7267    2855791838        22  1398/06/23  22956  F121\n",
      "...            ...       ...         ...    ...   ...\n",
      "88098   3205253797        22  1398/06/23  74580  F121\n",
      "88094   2586890420        22  1398/06/23  74751  F121\n",
      "260621  3791743724        22  1398/06/23  75697  F121\n",
      "260625  3791743724        22  1398/06/23  75699  F121\n",
      "260627  3791743724        22  1398/06/23  75704  F121\n",
      "\n",
      "[186 rows x 5 columns]\n",
      "first row of the selected chunck : \n",
      " [4059685581 22 '1398/06/23' 22873 'F121']\n",
      "186\n",
      "t0 = 22873\n",
      "ts = 75704\n",
      "time_intervals 88\n",
      "Origin destination interval view reindex \n",
      "     time_in  time_out\n",
      "0   22873.0   23473.0\n",
      "1   24673.0   25873.0\n",
      "2   26473.0   28273.0\n",
      "3   30073.0   31273.0\n",
      "4   31873.0   32473.0\n",
      "5   33673.0   34273.0\n",
      "6   36673.0   37273.0\n",
      "7   39673.0   40873.0\n",
      "8   42073.0   43273.0\n",
      "9   45673.0   46273.0\n",
      "10  48073.0   49273.0\n",
      "11  49873.0   50473.0\n",
      "12  51673.0   53473.0\n",
      "13  55273.0   56473.0\n",
      "14  57073.0   57673.0\n",
      "15  58273.0   59473.0\n",
      "16  61273.0   61873.0\n",
      "17  66073.0   67873.0\n",
      "18  70273.0   70873.0\n",
      "19  73273.0   75073.0\n",
      "OD bus stations of transactions: \n",
      "            CardID LineCode       FDate   Time  plat Station\n",
      "0       542446139        1  1398/06/23  24030  A145    3169\n",
      "1      2620656172        1  1398/06/23  24302  A145    3169\n",
      "2      3446252780        1  1398/06/23  26200  A145    1227\n",
      "3         7900260        1  1398/06/23  29677  A145    3169\n",
      "4       361857972        1  1398/06/23  29720  A145    3169\n",
      "...           ...      ...         ...    ...   ...     ...\n",
      "50343  3256329757       22  1398/06/23  67853  F121    1896\n",
      "50344  3558355249       22  1398/06/23  67859  F121    1896\n",
      "50345  2665171228       22  1398/06/23  70627  F121    2218\n",
      "50346  3205253797       22  1398/06/23  74580  F121    1896\n",
      "50347  2586890420       22  1398/06/23  74751  F121    1896\n",
      "\n",
      "[50348 rows x 6 columns]\n",
      "transactions in line 22 plat F98\n",
      "ps: \n",
      "              CardID  LineCode       FDate   Time plat\n",
      "605658  1789000644        22  1398/06/23  23624  F98\n",
      "605659   722223653        22  1398/06/23  23941  F98\n",
      "605660   212503436        22  1398/06/23  24079  F98\n",
      "605661  2488648260        22  1398/06/23  24099  F98\n",
      "605662  3678690780        22  1398/06/23  24925  F98\n",
      "...            ...       ...         ...    ...  ...\n",
      "605653  3792425132        22  1398/06/23  76268  F98\n",
      "605654  3792425132        22  1398/06/23  76271  F98\n",
      "605655  3792425132        22  1398/06/23  76275  F98\n",
      "605656  3792425132        22  1398/06/23  76278  F98\n",
      "605657  3792425132        22  1398/06/23  76282  F98\n",
      "\n",
      "[222 rows x 5 columns]\n",
      "first row of the selected chunck : \n",
      " [1789000644 22 '1398/06/23' 23624 'F98']\n",
      "222\n",
      "t0 = 23624\n",
      "ts = 76282\n",
      "time_intervals 88\n",
      "Origin destination interval view reindex \n",
      "     time_in  time_out\n",
      "0   23624.0   24224.0\n",
      "1   24824.0   25424.0\n",
      "2   27224.0   28424.0\n",
      "3   29624.0   30824.0\n",
      "4   32624.0   33224.0\n",
      "5   34424.0   35024.0\n",
      "6   37424.0   38024.0\n",
      "7   38624.0   39824.0\n",
      "8   44624.0   45824.0\n",
      "9   46424.0   47024.0\n",
      "10  48224.0   49424.0\n",
      "11  51824.0   53624.0\n",
      "12  55424.0   56024.0\n",
      "13  58424.0   59024.0\n",
      "14  60224.0   60824.0\n",
      "15  63824.0   65024.0\n",
      "16  66824.0   67424.0\n",
      "17  70424.0   71624.0\n",
      "18  74624.0   75224.0\n",
      "19  75824.0   76424.0\n",
      "OD bus stations of transactions: \n",
      "            CardID LineCode       FDate   Time  plat Station\n",
      "0       542446139        1  1398/06/23  24030  A145    3169\n",
      "1      2620656172        1  1398/06/23  24302  A145    3169\n",
      "2      3446252780        1  1398/06/23  26200  A145    1227\n",
      "3         7900260        1  1398/06/23  29677  A145    3169\n",
      "4       361857972        1  1398/06/23  29720  A145    3169\n",
      "...           ...      ...         ...    ...   ...     ...\n",
      "50433  3792425132       22  1398/06/23  76268   F98    1896\n",
      "50434  3792425132       22  1398/06/23  76271   F98    1896\n",
      "50435  3792425132       22  1398/06/23  76275   F98    1896\n",
      "50436  3792425132       22  1398/06/23  76278   F98    1896\n",
      "50437  3792425132       22  1398/06/23  76282   F98    1896\n",
      "\n",
      "[50438 rows x 6 columns]\n",
      "transactions in line 22 plat F99\n",
      "ps: \n",
      "              CardID  LineCode       FDate   Time plat\n",
      "229037  2928654053        22  1398/06/23  22855  F99\n",
      "229038   235090218        22  1398/06/23  23533  F99\n",
      "229039  2115561972        22  1398/06/23  23824  F99\n",
      "229040  3405884661        22  1398/06/23  24104  F99\n",
      "229041   427029630        22  1398/06/23  24291  F99\n",
      "229042  1291954014        22  1398/06/23  24331  F99\n",
      "229159  3556541985        22  1398/06/23  24410  F99\n",
      "229160  1834725693        22  1398/06/23  25970  F99\n",
      "229161  2137412205        22  1398/06/23  26350  F99\n",
      "229162  4278591026        22  1398/06/23  26617  F99\n",
      "229163   212490155        22  1398/06/23  26619  F99\n",
      "229164  1291947918        22  1398/06/23  26843  F99\n",
      "229165  1001839006        22  1398/06/23  26950  F99\n",
      "229166  3106973621        22  1398/06/23  27072  F99\n",
      "229168  1414976201        22  1398/06/23  40310  F99\n",
      "229167  2117888356        22  1398/06/23  40333  F99\n",
      "229169  1414976201        22  1398/06/23  40348  F99\n",
      "229170   721968032        22  1398/06/23  40595  F99\n",
      "229171   427212750        22  1398/06/23  40613  F99\n",
      "229172  3258081373        22  1398/06/23  40625  F99\n",
      "229173  4059266269        22  1398/06/23  41007  F99\n",
      "229174  3977472228        22  1398/06/23  41012  F99\n",
      "229176  3996706964        22  1398/06/23  41235  F99\n",
      "229175  3413877393        22  1398/06/23  41322  F99\n",
      "229177  1529172158        22  1398/06/23  41326  F99\n",
      "229178  2508235476        22  1398/06/23  41333  F99\n",
      "229179   985025947        22  1398/06/23  41472  F99\n",
      "229181   398165850        22  1398/06/23  41691  F99\n",
      "229180  2125037604        22  1398/06/23  41788  F99\n",
      "229182  3649763732        22  1398/06/23  44086  F99\n",
      "229183  2742712164        22  1398/06/23  44091  F99\n",
      "229185  2181080499        22  1398/06/23  44111  F99\n",
      "229184   980467067        22  1398/06/23  44238  F99\n",
      "229190   184031750        22  1398/06/23  44298  F99\n",
      "229186  3446042988        22  1398/06/23  44300  F99\n",
      "229191  2742421604        22  1398/06/23  44300  F99\n",
      "229187  3446042988        22  1398/06/23  44302  F99\n",
      "229188   721820492        22  1398/06/23  44306  F99\n",
      "229189   212391356        22  1398/06/23  44316  F99\n",
      "229192   175317574        22  1398/06/23  44323  F99\n",
      "229197   175317574        22  1398/06/23  44324  F99\n",
      "229201   261562545        22  1398/06/23  44416  F99\n",
      "230418  3257991293        22  1398/06/23  44808  F99\n",
      "230448  3631526556        22  1398/06/23  44915  F99\n",
      "230453  4256055428        22  1398/06/23  45234  F99\n",
      "230466  4256055428        22  1398/06/23  45236  F99\n",
      "314118  4256055428        22  1398/06/23  45239  F99\n",
      "314128  4265781682        22  1398/06/23  45339  F99\n",
      "314139  3210042212        22  1398/06/23  45557  F99\n",
      "first row of the selected chunck : \n",
      " [2928654053 22 '1398/06/23' 22855 'F99']\n",
      "49\n",
      "t0 = 22855\n",
      "ts = 45557\n",
      "time_intervals 38\n",
      "Origin destination interval view reindex \n",
      "    time_in  time_out\n",
      "0  22855.0   24055.0\n",
      "1  25255.0   26455.0\n",
      "2  28255.0   40855.0\n",
      "3  42655.0   44455.0\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "OD bus stations of transactions: \n",
      "            CardID LineCode       FDate   Time  plat Station\n",
      "0       542446139        1  1398/06/23  24030  A145    3169\n",
      "1      2620656172        1  1398/06/23  24302  A145    3169\n",
      "2      3446252780        1  1398/06/23  26200  A145    1227\n",
      "3         7900260        1  1398/06/23  29677  A145    3169\n",
      "4       361857972        1  1398/06/23  29720  A145    3169\n",
      "...           ...      ...         ...    ...   ...     ...\n",
      "50489   721820492       22  1398/06/23  44306   F99    1896\n",
      "50490   212391356       22  1398/06/23  44316   F99    1896\n",
      "50491   175317574       22  1398/06/23  44323   F99    1896\n",
      "50492   175317574       22  1398/06/23  44324   F99    1896\n",
      "50493   261562545       22  1398/06/23  44416   F99    1896\n",
      "\n",
      "[50494 rows x 6 columns]\n",
      "transactions in line 22 plat N199\n",
      "ps: \n",
      "              CardID  LineCode       FDate   Time  plat\n",
      "694514   210722043        22  1398/06/23  22820  N199\n",
      "694517  1775719396        22  1398/06/23  22823  N199\n",
      "694515   235851498        22  1398/06/23  22825  N199\n",
      "694516   869268717        22  1398/06/23  22828  N199\n",
      "694518  1291726174        22  1398/06/23  23499  N199\n",
      "...            ...       ...         ...    ...   ...\n",
      "348389  4266534578        22  1398/06/23  73169  N199\n",
      "349566   181084182        22  1398/06/23  73171  N199\n",
      "349567   722132150        22  1398/06/23  73250  N199\n",
      "694511   483099012        22  1398/06/23  74902  N199\n",
      "694512   483099012        22  1398/06/23  74904  N199\n",
      "\n",
      "[318 rows x 5 columns]\n",
      "first row of the selected chunck : \n",
      " [210722043 22 '1398/06/23' 22820 'N199']\n",
      "318\n",
      "t0 = 22820\n",
      "ts = 74904\n",
      "time_intervals 87\n",
      "Origin destination interval view reindex \n",
      "     time_in  time_out\n",
      "0   22820.0   23420.0\n",
      "1   25220.0   26420.0\n",
      "2   28820.0   29420.0\n",
      "3   31220.0   32420.0\n",
      "4   34820.0   35420.0\n",
      "5   40220.0   42620.0\n",
      "6   45020.0   45620.0\n",
      "7   46220.0   48620.0\n",
      "8   49220.0   51020.0\n",
      "9   53420.0   54020.0\n",
      "10  55220.0   55820.0\n",
      "11  56420.0   57020.0\n",
      "12  62420.0   63020.0\n",
      "13  66020.0   67220.0\n",
      "14  68420.0   69620.0\n",
      "15  70220.0   70820.0\n",
      "16  74420.0   75020.0\n",
      "OD bus stations of transactions: \n",
      "            CardID LineCode       FDate   Time  plat Station\n",
      "0       542446139        1  1398/06/23  24030  A145    3169\n",
      "1      2620656172        1  1398/06/23  24302  A145    3169\n",
      "2      3446252780        1  1398/06/23  26200  A145    1227\n",
      "3         7900260        1  1398/06/23  29677  A145    3169\n",
      "4       361857972        1  1398/06/23  29720  A145    3169\n",
      "...           ...      ...         ...    ...   ...     ...\n",
      "50553   483099012       22  1398/06/23  69313  N199    2218\n",
      "50554   483099012       22  1398/06/23  69315  N199    2218\n",
      "50555  3792008844       22  1398/06/23  70749  N199    1896\n",
      "50556   483099012       22  1398/06/23  74902  N199    2218\n",
      "50557   483099012       22  1398/06/23  74904  N199    2218\n",
      "\n",
      "[50558 rows x 6 columns]\n",
      "transactions in line 22 plat N37\n",
      "ps: \n",
      "             CardID  LineCode       FDate   Time plat\n",
      "85453  3794264908        22  1398/06/23  21986  N37\n",
      "85460   645645133        22  1398/06/23  22310  N37\n",
      "85457  3446650636        22  1398/06/23  22419  N37\n",
      "85462   721831446        22  1398/06/23  22582  N37\n",
      "86182  2123740484        22  1398/06/23  22692  N37\n",
      "...           ...       ...         ...    ...  ...\n",
      "23141   869461098        22  1398/06/23  53648  N37\n",
      "23144   981919515        22  1398/06/23  54383  N37\n",
      "23147  2125192564        22  1398/06/23  54389  N37\n",
      "96167   300409707        22  1398/06/23  54497  N37\n",
      "85449  3679921868        22  1398/06/23  55278  N37\n",
      "\n",
      "[117 rows x 5 columns]\n",
      "first row of the selected chunck : \n",
      " [3794264908 22 '1398/06/23' 21986 'N37']\n",
      "117\n",
      "t0 = 21986\n",
      "ts = 55278\n",
      "time_intervals 55\n",
      "Origin destination interval view reindex \n",
      "     time_in  time_out\n",
      "0   21986.0   22586.0\n",
      "1   23786.0   25586.0\n",
      "2   26186.0   27986.0\n",
      "3   29786.0   31586.0\n",
      "4   33386.0   34586.0\n",
      "5   35786.0   36986.0\n",
      "6   37586.0   38186.0\n",
      "7   41786.0   42986.0\n",
      "8   44186.0   45986.0\n",
      "9   46586.0   47186.0\n",
      "10  48986.0   49586.0\n",
      "11  50186.0   51986.0\n",
      "OD bus stations of transactions: \n",
      "            CardID LineCode       FDate   Time  plat Station\n",
      "0       542446139        1  1398/06/23  24030  A145    3169\n",
      "1      2620656172        1  1398/06/23  24302  A145    3169\n",
      "2      3446252780        1  1398/06/23  26200  A145    1227\n",
      "3         7900260        1  1398/06/23  29677  A145    3169\n",
      "4       361857972        1  1398/06/23  29720  A145    3169\n",
      "...           ...      ...         ...    ...   ...     ...\n",
      "50786   722207795       22  1398/06/23  49022   N37    2218\n",
      "50787   722207795       22  1398/06/23  49024   N37    2218\n",
      "50788   180221748       22  1398/06/23  49029   N37    2218\n",
      "50789  1414805753       22  1398/06/23  49092   N37    2218\n",
      "50790  1001839006       22  1398/06/23  51938   N37    1896\n",
      "\n",
      "[50791 rows x 6 columns]\n",
      "transactions in line 22 plat N89\n",
      "ps: \n",
      "             CardID  LineCode       FDate   Time plat\n",
      "192619  362645028        22  1398/06/23  23347  N89\n",
      "first row of the selected chunck : \n",
      " [362645028 22 '1398/06/23' 23347 'N89']\n",
      "1\n",
      "t0 = 23347\n",
      "ts = 23347\n",
      "time_intervals 0\n",
      "Origin destination interval view reindex \n",
      " Empty DataFrame\n",
      "Columns: [time_in, time_out]\n",
      "Index: []\n",
      "OD bus stations of transactions: \n",
      "            CardID LineCode       FDate   Time  plat Station\n",
      "0       542446139        1  1398/06/23  24030  A145    3169\n",
      "1      2620656172        1  1398/06/23  24302  A145    3169\n",
      "2      3446252780        1  1398/06/23  26200  A145    1227\n",
      "3         7900260        1  1398/06/23  29677  A145    3169\n",
      "4       361857972        1  1398/06/23  29720  A145    3169\n",
      "...           ...      ...         ...    ...   ...     ...\n",
      "50809  2181715235       22  1398/06/23  38648   N37    2658\n",
      "50810  2181715235       22  1398/06/23  38648   N37    2660\n",
      "50811  2181715235       22  1398/06/23  38648   N37    1706\n",
      "50812  2181715235       22  1398/06/23  38648   N37    2731\n",
      "50813  2181715235       22  1398/06/23  38648   N37    1896\n",
      "\n",
      "[50814 rows x 6 columns]\n",
      "stations in a specefic bus line 24\n",
      "len-of-go stations: 37\n",
      "len-of-back stations: 36\n",
      "len-of-go back stations: 0\n",
      "first Station  [2932 '24' '26' 'go' '???? ????-85-24' 51.650198 32.736302 'od' 'normal'\n",
      " 'no'] 2932\n",
      "last Station  [2777 '24' '1' 'back' '????? ??????  ??????-24' 51.647738 32.677055 'od'\n",
      " 'normal' 'no']\n",
      "['A140' 'A154' 'A158' 'A64' 'B38' 'E169' 'F117' 'F146' 'F174' 'M146' 'M52']\n",
      "transactions in line 24 plat A140\n",
      "ps: \n",
      "              CardID  LineCode       FDate   Time  plat\n",
      "284211   555015102        24  1398/06/23  21567  A140\n",
      "284212  3794839772        24  1398/06/23  23672  A140\n",
      "284214  1368190062        24  1398/06/23  23842  A140\n",
      "284213  1281867422        24  1398/06/23  23845  A140\n",
      "284215  1787148420        24  1398/06/23  23938  A140\n",
      "...            ...       ...         ...    ...   ...\n",
      "403653   211997996        24  1398/06/23  74973  A140\n",
      "403655   344247492        24  1398/06/23  75075  A140\n",
      "403656   344247492        24  1398/06/23  75078  A140\n",
      "403657  2116676564        24  1398/06/23  75575  A140\n",
      "403658  3445049100        24  1398/06/23  75690  A140\n",
      "\n",
      "[391 rows x 5 columns]\n",
      "first row of the selected chunck : \n",
      " [555015102 24 '1398/06/23' 21567 'A140']\n",
      "391\n",
      "t0 = 21567\n",
      "ts = 75690\n",
      "time_intervals 90\n",
      "Origin destination interval view reindex \n",
      "     time_in  time_out\n",
      "0   21567.0   23967.0\n",
      "1   26367.0   26967.0\n",
      "2   29967.0   31167.0\n",
      "3   34767.0   35367.0\n",
      "4   37767.0   38967.0\n",
      "5   46167.0   46767.0\n",
      "6   48567.0   49767.0\n",
      "7   51567.0   53367.0\n",
      "8   53967.0   65967.0\n",
      "9   68967.0   69567.0\n",
      "10  72567.0   74367.0\n",
      "OD bus stations of transactions: \n",
      "            CardID LineCode       FDate   Time  plat Station\n",
      "0       542446139        1  1398/06/23  24030  A145    3169\n",
      "1      2620656172        1  1398/06/23  24302  A145    3169\n",
      "2      3446252780        1  1398/06/23  26200  A145    1227\n",
      "3         7900260        1  1398/06/23  29677  A145    3169\n",
      "4       361857972        1  1398/06/23  29720  A145    3169\n",
      "...           ...      ...         ...    ...   ...     ...\n",
      "50865  4059663229       24  1398/06/23  74132  A140    2932\n",
      "50866  1594625684       24  1398/06/23  74133  A140    2932\n",
      "50867   261693585       24  1398/06/23  74135  A140    2932\n",
      "50868  3405828540       24  1398/06/23  74136  A140    2932\n",
      "50869  3183284910       24  1398/06/23  74200  A140    2932\n",
      "\n",
      "[50870 rows x 6 columns]\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "transactions in line 24 plat A154\n",
      "ps: \n",
      "              CardID  LineCode       FDate   Time  plat\n",
      "252334   869317764        24  1398/06/23  21635  A154\n",
      "252335  2239160266        24  1398/06/23  21799  A154\n",
      "252336   426460142        24  1398/06/23  21972  A154\n",
      "252337  3180554702        24  1398/06/23  22021  A154\n",
      "252338   838736836        24  1398/06/23  22162  A154\n",
      "...            ...       ...         ...    ...   ...\n",
      "104948  3179797502        24  1398/06/23  76836  A154\n",
      "104949  3179797502        24  1398/06/23  76837  A154\n",
      "104950   295502187        24  1398/06/23  76940  A154\n",
      "104951  2125895924        24  1398/06/23  76955  A154\n",
      "104952  2189133907        24  1398/06/23  77374  A154\n",
      "\n",
      "[522 rows x 5 columns]\n",
      "first row of the selected chunck : \n",
      " [869317764 24 '1398/06/23' 21635 'A154']\n",
      "522\n",
      "t0 = 21635\n",
      "ts = 77374\n",
      "time_intervals 93\n",
      "Origin destination interval view reindex \n",
      "     time_in  time_out\n",
      "0   21635.0   22235.0\n",
      "1   24635.0   25235.0\n",
      "2   27635.0   28835.0\n",
      "3   35435.0   36635.0\n",
      "4   43835.0   45035.0\n",
      "5   51035.0   51635.0\n",
      "6   57035.0   58235.0\n",
      "7   60635.0   61235.0\n",
      "8   64235.0   65435.0\n",
      "9   67835.0   68435.0\n",
      "10  71435.0   72635.0\n",
      "11  76235.0   76835.0\n",
      "OD bus stations of transactions: \n",
      "            CardID LineCode       FDate   Time  plat Station\n",
      "0       542446139        1  1398/06/23  24030  A145    3169\n",
      "1      2620656172        1  1398/06/23  24302  A145    3169\n",
      "2      3446252780        1  1398/06/23  26200  A145    1227\n",
      "3         7900260        1  1398/06/23  29677  A145    3169\n",
      "4       361857972        1  1398/06/23  29720  A145    3169\n",
      "...           ...      ...         ...    ...   ...     ...\n",
      "51059  1000740222       24  1398/06/23  72540  A154    2932\n",
      "51060  2742717460       24  1398/06/23  72544  A154    2932\n",
      "51061  2742717460       24  1398/06/23  72545  A154    2932\n",
      "51062  3405885424       24  1398/06/23  76668  A154    2777\n",
      "51063  2586768372       24  1398/06/23  76674  A154    2777\n",
      "\n",
      "[51064 rows x 6 columns]\n",
      "transactions in line 24 plat A158\n",
      "ps: \n",
      "              CardID  LineCode       FDate   Time  plat\n",
      "65869    721963098        24  1398/06/23  25316  A158\n",
      "65873   2585739124        24  1398/06/23  25367  A158\n",
      "65879    721982470        24  1398/06/23  25479  A158\n",
      "65884   3208396276        24  1398/06/23  25543  A158\n",
      "65888    175338790        24  1398/06/23  25602  A158\n",
      "...            ...       ...         ...    ...   ...\n",
      "151724  2498171453        24  1398/06/23  74175  A158\n",
      "151722  2184278227        24  1398/06/23  74176  A158\n",
      "151727  3405801739        24  1398/06/23  74446  A158\n",
      "151728   234422074        24  1398/06/23  74471  A158\n",
      "151730  2139054813        24  1398/06/23  75299  A158\n",
      "\n",
      "[216 rows x 5 columns]\n",
      "first row of the selected chunck : \n",
      " [721963098 24 '1398/06/23' 25316 'A158']\n",
      "216\n",
      "t0 = 25316\n",
      "ts = 75299\n",
      "time_intervals 83\n",
      "Origin destination interval view reindex \n",
      "     time_in  time_out\n",
      "0   25316.0   25916.0\n",
      "1   26516.0   39716.0\n",
      "2   43316.0   45116.0\n",
      "3   46916.0   47516.0\n",
      "4   51116.0   52316.0\n",
      "5   54116.0   54716.0\n",
      "6   56516.0   58916.0\n",
      "7   61316.0   61916.0\n",
      "8   64916.0   65516.0\n",
      "9   67916.0   69116.0\n",
      "10  70916.0   71516.0\n",
      "11  72116.0   73916.0\n",
      "OD bus stations of transactions: \n",
      "            CardID LineCode       FDate   Time  plat Station\n",
      "0       542446139        1  1398/06/23  24030  A145    3169\n",
      "1      2620656172        1  1398/06/23  24302  A145    3169\n",
      "2      3446252780        1  1398/06/23  26200  A145    1227\n",
      "3         7900260        1  1398/06/23  29677  A145    3169\n",
      "4       361857972        1  1398/06/23  29720  A145    3169\n",
      "...           ...      ...         ...    ...   ...     ...\n",
      "51466  3206600028       24  1398/06/23  71282  A158    2932\n",
      "51467  3793824844       24  1398/06/23  73538  A158    2777\n",
      "51468  3793824844       24  1398/06/23  73539  A158    2777\n",
      "51469  2590099620       24  1398/06/23  73546  A158    2777\n",
      "51470  2500199492       24  1398/06/23  73783  A158    2777\n",
      "\n",
      "[51471 rows x 6 columns]\n",
      "transactions in line 24 plat A64\n",
      "ps: \n",
      "              CardID  LineCode       FDate   Time plat\n",
      "66838   2505637780        24  1398/06/23  26011  A64\n",
      "66839   1835000365        24  1398/06/23  26142  A64\n",
      "66840   2125828020        24  1398/06/23  26267  A64\n",
      "66841   3648617108        24  1398/06/23  26270  A64\n",
      "66842   3997176692        24  1398/06/23  26271  A64\n",
      "...            ...       ...         ...    ...  ...\n",
      "134866  3179983790        24  1398/06/23  75154  A64\n",
      "134867  1835548205        24  1398/06/23  75259  A64\n",
      "134868  3648456452        24  1398/06/23  75344  A64\n",
      "134869  2125416820        24  1398/06/23  75347  A64\n",
      "134870  3649755300        24  1398/06/23  75410  A64\n",
      "\n",
      "[502 rows x 5 columns]\n",
      "first row of the selected chunck : \n",
      " [2505637780 24 '1398/06/23' 26011 'A64']\n",
      "502\n",
      "t0 = 26011\n",
      "ts = 75410\n",
      "time_intervals 82\n",
      "Origin destination interval view reindex \n",
      "    time_in  time_out\n",
      "0  26011.0   26611.0\n",
      "1  31411.0   33211.0\n",
      "2  47611.0   49411.0\n",
      "3  54211.0   55411.0\n",
      "4  61411.0   62611.0\n",
      "5  65011.0   65611.0\n",
      "6  72211.0   73411.0\n",
      "OD bus stations of transactions: \n",
      "            CardID LineCode       FDate   Time  plat Station\n",
      "0       542446139        1  1398/06/23  24030  A145    3169\n",
      "1      2620656172        1  1398/06/23  24302  A145    3169\n",
      "2      3446252780        1  1398/06/23  26200  A145    1227\n",
      "3         7900260        1  1398/06/23  29677  A145    3169\n",
      "4       361857972        1  1398/06/23  29720  A145    3169\n",
      "...           ...      ...         ...    ...   ...     ...\n",
      "51557   721907774       24  1398/06/23  73288   A64    2932\n",
      "51558  3405921045       24  1398/06/23  73338   A64    2932\n",
      "51559  3178542862       24  1398/06/23  73340   A64    2932\n",
      "51560  3555444385       24  1398/06/23  73343   A64    2932\n",
      "51561   342718068       24  1398/06/23  73392   A64    2932\n",
      "\n",
      "[51562 rows x 6 columns]\n",
      "transactions in line 24 plat B38\n",
      "ps: \n",
      "              CardID  LineCode       FDate   Time plat\n",
      "36199   3677611020        24  1398/06/23  26013  B38\n",
      "36200    983232315        24  1398/06/23  26334  B38\n",
      "36201    428346126        24  1398/06/23  26336  B38\n",
      "36203   4059538477        24  1398/06/23  26372  B38\n",
      "36204   3553835052        24  1398/06/23  26373  B38\n",
      "...            ...       ...         ...    ...  ...\n",
      "557363  3180113934        24  1398/06/23  78806  B38\n",
      "557365  2118171892        24  1398/06/23  79097  B38\n",
      "557366  1835172413        24  1398/06/23  79921  B38\n",
      "557367   981348603        24  1398/06/23  79925  B38\n",
      "557368  1528534286        24  1398/06/23  79926  B38\n",
      "\n",
      "[474 rows x 5 columns]\n",
      "first row of the selected chunck : \n",
      " [3677611020 24 '1398/06/23' 26013 'B38']\n",
      "474\n",
      "t0 = 26013\n",
      "ts = 79926\n",
      "time_intervals 90\n",
      "Origin destination interval view reindex \n",
      "     time_in  time_out\n",
      "0   26013.0   26613.0\n",
      "1   29013.0   29613.0\n",
      "2   31413.0   32613.0\n",
      "3   37413.0   38013.0\n",
      "4   38613.0   39213.0\n",
      "5   42813.0   43413.0\n",
      "6   45813.0   48213.0\n",
      "7   50013.0   51213.0\n",
      "8   54213.0   54813.0\n",
      "9   56613.0   57213.0\n",
      "10  59613.0   60213.0\n",
      "11  60813.0   61413.0\n",
      "12  66813.0   73413.0\n",
      "13  75213.0   77613.0\n",
      "OD bus stations of transactions: \n",
      "            CardID LineCode       FDate   Time  plat Station\n",
      "0       542446139        1  1398/06/23  24030  A145    3169\n",
      "1      2620656172        1  1398/06/23  24302  A145    3169\n",
      "2      3446252780        1  1398/06/23  26200  A145    1227\n",
      "3         7900260        1  1398/06/23  29677  A145    3169\n",
      "4       361857972        1  1398/06/23  29720  A145    3169\n",
      "...           ...      ...         ...    ...   ...     ...\n",
      "52015  4279501986       24  1398/06/23  73263   B38    2932\n",
      "52016  2620480300       24  1398/06/23  77527   B38    2777\n",
      "52017  2620480300       24  1398/06/23  77528   B38    2777\n",
      "52018  3181269694       24  1398/06/23  77576   B38    2777\n",
      "52019  3181269694       24  1398/06/23  77577   B38    2777\n",
      "\n",
      "[52020 rows x 6 columns]\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "C:\\Users\\esmaeli.h\\AppData\\Local\\Temp/ipykernel_12452/1949912630.py:257: ConvergenceWarning: Number of distinct clusters (33) found smaller than n_clusters (36). Possibly due to duplicate points in X.\n",
      "  kmeans = KMeans(n_clusters=len(filter_go_stations)-1,random_state=0).fit(partial_times.to_numpy())\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "transactions in line 24 plat E169\n",
      "ps: \n",
      "              CardID  LineCode       FDate   Time  plat\n",
      "286635  2236496147        24  1398/06/23  23657  E169\n",
      "286634  3677558076        24  1398/06/23  23814  E169\n",
      "286636  3206626780        24  1398/06/23  23960  E169\n",
      "286637  2125543844        24  1398/06/23  24060  E169\n",
      "286638  2125543844        24  1398/06/23  24061  E169\n",
      "...            ...       ...         ...    ...   ...\n",
      "258640  3678792556        24  1398/06/23  75748  E169\n",
      "258641  3792791276        24  1398/06/23  76000  E169\n",
      "258642   869229866        24  1398/06/23  76264  E169\n",
      "258643  3650287092        24  1398/06/23  76942  E169\n",
      "258644  3650287092        24  1398/06/23  76944  E169\n",
      "\n",
      "[355 rows x 5 columns]\n",
      "first row of the selected chunck : \n",
      " [2236496147 24 '1398/06/23' 23657 'E169']\n",
      "355\n",
      "t0 = 23657\n",
      "ts = 76944\n",
      "time_intervals 89\n",
      "Origin destination interval view reindex \n",
      "    time_in  time_out\n",
      "0  23657.0   24257.0\n",
      "1  25457.0   27857.0\n",
      "2  34457.0   36257.0\n",
      "3  41657.0   43457.0\n",
      "4  49457.0   50657.0\n",
      "5  56057.0   60257.0\n",
      "6  62657.0   63857.0\n",
      "7  66257.0   67457.0\n",
      "8  70457.0   71657.0\n",
      "9  74057.0   75257.0\n",
      "OD bus stations of transactions: \n",
      "            CardID LineCode       FDate   Time  plat Station\n",
      "0       542446139        1  1398/06/23  24030  A145    3169\n",
      "1      2620656172        1  1398/06/23  24302  A145    3169\n",
      "2      3446252780        1  1398/06/23  26200  A145    1227\n",
      "3         7900260        1  1398/06/23  29677  A145    3169\n",
      "4       361857972        1  1398/06/23  29720  A145    3169\n",
      "...           ...      ...         ...    ...   ...     ...\n",
      "52369  3151473918       24  1398/06/23  75145  E169    2777\n",
      "52370  1837339213       24  1398/06/23  75161  E169    2777\n",
      "52371  1371904030       24  1398/06/23  75178  E169    2777\n",
      "52372   869387046       24  1398/06/23  75225  E169    2777\n",
      "52373   721797246       24  1398/06/23  75238  E169    2777\n",
      "\n",
      "[52374 rows x 6 columns]\n",
      "transactions in line 24 plat F117\n",
      "ps: \n",
      "              CardID  LineCode       FDate   Time  plat\n",
      "161514   982297339        24  1398/06/23  53019  F117\n",
      "161515  3209711460        24  1398/06/23  53076  F117\n",
      "161517  3209711460        24  1398/06/23  53077  F117\n",
      "161529   261177713        24  1398/06/23  53196  F117\n",
      "161519  2125813748        24  1398/06/23  53389  F117\n",
      "...            ...       ...         ...    ...   ...\n",
      "83964   2741446452        24  1398/06/23  74544  F117\n",
      "221693   721986153        24  1398/06/23  76183  F117\n",
      "221697  2542212046        24  1398/06/23  76555  F117\n",
      "221702  3558600577        24  1398/06/23  76783  F117\n",
      "221705  3445992028        24  1398/06/23  77278  F117\n",
      "\n",
      "[236 rows x 5 columns]\n",
      "first row of the selected chunck : \n",
      " [982297339 24 '1398/06/23' 53019 'F117']\n",
      "236\n",
      "t0 = 53019\n",
      "ts = 77278\n",
      "time_intervals 40\n",
      "Origin destination interval view reindex \n",
      "    time_in  time_out\n",
      "0  53019.0   53619.0\n",
      "1  59019.0   60219.0\n",
      "2  63219.0   63819.0\n",
      "3  67419.0   68019.0\n",
      "4  71019.0   71619.0\n",
      "5  75219.0   76419.0\n",
      "OD bus stations of transactions: \n",
      "            CardID LineCode       FDate   Time  plat Station\n",
      "0       542446139        1  1398/06/23  24030  A145    3169\n",
      "1      2620656172        1  1398/06/23  24302  A145    3169\n",
      "2      3446252780        1  1398/06/23  26200  A145    1227\n",
      "3         7900260        1  1398/06/23  29677  A145    3169\n",
      "4       361857972        1  1398/06/23  29720  A145    3169\n",
      "...           ...      ...         ...    ...   ...     ...\n",
      "52585  2741351892       24  1398/06/23  71399  F117    2932\n",
      "52586  2741351892       24  1398/06/23  71402  F117    2932\n",
      "52587  4241486839       24  1398/06/23  71405  F117    2932\n",
      "52588  1598654244       24  1398/06/23  71461  F117    2932\n",
      "52589   721986153       24  1398/06/23  76183  F117    2777\n",
      "\n",
      "[52590 rows x 6 columns]\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "C:\\Users\\esmaeli.h\\AppData\\Local\\Temp/ipykernel_12452/1949912630.py:257: ConvergenceWarning: Number of distinct clusters (35) found smaller than n_clusters (36). Possibly due to duplicate points in X.\n",
      "  kmeans = KMeans(n_clusters=len(filter_go_stations)-1,random_state=0).fit(partial_times.to_numpy())\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "transactions in line 24 plat F146\n",
      "ps: \n",
      "              CardID  LineCode       FDate   Time  plat\n",
      "297409  2742029732        24  1398/06/23  23295  F146\n",
      "297410  2124247172        24  1398/06/23  23297  F146\n",
      "297411  1527289918        24  1398/06/23  23567  F146\n",
      "297412  3405879803        24  1398/06/23  23569  F146\n",
      "297413   361101668        24  1398/06/23  23571  F146\n",
      "...            ...       ...         ...    ...   ...\n",
      "298246   721767361        24  1398/06/23  35304  F146\n",
      "298247   721767361        24  1398/06/23  35305  F146\n",
      "298248  4270821362        24  1398/06/23  35437  F146\n",
      "298249  1001886462        24  1398/06/23  35542  F146\n",
      "298250  3678625644        24  1398/06/23  35959  F146\n",
      "\n",
      "[106 rows x 5 columns]\n",
      "first row of the selected chunck : \n",
      " [2742029732 24 '1398/06/23' 23295 'F146']\n",
      "106\n",
      "t0 = 23295\n",
      "ts = 35959\n",
      "time_intervals 21\n",
      "Origin destination interval view reindex \n",
      "    time_in  time_out\n",
      "0  23295.0   23895.0\n",
      "1  28695.0   29895.0\n",
      "OD bus stations of transactions: \n",
      "            CardID LineCode       FDate   Time  plat Station\n",
      "0       542446139        1  1398/06/23  24030  A145    3169\n",
      "1      2620656172        1  1398/06/23  24302  A145    3169\n",
      "2      3446252780        1  1398/06/23  26200  A145    1227\n",
      "3         7900260        1  1398/06/23  29677  A145    3169\n",
      "4       361857972        1  1398/06/23  29720  A145    3169\n",
      "...           ...      ...         ...    ...   ...     ...\n",
      "52736  2741538100       24  1398/06/23  23719  F146    2932\n",
      "52737   983031051       24  1398/06/23  23723  F146    2932\n",
      "52738  1459019189       24  1398/06/23  23737  F146    2932\n",
      "52739  3405887111       24  1398/06/23  23754  F146    2932\n",
      "52740  2138305549       24  1398/06/23  29322  F146    2777\n",
      "\n",
      "[52741 rows x 6 columns]\n",
      "transactions in line 24 plat F174\n",
      "ps: \n",
      "              CardID  LineCode       FDate   Time  plat\n",
      "252043   212114764        24  1398/06/23  23067  F174\n",
      "252044  4265622050        24  1398/06/23  23205  F174\n",
      "252045  4265622050        24  1398/06/23  23206  F174\n",
      "252046   721915290        24  1398/06/23  23384  F174\n",
      "252047  2239158955        24  1398/06/23  23425  F174\n",
      "...            ...       ...         ...    ...   ...\n",
      "17514   3150825294        24  1398/06/23  48175  F174\n",
      "252039    14110007        24  1398/06/23  49212  F174\n",
      "252040    14110007        24  1398/06/23  49214  F174\n",
      "252041    14110007        24  1398/06/23  49216  F174\n",
      "252042    14110007        24  1398/06/23  49218  F174\n",
      "\n",
      "[211 rows x 5 columns]\n",
      "first row of the selected chunck : \n",
      " [212114764 24 '1398/06/23' 23067 'F174']\n",
      "211\n",
      "t0 = 23067\n",
      "ts = 49218\n",
      "time_intervals 44\n",
      "Origin destination interval view reindex \n",
      "    time_in  time_out\n",
      "0  23067.0   23667.0\n",
      "1  24267.0   26667.0\n",
      "2  30267.0   30867.0\n",
      "3  33867.0   35667.0\n",
      "4  41667.0   42867.0\n",
      "5  45267.0   45867.0\n",
      "6  46467.0   47067.0\n",
      "7  48867.0   49467.0\n",
      "OD bus stations of transactions: \n",
      "            CardID LineCode       FDate   Time  plat Station\n",
      "0       542446139        1  1398/06/23  24030  A145    3169\n",
      "1      2620656172        1  1398/06/23  24302  A145    3169\n",
      "2      3446252780        1  1398/06/23  26200  A145    1227\n",
      "3         7900260        1  1398/06/23  29677  A145    3169\n",
      "4       361857972        1  1398/06/23  29720  A145    3169\n",
      "...           ...      ...         ...    ...   ...     ...\n",
      "52836   721811307       24  1398/06/23  47058  F174    2932\n",
      "52837    14110007       24  1398/06/23  49212  F174    2777\n",
      "52838    14110007       24  1398/06/23  49214  F174    2777\n",
      "52839    14110007       24  1398/06/23  49216  F174    2777\n",
      "52840    14110007       24  1398/06/23  49218  F174    2777\n",
      "\n",
      "[52841 rows x 6 columns]\n",
      "transactions in line 24 plat M146\n",
      "ps: \n",
      "              CardID  LineCode       FDate   Time  plat\n",
      "64051    361795556        24  1398/06/23  40896  M146\n",
      "64055   3405941233        24  1398/06/23  40946  M146\n",
      "64057    426403470        24  1398/06/23  41009  M146\n",
      "64059   2740740836        24  1398/06/23  41041  M146\n",
      "64061   3794129708        24  1398/06/23  41067  M146\n",
      "...            ...       ...         ...    ...   ...\n",
      "233664  1000754254        24  1398/06/23  73997  M146\n",
      "233666   235778410        24  1398/06/23  74041  M146\n",
      "233668   361453108        24  1398/06/23  74169  M146\n",
      "233669   802968290        24  1398/06/23  74506  M146\n",
      "233671   426440366        24  1398/06/23  75149  M146\n",
      "\n",
      "[320 rows x 5 columns]\n",
      "first row of the selected chunck : \n",
      " [361795556 24 '1398/06/23' 40896 'M146']\n",
      "320\n",
      "t0 = 40896\n",
      "ts = 75149\n",
      "time_intervals 57\n",
      "Origin destination interval view reindex \n",
      "    time_in  time_out\n",
      "0  40896.0   41496.0\n",
      "1  45096.0   45696.0\n",
      "2  48696.0   49296.0\n",
      "3  52296.0   53496.0\n",
      "4  59496.0   60696.0\n",
      "5  67896.0   68496.0\n",
      "6  71496.0   72096.0\n",
      "OD bus stations of transactions: \n",
      "            CardID LineCode       FDate   Time  plat Station\n",
      "0       542446139        1  1398/06/23  24030  A145    3169\n",
      "1      2620656172        1  1398/06/23  24302  A145    3169\n",
      "2      3446252780        1  1398/06/23  26200  A145    1227\n",
      "3         7900260        1  1398/06/23  29677  A145    3169\n",
      "4       361857972        1  1398/06/23  29720  A145    3169\n",
      "...           ...      ...         ...    ...   ...     ...\n",
      "52967  3206600028       24  1398/06/23  68071  M146    2777\n",
      "52968  3206600028       24  1398/06/23  68074  M146    2777\n",
      "52969   116004307       24  1398/06/23  71858  M146    2932\n",
      "52970  3258210765       24  1398/06/23  72074  M146    2932\n",
      "52971  3254572669       24  1398/06/23  72092  M146    2932\n",
      "\n",
      "[52972 rows x 6 columns]\n",
      "transactions in line 24 plat M52\n",
      "ps: \n",
      "              CardID  LineCode       FDate   Time plat\n",
      "227603   981993963        24  1398/06/23  23740  M52\n",
      "227606  2680632030        24  1398/06/23  24033  M52\n",
      "227608  3630745404        24  1398/06/23  24076  M52\n",
      "227610  3632017116        24  1398/06/23  24610  M52\n",
      "227612  3207989124        24  1398/06/23  24615  M52\n",
      "...            ...       ...         ...    ...  ...\n",
      "15475   3632030252        24  1398/06/23  76494  M52\n",
      "15477   4270351938        24  1398/06/23  76652  M52\n",
      "56670   1528195646        24  1398/06/23  76971  M52\n",
      "56673   3793920252        24  1398/06/23  77282  M52\n",
      "56676   3254558877        24  1398/06/23  78532  M52\n",
      "\n",
      "[346 rows x 5 columns]\n",
      "first row of the selected chunck : \n",
      " [981993963 24 '1398/06/23' 23740 'M52']\n",
      "346\n",
      "t0 = 23740\n",
      "ts = 78532\n",
      "time_intervals 91\n",
      "Origin destination interval view reindex \n",
      "     time_in  time_out\n",
      "0   23740.0   24340.0\n",
      "1   26140.0   28540.0\n",
      "2   34540.0   36340.0\n",
      "3   41740.0   44140.0\n",
      "4   45340.0   45940.0\n",
      "5   48340.0   48940.0\n",
      "6   49540.0   57340.0\n",
      "7   59740.0   60940.0\n",
      "8   63340.0   64540.0\n",
      "9   71140.0   72340.0\n",
      "10  75340.0   75940.0\n",
      "OD bus stations of transactions: \n",
      "            CardID LineCode       FDate   Time  plat Station\n",
      "0       542446139        1  1398/06/23  24030  A145    3169\n",
      "1      2620656172        1  1398/06/23  24302  A145    3169\n",
      "2      3446252780        1  1398/06/23  26200  A145    1227\n",
      "3         7900260        1  1398/06/23  29677  A145    3169\n",
      "4       361857972        1  1398/06/23  29720  A145    3169\n",
      "...           ...      ...         ...    ...   ...     ...\n",
      "53163   426014382       24  1398/06/23  75775   M52    2932\n",
      "53164   426014382       24  1398/06/23  75776   M52    2932\n",
      "53165  2239164755       24  1398/06/23  75879   M52    2932\n",
      "53166  2137022589       24  1398/06/23  75894   M52    2932\n",
      "53167  2498117901       24  1398/06/23  75935   M52    2932\n",
      "\n",
      "[53168 rows x 6 columns]\n",
      "stations in a specefic bus line 25\n",
      "len-of-go stations: 25\n",
      "len-of-back stations: 22\n",
      "len-of-go back stations: 0\n",
      "first Station  [2764 '25' '1' 'go' '????? ???? ???????-25' 51.602692 32.679143 'od'\n",
      " 'normal' 'no'] 2764\n",
      "last Station  [3830 '25' '1' 'back' '?????? ???-25' 51.649352 32.672904 'od' 'normal'\n",
      " 'yes']\n",
      "['A27' 'B69' 'D86' 'E174' 'E240' 'F18' 'F63' 'M152' 'M36' 'M75' 'N113'\n",
      " 'N157' 'N58']\n",
      "transactions in line 25 plat A27\n",
      "ps: \n",
      "              CardID  LineCode       FDate   Time plat\n",
      "157355  2501464500        25  1398/06/23  21511  A27\n",
      "156972  3791699580        25  1398/06/23  21878  A27\n",
      "157356   262702177        25  1398/06/23  22073  A27\n",
      "157357  2855375566        25  1398/06/23  22073  A27\n",
      "157358  2678120196        25  1398/06/23  22214  A27\n",
      "...            ...       ...         ...    ...  ...\n",
      "315878   184008006        25  1398/06/23  67922  A27\n",
      "157354   212931579        25  1398/06/23  67968  A27\n",
      "315881   980746955        25  1398/06/23  68013  A27\n",
      "315882   980746955        25  1398/06/23  68014  A27\n",
      "315883  3181405918        25  1398/06/23  68017  A27\n",
      "\n",
      "[289 rows x 5 columns]\n",
      "first row of the selected chunck : \n",
      " [2501464500 25 '1398/06/23' 21511 'A27']\n",
      "289\n",
      "t0 = 21511\n",
      "ts = 68017\n",
      "time_intervals 78\n",
      "Origin destination interval view reindex \n",
      "    time_in  time_out\n",
      "0  21511.0   22111.0\n",
      "1  23911.0   24511.0\n",
      "2  29311.0   30511.0\n",
      "3  39511.0   40111.0\n",
      "4  41911.0   42511.0\n",
      "5  46111.0   47311.0\n",
      "6  49711.0   59911.0\n",
      "7  60511.0   61111.0\n",
      "8  65911.0   66511.0\n",
      "9  67711.0   68311.0\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "OD bus stations of transactions: \n",
      "            CardID LineCode       FDate   Time  plat Station\n",
      "0       542446139        1  1398/06/23  24030  A145    3169\n",
      "1      2620656172        1  1398/06/23  24302  A145    3169\n",
      "2      3446252780        1  1398/06/23  26200  A145    1227\n",
      "3         7900260        1  1398/06/23  29677  A145    3169\n",
      "4       361857972        1  1398/06/23  29720  A145    3169\n",
      "...           ...      ...         ...    ...   ...     ...\n",
      "53407   184008006       25  1398/06/23  67922   A27    3830\n",
      "53408   212931579       25  1398/06/23  67968   A27    3830\n",
      "53409   980746955       25  1398/06/23  68013   A27    3830\n",
      "53410   980746955       25  1398/06/23  68014   A27    3830\n",
      "53411  3181405918       25  1398/06/23  68017   A27    3830\n",
      "\n",
      "[53412 rows x 6 columns]\n",
      "transactions in line 25 plat B69\n",
      "ps: \n",
      "              CardID  LineCode       FDate   Time plat\n",
      "336428   981781307        25  1398/06/23  59466  B69\n",
      "336429   981781307        25  1398/06/23  59467  B69\n",
      "336430  2125699572        25  1398/06/23  59528  B69\n",
      "336436  3650183764        25  1398/06/23  59529  B69\n",
      "336431  2125699572        25  1398/06/23  59531  B69\n",
      "...            ...       ...         ...    ...  ...\n",
      "397523  2044761678        25  1398/06/23  67539  B69\n",
      "397524  3446862108        25  1398/06/23  67585  B69\n",
      "397525   721950124        25  1398/06/23  67673  B69\n",
      "397526   262517985        25  1398/06/23  68159  B69\n",
      "397527   262517985        25  1398/06/23  68166  B69\n",
      "\n",
      "[85 rows x 5 columns]\n",
      "first row of the selected chunck : \n",
      " [981781307 25 '1398/06/23' 59466 'B69']\n",
      "85\n",
      "t0 = 59466\n",
      "ts = 68166\n",
      "time_intervals 14\n",
      "Origin destination interval view reindex \n",
      "    time_in  time_out\n",
      "0  59466.0   60066.0\n",
      "1  61266.0   63666.0\n",
      "2  66066.0   66666.0\n",
      "OD bus stations of transactions: \n",
      "            CardID LineCode       FDate   Time  plat Station\n",
      "0       542446139        1  1398/06/23  24030  A145    3169\n",
      "1      2620656172        1  1398/06/23  24302  A145    3169\n",
      "2      3446252780        1  1398/06/23  26200  A145    1227\n",
      "3         7900260        1  1398/06/23  29677  A145    3169\n",
      "4       361857972        1  1398/06/23  29720  A145    3169\n",
      "...           ...      ...         ...    ...   ...     ...\n",
      "53653  2665697116       25  1398/06/23  66290   B69    2764\n",
      "53654  2620414508       25  1398/06/23  66509   B69    2764\n",
      "53655  3446183964       25  1398/06/23  66592   B69    2764\n",
      "53656  3446183964       25  1398/06/23  66594   B69    2764\n",
      "53657  3446183964       25  1398/06/23  66596   B69    2764\n",
      "\n",
      "[53658 rows x 6 columns]\n",
      "transactions in line 25 plat D86\n",
      "ps: \n",
      "              CardID  LineCode       FDate   Time plat\n",
      "190206  3793471356        25  1398/06/23  27737  D86\n",
      "190207  4270283490        25  1398/06/23  27855  D86\n",
      "190208   233135082        25  1398/06/23  28334  D86\n",
      "190209   362731860        25  1398/06/23  28335  D86\n",
      "190211  2482489332        25  1398/06/23  28463  D86\n",
      "...            ...       ...         ...    ...  ...\n",
      "190205  3791696332        25  1398/06/23  49959  D86\n",
      "237501  2855449086        25  1398/06/23  50114  D86\n",
      "237502  3680109612        25  1398/06/23  50218  D86\n",
      "237503  2239163200        25  1398/06/23  50865  D86\n",
      "237504  3209704020        25  1398/06/23  51029  D86\n",
      "\n",
      "[236 rows x 5 columns]\n",
      "first row of the selected chunck : \n",
      " [3793471356 25 '1398/06/23' 27737 'D86']\n",
      "236\n",
      "t0 = 27737\n",
      "ts = 51029\n",
      "time_intervals 39\n",
      "Origin destination interval view reindex \n",
      "    time_in  time_out\n",
      "0  27737.0   28337.0\n",
      "1  29537.0   30137.0\n",
      "2  33137.0   33737.0\n",
      "3  36137.0   36737.0\n",
      "4  39737.0   40937.0\n",
      "5  43937.0   44537.0\n",
      "6  48737.0   49337.0\n",
      "7  49937.0   50537.0\n",
      "OD bus stations of transactions: \n",
      "            CardID LineCode       FDate   Time  plat Station\n",
      "0       542446139        1  1398/06/23  24030  A145    3169\n",
      "1      2620656172        1  1398/06/23  24302  A145    3169\n",
      "2      3446252780        1  1398/06/23  26200  A145    1227\n",
      "3         7900260        1  1398/06/23  29677  A145    3169\n",
      "4       361857972        1  1398/06/23  29720  A145    3169\n",
      "...           ...      ...         ...    ...   ...     ...\n",
      "53684  3650298612       25  1398/06/23  48782   D86    2764\n",
      "53685  3791696332       25  1398/06/23  49293   D86    2764\n",
      "53686  3791696332       25  1398/06/23  49959   D86    3830\n",
      "53687  2855449086       25  1398/06/23  50114   D86    3830\n",
      "53688  3680109612       25  1398/06/23  50218   D86    3830\n",
      "\n",
      "[53689 rows x 6 columns]\n",
      "transactions in line 25 plat E174\n",
      "ps: \n",
      "              CardID  LineCode       FDate   Time  plat\n",
      "349870  1368254334        25  1398/06/23  53017  E174\n",
      "349871  2138840781        25  1398/06/23  53019  E174\n",
      "349872  2743386468        25  1398/06/23  53021  E174\n",
      "349873  2741824836        25  1398/06/23  53023  E174\n",
      "349874  3152232910        25  1398/06/23  53038  E174\n",
      "349875  3152232910        25  1398/06/23  53039  E174\n",
      "349876  3152232910        25  1398/06/23  53042  E174\n",
      "488236  4246070231        25  1398/06/23  57589  E174\n",
      "488237   427332798        25  1398/06/23  57594  E174\n",
      "488238  2742671940        25  1398/06/23  57598  E174\n",
      "488239   261563393        25  1398/06/23  57670  E174\n",
      "488240   736669136        25  1398/06/23  57673  E174\n",
      "488241  2680553732        25  1398/06/23  57950  E174\n",
      "488242  2680553732        25  1398/06/23  57954  E174\n",
      "488244  1294032270        25  1398/06/23  57998  E174\n",
      "488245  1294032270        25  1398/06/23  58001  E174\n",
      "488243  3818762373        25  1398/06/23  58064  E174\n",
      "488246  1834842989        25  1398/06/23  58415  E174\n",
      "488247  1002183335        25  1398/06/23  58857  E174\n",
      "488248   260838641        25  1398/06/23  59335  E174\n",
      "488249  2182481267        25  1398/06/23  59479  E174\n",
      "488250  3214551636        25  1398/06/23  59487  E174\n",
      "488251  2742913556        25  1398/06/23  61614  E174\n",
      "488252  1835468173        25  1398/06/23  61617  E174\n",
      "488253  2855522686        25  1398/06/23  61629  E174\n",
      "488254  2741541892        25  1398/06/23  62230  E174\n",
      "488255  2481885316        25  1398/06/23  62234  E174\n",
      "488256  2052878306        25  1398/06/23  62401  E174\n",
      "488257  3208138660        25  1398/06/23  62408  E174\n",
      "488258  3208138660        25  1398/06/23  62410  E174\n",
      "488259   721870354        25  1398/06/23  62416  E174\n",
      "488260  3181074270        25  1398/06/23  62581  E174\n",
      "488261   869453675        25  1398/06/23  63083  E174\n",
      "first row of the selected chunck : \n",
      " [1368254334 25 '1398/06/23' 53017 'E174']\n",
      "33\n",
      "t0 = 53017\n",
      "ts = 63083\n",
      "time_intervals 17\n",
      "Origin destination interval view reindex \n",
      "    time_in  time_out\n",
      "0  53017.0   53617.0\n",
      "1  54217.0   57817.0\n",
      "2  60217.0   62017.0\n",
      "OD bus stations of transactions: \n",
      "            CardID LineCode       FDate   Time  plat Station\n",
      "0       542446139        1  1398/06/23  24030  A145    3169\n",
      "1      2620656172        1  1398/06/23  24302  A145    3169\n",
      "2      3446252780        1  1398/06/23  26200  A145    1227\n",
      "3         7900260        1  1398/06/23  29677  A145    3169\n",
      "4       361857972        1  1398/06/23  29720  A145    3169\n",
      "...           ...      ...         ...    ...   ...     ...\n",
      "53900   261563393       25  1398/06/23  57670  E174    3830\n",
      "53901   736669136       25  1398/06/23  57673  E174    3830\n",
      "53902  2742913556       25  1398/06/23  61614  E174    2764\n",
      "53903  1835468173       25  1398/06/23  61617  E174    2764\n",
      "53904  2855522686       25  1398/06/23  61629  E174    2764\n",
      "\n",
      "[53905 rows x 6 columns]\n",
      "transactions in line 25 plat E240\n",
      "ps: \n",
      "              CardID  LineCode       FDate   Time  plat\n",
      "4359    3677868700        25  1398/06/23  59483  E240\n",
      "4360    3183856062        25  1398/06/23  59542  E240\n",
      "4361    3183856062        25  1398/06/23  59546  E240\n",
      "4362    3154008238        25  1398/06/23  59710  E240\n",
      "4363    2124712756        25  1398/06/23  59712  E240\n",
      "...            ...       ...         ...    ...   ...\n",
      "324167  1831715085        25  1398/06/23  73458  E240\n",
      "694296  3679976492        25  1398/06/23  74830  E240\n",
      "694297  3679976492        25  1398/06/23  74832  E240\n",
      "694298  3679976492        25  1398/06/23  74834  E240\n",
      "694299  3679976492        25  1398/06/23  74837  E240\n",
      "\n",
      "[150 rows x 5 columns]\n",
      "first row of the selected chunck : \n",
      " [3677868700 25 '1398/06/23' 59483 'E240']\n",
      "150\n",
      "t0 = 59483\n",
      "ts = 74837\n",
      "time_intervals 26\n",
      "Origin destination interval view reindex \n",
      "    time_in  time_out\n",
      "0  59483.0   60083.0\n",
      "1  61883.0   63083.0\n",
      "2  64883.0   66683.0\n",
      "3  68483.0   69083.0\n",
      "4  69683.0   70283.0\n",
      "5  74483.0   75083.0\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "OD bus stations of transactions: \n",
      "            CardID LineCode       FDate   Time  plat Station\n",
      "0       542446139        1  1398/06/23  24030  A145    3169\n",
      "1      2620656172        1  1398/06/23  24302  A145    3169\n",
      "2      3446252780        1  1398/06/23  26200  A145    1227\n",
      "3         7900260        1  1398/06/23  29677  A145    3169\n",
      "4       361857972        1  1398/06/23  29720  A145    3169\n",
      "...           ...      ...         ...    ...   ...     ...\n",
      "53987  1775603956       25  1398/06/23  70258  E240    2764\n",
      "53988  3679976492       25  1398/06/23  74830  E240    3830\n",
      "53989  3679976492       25  1398/06/23  74832  E240    3830\n",
      "53990  3679976492       25  1398/06/23  74834  E240    3830\n",
      "53991  3679976492       25  1398/06/23  74837  E240    3830\n",
      "\n",
      "[53992 rows x 6 columns]\n",
      "transactions in line 25 plat F18\n",
      "ps: \n",
      "              CardID  LineCode       FDate   Time plat\n",
      "507976  1835842333        25  1398/06/23  51052  F18\n",
      "507858  1527007566        25  1398/06/23  51053  F18\n",
      "507977  2741278612        25  1398/06/23  51053  F18\n",
      "507859  3209493764        25  1398/06/23  51055  F18\n",
      "507978  1003054759        25  1398/06/23  51058  F18\n",
      "507979  1003054759        25  1398/06/23  51060  F18\n",
      "507860  1361121413        25  1398/06/23  51064  F18\n",
      "507980   210784427        25  1398/06/23  51067  F18\n",
      "507861   869456756        25  1398/06/23  51068  F18\n",
      "507862   808734866        25  1398/06/23  51069  F18\n",
      "507981  3629866380        25  1398/06/23  51069  F18\n",
      "507973   869456756        25  1398/06/23  51070  F18\n",
      "507982   362529604        25  1398/06/23  51072  F18\n",
      "507983  3405918070        25  1398/06/23  51074  F18\n",
      "507974   869428966        25  1398/06/23  51078  F18\n",
      "507984  3209133204        25  1398/06/23  51079  F18\n",
      "507985  3154029118        25  1398/06/23  51085  F18\n",
      "507986  2742219348        25  1398/06/23  51092  F18\n",
      "507975  4270275202        25  1398/06/23  51093  F18\n",
      "507987  2043925742        25  1398/06/23  51114  F18\n",
      "507990   982028203        25  1398/06/23  51257  F18\n",
      "507988  4270865858        25  1398/06/23  51298  F18\n",
      "507989  2537875906        25  1398/06/23  51458  F18\n",
      "507991   996445166        25  1398/06/23  51525  F18\n",
      "507992  2741536212        25  1398/06/23  52140  F18\n",
      "first row of the selected chunck : \n",
      " [1835842333 25 '1398/06/23' 51052 'F18']\n",
      "25\n",
      "t0 = 51052\n",
      "ts = 52140\n",
      "time_intervals 2\n",
      "Origin destination interval view reindex \n",
      "    time_in  time_out\n",
      "0  51052.0   51652.0\n",
      "OD bus stations of transactions: \n",
      "            CardID LineCode       FDate   Time  plat Station\n",
      "0       542446139        1  1398/06/23  24030  A145    3169\n",
      "1      2620656172        1  1398/06/23  24302  A145    3169\n",
      "2      3446252780        1  1398/06/23  26200  A145    1227\n",
      "3         7900260        1  1398/06/23  29677  A145    3169\n",
      "4       361857972        1  1398/06/23  29720  A145    3169\n",
      "...           ...      ...         ...    ...   ...     ...\n",
      "54011  2043925742       25  1398/06/23  51114   F18    2764\n",
      "54012   982028203       25  1398/06/23  51257   F18    2764\n",
      "54013  4270865858       25  1398/06/23  51298   F18    2764\n",
      "54014  2537875906       25  1398/06/23  51458   F18    2764\n",
      "54015   996445166       25  1398/06/23  51525   F18    2764\n",
      "\n",
      "[54016 rows x 6 columns]\n",
      "transactions in line 25 plat F63\n",
      "ps: \n",
      "              CardID  LineCode       FDate   Time plat\n",
      "456408  3632318364        25  1398/06/23  46278  F63\n",
      "456409  3154008238        25  1398/06/23  46280  F63\n",
      "456410  3650176212        25  1398/06/23  46285  F63\n",
      "456793   981820635        25  1398/06/23  46287  F63\n",
      "456777  1527769902        25  1398/06/23  46289  F63\n",
      "...            ...       ...         ...    ...  ...\n",
      "459816   722213216        25  1398/06/23  75510  F63\n",
      "459817  2045357422        25  1398/06/23  75668  F63\n",
      "459818   722192368        25  1398/06/23  75909  F63\n",
      "459819  2137758205        25  1398/06/23  75924  F63\n",
      "459820  2137758205        25  1398/06/23  75926  F63\n",
      "\n",
      "[116 rows x 5 columns]\n",
      "first row of the selected chunck : \n",
      " [3632318364 25 '1398/06/23' 46278 'F63']\n",
      "116\n",
      "t0 = 46278\n",
      "ts = 75926\n",
      "time_intervals 49\n",
      "Origin destination interval view reindex \n",
      "    time_in  time_out\n",
      "0  46278.0   46878.0\n",
      "1  48678.0   49878.0\n",
      "2  51678.0   52278.0\n",
      "3  54678.0   55878.0\n",
      "4  56478.0   57678.0\n",
      "5  58878.0   60078.0\n",
      "6  60678.0   63678.0\n",
      "7  69678.0   72678.0\n",
      "8  74478.0   75678.0\n",
      "OD bus stations of transactions: \n",
      "            CardID LineCode       FDate   Time  plat Station\n",
      "0       542446139        1  1398/06/23  24030  A145    3169\n",
      "1      2620656172        1  1398/06/23  24302  A145    3169\n",
      "2      3446252780        1  1398/06/23  26200  A145    1227\n",
      "3         7900260        1  1398/06/23  29677  A145    3169\n",
      "4       361857972        1  1398/06/23  29720  A145    3169\n",
      "...           ...      ...         ...    ...   ...     ...\n",
      "54070  3650049332       25  1398/06/23  63423   F63    2764\n",
      "54071  3213956436       25  1398/06/23  63590   F63    2764\n",
      "54072  3405788282       25  1398/06/23  72465   F63    3830\n",
      "54073   722213216       25  1398/06/23  75510   F63    2764\n",
      "54074  2045357422       25  1398/06/23  75668   F63    2764\n",
      "\n",
      "[54075 rows x 6 columns]\n",
      "transactions in line 25 plat M152\n",
      "ps: \n",
      "               CardID  LineCode       FDate   Time  plat\n",
      "2335295  3446246828        25  1398/06/23  22074  M152\n",
      "2335298  1782122148        25  1398/06/23  22634  M152\n",
      "2335301  3997320468        25  1398/06/23  22637  M152\n",
      "2335306   184606614        25  1398/06/23  22698  M152\n",
      "2335304  2136893757        25  1398/06/23  22899  M152\n",
      "...             ...       ...         ...    ...   ...\n",
      "2314609  1001711790        25  1398/06/23  37186  M152\n",
      "2314614  2044522734        25  1398/06/23  37195  M152\n",
      "2314615   736663360        25  1398/06/23  37253  M152\n",
      "2314611  2184232147        25  1398/06/23  37260  M152\n",
      "2314617  2117531444        25  1398/06/23  37266  M152\n",
      "\n",
      "[100 rows x 5 columns]\n",
      "first row of the selected chunck : \n",
      " [3446246828 25 '1398/06/23' 22074 'M152']\n",
      "100\n",
      "t0 = 22074\n",
      "ts = 37266\n",
      "time_intervals 25\n",
      "Origin destination interval view reindex \n",
      "    time_in  time_out\n",
      "0  22074.0   22674.0\n",
      "1  24474.0   25674.0\n",
      "2  31674.0   32874.0\n",
      "3  34674.0   35874.0\n",
      "OD bus stations of transactions: \n",
      "            CardID LineCode       FDate   Time  plat Station\n",
      "0       542446139        1  1398/06/23  24030  A145    3169\n",
      "1      2620656172        1  1398/06/23  24302  A145    3169\n",
      "2      3446252780        1  1398/06/23  26200  A145    1227\n",
      "3         7900260        1  1398/06/23  29677  A145    3169\n",
      "4       361857972        1  1398/06/23  29720  A145    3169\n",
      "...           ...      ...         ...    ...   ...     ...\n",
      "54087  2122375588       25  1398/06/23  35643  M152    3830\n",
      "54088  3180618558       25  1398/06/23  35645  M152    3830\n",
      "54089   261899985       25  1398/06/23  35646  M152    3830\n",
      "54090  2139035181       25  1398/06/23  35649  M152    3830\n",
      "54091  3206651596       25  1398/06/23  35650  M152    3830\n",
      "\n",
      "[54092 rows x 6 columns]\n",
      "transactions in line 25 plat M36\n",
      "ps: \n",
      "              CardID  LineCode       FDate   Time plat\n",
      "132466  1001861166        25  1398/06/23  23754  M36\n",
      "132467   721955126        25  1398/06/23  23856  M36\n",
      "132468  3208138660        25  1398/06/23  23856  M36\n",
      "132469  2122880612        25  1398/06/23  24115  M36\n",
      "132470   721917692        25  1398/06/23  25624  M36\n",
      "...            ...       ...         ...    ...  ...\n",
      "694497   980838987        25  1398/06/23  75810  M36\n",
      "694499   235153802        25  1398/06/23  75815  M36\n",
      "132463  3791722348        25  1398/06/23  77927  M36\n",
      "132464  3791722348        25  1398/06/23  77935  M36\n",
      "132465  3791722348        25  1398/06/23  77939  M36\n",
      "\n",
      "[392 rows x 5 columns]\n",
      "first row of the selected chunck : \n",
      " [1001861166 25 '1398/06/23' 23754 'M36']\n",
      "392\n",
      "t0 = 23754\n",
      "ts = 77939\n",
      "time_intervals 90\n",
      "Origin destination interval view reindex \n",
      "     time_in  time_out\n",
      "0   23754.0   24354.0\n",
      "1   24954.0   26154.0\n",
      "2   27354.0   27954.0\n",
      "3   33354.0   33954.0\n",
      "4   36954.0   37554.0\n",
      "5   39354.0   39954.0\n",
      "6   42954.0   44154.0\n",
      "7   47154.0   47754.0\n",
      "8   49554.0   50154.0\n",
      "9   50754.0   51354.0\n",
      "10  54354.0   54954.0\n",
      "11  60354.0   62154.0\n",
      "12  64554.0   66354.0\n",
      "13  66954.0   68154.0\n",
      "14  74154.0   75354.0\n",
      "15  76554.0   77754.0\n",
      "OD bus stations of transactions: \n",
      "            CardID LineCode       FDate   Time  plat Station\n",
      "0       542446139        1  1398/06/23  24030  A145    3169\n",
      "1      2620656172        1  1398/06/23  24302  A145    3169\n",
      "2      3446252780        1  1398/06/23  26200  A145    1227\n",
      "3         7900260        1  1398/06/23  29677  A145    3169\n",
      "4       361857972        1  1398/06/23  29720  A145    3169\n",
      "...           ...      ...         ...    ...   ...     ...\n",
      "54172  4276383746       25  1398/06/23  67827   M36    3830\n",
      "54173  2590559012       25  1398/06/23  74835   M36    2764\n",
      "54174  2590559012       25  1398/06/23  74836   M36    2764\n",
      "54175  2590559012       25  1398/06/23  74839   M36    2764\n",
      "54176  3793448780       25  1398/06/23  74891   M36    2764\n",
      "\n",
      "[54177 rows x 6 columns]\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "transactions in line 25 plat M75\n",
      "ps: \n",
      "              CardID  LineCode       FDate   Time plat\n",
      "149730  3648162068        25  1398/06/23  49846  M75\n",
      "149734  2115893556        25  1398/06/23  49849  M75\n",
      "149738  3650298612        25  1398/06/23  50550  M75\n",
      "149740  3650298612        25  1398/06/23  50551  M75\n",
      "149743  1528528430        25  1398/06/23  50949  M75\n",
      "...            ...       ...         ...    ...  ...\n",
      "76174   1832911661        25  1398/06/23  75777  M75\n",
      "76178   2239125104        25  1398/06/23  75989  M75\n",
      "156580   212931579        25  1398/06/23  78134  M75\n",
      "156583   212931579        25  1398/06/23  78136  M75\n",
      "156585   212931579        25  1398/06/23  78138  M75\n",
      "\n",
      "[119 rows x 5 columns]\n",
      "first row of the selected chunck : \n",
      " [3648162068 25 '1398/06/23' 49846 'M75']\n",
      "119\n",
      "t0 = 49846\n",
      "ts = 78138\n",
      "time_intervals 47\n",
      "Origin destination interval view reindex \n",
      "    time_in  time_out\n",
      "0  49846.0   50446.0\n",
      "1  52846.0   60646.0\n",
      "2  63046.0   64246.0\n",
      "3  66646.0   67246.0\n",
      "4  70246.0   72646.0\n",
      "5  73246.0   75046.0\n",
      "6  76846.0   78046.0\n",
      "OD bus stations of transactions: \n",
      "            CardID LineCode       FDate   Time  plat Station\n",
      "0       542446139        1  1398/06/23  24030  A145    3169\n",
      "1      2620656172        1  1398/06/23  24302  A145    3169\n",
      "2      3446252780        1  1398/06/23  26200  A145    1227\n",
      "3         7900260        1  1398/06/23  29677  A145    3169\n",
      "4       361857972        1  1398/06/23  29720  A145    3169\n",
      "...           ...      ...         ...    ...   ...     ...\n",
      "54461   986175355       25  1398/06/23  74778   M75    3830\n",
      "54462   986175355       25  1398/06/23  74779   M75    3830\n",
      "54463   869393893       25  1398/06/23  74803   M75    3830\n",
      "54464   869393893       25  1398/06/23  74805   M75    3830\n",
      "54465   429436750       25  1398/06/23  75046   M75    3830\n",
      "\n",
      "[54466 rows x 6 columns]\n",
      "transactions in line 25 plat N113\n",
      "ps: \n",
      "              CardID  LineCode       FDate   Time  plat\n",
      "215768   721958683        25  1398/06/23  21562  N113\n",
      "215769  4270105058        25  1398/06/23  23917  N113\n",
      "54865   1835842333        25  1398/06/23  24355  N113\n",
      "310229  3629866380        25  1398/06/23  24473  N113\n",
      "310230  1837331021        25  1398/06/23  24476  N113\n",
      "...            ...       ...         ...    ...   ...\n",
      "90219   1776193156        25  1398/06/23  74754  N113\n",
      "90222   2128888708        25  1398/06/23  74755  N113\n",
      "90224    426291486        25  1398/06/23  74805  N113\n",
      "90226    426291486        25  1398/06/23  74807  N113\n",
      "215767   362347348        25  1398/06/23  76211  N113\n",
      "\n",
      "[269 rows x 5 columns]\n",
      "first row of the selected chunck : \n",
      " [721958683 25 '1398/06/23' 21562 'N113']\n",
      "269\n",
      "t0 = 21562\n",
      "ts = 76211\n",
      "time_intervals 91\n",
      "Origin destination interval view reindex \n",
      "     time_in  time_out\n",
      "0   21562.0   23962.0\n",
      "1   26362.0   26962.0\n",
      "2   31162.0   32362.0\n",
      "3   34162.0   34762.0\n",
      "4   37162.0   38362.0\n",
      "5   40162.0   40762.0\n",
      "6   44362.0   46762.0\n",
      "7   47962.0   58762.0\n",
      "8   61162.0   62362.0\n",
      "9   64162.0   65362.0\n",
      "10  68362.0   69562.0\n",
      "11  73162.0   73762.0\n",
      "12  75562.0   76162.0\n",
      "OD bus stations of transactions: \n",
      "            CardID LineCode       FDate   Time  plat Station\n",
      "0       542446139        1  1398/06/23  24030  A145    3169\n",
      "1      2620656172        1  1398/06/23  24302  A145    3169\n",
      "2      3446252780        1  1398/06/23  26200  A145    1227\n",
      "3         7900260        1  1398/06/23  29677  A145    3169\n",
      "4       361857972        1  1398/06/23  29720  A145    3169\n",
      "...           ...      ...         ...    ...   ...     ...\n",
      "54543  2239100779       25  1398/06/23  73595  N113    3830\n",
      "54544  3678135836       25  1398/06/23  73615  N113    3830\n",
      "54545   722256549       25  1398/06/23  73627  N113    3830\n",
      "54546  3631614028       25  1398/06/23  73629  N113    3830\n",
      "54547  2523612834       25  1398/06/23  73680  N113    3830\n",
      "\n",
      "[54548 rows x 6 columns]\n",
      "transactions in line 25 plat N157\n",
      "ps: \n",
      "              CardID  LineCode       FDate   Time  plat\n",
      "363469  2501600052        25  1398/06/23  60782  N157\n",
      "363470   185280118        25  1398/06/23  61459  N157\n",
      "363471   185280118        25  1398/06/23  61463  N157\n",
      "363472   986175355        25  1398/06/23  61724  N157\n",
      "363473   986175355        25  1398/06/23  61725  N157\n",
      "...            ...       ...         ...    ...   ...\n",
      "336422  3630547628        25  1398/06/23  74138  N157\n",
      "336423   722203671        25  1398/06/23  74141  N157\n",
      "336424   428294046        25  1398/06/23  74291  N157\n",
      "336425  3648927908        25  1398/06/23  74295  N157\n",
      "336426  3648085828        25  1398/06/23  75973  N157\n",
      "\n",
      "[123 rows x 5 columns]\n",
      "first row of the selected chunck : \n",
      " [2501600052 25 '1398/06/23' 60782 'N157']\n",
      "123\n",
      "t0 = 60782\n",
      "ts = 75973\n",
      "time_intervals 25\n",
      "Origin destination interval view reindex \n",
      "    time_in  time_out\n",
      "0  60782.0   61982.0\n",
      "1  63782.0   64382.0\n",
      "2  67382.0   68582.0\n",
      "3  71582.0   72782.0\n",
      "4  75182.0   75782.0\n",
      "OD bus stations of transactions: \n",
      "            CardID LineCode       FDate   Time  plat Station\n",
      "0       542446139        1  1398/06/23  24030  A145    3169\n",
      "1      2620656172        1  1398/06/23  24302  A145    3169\n",
      "2      3446252780        1  1398/06/23  26200  A145    1227\n",
      "3         7900260        1  1398/06/23  29677  A145    3169\n",
      "4       361857972        1  1398/06/23  29720  A145    3169\n",
      "...           ...      ...         ...    ...   ...     ...\n",
      "54672   721910673       25  1398/06/23  72651  N157    3830\n",
      "54673   428083822       25  1398/06/23  72698  N157    3830\n",
      "54674  2659007548       25  1398/06/23  72700  N157    3830\n",
      "54675   721957659       25  1398/06/23  72701  N157    3830\n",
      "54676  3151715342       25  1398/06/23  72715  N157    3830\n",
      "\n",
      "[54677 rows x 6 columns]\n",
      "transactions in line 25 plat N58\n",
      "ps: \n",
      "              CardID  LineCode       FDate   Time plat\n",
      "257969  2541637022        25  1398/06/23  61000  N58\n",
      "257970  1368131694        25  1398/06/23  61024  N58\n",
      "257971   796391950        25  1398/06/23  61285  N58\n",
      "257972  2232937859        25  1398/06/23  61319  N58\n",
      "257973  1528559454        25  1398/06/23  61531  N58\n",
      "...            ...       ...         ...    ...  ...\n",
      "258378   721762030        25  1398/06/23  75620  N58\n",
      "258379   638292571        25  1398/06/23  75698  N58\n",
      "258380   982112587        25  1398/06/23  75771  N58\n",
      "156349   362694324        25  1398/06/23  77597  N58\n",
      "156350   362694324        25  1398/06/23  77600  N58\n",
      "\n",
      "[123 rows x 5 columns]\n",
      "first row of the selected chunck : \n",
      " [2541637022 25 '1398/06/23' 61000 'N58']\n",
      "123\n",
      "t0 = 61000\n",
      "ts = 77600\n",
      "time_intervals 28\n",
      "Origin destination interval view reindex \n",
      "    time_in  time_out\n",
      "0  61000.0   61600.0\n",
      "1  63400.0   64600.0\n",
      "2  67000.0   68800.0\n",
      "3  70600.0   74200.0\n",
      "4  76600.0   77800.0\n",
      "OD bus stations of transactions: \n",
      "            CardID LineCode       FDate   Time  plat Station\n",
      "0       542446139        1  1398/06/23  24030  A145    3169\n",
      "1      2620656172        1  1398/06/23  24302  A145    3169\n",
      "2      3446252780        1  1398/06/23  26200  A145    1227\n",
      "3         7900260        1  1398/06/23  29677  A145    3169\n",
      "4       361857972        1  1398/06/23  29720  A145    3169\n",
      "...           ...      ...         ...    ...   ...     ...\n",
      "54727  3206039988       25  1398/06/23  74109   N58    3830\n",
      "54728  1548146245       25  1398/06/23  74182   N58    3830\n",
      "54729  1548146245       25  1398/06/23  74184   N58    3830\n",
      "54730   362694324       25  1398/06/23  77597   N58    2764\n",
      "54731   362694324       25  1398/06/23  77600   N58    2764\n",
      "\n",
      "[54732 rows x 6 columns]\n",
      "stations in a specefic bus line 26\n",
      "len-of-go stations: 0\n",
      "len-of-back stations: 0\n",
      "len-of-go back stations: 0\n",
      "stations in a specefic bus line 28\n",
      "len-of-go stations: 38\n",
      "len-of-back stations: 36\n",
      "len-of-go back stations: 0\n",
      "first Station  [1898 '28' '1' 'go' '?????? ???????? -28' 51.75241 32.649044 'od' 'normal'\n",
      " 'yes'] 1898\n",
      "last Station  [2164 '28' '1' 'back' '?? ????-74-28' 51.641286 32.643469 'od' 'normal'\n",
      " 'no']\n",
      "['A118' 'A38' 'B14' 'B20' 'B73' 'C36' 'C37' 'E228' 'F138' 'F139' 'F145'\n",
      " 'M190' 'M211' 'N125' 'N161' 'N169' 'N75']\n",
      "transactions in line 28 plat A118\n",
      "ps: \n",
      "              CardID  LineCode       FDate   Time  plat\n",
      "317147  2491424420        28  1398/06/23  44269  A118\n",
      "317149  3205858325        28  1398/06/23  44276  A118\n",
      "317152  2741416484        28  1398/06/23  44539  A118\n",
      "317154   261403473        28  1398/06/23  44656  A118\n",
      "317156   641541738        28  1398/06/23  44747  A118\n",
      "317159  2742567252        28  1398/06/23  45072  A118\n",
      "317162  2742567252        28  1398/06/23  45074  A118\n",
      "12463    869215373        28  1398/06/23  46111  A118\n",
      "317165  1407176796        28  1398/06/23  46174  A118\n",
      "12466   1787061156        28  1398/06/23  46297  A118\n",
      "12467   3184006494        28  1398/06/23  46542  A118\n",
      "12471   1002357303        28  1398/06/23  46735  A118\n",
      "12473   1002357303        28  1398/06/23  46737  A118\n",
      "12476   2742367508        28  1398/06/23  46737  A118\n",
      "12478   2039949802        28  1398/06/23  46739  A118\n",
      "12481    735810176        28  1398/06/23  47089  A118\n",
      "12484    735810176        28  1398/06/23  47091  A118\n",
      "12486   2621511244        28  1398/06/23  47221  A118\n",
      "12489    168686020        28  1398/06/23  51782  A118\n",
      "12492   2855252734        28  1398/06/23  51797  A118\n",
      "12497   2125867732        28  1398/06/23  52013  A118\n",
      "12500    555856238        28  1398/06/23  52019  A118\n",
      "12495   1789000324        28  1398/06/23  52020  A118\n",
      "12503   2124192212        28  1398/06/23  52329  A118\n",
      "12506   1529829438        28  1398/06/23  52518  A118\n",
      "12509   1831860765        28  1398/06/23  52728  A118\n",
      "12510    556667950        28  1398/06/23  52730  A118\n",
      "12513   3630900780        28  1398/06/23  52789  A118\n",
      "12516    361742516        28  1398/06/23  53004  A118\n",
      "12873   2124600372        28  1398/06/23  53008  A118\n",
      "12875   2541425118        28  1398/06/23  53011  A118\n",
      "12870    869433178        28  1398/06/23  53112  A118\n",
      "12877    361654948        28  1398/06/23  53204  A118\n",
      "12883   2189804547        28  1398/06/23  55620  A118\n",
      "12885   3677681852        28  1398/06/23  56396  A118\n",
      "12888   4266271554        28  1398/06/23  56410  A118\n",
      "first row of the selected chunck : \n",
      " [2491424420 28 '1398/06/23' 44269 'A118']\n",
      "36\n",
      "t0 = 44269\n",
      "ts = 56410\n",
      "time_intervals 20\n",
      "Origin destination interval view reindex \n",
      "    time_in  time_out\n",
      "0  44269.0   44869.0\n",
      "1  46069.0   46669.0\n",
      "2  47869.0   52069.0\n",
      "3  53869.0   55669.0\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "OD bus stations of transactions: \n",
      "            CardID LineCode       FDate   Time  plat Station\n",
      "0       542446139        1  1398/06/23  24030  A145    3169\n",
      "1      2620656172        1  1398/06/23  24302  A145    3169\n",
      "2      3446252780        1  1398/06/23  26200  A145    1227\n",
      "3         7900260        1  1398/06/23  29677  A145    3169\n",
      "4       361857972        1  1398/06/23  29720  A145    3169\n",
      "...           ...      ...         ...    ...   ...     ...\n",
      "54793  2855252734       28  1398/06/23  51797  A118    1898\n",
      "54794  2125867732       28  1398/06/23  52013  A118    1898\n",
      "54795   555856238       28  1398/06/23  52019  A118    1898\n",
      "54796  1789000324       28  1398/06/23  52020  A118    1898\n",
      "54797  2189804547       28  1398/06/23  55620  A118    2164\n",
      "\n",
      "[54798 rows x 6 columns]\n",
      "transactions in line 28 plat A38\n",
      "ps: \n",
      "              CardID  LineCode       FDate   Time plat\n",
      "491840  3701032053        28  1398/06/23  23418  A38\n",
      "491841  3679875132        28  1398/06/23  23611  A38\n",
      "491842  3445514348        28  1398/06/23  23787  A38\n",
      "491843  1296109742        28  1398/06/23  23935  A38\n",
      "491844  3203250292        28  1398/06/23  23938  A38\n",
      "...            ...       ...         ...    ...  ...\n",
      "491835  2070791201        28  1398/06/23  78594  A38\n",
      "491836  2070791201        28  1398/06/23  78596  A38\n",
      "491837  2070791201        28  1398/06/23  78598  A38\n",
      "491838  2070791201        28  1398/06/23  78601  A38\n",
      "491839  2070791201        28  1398/06/23  78607  A38\n",
      "\n",
      "[856 rows x 5 columns]\n",
      "first row of the selected chunck : \n",
      " [3701032053 28 '1398/06/23' 23418 'A38']\n",
      "856\n",
      "t0 = 23418\n",
      "ts = 78607\n",
      "time_intervals 92\n",
      "Origin destination interval view reindex \n",
      "    time_in  time_out\n",
      "0  23418.0   24018.0\n",
      "1  33618.0   34218.0\n",
      "2  37218.0   39018.0\n",
      "3  52218.0   52818.0\n",
      "4  54618.0   55218.0\n",
      "5  55818.0   56418.0\n",
      "6  60018.0   61218.0\n",
      "7  73818.0   74418.0\n",
      "8  76218.0   78618.0\n",
      "OD bus stations of transactions: \n",
      "            CardID LineCode       FDate   Time  plat Station\n",
      "0       542446139        1  1398/06/23  24030  A145    3169\n",
      "1      2620656172        1  1398/06/23  24302  A145    3169\n",
      "2      3446252780        1  1398/06/23  26200  A145    1227\n",
      "3         7900260        1  1398/06/23  29677  A145    3169\n",
      "4       361857972        1  1398/06/23  29720  A145    3169\n",
      "...           ...      ...         ...    ...   ...     ...\n",
      "54839  2070791201       28  1398/06/23  78594   A38    1898\n",
      "54840  2070791201       28  1398/06/23  78596   A38    1898\n",
      "54841  2070791201       28  1398/06/23  78598   A38    1898\n",
      "54842  2070791201       28  1398/06/23  78601   A38    1898\n",
      "54843  2070791201       28  1398/06/23  78607   A38    1898\n",
      "\n",
      "[54844 rows x 6 columns]\n",
      "transactions in line 28 plat B14\n",
      "ps: \n",
      "              CardID  LineCode       FDate   Time plat\n",
      "129929   721805548        28  1398/06/23  23120  B14\n",
      "129931   721934780        28  1398/06/23  23127  B14\n",
      "129933  2122319700        28  1398/06/23  23355  B14\n",
      "129934  2501028324        28  1398/06/23  23463  B14\n",
      "129935   869189081        28  1398/06/23  23548  B14\n",
      "...            ...       ...         ...    ...  ...\n",
      "446083  3680022588        28  1398/06/23  77933  B14\n",
      "446086  3680022588        28  1398/06/23  77935  B14\n",
      "42707   3631268988        28  1398/06/23  78285  B14\n",
      "42708   3631268988        28  1398/06/23  78287  B14\n",
      "42710   3631268988        28  1398/06/23  78288  B14\n",
      "\n",
      "[504 rows x 5 columns]\n",
      "first row of the selected chunck : \n",
      " [721805548 28 '1398/06/23' 23120 'B14']\n",
      "504\n",
      "t0 = 23120\n",
      "ts = 78288\n",
      "time_intervals 92\n",
      "Origin destination interval view reindex \n",
      "    time_in  time_out\n",
      "0  23120.0   23720.0\n",
      "1  29120.0   29720.0\n",
      "2  33320.0   33920.0\n",
      "3  37520.0   38720.0\n",
      "4  42320.0   42920.0\n",
      "5  50120.0   52520.0\n",
      "6  54320.0   54920.0\n",
      "7  57920.0   59120.0\n",
      "8  62120.0   62720.0\n",
      "9  73520.0   76520.0\n",
      "OD bus stations of transactions: \n",
      "            CardID LineCode       FDate   Time  plat Station\n",
      "0       542446139        1  1398/06/23  24030  A145    3169\n",
      "1      2620656172        1  1398/06/23  24302  A145    3169\n",
      "2      3446252780        1  1398/06/23  26200  A145    1227\n",
      "3         7900260        1  1398/06/23  29677  A145    3169\n",
      "4       361857972        1  1398/06/23  29720  A145    3169\n",
      "...           ...      ...         ...    ...   ...     ...\n",
      "55693  2620613532       28  1398/06/23  76496   B14    2164\n",
      "55694  1414658937       28  1398/06/23  76497   B14    2164\n",
      "55695  1414658937       28  1398/06/23  76498   B14    2164\n",
      "55696   474069882       28  1398/06/23  76500   B14    2164\n",
      "55697   483110356       28  1398/06/23  76515   B14    2164\n",
      "\n",
      "[55698 rows x 6 columns]\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "C:\\Users\\esmaeli.h\\AppData\\Local\\Temp/ipykernel_12452/1949912630.py:257: ConvergenceWarning: Number of distinct clusters (35) found smaller than n_clusters (37). Possibly due to duplicate points in X.\n",
      "  kmeans = KMeans(n_clusters=len(filter_go_stations)-1,random_state=0).fit(partial_times.to_numpy())\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "transactions in line 28 plat B20\n",
      "ps: \n",
      "              CardID  LineCode       FDate   Time plat\n",
      "646770  3254642893        28  1398/06/23  22070  B20\n",
      "646771  3150976062        28  1398/06/23  23040  B20\n",
      "646772   262745761        28  1398/06/23  24242  B20\n",
      "646773   722080983        28  1398/06/23  25622  B20\n",
      "646774   722206460        28  1398/06/23  25758  B20\n",
      "...            ...       ...         ...    ...  ...\n",
      "386745  3405885143        28  1398/06/23  72229  B20\n",
      "646767   389477269        28  1398/06/23  75427  B20\n",
      "386746   175714262        28  1398/06/23  75477  B20\n",
      "646768   389477269        28  1398/06/23  78961  B20\n",
      "646769   389477269        28  1398/06/23  79089  B20\n",
      "\n",
      "[542 rows x 5 columns]\n",
      "first row of the selected chunck : \n",
      " [3254642893 28 '1398/06/23' 22070 'B20']\n",
      "542\n",
      "t0 = 22070\n",
      "ts = 79089\n",
      "time_intervals 95\n",
      "Origin destination interval view reindex \n",
      "     time_in  time_out\n",
      "0   22070.0   23270.0\n",
      "1   23870.0   24470.0\n",
      "2   25070.0   25670.0\n",
      "3   28070.0   29270.0\n",
      "4   37070.0   38270.0\n",
      "5   40670.0   42470.0\n",
      "6   44270.0   44870.0\n",
      "7   49670.0   50270.0\n",
      "8   50870.0   51470.0\n",
      "9   53870.0   54470.0\n",
      "10  56270.0   57470.0\n",
      "11  59870.0   61070.0\n",
      "12  68870.0   70070.0\n",
      "13  73070.0   75470.0\n",
      "14  76670.0   79070.0\n",
      "OD bus stations of transactions: \n",
      "            CardID LineCode       FDate   Time  plat Station\n",
      "0       542446139        1  1398/06/23  24030  A145    3169\n",
      "1      2620656172        1  1398/06/23  24302  A145    3169\n",
      "2      3446252780        1  1398/06/23  26200  A145    1227\n",
      "3         7900260        1  1398/06/23  29677  A145    3169\n",
      "4       361857972        1  1398/06/23  29720  A145    3169\n",
      "...           ...      ...         ...    ...   ...     ...\n",
      "56069  3677828492       28  1398/06/23  69771   B20    1898\n",
      "56070  1407754553       28  1398/06/23  69926   B20    1898\n",
      "56071  2239158022       28  1398/06/23  69930   B20    1898\n",
      "56072   389477269       28  1398/06/23  75427   B20    2164\n",
      "56073   389477269       28  1398/06/23  78961   B20    1898\n",
      "\n",
      "[56074 rows x 6 columns]\n",
      "transactions in line 28 plat B73\n",
      "ps: \n",
      "              CardID  LineCode       FDate   Time plat\n",
      "206045  3257493277        28  1398/06/23  23947  B73\n",
      "206042  3794811276        28  1398/06/23  23990  B73\n",
      "206048  1407220188        28  1398/06/23  24139  B73\n",
      "206049   362522196        28  1398/06/23  24184  B73\n",
      "206052  1611635163        28  1398/06/23  24594  B73\n",
      "...            ...       ...         ...    ...  ...\n",
      "217469  1831373805        28  1398/06/23  72801  B73\n",
      "217473  3405905370        28  1398/06/23  73809  B73\n",
      "63792   3405905370        28  1398/06/23  73811  B73\n",
      "63794   1837363597        28  1398/06/23  73816  B73\n",
      "206040  3678777980        28  1398/06/23  73955  B73\n",
      "\n",
      "[476 rows x 5 columns]\n",
      "first row of the selected chunck : \n",
      " [3257493277 28 '1398/06/23' 23947 'B73']\n",
      "476\n",
      "t0 = 23947\n",
      "ts = 73955\n",
      "time_intervals 83\n",
      "Origin destination interval view reindex \n",
      "     time_in  time_out\n",
      "0   23947.0   24547.0\n",
      "1   25747.0   26347.0\n",
      "2   29347.0   29947.0\n",
      "3   40747.0   43147.0\n",
      "4   44347.0   44947.0\n",
      "5   49147.0   49747.0\n",
      "6   50347.0   50947.0\n",
      "7   53347.0   54547.0\n",
      "8   57547.0   58147.0\n",
      "9   61147.0   62347.0\n",
      "10  65347.0   65947.0\n",
      "11  68947.0   70147.0\n",
      "OD bus stations of transactions: \n",
      "            CardID LineCode       FDate   Time  plat Station\n",
      "0       542446139        1  1398/06/23  24030  A145    3169\n",
      "1      2620656172        1  1398/06/23  24302  A145    3169\n",
      "2      3446252780        1  1398/06/23  26200  A145    1227\n",
      "3         7900260        1  1398/06/23  29677  A145    3169\n",
      "4       361857972        1  1398/06/23  29720  A145    3169\n",
      "...           ...      ...         ...    ...   ...     ...\n",
      "56527  2542016062       28  1398/06/23  62334   B73    2164\n",
      "56528   722269591       28  1398/06/23  62340   B73    2164\n",
      "56529  3678777980       28  1398/06/23  65768   B73    1898\n",
      "56530  3405955436       28  1398/06/23  65836   B73    1898\n",
      "56531  1788998100       28  1398/06/23  69935   B73    2164\n",
      "\n",
      "[56532 rows x 6 columns]\n",
      "transactions in line 28 plat C36\n",
      "ps: \n",
      "              CardID  LineCode       FDate   Time plat\n",
      "178940  3679550620        28  1398/06/23  22266  C36\n",
      "178943  2235008899        28  1398/06/23  22411  C36\n",
      "178945   721919531        28  1398/06/23  22550  C36\n",
      "178950  1368268046        28  1398/06/23  22557  C36\n",
      "178948  2742448980        28  1398/06/23  22645  C36\n",
      "...            ...       ...         ...    ...  ...\n",
      "134553  1776238804        28  1398/06/23  74581  C36\n",
      "134568  4269784754        28  1398/06/23  74587  C36\n",
      "134570   722169675        28  1398/06/23  75168  C36\n",
      "178934  3791738940        28  1398/06/23  75978  C36\n",
      "178937  3791738940        28  1398/06/23  75981  C36\n",
      "\n",
      "[530 rows x 5 columns]\n",
      "first row of the selected chunck : \n",
      " [3679550620 28 '1398/06/23' 22266 'C36']\n",
      "530\n",
      "t0 = 22266\n",
      "ts = 75981\n",
      "time_intervals 90\n",
      "Origin destination interval view reindex \n",
      "     time_in  time_out\n",
      "0   22266.0   22866.0\n",
      "1   27666.0   28266.0\n",
      "2   31266.0   31866.0\n",
      "3   35466.0   36666.0\n",
      "4   40266.0   42066.0\n",
      "5   49266.0   49866.0\n",
      "6   55866.0   57066.0\n",
      "7   59466.0   60066.0\n",
      "8   62466.0   63666.0\n",
      "9   70866.0   71466.0\n",
      "10  72066.0   72666.0\n",
      "OD bus stations of transactions: \n",
      "            CardID LineCode       FDate   Time  plat Station\n",
      "0       542446139        1  1398/06/23  24030  A145    3169\n",
      "1      2620656172        1  1398/06/23  24302  A145    3169\n",
      "2      3446252780        1  1398/06/23  26200  A145    1227\n",
      "3         7900260        1  1398/06/23  29677  A145    3169\n",
      "4       361857972        1  1398/06/23  29720  A145    3169\n",
      "...           ...      ...         ...    ...   ...     ...\n",
      "56805  1527075326       28  1398/06/23  70979   C36    2164\n",
      "56806  2740544900       28  1398/06/23  71029   C36    2164\n",
      "56807   869219982       28  1398/06/23  71188   C36    2164\n",
      "56808   982704987       28  1398/06/23  72145   C36    1898\n",
      "56809  1837706077       28  1398/06/23  72411   C36    1898\n",
      "\n",
      "[56810 rows x 6 columns]\n",
      "transactions in line 28 plat C37\n",
      "ps: \n",
      "              CardID  LineCode       FDate   Time plat\n",
      "157620  3553708844        28  1398/06/23  24435  C37\n",
      "157619  3445968732        28  1398/06/23  24443  C37\n",
      "157621   721867164        28  1398/06/23  24689  C37\n",
      "157622  3152725294        28  1398/06/23  24971  C37\n",
      "157627  1002850247        28  1398/06/23  25099  C37\n",
      "...            ...       ...         ...    ...  ...\n",
      "240643  1001252478        28  1398/06/23  76028  C37\n",
      "240644  1775938932        28  1398/06/23  76223  C37\n",
      "240645  3446741436        28  1398/06/23  76237  C37\n",
      "240646  3446741436        28  1398/06/23  76238  C37\n",
      "240647   722211253        28  1398/06/23  76409  C37\n",
      "\n",
      "[486 rows x 5 columns]\n",
      "first row of the selected chunck : \n",
      " [3553708844 28 '1398/06/23' 24435 'C37']\n",
      "486\n",
      "t0 = 24435\n",
      "ts = 76409\n",
      "time_intervals 87\n",
      "Origin destination interval view reindex \n",
      "    time_in  time_out\n",
      "0  24435.0   25035.0\n",
      "1  27435.0   28035.0\n",
      "2  31035.0   41235.0\n",
      "3  41835.0   42435.0\n",
      "4  44835.0   45435.0\n",
      "5  48435.0   49035.0\n",
      "6  52035.0   53835.0\n",
      "7  55635.0   56235.0\n",
      "8  59235.0   59835.0\n",
      "9  67635.0   68235.0\n",
      "OD bus stations of transactions: \n",
      "            CardID LineCode       FDate   Time  plat Station\n",
      "0       542446139        1  1398/06/23  24030  A145    3169\n",
      "1      2620656172        1  1398/06/23  24302  A145    3169\n",
      "2      3446252780        1  1398/06/23  26200  A145    1227\n",
      "3         7900260        1  1398/06/23  29677  A145    3169\n",
      "4       361857972        1  1398/06/23  29720  A145    3169\n",
      "...           ...      ...         ...    ...   ...     ...\n",
      "57237   974203189       28  1398/06/23  68093   C37    2164\n",
      "57238  1524319156       28  1398/06/23  68158   C37    2164\n",
      "57239  1781921972       28  1398/06/23  68159   C37    2164\n",
      "57240   105762435       28  1398/06/23  68161   C37    2164\n",
      "57241  3700971637       28  1398/06/23  68164   C37    2164\n",
      "\n",
      "[57242 rows x 6 columns]\n",
      "transactions in line 28 plat E228\n",
      "ps: \n",
      "              CardID  LineCode       FDate   Time  plat\n",
      "250836  2048147490        28  1398/06/23  24461  E228\n",
      "250835  3208675028        28  1398/06/23  24591  E228\n",
      "250837  3181217774        28  1398/06/23  25262  E228\n",
      "250838  2122926244        28  1398/06/23  25305  E228\n",
      "250839  3405842755        28  1398/06/23  25388  E228\n",
      "...            ...       ...         ...    ...   ...\n",
      "251285  1837794733        28  1398/06/23  28692  E228\n",
      "251286   735796352        28  1398/06/23  29125  E228\n",
      "251287  2044126606        28  1398/06/23  29286  E228\n",
      "251288  2125735028        28  1398/06/23  29427  E228\n",
      "251289   182920022        28  1398/06/23  29726  E228\n",
      "\n",
      "[104 rows x 5 columns]\n",
      "first row of the selected chunck : \n",
      " [2048147490 28 '1398/06/23' 24461 'E228']\n",
      "104\n",
      "t0 = 24461\n",
      "ts = 29726\n",
      "time_intervals 9\n",
      "Origin destination interval view reindex \n",
      "    time_in  time_out\n",
      "0  24461.0   25061.0\n",
      "OD bus stations of transactions: \n",
      "            CardID LineCode       FDate   Time  plat Station\n",
      "0       542446139        1  1398/06/23  24030  A145    3169\n",
      "1      2620656172        1  1398/06/23  24302  A145    3169\n",
      "2      3446252780        1  1398/06/23  26200  A145    1227\n",
      "3         7900260        1  1398/06/23  29677  A145    3169\n",
      "4       361857972        1  1398/06/23  29720  A145    3169\n",
      "...           ...      ...         ...    ...   ...     ...\n",
      "57382   212463403       28  1398/06/23  60103   C37    2164\n",
      "57383  1844674164       28  1398/06/23  60105   C37    2164\n",
      "57384  3678631276       28  1398/06/23  60112   C37    2164\n",
      "57385  2048147490       28  1398/06/23  24461  E228    1898\n",
      "57386  3208675028       28  1398/06/23  24591  E228    1898\n",
      "\n",
      "[57387 rows x 6 columns]\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "transactions in line 28 plat F138\n",
      "ps: \n",
      "              CardID  LineCode       FDate   Time  plat\n",
      "85715    582472299        28  1398/06/23  22936  F138\n",
      "85719    722149077        28  1398/06/23  23123  F138\n",
      "94468    212155275        28  1398/06/23  23542  F138\n",
      "85723   3794868764        28  1398/06/23  23543  F138\n",
      "94471   4058519869        28  1398/06/23  23544  F138\n",
      "...            ...       ...         ...    ...   ...\n",
      "178475  2123919716        28  1398/06/23  76622  F138\n",
      "178601  4266443378        28  1398/06/23  76624  F138\n",
      "178477  2506425540        28  1398/06/23  76627  F138\n",
      "178603   174344692        28  1398/06/23  76990  F138\n",
      "178605  3151304910        28  1398/06/23  77091  F138\n",
      "\n",
      "[451 rows x 5 columns]\n",
      "first row of the selected chunck : \n",
      " [582472299 28 '1398/06/23' 22936 'F138']\n",
      "451\n",
      "t0 = 22936\n",
      "ts = 77091\n",
      "time_intervals 90\n",
      "Origin destination interval view reindex \n",
      "     time_in  time_out\n",
      "0   22936.0   23536.0\n",
      "1   25336.0   26536.0\n",
      "2   29536.0   30736.0\n",
      "3   37936.0   40936.0\n",
      "4   42736.0   47536.0\n",
      "5   51136.0   51736.0\n",
      "6   54736.0   55336.0\n",
      "7   57736.0   58336.0\n",
      "8   60136.0   60736.0\n",
      "9   61336.0   61936.0\n",
      "10  65536.0   66136.0\n",
      "11  73336.0   75136.0\n",
      "OD bus stations of transactions: \n",
      "            CardID LineCode       FDate   Time  plat Station\n",
      "0       542446139        1  1398/06/23  24030  A145    3169\n",
      "1      2620656172        1  1398/06/23  24302  A145    3169\n",
      "2      3446252780        1  1398/06/23  26200  A145    1227\n",
      "3         7900260        1  1398/06/23  29677  A145    3169\n",
      "4       361857972        1  1398/06/23  29720  A145    3169\n",
      "...           ...      ...         ...    ...   ...     ...\n",
      "57437  2590033700       28  1398/06/23  66087  F138    1898\n",
      "57438  3180675358       28  1398/06/23  66123  F138    1898\n",
      "57439   722235955       28  1398/06/23  74999  F138    2164\n",
      "57440   233570906       28  1398/06/23  75120  F138    2164\n",
      "57441   361544404       28  1398/06/23  75131  F138    2164\n",
      "\n",
      "[57442 rows x 6 columns]\n",
      "transactions in line 28 plat F139\n",
      "ps: \n",
      "              CardID  LineCode       FDate   Time  plat\n",
      "122429  3631418316        28  1398/06/23  21499  F139\n",
      "122428  3672453330        28  1398/06/23  21708  F139\n",
      "122433   176704118        28  1398/06/23  21861  F139\n",
      "122430  2854917806        28  1398/06/23  21914  F139\n",
      "122431  2541476110        28  1398/06/23  21916  F139\n",
      "...            ...       ...         ...    ...   ...\n",
      "122423  3791718684        28  1398/06/23  75626  F139\n",
      "122424  3791718684        28  1398/06/23  75628  F139\n",
      "122425  3791718684        28  1398/06/23  75629  F139\n",
      "122426  3791718684        28  1398/06/23  75631  F139\n",
      "122427  3791718684        28  1398/06/23  75634  F139\n",
      "\n",
      "[496 rows x 5 columns]\n",
      "first row of the selected chunck : \n",
      " [3631418316 28 '1398/06/23' 21499 'F139']\n",
      "496\n",
      "t0 = 21499\n",
      "ts = 75634\n",
      "time_intervals 90\n",
      "Origin destination interval view reindex \n",
      "     time_in  time_out\n",
      "0   21499.0   22099.0\n",
      "1   23899.0   25099.0\n",
      "2   30499.0   31699.0\n",
      "3   34699.0   35899.0\n",
      "4   39499.0   40699.0\n",
      "5   48499.0   49099.0\n",
      "6   50899.0   52099.0\n",
      "7   54499.0   55699.0\n",
      "8   61099.0   62899.0\n",
      "9   65899.0   67099.0\n",
      "10  70699.0   71299.0\n",
      "11  74899.0   75499.0\n",
      "OD bus stations of transactions: \n",
      "            CardID LineCode       FDate   Time  plat Station\n",
      "0       542446139        1  1398/06/23  24030  A145    3169\n",
      "1      2620656172        1  1398/06/23  24302  A145    3169\n",
      "2      3446252780        1  1398/06/23  26200  A145    1227\n",
      "3         7900260        1  1398/06/23  29677  A145    3169\n",
      "4       361857972        1  1398/06/23  29720  A145    3169\n",
      "...           ...      ...         ...    ...   ...     ...\n",
      "57718  3211777492       28  1398/06/23  55614  F139    2164\n",
      "57719   737100368       28  1398/06/23  62358  F139    1898\n",
      "57720   721772218       28  1398/06/23  66914  F139    2164\n",
      "57721   996794286       28  1398/06/23  71258  F139    1898\n",
      "57722  2740651092       28  1398/06/23  71264  F139    1898\n",
      "\n",
      "[57723 rows x 6 columns]\n",
      "transactions in line 28 plat F145\n",
      "ps: \n",
      "              CardID  LineCode       FDate   Time  plat\n",
      "534781  3256114301        28  1398/06/23  39838  F145\n",
      "534782  1845599044        28  1398/06/23  39931  F145\n",
      "534783  3792520588        28  1398/06/23  39953  F145\n",
      "534784  1611986821        28  1398/06/23  40102  F145\n",
      "534785   721749019        28  1398/06/23  40317  F145\n",
      "...            ...       ...         ...    ...   ...\n",
      "482098   361825188        28  1398/06/23  75074  F145\n",
      "482099   645951821        28  1398/06/23  75105  F145\n",
      "482100   982704987        28  1398/06/23  75119  F145\n",
      "482102   980592955        28  1398/06/23  75185  F145\n",
      "482101   211766187        28  1398/06/23  75316  F145\n",
      "\n",
      "[305 rows x 5 columns]\n",
      "first row of the selected chunck : \n",
      " [3256114301 28 '1398/06/23' 39838 'F145']\n",
      "305\n",
      "t0 = 39838\n",
      "ts = 75316\n",
      "time_intervals 59\n",
      "Origin destination interval view reindex \n",
      "    time_in  time_out\n",
      "0  39838.0   40438.0\n",
      "1  47038.0   47638.0\n",
      "2  48238.0   48838.0\n",
      "3  50638.0   53038.0\n",
      "4  54838.0   56038.0\n",
      "5  62638.0   63238.0\n",
      "6  66238.0   68038.0\n",
      "7  72838.0   73438.0\n",
      "8  74638.0   75238.0\n",
      "OD bus stations of transactions: \n",
      "            CardID LineCode       FDate   Time  plat Station\n",
      "0       542446139        1  1398/06/23  24030  A145    3169\n",
      "1      2620656172        1  1398/06/23  24302  A145    3169\n",
      "2      3446252780        1  1398/06/23  26200  A145    1227\n",
      "3         7900260        1  1398/06/23  29677  A145    3169\n",
      "4       361857972        1  1398/06/23  29720  A145    3169\n",
      "...           ...      ...         ...    ...   ...     ...\n",
      "58076   209824091       28  1398/06/23  74805  F145    1898\n",
      "58077   361825188       28  1398/06/23  75074  F145    1898\n",
      "58078   645951821       28  1398/06/23  75105  F145    1898\n",
      "58079   982704987       28  1398/06/23  75119  F145    1898\n",
      "58080   980592955       28  1398/06/23  75185  F145    1898\n",
      "\n",
      "[58081 rows x 6 columns]\n",
      "transactions in line 28 plat M190\n",
      "ps: \n",
      "              CardID  LineCode       FDate   Time  plat\n",
      "134879  3215093764        28  1398/06/23  27739  M190\n",
      "134880  2741772660        28  1398/06/23  28236  M190\n",
      "134881  3446787068        28  1398/06/23  28256  M190\n",
      "134882  2239157307        28  1398/06/23  28442  M190\n",
      "134942  4278758210        28  1398/06/23  28479  M190\n",
      "...            ...       ...         ...    ...   ...\n",
      "320372  3208494820        28  1398/06/23  74382  M190\n",
      "320371  3209936388        28  1398/06/23  74383  M190\n",
      "134876  3679994348        28  1398/06/23  75202  M190\n",
      "134877  3679994348        28  1398/06/23  75205  M190\n",
      "134878  3679994348        28  1398/06/23  75207  M190\n",
      "\n",
      "[402 rows x 5 columns]\n",
      "first row of the selected chunck : \n",
      " [3215093764 28 '1398/06/23' 27739 'M190']\n",
      "402\n",
      "t0 = 27739\n",
      "ts = 75207\n",
      "time_intervals 79\n",
      "Origin destination interval view reindex \n",
      "    time_in  time_out\n",
      "0  27739.0   28339.0\n",
      "1  31939.0   33739.0\n",
      "2  36139.0   37339.0\n",
      "3  41539.0   42139.0\n",
      "4  44539.0   45139.0\n",
      "5  45739.0   46339.0\n",
      "6  49339.0   50539.0\n",
      "7  53539.0   61339.0\n",
      "8  64939.0   66739.0\n",
      "9  70339.0   70939.0\n",
      "OD bus stations of transactions: \n",
      "            CardID LineCode       FDate   Time  plat Station\n",
      "0       542446139        1  1398/06/23  24030  A145    3169\n",
      "1      2620656172        1  1398/06/23  24302  A145    3169\n",
      "2      3446252780        1  1398/06/23  26200  A145    1227\n",
      "3         7900260        1  1398/06/23  29677  A145    3169\n",
      "4       361857972        1  1398/06/23  29720  A145    3169\n",
      "...           ...      ...         ...    ...   ...     ...\n",
      "58306  3679655260       28  1398/06/23  50529  M190    1898\n",
      "58307  3179507342       28  1398/06/23  61212  M190    2164\n",
      "58308   645438013       28  1398/06/23  61220  M190    2164\n",
      "58309  2502055940       28  1398/06/23  66445  M190    1898\n",
      "58310  3258140605       28  1398/06/23  70412  M190    2164\n",
      "\n",
      "[58311 rows x 6 columns]\n",
      "transactions in line 28 plat M211\n",
      "ps: \n",
      "             CardID  LineCode       FDate   Time  plat\n",
      "83612   721905741        28  1398/06/23  23495  M211\n",
      "83618  3405953857        28  1398/06/23  24012  M211\n",
      "83614  3254187309        28  1398/06/23  24118  M211\n",
      "83621  3632010604        28  1398/06/23  24224  M211\n",
      "83626  3630655788        28  1398/06/23  24397  M211\n",
      "...           ...       ...         ...    ...   ...\n",
      "24924  3678543420        28  1398/06/23  77143  M211\n",
      "24926  3678543420        28  1398/06/23  77146  M211\n",
      "24928  3678543420        28  1398/06/23  77148  M211\n",
      "83416  3678543420        28  1398/06/23  77152  M211\n",
      "83419  3678543420        28  1398/06/23  77158  M211\n",
      "\n",
      "[673 rows x 5 columns]\n",
      "first row of the selected chunck : \n",
      " [721905741 28 '1398/06/23' 23495 'M211']\n",
      "673\n",
      "t0 = 23495\n",
      "ts = 77158\n",
      "time_intervals 89\n",
      "Origin destination interval view reindex \n",
      "    time_in  time_out\n",
      "0  23495.0   24095.0\n",
      "1  26495.0   27095.0\n",
      "2  30095.0   31295.0\n",
      "3  34895.0   35495.0\n",
      "4  48095.0   48695.0\n",
      "5  51095.0   51695.0\n",
      "6  68495.0   69095.0\n",
      "7  72695.0   74495.0\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "OD bus stations of transactions: \n",
      "            CardID LineCode       FDate   Time  plat Station\n",
      "0       542446139        1  1398/06/23  24030  A145    3169\n",
      "1      2620656172        1  1398/06/23  24302  A145    3169\n",
      "2      3446252780        1  1398/06/23  26200  A145    1227\n",
      "3         7900260        1  1398/06/23  29677  A145    3169\n",
      "4       361857972        1  1398/06/23  29720  A145    3169\n",
      "...           ...      ...         ...    ...   ...     ...\n",
      "58536  3201518532       28  1398/06/23  74262  M211    2164\n",
      "58537   996495582       28  1398/06/23  74342  M211    2164\n",
      "58538   638452283       28  1398/06/23  74348  M211    2164\n",
      "58539   638452283       28  1398/06/23  74349  M211    2164\n",
      "58540   638452283       28  1398/06/23  74351  M211    2164\n",
      "\n",
      "[58541 rows x 6 columns]\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "C:\\Users\\esmaeli.h\\AppData\\Local\\Temp/ipykernel_12452/1949912630.py:257: ConvergenceWarning: Number of distinct clusters (36) found smaller than n_clusters (37). Possibly due to duplicate points in X.\n",
      "  kmeans = KMeans(n_clusters=len(filter_go_stations)-1,random_state=0).fit(partial_times.to_numpy())\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "transactions in line 28 plat N125\n",
      "ps: \n",
      "              CardID  LineCode       FDate   Time  plat\n",
      "574679   721941948        28  1398/06/23  48247  N125\n",
      "574681   721941948        28  1398/06/23  48248  N125\n",
      "194241  1835678893        28  1398/06/23  48250  N125\n",
      "194238  3180177742        28  1398/06/23  48262  N125\n",
      "194244  2741630484        28  1398/06/23  48325  N125\n",
      "...            ...       ...         ...    ...   ...\n",
      "574639  3603959020        28  1398/06/23  74128  N125\n",
      "574640  3603959020        28  1398/06/23  74129  N125\n",
      "574641  3603959020        28  1398/06/23  74131  N125\n",
      "574642  3603959020        28  1398/06/23  74133  N125\n",
      "574644  3603959020        28  1398/06/23  74140  N125\n",
      "\n",
      "[165 rows x 5 columns]\n",
      "first row of the selected chunck : \n",
      " [721941948 28 '1398/06/23' 48247 'N125']\n",
      "165\n",
      "t0 = 48247\n",
      "ts = 74140\n",
      "time_intervals 43\n",
      "Origin destination interval view reindex \n",
      "    time_in  time_out\n",
      "0  48247.0   48847.0\n",
      "1  50047.0   59647.0\n",
      "2  62647.0   63847.0\n",
      "3  67447.0   68047.0\n",
      "4  68647.0   71047.0\n",
      "5  72247.0   72847.0\n",
      "OD bus stations of transactions: \n",
      "            CardID LineCode       FDate   Time  plat Station\n",
      "0       542446139        1  1398/06/23  24030  A145    3169\n",
      "1      2620656172        1  1398/06/23  24302  A145    3169\n",
      "2      3446252780        1  1398/06/23  26200  A145    1227\n",
      "3         7900260        1  1398/06/23  29677  A145    3169\n",
      "4       361857972        1  1398/06/23  29720  A145    3169\n",
      "...           ...      ...         ...    ...   ...     ...\n",
      "59142  2589975860       28  1398/06/23  72494  N125    2164\n",
      "59143   209281531       28  1398/06/23  72513  N125    2164\n",
      "59144   209281531       28  1398/06/23  72514  N125    2164\n",
      "59145  3558853089       28  1398/06/23  72600  N125    2164\n",
      "59146   344165801       28  1398/06/23  72689  N125    2164\n",
      "\n",
      "[59147 rows x 6 columns]\n",
      "transactions in line 28 plat N161\n",
      "ps: \n",
      "              CardID  LineCode       FDate   Time  plat\n",
      "331952   340861865        28  1398/06/23  22284  N161\n",
      "332222  2742763284        28  1398/06/23  22688  N161\n",
      "332225  2742353028        28  1398/06/23  22694  N161\n",
      "332223  2742959236        28  1398/06/23  22849  N161\n",
      "332224  4269821650        28  1398/06/23  22851  N161\n",
      "...            ...       ...         ...    ...   ...\n",
      "611462   721943981        28  1398/06/23  75116  N161\n",
      "611463   869390724        28  1398/06/23  75335  N161\n",
      "611464  2499650580        28  1398/06/23  75864  N161\n",
      "400324  3791732988        28  1398/06/23  76533  N161\n",
      "400325  3791732988        28  1398/06/23  76535  N161\n",
      "\n",
      "[560 rows x 5 columns]\n",
      "first row of the selected chunck : \n",
      " [340861865 28 '1398/06/23' 22284 'N161']\n",
      "560\n",
      "t0 = 22284\n",
      "ts = 76535\n",
      "time_intervals 90\n",
      "Origin destination interval view reindex \n",
      "     time_in  time_out\n",
      "0   22284.0   22884.0\n",
      "1   24084.0   25284.0\n",
      "2   27684.0   29484.0\n",
      "3   33084.0   33684.0\n",
      "4   36684.0   37884.0\n",
      "5   41484.0   42684.0\n",
      "6   46284.0   46884.0\n",
      "7   49884.0   51084.0\n",
      "8   52884.0   53484.0\n",
      "9   56484.0   57684.0\n",
      "10  63084.0   63684.0\n",
      "11  64284.0   64884.0\n",
      "12  73284.0   73884.0\n",
      "OD bus stations of transactions: \n",
      "            CardID LineCode       FDate   Time  plat Station\n",
      "0       542446139        1  1398/06/23  24030  A145    3169\n",
      "1      2620656172        1  1398/06/23  24302  A145    3169\n",
      "2      3446252780        1  1398/06/23  26200  A145    1227\n",
      "3         7900260        1  1398/06/23  29677  A145    3169\n",
      "4       361857972        1  1398/06/23  29720  A145    3169\n",
      "...           ...      ...         ...    ...   ...     ...\n",
      "59279   344362708       28  1398/06/23  64843  N161    2164\n",
      "59280  3405791201       28  1398/06/23  64844  N161    2164\n",
      "59281  1831957117       28  1398/06/23  73580  N161    1898\n",
      "59282  2117611332       28  1398/06/23  73580  N161    1898\n",
      "59283  2228965971       28  1398/06/23  73583  N161    1898\n",
      "\n",
      "[59284 rows x 6 columns]\n",
      "transactions in line 28 plat N169\n",
      "ps: \n",
      "              CardID  LineCode       FDate   Time  plat\n",
      "124839   298822235        28  1398/06/23  22227  N169\n",
      "124844  2047944082        28  1398/06/23  22687  N169\n",
      "124847  2047944082        28  1398/06/23  22689  N169\n",
      "194683   980449659        28  1398/06/23  25188  N169\n",
      "194686  3104957813        28  1398/06/23  25377  N169\n",
      "...            ...       ...         ...    ...   ...\n",
      "261264   996794286        28  1398/06/23  76854  N169\n",
      "124826  3791718620        28  1398/06/23  79561  N169\n",
      "124829  3791718620        28  1398/06/23  79563  N169\n",
      "124831  3791718620        28  1398/06/23  79566  N169\n",
      "124835  3791718620        28  1398/06/23  79839  N169\n",
      "\n",
      "[595 rows x 5 columns]\n",
      "first row of the selected chunck : \n",
      " [298822235 28 '1398/06/23' 22227 'N169']\n",
      "595\n",
      "t0 = 22227\n",
      "ts = 79839\n",
      "time_intervals 96\n",
      "Origin destination interval view reindex \n",
      "     time_in  time_out\n",
      "0   22227.0   22827.0\n",
      "1   23427.0   25227.0\n",
      "2   28227.0   28827.0\n",
      "3   30627.0   31227.0\n",
      "4   31827.0   32427.0\n",
      "5   35427.0   36627.0\n",
      "6   40227.0   42027.0\n",
      "7   53427.0   54027.0\n",
      "8   60027.0   60627.0\n",
      "9   68427.0   69027.0\n",
      "10  70227.0   70827.0\n",
      "11  73827.0   75027.0\n",
      "12  78027.0   79827.0\n",
      "OD bus stations of transactions: \n",
      "            CardID LineCode       FDate   Time  plat Station\n",
      "0       542446139        1  1398/06/23  24030  A145    3169\n",
      "1      2620656172        1  1398/06/23  24302  A145    3169\n",
      "2      3446252780        1  1398/06/23  26200  A145    1227\n",
      "3         7900260        1  1398/06/23  29677  A145    3169\n",
      "4       361857972        1  1398/06/23  29720  A145    3169\n",
      "...           ...      ...         ...    ...   ...     ...\n",
      "59625  3256317069       28  1398/06/23  74499  N169    2164\n",
      "59626  3256317069       28  1398/06/23  74500  N169    2164\n",
      "59627  3791718620       28  1398/06/23  79561  N169    1898\n",
      "59628  3791718620       28  1398/06/23  79563  N169    1898\n",
      "59629  3791718620       28  1398/06/23  79566  N169    1898\n",
      "\n",
      "[59630 rows x 6 columns]\n",
      "transactions in line 28 plat N75\n",
      "ps: \n",
      "              CardID  LineCode       FDate   Time plat\n",
      "420050  1155946004        28  1398/06/23   2236  N75\n",
      "131922  3151180622        28  1398/06/23  36479  N75\n",
      "131927   211930124        28  1398/06/23  36482  N75\n",
      "131930  3547388068        28  1398/06/23  36484  N75\n",
      "131934  2239186949        28  1398/06/23  36488  N75\n",
      "...            ...       ...         ...    ...  ...\n",
      "418133   211304684        28  1398/06/23  73794  N75\n",
      "131649  3679968812        28  1398/06/23  76447  N75\n",
      "131651  3679968812        28  1398/06/23  76450  N75\n",
      "131654  3679968812        28  1398/06/23  76455  N75\n",
      "131662    77054136        28  1398/06/23  86399  N75\n",
      "\n",
      "[165 rows x 5 columns]\n",
      "first row of the selected chunck : \n",
      " [1155946004 28 '1398/06/23' 2236 'N75']\n",
      "165\n",
      "t0 = 2236\n",
      "ts = 86399\n",
      "time_intervals 140\n",
      "Origin destination interval view reindex \n",
      "    time_in  time_out\n",
      "0   2236.0   37036.0\n",
      "1  39436.0   41236.0\n",
      "2  44236.0   45436.0\n",
      "3  51436.0   65836.0\n",
      "4  69436.0   72436.0\n",
      "5  73636.0   74236.0\n",
      "6  74836.0   76636.0\n",
      "7  77236.0   86236.0\n",
      "OD bus stations of transactions: \n",
      "            CardID LineCode       FDate   Time  plat Station\n",
      "0       542446139        1  1398/06/23  24030  A145    3169\n",
      "1      2620656172        1  1398/06/23  24302  A145    3169\n",
      "2      3446252780        1  1398/06/23  26200  A145    1227\n",
      "3         7900260        1  1398/06/23  29677  A145    3169\n",
      "4       361857972        1  1398/06/23  29720  A145    3169\n",
      "...           ...      ...         ...    ...   ...     ...\n",
      "60121  3405921552       28  1398/06/23  73792   N75    2164\n",
      "60122   211304684       28  1398/06/23  73794   N75    2164\n",
      "60123  3679968812       28  1398/06/23  76447   N75    1898\n",
      "60124  3679968812       28  1398/06/23  76450   N75    1898\n",
      "60125  3679968812       28  1398/06/23  76455   N75    1898\n",
      "\n",
      "[60126 rows x 6 columns]\n",
      "stations in a specefic bus line 29\n",
      "len-of-go stations: 27\n",
      "len-of-back stations: 30\n",
      "len-of-go back stations: 0\n",
      "first Station  [2524 '29' '1' 'go' '????? ???????-641-90-83-64' 51.697626 32.640424 'od'\n",
      " 'normal' 'no'] 2524\n",
      "last Station  [1996 '29' '1' 'back' '????? ???? ????? ??' 51.758934 32.655208 'normal'\n",
      " 'normal' 'no']\n",
      "['A29' 'B17' 'B55' 'B78' 'C12' 'C49' 'E15' 'E170' 'E62' 'F92' 'M134'\n",
      " 'M139' 'M140' 'M209' 'M37' 'M58' 'M76' 'N162']\n",
      "transactions in line 29 plat A29\n",
      "ps: \n",
      "              CardID  LineCode       FDate   Time plat\n",
      "288936  1361121877        29  1398/06/23  40380  A29\n",
      "288938  3153322686        29  1398/06/23  40389  A29\n",
      "288941  2481804148        29  1398/06/23  40490  A29\n",
      "288943  2481804148        29  1398/06/23  40500  A29\n",
      "288947  2500210244        29  1398/06/23  40507  A29\n",
      "288951  1000863886        29  1398/06/23  40529  A29\n",
      "288954   537940158        29  1398/06/23  40536  A29\n",
      "288957  3108708229        29  1398/06/23  40563  A29\n",
      "288961   721931262        29  1398/06/23  40801  A29\n",
      "289721   722232199        29  1398/06/23  40924  A29\n",
      "289726  1836077533        29  1398/06/23  40924  A29\n",
      "288966  3630381180        29  1398/06/23  40957  A29\n",
      "288970   645942493        29  1398/06/23  41128  A29\n",
      "289744  2741414196        29  1398/06/23  41166  A29\n",
      "289748  2741414196        29  1398/06/23  41167  A29\n",
      "289729  2742469716        29  1398/06/23  41201  A29\n",
      "289733  2742469716        29  1398/06/23  41204  A29\n",
      "289737  2742469716        29  1398/06/23  41207  A29\n",
      "289740   427144478        29  1398/06/23  41209  A29\n",
      "289752   176324566        29  1398/06/23  41282  A29\n",
      "289755   261115841        29  1398/06/23  41282  A29\n",
      "289761   300337259        29  1398/06/23  41580  A29\n",
      "289762  1835866925        29  1398/06/23  41850  A29\n",
      "289765   429914574        29  1398/06/23  42380  A29\n",
      "289768  3629830220        29  1398/06/23  42480  A29\n",
      "289770   426460142        29  1398/06/23  42645  A29\n",
      "100324   428600430        29  1398/06/23  42723  A29\n",
      "100328   981605307        29  1398/06/23  42723  A29\n",
      "100331  3405962658        29  1398/06/23  42723  A29\n",
      "100335   722048419        29  1398/06/23  42723  A29\n",
      "100338  3206043684        29  1398/06/23  42723  A29\n",
      "289771  2123509908        29  1398/06/23  42724  A29\n",
      "289774  2234052579        29  1398/06/23  42729  A29\n",
      "288933     9682711        29  1398/06/23  42805  A29\n",
      "100341  2123548724        29  1398/06/23  42843  A29\n",
      "first row of the selected chunck : \n",
      " [1361121877 29 '1398/06/23' 40380 'A29']\n",
      "35\n",
      "t0 = 40380\n",
      "ts = 42843\n",
      "time_intervals 4\n",
      "Origin destination interval view reindex \n",
      "    time_in  time_out\n",
      "0  40380.0   40980.0\n",
      "OD bus stations of transactions: \n",
      "            CardID LineCode       FDate   Time  plat Station\n",
      "0       542446139        1  1398/06/23  24030  A145    3169\n",
      "1      2620656172        1  1398/06/23  24302  A145    3169\n",
      "2      3446252780        1  1398/06/23  26200  A145    1227\n",
      "3         7900260        1  1398/06/23  29677  A145    3169\n",
      "4       361857972        1  1398/06/23  29720  A145    3169\n",
      "...           ...      ...         ...    ...   ...     ...\n",
      "60188  3108708229       29  1398/06/23  40563   A29    2524\n",
      "60189   721931262       29  1398/06/23  40801   A29    2524\n",
      "60190   722232199       29  1398/06/23  40924   A29    2524\n",
      "60191  1836077533       29  1398/06/23  40924   A29    2524\n",
      "60192  3630381180       29  1398/06/23  40957   A29    2524\n",
      "\n",
      "[60193 rows x 6 columns]\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "transactions in line 29 plat B17\n",
      "ps: \n",
      "              CardID  LineCode       FDate   Time plat\n",
      "316021  3679101228        29  1398/06/23  23569  B17\n",
      "316022   721785382        29  1398/06/23  23919  B17\n",
      "316023  2681772270        29  1398/06/23  23925  B17\n",
      "316024  2742071524        29  1398/06/23  23930  B17\n",
      "316025  1764991492        29  1398/06/23  23936  B17\n",
      "...            ...       ...         ...    ...  ...\n",
      "68483   3603672172        29  1398/06/23  72028  B17\n",
      "73328    722133262        29  1398/06/23  72261  B17\n",
      "316018   696240312        29  1398/06/23  72349  B17\n",
      "316019   696240312        29  1398/06/23  72351  B17\n",
      "316020   696240312        29  1398/06/23  72361  B17\n",
      "\n",
      "[291 rows x 5 columns]\n",
      "first row of the selected chunck : \n",
      " [3679101228 29 '1398/06/23' 23569 'B17']\n",
      "291\n",
      "t0 = 23569\n",
      "ts = 72361\n",
      "time_intervals 81\n",
      "Origin destination interval view reindex \n",
      "     time_in  time_out\n",
      "0   23569.0   24169.0\n",
      "1   24769.0   25369.0\n",
      "2   25969.0   26569.0\n",
      "3   28369.0   30169.0\n",
      "4   36169.0   37369.0\n",
      "5   39169.0   40369.0\n",
      "6   43369.0   43969.0\n",
      "7   46969.0   48769.0\n",
      "8   50569.0   51169.0\n",
      "9   52369.0   52969.0\n",
      "10  54169.0   54769.0\n",
      "11  55369.0   55969.0\n",
      "12  59569.0   60169.0\n",
      "13  60769.0   61969.0\n",
      "14  63769.0   64969.0\n",
      "15  67369.0   67969.0\n",
      "16  69769.0   70969.0\n",
      "OD bus stations of transactions: \n",
      "            CardID LineCode       FDate   Time  plat Station\n",
      "0       542446139        1  1398/06/23  24030  A145    3169\n",
      "1      2620656172        1  1398/06/23  24302  A145    3169\n",
      "2      3446252780        1  1398/06/23  26200  A145    1227\n",
      "3         7900260        1  1398/06/23  29677  A145    3169\n",
      "4       361857972        1  1398/06/23  29720  A145    3169\n",
      "...           ...      ...         ...    ...   ...     ...\n",
      "60280  2239181009       29  1398/06/23  70715   B17    2524\n",
      "60281  2190239571       29  1398/06/23  70858   B17    2524\n",
      "60282  2190239571       29  1398/06/23  70860   B17    2524\n",
      "60283   175685190       29  1398/06/23  70861   B17    2524\n",
      "60284   722189968       29  1398/06/23  70932   B17    2524\n",
      "\n",
      "[60285 rows x 6 columns]\n",
      "transactions in line 29 plat B55\n",
      "ps: \n",
      "              CardID  LineCode       FDate   Time plat\n",
      "141338   176883574        29  1398/06/23  24614  B55\n",
      "141343   174997894        29  1398/06/23  25352  B55\n",
      "242774   869426132        29  1398/06/23  25440  B55\n",
      "242778  3553278668        29  1398/06/23  25445  B55\n",
      "242781  3677727708        29  1398/06/23  25620  B55\n",
      "...            ...       ...         ...    ...  ...\n",
      "49562   4276190834        29  1398/06/23  76586  B55\n",
      "49566   2049968818        29  1398/06/23  76622  B55\n",
      "49576   1845277844        29  1398/06/23  76827  B55\n",
      "49578   1528662094        29  1398/06/23  76845  B55\n",
      "49582   2048260626        29  1398/06/23  76995  B55\n",
      "\n",
      "[213 rows x 5 columns]\n",
      "first row of the selected chunck : \n",
      " [176883574 29 '1398/06/23' 24614 'B55']\n",
      "213\n",
      "t0 = 24614\n",
      "ts = 76995\n",
      "time_intervals 87\n",
      "Origin destination interval view reindex \n",
      "     time_in  time_out\n",
      "0   24614.0   25814.0\n",
      "1   27014.0   27614.0\n",
      "2   30014.0   31214.0\n",
      "3   37214.0   37814.0\n",
      "4   38414.0   48614.0\n",
      "5   52214.0   53414.0\n",
      "6   55814.0   57014.0\n",
      "7   58814.0   61214.0\n",
      "8   61814.0   62414.0\n",
      "9   63614.0   64814.0\n",
      "10  67214.0   67814.0\n",
      "11  68414.0   69014.0\n",
      "12  69614.0   74414.0\n",
      "13  75014.0   76214.0\n",
      "OD bus stations of transactions: \n",
      "            CardID LineCode       FDate   Time  plat Station\n",
      "0       542446139        1  1398/06/23  24030  A145    3169\n",
      "1      2620656172        1  1398/06/23  24302  A145    3169\n",
      "2      3446252780        1  1398/06/23  26200  A145    1227\n",
      "3         7900260        1  1398/06/23  29677  A145    3169\n",
      "4       361857972        1  1398/06/23  29720  A145    3169\n",
      "...           ...      ...         ...    ...   ...     ...\n",
      "60391   869434807       29  1398/06/23  75817   B55    1996\n",
      "60392  3553700716       29  1398/06/23  75917   B55    1996\n",
      "60393  2125974708       29  1398/06/23  76165   B55    1996\n",
      "60394  2125974708       29  1398/06/23  76167   B55    1996\n",
      "60395  2125974708       29  1398/06/23  76173   B55    1996\n",
      "\n",
      "[60396 rows x 6 columns]\n",
      "transactions in line 29 plat B78\n",
      "ps: \n",
      "              CardID  LineCode       FDate   Time plat\n",
      "217504  2118290644        29  1398/06/23  71856  B78\n",
      "217505  1407177603        29  1398/06/23  72039  B78\n",
      "217507  1407177603        29  1398/06/23  72040  B78\n",
      "217508  1594641124        29  1398/06/23  72126  B78\n",
      "217509  2184550595        29  1398/06/23  72133  B78\n",
      "217510   869442828        29  1398/06/23  72138  B78\n",
      "217511  1531199998        29  1398/06/23  72169  B78\n",
      "217512   262011889        29  1398/06/23  72521  B78\n",
      "217513  4275279090        29  1398/06/23  72567  B78\n",
      "217514  2044498350        29  1398/06/23  72650  B78\n",
      "217515   429217774        29  1398/06/23  72801  B78\n",
      "217516   428324654        29  1398/06/23  73442  B78\n",
      "6001      15941703        29  1398/06/23  73700  B78\n",
      "first row of the selected chunck : \n",
      " [2118290644 29 '1398/06/23' 71856 'B78']\n",
      "13\n",
      "t0 = 71856\n",
      "ts = 73700\n",
      "time_intervals 3\n",
      "Origin destination interval view reindex \n",
      "    time_in  time_out\n",
      "0  71856.0   72456.0\n",
      "OD bus stations of transactions: \n",
      "            CardID LineCode       FDate   Time  plat Station\n",
      "0       542446139        1  1398/06/23  24030  A145    3169\n",
      "1      2620656172        1  1398/06/23  24302  A145    3169\n",
      "2      3446252780        1  1398/06/23  26200  A145    1227\n",
      "3         7900260        1  1398/06/23  29677  A145    3169\n",
      "4       361857972        1  1398/06/23  29720  A145    3169\n",
      "...           ...      ...         ...    ...   ...     ...\n",
      "60498  1407177603       29  1398/06/23  72040   B78    2524\n",
      "60499  1594641124       29  1398/06/23  72126   B78    2524\n",
      "60500  2184550595       29  1398/06/23  72133   B78    2524\n",
      "60501   869442828       29  1398/06/23  72138   B78    2524\n",
      "60502  1531199998       29  1398/06/23  72169   B78    2524\n",
      "\n",
      "[60503 rows x 6 columns]\n",
      "transactions in line 29 plat C12\n",
      "ps: \n",
      "               CardID  LineCode       FDate   Time plat\n",
      "2061009   721785286        29  1398/06/23  21750  C12\n",
      "2061012  3210114004        29  1398/06/23  21817  C12\n",
      "2061015  2740573204        29  1398/06/23  24794  C12\n",
      "2061019   386721114        29  1398/06/23  24800  C12\n",
      "1834122  4276235810        29  1398/06/23  24987  C12\n",
      "...             ...       ...         ...    ...  ...\n",
      "2715492  1845122308        29  1398/06/23  73182  C12\n",
      "2715496   721955009        29  1398/06/23  73240  C12\n",
      "2715487  3180269694        29  1398/06/23  73294  C12\n",
      "2715499  2045026974        29  1398/06/23  75014  C12\n",
      "2715502  1613527349        29  1398/06/23  75434  C12\n",
      "\n",
      "[257 rows x 5 columns]\n",
      "first row of the selected chunck : \n",
      " [721785286 29 '1398/06/23' 21750 'C12']\n",
      "257\n",
      "t0 = 21750\n",
      "ts = 75434\n",
      "time_intervals 89\n",
      "Origin destination interval view reindex \n",
      "     time_in  time_out\n",
      "0   21750.0   22350.0\n",
      "1   22950.0   25350.0\n",
      "2   25950.0   26550.0\n",
      "3   27150.0   27750.0\n",
      "4   30750.0   37350.0\n",
      "5   40350.0   40950.0\n",
      "6   45150.0   45750.0\n",
      "7   49350.0   50550.0\n",
      "8   51750.0   52350.0\n",
      "9   54150.0   54750.0\n",
      "10  57750.0   58950.0\n",
      "11  60150.0   60750.0\n",
      "12  63150.0   63750.0\n",
      "13  69150.0   70350.0\n",
      "14  70950.0   71550.0\n",
      "15  72750.0   73350.0\n",
      "16  73950.0   75150.0\n",
      "OD bus stations of transactions: \n",
      "            CardID LineCode       FDate   Time  plat Station\n",
      "0       542446139        1  1398/06/23  24030  A145    3169\n",
      "1      2620656172        1  1398/06/23  24302  A145    3169\n",
      "2      3446252780        1  1398/06/23  26200  A145    1227\n",
      "3         7900260        1  1398/06/23  29677  A145    3169\n",
      "4       361857972        1  1398/06/23  29720  A145    3169\n",
      "...           ...      ...         ...    ...   ...     ...\n",
      "60554  1845122308       29  1398/06/23  73181   C12    1996\n",
      "60555  1845122308       29  1398/06/23  73182   C12    1996\n",
      "60556   721955009       29  1398/06/23  73240   C12    1996\n",
      "60557  3180269694       29  1398/06/23  73294   C12    1996\n",
      "60558  2045026974       29  1398/06/23  75014   C12    2524\n",
      "\n",
      "[60559 rows x 6 columns]\n",
      "transactions in line 29 plat C49\n",
      "ps: \n",
      "              CardID  LineCode       FDate   Time plat\n",
      "84391    869230608        29  1398/06/23  24724  C49\n",
      "84395   2680426462        29  1398/06/23  24806  C49\n",
      "84400    725557975        29  1398/06/23  25364  C49\n",
      "84404   4244971111        29  1398/06/23  25427  C49\n",
      "84409    344544020        29  1398/06/23  25772  C49\n",
      "...            ...       ...         ...    ...  ...\n",
      "275260  2117892340        29  1398/06/23  74800  C49\n",
      "275254   262594977        29  1398/06/23  74858  C49\n",
      "275262  2239131364        29  1398/06/23  74877  C49\n",
      "178425  2239131364        29  1398/06/23  74878  C49\n",
      "178429  3603938108        29  1398/06/23  75299  C49\n",
      "\n",
      "[64 rows x 5 columns]\n",
      "first row of the selected chunck : \n",
      " [869230608 29 '1398/06/23' 24724 'C49']\n",
      "64\n",
      "t0 = 24724\n",
      "ts = 75299\n",
      "time_intervals 84\n",
      "Origin destination interval view reindex \n",
      "    time_in  time_out\n",
      "0  24724.0   25324.0\n",
      "1  27124.0   28324.0\n",
      "2  30724.0   31324.0\n",
      "3  33124.0   69124.0\n",
      "4  71524.0   72724.0\n",
      "5  73324.0   73924.0\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "OD bus stations of transactions: \n",
      "            CardID LineCode       FDate   Time  plat Station\n",
      "0       542446139        1  1398/06/23  24030  A145    3169\n",
      "1      2620656172        1  1398/06/23  24302  A145    3169\n",
      "2      3446252780        1  1398/06/23  26200  A145    1227\n",
      "3         7900260        1  1398/06/23  29677  A145    3169\n",
      "4       361857972        1  1398/06/23  29720  A145    3169\n",
      "...           ...      ...         ...    ...   ...     ...\n",
      "60659  2681772270       29  1398/06/23  72537   C49    2524\n",
      "60660  1611502139       29  1398/06/23  72583   C49    2524\n",
      "60661  1611502139       29  1398/06/23  72584   C49    2524\n",
      "60662  4278756482       29  1398/06/23  73347   C49    1996\n",
      "60663  2742391156       29  1398/06/23  73349   C49    1996\n",
      "\n",
      "[60664 rows x 6 columns]\n",
      "transactions in line 29 plat E15\n",
      "ps: \n",
      "              CardID  LineCode       FDate   Time plat\n",
      "394444  2587008788        29  1398/06/23  24349  E15\n",
      "394445   235951658        29  1398/06/23  24358  E15\n",
      "394446   722062220        29  1398/06/23  24468  E15\n",
      "394447  4268593506        29  1398/06/23  24787  E15\n",
      "394679  2239116546        29  1398/06/23  24949  E15\n",
      "...            ...       ...         ...    ...  ...\n",
      "394731  1001037854        29  1398/06/23  33030  E15\n",
      "394732   426608254        29  1398/06/23  33368  E15\n",
      "394733  1000720110        29  1398/06/23  33509  E15\n",
      "395128  3152000190        29  1398/06/23  33528  E15\n",
      "395129  1611029931        29  1398/06/23  33569  E15\n",
      "\n",
      "[66 rows x 5 columns]\n",
      "first row of the selected chunck : \n",
      " [2587008788 29 '1398/06/23' 24349 'E15']\n",
      "66\n",
      "t0 = 24349\n",
      "ts = 33569\n",
      "time_intervals 15\n",
      "Origin destination interval view reindex \n",
      "    time_in  time_out\n",
      "0  24349.0   24949.0\n",
      "1  26749.0   27349.0\n",
      "2  29749.0   30949.0\n",
      "OD bus stations of transactions: \n",
      "            CardID LineCode       FDate   Time  plat Station\n",
      "0       542446139        1  1398/06/23  24030  A145    3169\n",
      "1      2620656172        1  1398/06/23  24302  A145    3169\n",
      "2      3446252780        1  1398/06/23  26200  A145    1227\n",
      "3         7900260        1  1398/06/23  29677  A145    3169\n",
      "4       361857972        1  1398/06/23  29720  A145    3169\n",
      "...           ...      ...         ...    ...   ...     ...\n",
      "60675  1003481559       29  1398/06/23  27222   E15    1996\n",
      "60676  3258128061       29  1398/06/23  30417   E15    2524\n",
      "60677  3330533205       29  1398/06/23  30442   E15    2524\n",
      "60678  3330533205       29  1398/06/23  30445   E15    2524\n",
      "60679   721892605       29  1398/06/23  30897   E15    2524\n",
      "\n",
      "[60680 rows x 6 columns]\n",
      "transactions in line 29 plat E170\n",
      "ps: \n",
      "              CardID  LineCode       FDate   Time  plat\n",
      "291230  4279332434        29  1398/06/23  21555  E170\n",
      "291231  1282195294        29  1398/06/23  21556  E170\n",
      "291232   645669629        29  1398/06/23  21835  E170\n",
      "291233   181715764        29  1398/06/23  21933  E170\n",
      "291236   722050147        29  1398/06/23  21934  E170\n",
      "291234  2123509156        29  1398/06/23  21946  E170\n",
      "291235  2123509156        29  1398/06/23  21947  E170\n",
      "291237  3996994932        29  1398/06/23  22089  E170\n",
      "291238  1000721726        29  1398/06/23  22201  E170\n",
      "291239   869434807        29  1398/06/23  22206  E170\n",
      "291240   262044097        29  1398/06/23  22208  E170\n",
      "291241  2048019426        29  1398/06/23  22409  E170\n",
      "291242   721723218        29  1398/06/23  22409  E170\n",
      "291243  3631073804        29  1398/06/23  22413  E170\n",
      "291244   179842870        29  1398/06/23  22829  E170\n",
      "97902    261284737        29  1398/06/23  62959  E170\n",
      "97900   3679797132        29  1398/06/23  62999  E170\n",
      "97904   2123744436        29  1398/06/23  63263  E170\n",
      "97907    721935761        29  1398/06/23  63656  E170\n",
      "97906   1213587230        29  1398/06/23  63661  E170\n",
      "97910   3678246572        29  1398/06/23  63810  E170\n",
      "97911   1003291687        29  1398/06/23  63835  E170\n",
      "97915   3677689228        29  1398/06/23  63836  E170\n",
      "97914   2138912925        29  1398/06/23  63916  E170\n",
      "97918   2138912925        29  1398/06/23  63928  E170\n",
      "97919    725400999        29  1398/06/23  65723  E170\n",
      "97920    725400999        29  1398/06/23  65731  E170\n",
      "97924   1835443485        29  1398/06/23  65963  E170\n",
      "97921   3649064836        29  1398/06/23  66050  E170\n",
      "97922   3405851609        29  1398/06/23  66150  E170\n",
      "97926   2482047764        29  1398/06/23  66189  E170\n",
      "164430  3206558837        29  1398/06/23  66237  E170\n",
      "164431  2239160649        29  1398/06/23  66312  E170\n",
      "164436  3209206324        29  1398/06/23  66317  E170\n",
      "164434   186819958        29  1398/06/23  66369  E170\n",
      "164437  3632338908        29  1398/06/23  66408  E170\n",
      "164441  3632338908        29  1398/06/23  66409  E170\n",
      "164443   721785382        29  1398/06/23  66450  E170\n",
      "291228  3791735900        29  1398/06/23  66650  E170\n",
      "291229  3791735900        29  1398/06/23  66652  E170\n",
      "164445  3632322988        29  1398/06/23  66665  E170\n",
      "164447  3631649516        29  1398/06/23  68046  E170\n",
      "164449  2741318948        29  1398/06/23  68223  E170\n",
      "164452  2052576994        29  1398/06/23  69653  E170\n",
      "164454  1612062917        29  1398/06/23  70086  E170\n",
      "164457   869220044        29  1398/06/23  70363  E170\n",
      "164459  2049011474        29  1398/06/23  70784  E170\n",
      "164462  2049011474        29  1398/06/23  70786  E170\n",
      "164464  2049011474        29  1398/06/23  70788  E170\n",
      "164467   429935390        29  1398/06/23  71348  E170\n",
      "164470  4266246002        29  1398/06/23  71509  E170\n",
      "164473  4266246002        29  1398/06/23  71510  E170\n",
      "164475  3793390188        29  1398/06/23  71514  E170\n",
      "164477   427485102        29  1398/06/23  71516  E170\n",
      "164480  2740745252        29  1398/06/23  71757  E170\n",
      "164482  3559308081        29  1398/06/23  71787  E170\n",
      "164485  1407754553        29  1398/06/23  71809  E170\n",
      "164488   645331869        29  1398/06/23  74244  E170\n",
      "238611   645331869        29  1398/06/23  74245  E170\n",
      "first row of the selected chunck : \n",
      " [4279332434 29 '1398/06/23' 21555 'E170']\n",
      "59\n",
      "t0 = 21555\n",
      "ts = 74245\n",
      "time_intervals 88\n",
      "Origin destination interval view reindex \n",
      "    time_in  time_out\n",
      "0  21555.0   22155.0\n",
      "1  23955.0   63555.0\n",
      "2  64755.0   65955.0\n",
      "3  67755.0   68355.0\n",
      "4  68955.0   70155.0\n",
      "5  72555.0   74355.0\n",
      "OD bus stations of transactions: \n",
      "            CardID LineCode       FDate   Time  plat Station\n",
      "0       542446139        1  1398/06/23  24030  A145    3169\n",
      "1      2620656172        1  1398/06/23  24302  A145    3169\n",
      "2      3446252780        1  1398/06/23  26200  A145    1227\n",
      "3         7900260        1  1398/06/23  29677  A145    3169\n",
      "4       361857972        1  1398/06/23  29720  A145    3169\n",
      "...           ...      ...         ...    ...   ...     ...\n",
      "60694  2741318948       29  1398/06/23  68223  E170    1996\n",
      "60695  2052576994       29  1398/06/23  69653  E170    2524\n",
      "60696  1612062917       29  1398/06/23  70086  E170    2524\n",
      "60697   645331869       29  1398/06/23  74244  E170    1996\n",
      "60698   645331869       29  1398/06/23  74245  E170    1996\n",
      "\n",
      "[60699 rows x 6 columns]\n",
      "transactions in line 29 plat E62\n",
      "ps: \n",
      "               CardID  LineCode       FDate   Time plat\n",
      "2042615   721825370        29  1398/06/23  49331  E62\n",
      "2042617   721825370        29  1398/06/23  49332  E62\n",
      "2042620  1611029931        29  1398/06/23  49419  E62\n",
      "2042623  3206606156        29  1398/06/23  49561  E62\n",
      "2042625   981563147        29  1398/06/23  49919  E62\n",
      "...             ...       ...         ...    ...  ...\n",
      "1827006  2589934836        29  1398/06/23  71250  E62\n",
      "1827011   982635835        29  1398/06/23  71515  E62\n",
      "1827014   184130086        29  1398/06/23  72080  E62\n",
      "2042609  3791679388        29  1398/06/23  73189  E62\n",
      "2042611  3791679388        29  1398/06/23  77229  E62\n",
      "\n",
      "[98 rows x 5 columns]\n",
      "first row of the selected chunck : \n",
      " [721825370 29 '1398/06/23' 49331 'E62']\n",
      "98\n",
      "t0 = 49331\n",
      "ts = 77229\n",
      "time_intervals 46\n",
      "Origin destination interval view reindex \n",
      "    time_in  time_out\n",
      "0  49331.0   49931.0\n",
      "1  50531.0   51131.0\n",
      "2  52331.0   53531.0\n",
      "3  55931.0   58331.0\n",
      "4  60131.0   61931.0\n",
      "5  64931.0   66731.0\n",
      "6  70331.0   71531.0\n",
      "7  72731.0   73331.0\n",
      "8  73931.0   76931.0\n",
      "OD bus stations of transactions: \n",
      "            CardID LineCode       FDate   Time  plat Station\n",
      "0       542446139        1  1398/06/23  24030  A145    3169\n",
      "1      2620656172        1  1398/06/23  24302  A145    3169\n",
      "2      3446252780        1  1398/06/23  26200  A145    1227\n",
      "3         7900260        1  1398/06/23  29677  A145    3169\n",
      "4       361857972        1  1398/06/23  29720  A145    3169\n",
      "...           ...      ...         ...    ...   ...     ...\n",
      "60724  3648832628       29  1398/06/23  70995   E62    2524\n",
      "60725  3444815804       29  1398/06/23  71152   E62    2524\n",
      "60726  2589934836       29  1398/06/23  71250   E62    2524\n",
      "60727   982635835       29  1398/06/23  71515   E62    2524\n",
      "60728  3791679388       29  1398/06/23  73189   E62    1996\n",
      "\n",
      "[60729 rows x 6 columns]\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "transactions in line 29 plat F92\n",
      "ps: \n",
      "             CardID  LineCode       FDate   Time plat\n",
      "85975   983092971        29  1398/06/23  62341  F92\n",
      "85977   721712452        29  1398/06/23  62344  F92\n",
      "85979  2138316205        29  1398/06/23  62974  F92\n",
      "85981  2125983652        29  1398/06/23  63251  F92\n",
      "85982  4241536183        29  1398/06/23  63268  F92\n",
      "85984  3793672124        29  1398/06/23  63270  F92\n",
      "85986   262546289        29  1398/06/23  63343  F92\n",
      "85987   262546289        29  1398/06/23  63345  F92\n",
      "85988  3445639468        29  1398/06/23  64613  F92\n",
      "85990  3445639468        29  1398/06/23  64614  F92\n",
      "85991  1837950013        29  1398/06/23  64672  F92\n",
      "85993  2045334414        29  1398/06/23  64678  F92\n",
      "85995  4257644532        29  1398/06/23  64706  F92\n",
      "85998  3151164654        29  1398/06/23  65923  F92\n",
      "86000  3212283828        29  1398/06/23  67244  F92\n",
      "86004  2492025700        29  1398/06/23  67346  F92\n",
      "86007  1832348429        29  1398/06/23  67608  F92\n",
      "86010   537211758        29  1398/06/23  67825  F92\n",
      "86013  3183166670        29  1398/06/23  68017  F92\n",
      "86016  3650034292        29  1398/06/23  68034  F92\n",
      "86019  2125702884        29  1398/06/23  68248  F92\n",
      "86022   210589499        29  1398/06/23  68620  F92\n",
      "86084  3151178206        29  1398/06/23  68827  F92\n",
      "86086  3445154508        29  1398/06/23  69847  F92\n",
      "86091   399920474        29  1398/06/23  70422  F92\n",
      "86093   233601610        29  1398/06/23  70474  F92\n",
      "86096   555500158        29  1398/06/23  70657  F92\n",
      "86100  1281072078        29  1398/06/23  70812  F92\n",
      "86103  1281072078        29  1398/06/23  70814  F92\n",
      "86105  4270489602        29  1398/06/23  70864  F92\n",
      "94093  4270489602        29  1398/06/23  70865  F92\n",
      "94096  2138119629        29  1398/06/23  71000  F92\n",
      "94098  2138119629        29  1398/06/23  71001  F92\n",
      "94101   300940123        29  1398/06/23  71236  F92\n",
      "94111  1613527349        29  1398/06/23  71291  F92\n",
      "94108  2122777364        29  1398/06/23  71294  F92\n",
      "94114   622889173        29  1398/06/23  71784  F92\n",
      "94119  1832755965        29  1398/06/23  73049  F92\n",
      "94998  1610646603        29  1398/06/23  73166  F92\n",
      "94121   722157305        29  1398/06/23  73306  F92\n",
      "95002   869419678        29  1398/06/23  73348  F92\n",
      "95005   298444123        29  1398/06/23  73603  F92\n",
      "95008   298444123        29  1398/06/23  73605  F92\n",
      "95012   113086547        29  1398/06/23  73697  F92\n",
      "95015   869446931        29  1398/06/23  73700  F92\n",
      "95018  2680274862        29  1398/06/23  74364  F92\n",
      "64795  3792425596        29  1398/06/23  75311  F92\n",
      "64798  3792425596        29  1398/06/23  75313  F92\n",
      "64802  3792425596        29  1398/06/23  75315  F92\n",
      "first row of the selected chunck : \n",
      " [983092971 29 '1398/06/23' 62341 'F92']\n",
      "49\n",
      "t0 = 62341\n",
      "ts = 75315\n",
      "time_intervals 22\n",
      "Origin destination interval view reindex \n",
      "    time_in  time_out\n",
      "0  62341.0   62941.0\n",
      "1  64141.0   64741.0\n",
      "2  65341.0   65941.0\n",
      "3  66541.0   67741.0\n",
      "4  69541.0   70141.0\n",
      "5  72541.0   73141.0\n",
      "6  74341.0   74941.0\n",
      "OD bus stations of transactions: \n",
      "            CardID LineCode       FDate   Time  plat Station\n",
      "0       542446139        1  1398/06/23  24030  A145    3169\n",
      "1      2620656172        1  1398/06/23  24302  A145    3169\n",
      "2      3446252780        1  1398/06/23  26200  A145    1227\n",
      "3         7900260        1  1398/06/23  29677  A145    3169\n",
      "4       361857972        1  1398/06/23  29720  A145    3169\n",
      "...           ...      ...         ...    ...   ...     ...\n",
      "60738  2492025700       29  1398/06/23  67346   F92    1996\n",
      "60739  1832348429       29  1398/06/23  67608   F92    1996\n",
      "60740  3445154508       29  1398/06/23  69847   F92    2524\n",
      "60741  1832755965       29  1398/06/23  73049   F92    1996\n",
      "60742  2680274862       29  1398/06/23  74364   F92    2524\n",
      "\n",
      "[60743 rows x 6 columns]\n",
      "transactions in line 29 plat M134\n",
      "ps: \n",
      "              CardID  LineCode       FDate   Time  plat\n",
      "304325   262334465        29  1398/06/23  22279  M134\n",
      "304326  2123754180        29  1398/06/23  22364  M134\n",
      "304329  2743143748        29  1398/06/23  22579  M134\n",
      "304327  3178805694        29  1398/06/23  22661  M134\n",
      "304328  3678808620        29  1398/06/23  22663  M134\n",
      "304331  1799039668        29  1398/06/23  22856  M134\n",
      "304332  3678133676        29  1398/06/23  22910  M134\n",
      "304330  1002274359        29  1398/06/23  22911  M134\n",
      "304333   722249790        29  1398/06/23  25220  M134\n",
      "304334  1001129550        29  1398/06/23  25221  M134\n",
      "304335  4265462850        29  1398/06/23  25223  M134\n",
      "304336   869420021        29  1398/06/23  25870  M134\n",
      "304337  1292849502        29  1398/06/23  25877  M134\n",
      "first row of the selected chunck : \n",
      " [262334465 29 '1398/06/23' 22279 'M134']\n",
      "13\n",
      "t0 = 22279\n",
      "ts = 25877\n",
      "time_intervals 6\n",
      "Origin destination interval view reindex \n",
      "    time_in  time_out\n",
      "0  22279.0   22879.0\n",
      "1  24079.0   25279.0\n",
      "OD bus stations of transactions: \n",
      "            CardID LineCode       FDate   Time  plat Station\n",
      "0       542446139        1  1398/06/23  24030  A145    3169\n",
      "1      2620656172        1  1398/06/23  24302  A145    3169\n",
      "2      3446252780        1  1398/06/23  26200  A145    1227\n",
      "3         7900260        1  1398/06/23  29677  A145    3169\n",
      "4       361857972        1  1398/06/23  29720  A145    3169\n",
      "...           ...      ...         ...    ...   ...     ...\n",
      "60747  3678808620       29  1398/06/23  22663  M134    2524\n",
      "60748  1799039668       29  1398/06/23  22856  M134    2524\n",
      "60749   722249790       29  1398/06/23  25220  M134    1996\n",
      "60750  1001129550       29  1398/06/23  25221  M134    1996\n",
      "60751  4265462850       29  1398/06/23  25223  M134    1996\n",
      "\n",
      "[60752 rows x 6 columns]\n",
      "transactions in line 29 plat M139\n",
      "ps: \n",
      "              CardID  LineCode       FDate   Time  plat\n",
      "304253  2116347380        29  1398/06/23  23336  M139\n",
      "304261  2680772804        29  1398/06/23  23841  M139\n",
      "304265  1458488389        29  1398/06/23  23843  M139\n",
      "304269  2038254138        29  1398/06/23  23845  M139\n",
      "304259  3678246572        29  1398/06/23  23849  M139\n",
      "...            ...       ...         ...    ...   ...\n",
      "196190  1594807476        29  1398/06/23  73100  M139\n",
      "196195  2504247716        29  1398/06/23  73102  M139\n",
      "196201  3791801404        29  1398/06/23  73667  M139\n",
      "196381  3166396750        29  1398/06/23  74255  M139\n",
      "196385  2966175230        29  1398/06/23  74342  M139\n",
      "\n",
      "[224 rows x 5 columns]\n",
      "first row of the selected chunck : \n",
      " [2116347380 29 '1398/06/23' 23336 'M139']\n",
      "224\n",
      "t0 = 23336\n",
      "ts = 74342\n",
      "time_intervals 85\n",
      "Origin destination interval view reindex \n",
      "     time_in  time_out\n",
      "0   23336.0   23936.0\n",
      "1   25136.0   25736.0\n",
      "2   26336.0   27536.0\n",
      "3   29936.0   31736.0\n",
      "4   33536.0   34136.0\n",
      "5   34736.0   35936.0\n",
      "6   41936.0   43736.0\n",
      "7   50936.0   51536.0\n",
      "8   54536.0   55736.0\n",
      "9   58136.0   58736.0\n",
      "10  59336.0   59936.0\n",
      "11  63536.0   64136.0\n",
      "12  64736.0   65336.0\n",
      "13  67736.0   68936.0\n",
      "14  70736.0   71336.0\n",
      "15  71936.0   72536.0\n",
      "OD bus stations of transactions: \n",
      "            CardID LineCode       FDate   Time  plat Station\n",
      "0       542446139        1  1398/06/23  24030  A145    3169\n",
      "1      2620656172        1  1398/06/23  24302  A145    3169\n",
      "2      3446252780        1  1398/06/23  26200  A145    1227\n",
      "3         7900260        1  1398/06/23  29677  A145    3169\n",
      "4       361857972        1  1398/06/23  29720  A145    3169\n",
      "...           ...      ...         ...    ...   ...     ...\n",
      "60790   722089780       29  1398/06/23  70978  M139    2524\n",
      "60791  3794238156       29  1398/06/23  71287  M139    2524\n",
      "60792  3794238156       29  1398/06/23  71288  M139    2524\n",
      "60793  3791681052       29  1398/06/23  72076  M139    1996\n",
      "60794  3791681052       29  1398/06/23  72078  M139    1996\n",
      "\n",
      "[60795 rows x 6 columns]\n",
      "transactions in line 29 plat M140\n",
      "ps: \n",
      "              CardID  LineCode       FDate   Time  plat\n",
      "474241   721803003        29  1398/06/23  21658  M140\n",
      "474244  2505878276        29  1398/06/23  21724  M140\n",
      "474247   236043114        29  1398/06/23  22085  M140\n",
      "474250  1002026926        29  1398/06/23  23069  M140\n",
      "474252  1002026926        29  1398/06/23  23071  M140\n",
      "...            ...       ...         ...    ...   ...\n",
      "192545   361812516        29  1398/06/23  72512  M140\n",
      "474229  3791743932        29  1398/06/23  77776  M140\n",
      "474232  3791743932        29  1398/06/23  77778  M140\n",
      "474235  3791743932        29  1398/06/23  77780  M140\n",
      "474238  3791743932        29  1398/06/23  77782  M140\n",
      "\n",
      "[298 rows x 5 columns]\n",
      "first row of the selected chunck : \n",
      " [721803003 29 '1398/06/23' 21658 'M140']\n",
      "298\n",
      "t0 = 21658\n",
      "ts = 77782\n",
      "time_intervals 94\n",
      "Origin destination interval view reindex \n",
      "     time_in  time_out\n",
      "0   21658.0   22258.0\n",
      "1   22858.0   23458.0\n",
      "2   24058.0   24658.0\n",
      "3   27658.0   28858.0\n",
      "4   31258.0   32458.0\n",
      "5   43258.0   43858.0\n",
      "6   45058.0   45658.0\n",
      "7   47458.0   48658.0\n",
      "8   49258.0   49858.0\n",
      "9   54658.0   55858.0\n",
      "10  57058.0   57658.0\n",
      "11  58258.0   58858.0\n",
      "12  59458.0   60658.0\n",
      "13  62458.0   64258.0\n",
      "14  64858.0   65458.0\n",
      "15  73258.0   78058.0\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "OD bus stations of transactions: \n",
      "            CardID LineCode       FDate   Time  plat Station\n",
      "0       542446139        1  1398/06/23  24030  A145    3169\n",
      "1      2620656172        1  1398/06/23  24302  A145    3169\n",
      "2      3446252780        1  1398/06/23  26200  A145    1227\n",
      "3         7900260        1  1398/06/23  29677  A145    3169\n",
      "4       361857972        1  1398/06/23  29720  A145    3169\n",
      "...           ...      ...         ...    ...   ...     ...\n",
      "60928   736353536       29  1398/06/23  65361  M140    2524\n",
      "60929  3791743932       29  1398/06/23  77776  M140    1996\n",
      "60930  3791743932       29  1398/06/23  77778  M140    1996\n",
      "60931  3791743932       29  1398/06/23  77780  M140    1996\n",
      "60932  3791743932       29  1398/06/23  77782  M140    1996\n",
      "\n",
      "[60933 rows x 6 columns]\n",
      "transactions in line 29 plat M209\n",
      "ps: \n",
      "              CardID  LineCode       FDate   Time  plat\n",
      "175965   641407658        29  1398/06/23  38692  M209\n",
      "175967   212361515        29  1398/06/23  38720  M209\n",
      "175963  3446913116        29  1398/06/23  38799  M209\n",
      "175968  3201636756        29  1398/06/23  38860  M209\n",
      "175969  1294401438        29  1398/06/23  38995  M209\n",
      "175970  1838012573        29  1398/06/23  39007  M209\n",
      "175971  4276014146        29  1398/06/23  39028  M209\n",
      "175973  2504349108        29  1398/06/23  39063  M209\n",
      "175974   211347724        29  1398/06/23  39085  M209\n",
      "175976  4276364050        29  1398/06/23  39299  M209\n",
      "175980   981748299        29  1398/06/23  39351  M209\n",
      "175981  2044096958        29  1398/06/23  39476  M209\n",
      "175984  2115570164        29  1398/06/23  39478  M209\n",
      "175986   262032321        29  1398/06/23  39852  M209\n",
      "138181  3792430300        29  1398/06/23  40126  M209\n",
      "175988  3604378764        29  1398/06/23  41683  M209\n",
      "175990  1844931284        29  1398/06/23  41721  M209\n",
      "175991  3677186844        29  1398/06/23  42113  M209\n",
      "175993  1786963764        29  1398/06/23  42116  M209\n",
      "175995   722134272        29  1398/06/23  42372  M209\n",
      "175998  2855345550        29  1398/06/23  42391  M209\n",
      "175999  1799148052        29  1398/06/23  42667  M209\n",
      "176124  1598413332        29  1398/06/23  42667  M209\n",
      "176001  1799148052        29  1398/06/23  42668  M209\n",
      "176002  1845509476        29  1398/06/23  42672  M209\n",
      "176117  1845509476        29  1398/06/23  42674  M209\n",
      "176119  3258313469        29  1398/06/23  42679  M209\n",
      "176121  3258313469        29  1398/06/23  42680  M209\n",
      "176123  4276627762        29  1398/06/23  42699  M209\n",
      "176126  4241394183        29  1398/06/23  42990  M209\n",
      "176129  3679070700        29  1398/06/23  43044  M209\n",
      "176131  2045140718        29  1398/06/23  43305  M209\n",
      "176132   808408482        29  1398/06/23  43308  M209\n",
      "176134  1763680948        29  1398/06/23  43310  M209\n",
      "176136  1294300862        29  1398/06/23  43315  M209\n",
      "176138  1835680317        29  1398/06/23  43424  M209\n",
      "138182  3792430300        29  1398/06/23  43444  M209\n",
      "176139  4059248237        29  1398/06/23  43759  M209\n",
      "176142  2541300014        29  1398/06/23  44389  M209\n",
      "first row of the selected chunck : \n",
      " [641407658 29 '1398/06/23' 38692 'M209']\n",
      "39\n",
      "t0 = 38692\n",
      "ts = 44389\n",
      "time_intervals 9\n",
      "Origin destination interval view reindex \n",
      "    time_in  time_out\n",
      "0  38692.0   39292.0\n",
      "1  41092.0   41692.0\n",
      "OD bus stations of transactions: \n",
      "            CardID LineCode       FDate   Time  plat Station\n",
      "0       542446139        1  1398/06/23  24030  A145    3169\n",
      "1      2620656172        1  1398/06/23  24302  A145    3169\n",
      "2      3446252780        1  1398/06/23  26200  A145    1227\n",
      "3         7900260        1  1398/06/23  29677  A145    3169\n",
      "4       361857972        1  1398/06/23  29720  A145    3169\n",
      "...           ...      ...         ...    ...   ...     ...\n",
      "61121  1838012573       29  1398/06/23  39007  M209    2524\n",
      "61122  4276014146       29  1398/06/23  39028  M209    2524\n",
      "61123  2504349108       29  1398/06/23  39063  M209    2524\n",
      "61124   211347724       29  1398/06/23  39085  M209    2524\n",
      "61125  3604378764       29  1398/06/23  41683  M209    1996\n",
      "\n",
      "[61126 rows x 6 columns]\n",
      "transactions in line 29 plat M37\n",
      "ps: \n",
      "             CardID  LineCode       FDate   Time plat\n",
      "90245   429483518        29  1398/06/23  22600  M37\n",
      "90247   981712619        29  1398/06/23  22639  M37\n",
      "90248  3649773636        29  1398/06/23  22660  M37\n",
      "90249  2232812563        29  1398/06/23  22691  M37\n",
      "90252  2680481246        29  1398/06/23  22781  M37\n",
      "...           ...       ...         ...    ...  ...\n",
      "15972  3792748892        29  1398/06/23  71772  M37\n",
      "15975   646214493        29  1398/06/23  73833  M37\n",
      "15973  2048158418        29  1398/06/23  74036  M37\n",
      "15974  2048158418        29  1398/06/23  74037  M37\n",
      "90243  3680008540        29  1398/06/23  74823  M37\n",
      "\n",
      "[191 rows x 5 columns]\n",
      "first row of the selected chunck : \n",
      " [429483518 29 '1398/06/23' 22600 'M37']\n",
      "191\n",
      "t0 = 22600\n",
      "ts = 74823\n",
      "time_intervals 87\n",
      "Origin destination interval view reindex \n",
      "     time_in  time_out\n",
      "0   22600.0   23200.0\n",
      "1   23800.0   25600.0\n",
      "2   28600.0   29200.0\n",
      "3   31600.0   33400.0\n",
      "4   37000.0   43000.0\n",
      "5   46600.0   47200.0\n",
      "6   48400.0   49600.0\n",
      "7   50200.0   59800.0\n",
      "8   62800.0   65200.0\n",
      "9   67000.0   68200.0\n",
      "10  71200.0   71800.0\n",
      "11  72400.0   74200.0\n",
      "OD bus stations of transactions: \n",
      "            CardID LineCode       FDate   Time  plat Station\n",
      "0       542446139        1  1398/06/23  24030  A145    3169\n",
      "1      2620656172        1  1398/06/23  24302  A145    3169\n",
      "2      3446252780        1  1398/06/23  26200  A145    1227\n",
      "3         7900260        1  1398/06/23  29677  A145    3169\n",
      "4       361857972        1  1398/06/23  29720  A145    3169\n",
      "...           ...      ...         ...    ...   ...     ...\n",
      "61179   425809470       29  1398/06/23  71491   M37    2524\n",
      "61180  3792748892       29  1398/06/23  71772   M37    2524\n",
      "61181   646214493       29  1398/06/23  73833   M37    1996\n",
      "61182  2048158418       29  1398/06/23  74036   M37    1996\n",
      "61183  2048158418       29  1398/06/23  74037   M37    1996\n",
      "\n",
      "[61184 rows x 6 columns]\n",
      "transactions in line 29 plat M58\n",
      "ps: \n",
      "              CardID  LineCode       FDate   Time plat\n",
      "137426  2123303844        29  1398/06/23  26181  M58\n",
      "137427  3405931157        29  1398/06/23  26331  M58\n",
      "137430   425664254        29  1398/06/23  26689  M58\n",
      "137428  2125652820        29  1398/06/23  26691  M58\n",
      "137431  3793172156        29  1398/06/23  26692  M58\n",
      "...            ...       ...         ...    ...  ...\n",
      "176446  2124153556        29  1398/06/23  71896  M58\n",
      "176447  2125259940        29  1398/06/23  71906  M58\n",
      "176449  2125259940        29  1398/06/23  71911  M58\n",
      "176450   869281038        29  1398/06/23  72226  M58\n",
      "176451   869305854        29  1398/06/23  72537  M58\n",
      "\n",
      "[249 rows x 5 columns]\n",
      "first row of the selected chunck : \n",
      " [2123303844 29 '1398/06/23' 26181 'M58']\n",
      "249\n",
      "t0 = 26181\n",
      "ts = 72537\n",
      "time_intervals 77\n",
      "Origin destination interval view reindex \n",
      "     time_in  time_out\n",
      "0   26181.0   26781.0\n",
      "1   28581.0   29781.0\n",
      "2   32181.0   33381.0\n",
      "3   41181.0   41781.0\n",
      "4   51381.0   53181.0\n",
      "5   54981.0   56781.0\n",
      "6   59181.0   60981.0\n",
      "7   63981.0   65181.0\n",
      "8   68181.0   68781.0\n",
      "9   69381.0   70581.0\n",
      "10  71181.0   71781.0\n",
      "OD bus stations of transactions: \n",
      "            CardID LineCode       FDate   Time  plat Station\n",
      "0       542446139        1  1398/06/23  24030  A145    3169\n",
      "1      2620656172        1  1398/06/23  24302  A145    3169\n",
      "2      3446252780        1  1398/06/23  26200  A145    1227\n",
      "3         7900260        1  1398/06/23  29677  A145    3169\n",
      "4       361857972        1  1398/06/23  29720  A145    3169\n",
      "...           ...      ...         ...    ...   ...     ...\n",
      "61289   342980740       29  1398/06/23  70363   M58    1996\n",
      "61290  1833359965       29  1398/06/23  70553   M58    1996\n",
      "61291  2501278260       29  1398/06/23  71189   M58    2524\n",
      "61292   113878371       29  1398/06/23  71191   M58    2524\n",
      "61293  2742872836       29  1398/06/23  71752   M58    2524\n",
      "\n",
      "[61294 rows x 6 columns]\n",
      "transactions in line 29 plat M76\n",
      "ps: \n",
      "              CardID  LineCode       FDate   Time plat\n",
      "522812   202857740        29  1398/06/23  34254  M76\n",
      "522813  2541363038        29  1398/06/23  34329  M76\n",
      "522814  3181382062        29  1398/06/23  34352  M76\n",
      "522815  2541465422        29  1398/06/23  35533  M76\n",
      "522816   721932514        29  1398/06/23  35543  M76\n",
      "...            ...       ...         ...    ...  ...\n",
      "523575   235718410        29  1398/06/23  68339  M76\n",
      "523576  2125094388        29  1398/06/23  69108  M76\n",
      "523577  3405892246        29  1398/06/23  69170  M76\n",
      "523578  1592426196        29  1398/06/23  69272  M76\n",
      "521709  3680197116        29  1398/06/23  71524  M76\n",
      "\n",
      "[113 rows x 5 columns]\n",
      "first row of the selected chunck : \n",
      " [202857740 29 '1398/06/23' 34254 'M76']\n",
      "113\n",
      "t0 = 34254\n",
      "ts = 71524\n",
      "time_intervals 62\n",
      "Origin destination interval view reindex \n",
      "    time_in  time_out\n",
      "0  34254.0   34854.0\n",
      "1  35454.0   36054.0\n",
      "2  37254.0   45654.0\n",
      "3  46254.0   46854.0\n",
      "4  51054.0   51654.0\n",
      "5  52854.0   59454.0\n",
      "6  64254.0   64854.0\n",
      "7  67254.0   67854.0\n",
      "8  69054.0   69654.0\n",
      "9  70254.0   71454.0\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "OD bus stations of transactions: \n",
      "            CardID LineCode       FDate   Time  plat Station\n",
      "0       542446139        1  1398/06/23  24030  A145    3169\n",
      "1      2620656172        1  1398/06/23  24302  A145    3169\n",
      "2      3446252780        1  1398/06/23  26200  A145    1227\n",
      "3         7900260        1  1398/06/23  29677  A145    3169\n",
      "4       361857972        1  1398/06/23  29720  A145    3169\n",
      "...           ...      ...         ...    ...   ...     ...\n",
      "61463  4269771410       29  1398/06/23  67698   M76    1996\n",
      "61464  3649865860       29  1398/06/23  67830   M76    1996\n",
      "61465  2125094388       29  1398/06/23  69108   M76    2524\n",
      "61466  3405892246       29  1398/06/23  69170   M76    2524\n",
      "61467  1592426196       29  1398/06/23  69272   M76    2524\n",
      "\n",
      "[61468 rows x 6 columns]\n",
      "transactions in line 29 plat N162\n",
      "ps: \n",
      "              CardID  LineCode       FDate   Time  plat\n",
      "567166  2961963029        29  1398/06/23  23600  N162\n",
      "567167  1787355732        29  1398/06/23  23611  N162\n",
      "567169  2855073246        29  1398/06/23  23644  N162\n",
      "567170   721786048        29  1398/06/23  23649  N162\n",
      "567168   233115578        29  1398/06/23  23839  N162\n",
      "...            ...       ...         ...    ...   ...\n",
      "324801   869269927        29  1398/06/23  75240  N162\n",
      "324802  4255749284        29  1398/06/23  75280  N162\n",
      "324803   361129796        29  1398/06/23  75398  N162\n",
      "324804   426093950        29  1398/06/23  75549  N162\n",
      "324805  1838086349        29  1398/06/23  75573  N162\n",
      "\n",
      "[242 rows x 5 columns]\n",
      "first row of the selected chunck : \n",
      " [2961963029 29 '1398/06/23' 23600 'N162']\n",
      "242\n",
      "t0 = 23600\n",
      "ts = 75573\n",
      "time_intervals 87\n",
      "Origin destination interval view reindex \n",
      "     time_in  time_out\n",
      "0   23600.0   24200.0\n",
      "1   25400.0   26600.0\n",
      "2   29000.0   30800.0\n",
      "3   37400.0   38600.0\n",
      "4   44000.0   44600.0\n",
      "5   45200.0   46400.0\n",
      "6   50000.0   50600.0\n",
      "7   53000.0   53600.0\n",
      "8   54200.0   55400.0\n",
      "9   56000.0   56600.0\n",
      "10  57800.0   59000.0\n",
      "11  61400.0   62000.0\n",
      "12  63800.0   64400.0\n",
      "13  65000.0   65600.0\n",
      "14  66800.0   67400.0\n",
      "15  68600.0   70400.0\n",
      "16  71000.0   73400.0\n",
      "OD bus stations of transactions: \n",
      "            CardID LineCode       FDate   Time  plat Station\n",
      "0       542446139        1  1398/06/23  24030  A145    3169\n",
      "1      2620656172        1  1398/06/23  24302  A145    3169\n",
      "2      3446252780        1  1398/06/23  26200  A145    1227\n",
      "3         7900260        1  1398/06/23  29677  A145    3169\n",
      "4       361857972        1  1398/06/23  29720  A145    3169\n",
      "...           ...      ...         ...    ...   ...     ...\n",
      "61546   869423584       29  1398/06/23  67245  N162    2524\n",
      "61547   425969886       29  1398/06/23  69980  N162    1996\n",
      "61548  2681864846       29  1398/06/23  70228  N162    1996\n",
      "61549  2681864846       29  1398/06/23  70229  N162    1996\n",
      "61550  3793854668       29  1398/06/23  73260  N162    2524\n",
      "\n",
      "[61551 rows x 6 columns]\n",
      "stations in a specefic bus line 30\n",
      "len-of-go stations: 0\n",
      "len-of-back stations: 0\n",
      "len-of-go back stations: 0\n",
      "stations in a specefic bus line 31\n",
      "len-of-go stations: 37\n",
      "len-of-back stations: 37\n",
      "len-of-go back stations: 0\n",
      "first Station  [1889 '31' '1' 'go' '?????? ????? -31' 51.716181 32.624754 'od' 'normal'\n",
      " 'yes'] 1889\n",
      "last Station  [3595 '31' '1' 'back' '?????? ??? ??? ??? ?? -31' 51.623946 32.611107 'od'\n",
      " 'normal' 'yes']\n",
      "['A38' 'B45' 'B48' 'B51' 'B68' 'B74' 'B77' 'C20' 'C64' 'D80' 'E131' 'E214'\n",
      " 'E228' 'F175' 'F26' 'M41' 'M44']\n",
      "transactions in line 31 plat A38\n",
      "ps: \n",
      "              CardID  LineCode       FDate   Time plat\n",
      "525808  2658351116        31  1398/06/23  23820  A38\n",
      "525809  2658351116        31  1398/06/23  23823  A38\n",
      "525810   721978381        31  1398/06/23  24275  A38\n",
      "525813   809119282        31  1398/06/23  24291  A38\n",
      "525811   262825921        31  1398/06/23  24328  A38\n",
      "...            ...       ...         ...    ...  ...\n",
      "568710   869248406        31  1398/06/23  73660  A38\n",
      "568708  1775677684        31  1398/06/23  73663  A38\n",
      "568711  4058622365        31  1398/06/23  73666  A38\n",
      "568709  1775677684        31  1398/06/23  73669  A38\n",
      "568712  2681617422        31  1398/06/23  73705  A38\n",
      "\n",
      "[525 rows x 5 columns]\n",
      "first row of the selected chunck : \n",
      " [2658351116 31 '1398/06/23' 23820 'A38']\n",
      "525\n",
      "t0 = 23820\n",
      "ts = 73705\n",
      "time_intervals 83\n",
      "Origin destination interval view reindex \n",
      "     time_in  time_out\n",
      "0   23820.0   24420.0\n",
      "1   26220.0   29220.0\n",
      "2   31620.0   32220.0\n",
      "3   35220.0   37020.0\n",
      "4   39420.0   40020.0\n",
      "5   43620.0   44220.0\n",
      "6   47820.0   49020.0\n",
      "7   52020.0   52620.0\n",
      "8   55620.0   56820.0\n",
      "9   59820.0   60420.0\n",
      "10  64020.0   64620.0\n",
      "11  69420.0   70620.0\n",
      "OD bus stations of transactions: \n",
      "            CardID LineCode       FDate   Time  plat Station\n",
      "0       542446139        1  1398/06/23  24030  A145    3169\n",
      "1      2620656172        1  1398/06/23  24302  A145    3169\n",
      "2      3446252780        1  1398/06/23  26200  A145    1227\n",
      "3         7900260        1  1398/06/23  29677  A145    3169\n",
      "4       361857972        1  1398/06/23  29720  A145    3169\n",
      "...           ...      ...         ...    ...   ...     ...\n",
      "61685   429540958       31  1398/06/23  60328   A38    3595\n",
      "61686  3791701644       31  1398/06/23  60357   A38    3595\n",
      "61687   428418190       31  1398/06/23  64539   A38    1889\n",
      "61688   721925065       31  1398/06/23  70460   A38    3595\n",
      "61689  2680451684       31  1398/06/23  70468   A38    3595\n",
      "\n",
      "[61690 rows x 6 columns]\n",
      "transactions in line 31 plat B45\n",
      "ps: \n",
      "              CardID  LineCode       FDate   Time plat\n",
      "243778  3793897724        31  1398/06/23  22735  B45\n",
      "243779  2125859588        31  1398/06/23  22740  B45\n",
      "243780  2680585790        31  1398/06/23  24359  B45\n",
      "243781  3209617684        31  1398/06/23  24521  B45\n",
      "243782  3209617684        31  1398/06/23  24523  B45\n",
      "...            ...       ...         ...    ...  ...\n",
      "20978    429224446        31  1398/06/23  50104  B45\n",
      "20979    261344433        31  1398/06/23  50219  B45\n",
      "20980    261344433        31  1398/06/23  50222  B45\n",
      "20981   3205848196        31  1398/06/23  50225  B45\n",
      "20982   3793957260        31  1398/06/23  50385  B45\n",
      "\n",
      "[266 rows x 5 columns]\n",
      "first row of the selected chunck : \n",
      " [3793897724 31 '1398/06/23' 22735 'B45']\n",
      "266\n",
      "t0 = 22735\n",
      "ts = 50385\n",
      "time_intervals 46\n",
      "Origin destination interval view reindex \n",
      "    time_in  time_out\n",
      "0  22735.0   23335.0\n",
      "1  23935.0   24535.0\n",
      "2  29935.0   31135.0\n",
      "3  34135.0   35335.0\n",
      "4  38935.0   40135.0\n",
      "5  44335.0   46135.0\n",
      "6  49135.0   49735.0\n",
      "OD bus stations of transactions: \n",
      "            CardID LineCode       FDate   Time  plat Station\n",
      "0       542446139        1  1398/06/23  24030  A145    3169\n",
      "1      2620656172        1  1398/06/23  24302  A145    3169\n",
      "2      3446252780        1  1398/06/23  26200  A145    1227\n",
      "3         7900260        1  1398/06/23  29677  A145    3169\n",
      "4       361857972        1  1398/06/23  29720  A145    3169\n",
      "...           ...      ...         ...    ...   ...     ...\n",
      "61996  2590433156       31  1398/06/23  49571   B45    1889\n",
      "61997   234383450       31  1398/06/23  49574   B45    1889\n",
      "61998  3215159316       31  1398/06/23  49576   B45    1889\n",
      "61999  1765641508       31  1398/06/23  49655   B45    1889\n",
      "62000   869301427       31  1398/06/23  49660   B45    1889\n",
      "\n",
      "[62001 rows x 6 columns]\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "C:\\Users\\esmaeli.h\\AppData\\Local\\Temp/ipykernel_12452/1949912630.py:257: ConvergenceWarning: Number of distinct clusters (35) found smaller than n_clusters (36). Possibly due to duplicate points in X.\n",
      "  kmeans = KMeans(n_clusters=len(filter_go_stations)-1,random_state=0).fit(partial_times.to_numpy())\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "transactions in line 31 plat B48\n",
      "ps: \n",
      "              CardID  LineCode       FDate   Time plat\n",
      "136689   721721874        31  1398/06/23  25756  B48\n",
      "136690   808243570        31  1398/06/23  25764  B48\n",
      "136691  2680754036        31  1398/06/23  25963  B48\n",
      "136680  1764855700        31  1398/06/23  26065  B48\n",
      "136692  2125956020        31  1398/06/23  26142  B48\n",
      "...            ...       ...         ...    ...  ...\n",
      "279162  1613563493        31  1398/06/23  74101  B48\n",
      "279163  3405906374        31  1398/06/23  75021  B48\n",
      "136686  3792428396        31  1398/06/23  75298  B48\n",
      "136687  3792428396        31  1398/06/23  75302  B48\n",
      "136688  3792428396        31  1398/06/23  75307  B48\n",
      "\n",
      "[451 rows x 5 columns]\n",
      "first row of the selected chunck : \n",
      " [721721874 31 '1398/06/23' 25756 'B48']\n",
      "451\n",
      "t0 = 25756\n",
      "ts = 75307\n",
      "time_intervals 83\n",
      "Origin destination interval view reindex \n",
      "     time_in  time_out\n",
      "0   25756.0   26356.0\n",
      "1   28156.0   29356.0\n",
      "2   32356.0   35956.0\n",
      "3   38356.0   42556.0\n",
      "4   44956.0   46156.0\n",
      "5   49156.0   50356.0\n",
      "6   50956.0   51556.0\n",
      "7   53356.0   54556.0\n",
      "8   59956.0   61756.0\n",
      "9   64756.0   66556.0\n",
      "10  70756.0   71956.0\n",
      "11  74956.0   75556.0\n",
      "OD bus stations of transactions: \n",
      "            CardID LineCode       FDate   Time  plat Station\n",
      "0       542446139        1  1398/06/23  24030  A145    3169\n",
      "1      2620656172        1  1398/06/23  24302  A145    3169\n",
      "2      3446252780        1  1398/06/23  26200  A145    1227\n",
      "3         7900260        1  1398/06/23  29677  A145    3169\n",
      "4       361857972        1  1398/06/23  29720  A145    3169\n",
      "...           ...      ...         ...    ...   ...     ...\n",
      "62257   256723857       31  1398/06/23  71947   B48    1889\n",
      "62258  3405906374       31  1398/06/23  75021   B48    3595\n",
      "62259  3792428396       31  1398/06/23  75298   B48    3595\n",
      "62260  3792428396       31  1398/06/23  75302   B48    3595\n",
      "62261  3792428396       31  1398/06/23  75307   B48    3595\n",
      "\n",
      "[62262 rows x 6 columns]\n",
      "transactions in line 31 plat B51\n",
      "ps: \n",
      "              CardID  LineCode       FDate   Time plat\n",
      "321065  3257961149        31  1398/06/23  26574  B51\n",
      "321066  1114668274        31  1398/06/23  26588  B51\n",
      "321067  2239107942        31  1398/06/23  26591  B51\n",
      "321068   234362346        31  1398/06/23  26597  B51\n",
      "321070  3405936281        31  1398/06/23  26753  B51\n",
      "...            ...       ...         ...    ...  ...\n",
      "321926  3997603892        31  1398/06/23  76136  B51\n",
      "131978  3997603892        31  1398/06/23  76137  B51\n",
      "131982  2239177529        31  1398/06/23  76137  B51\n",
      "131979  3997603892        31  1398/06/23  76138  B51\n",
      "131983  3254427149        31  1398/06/23  76151  B51\n",
      "\n",
      "[248 rows x 5 columns]\n",
      "first row of the selected chunck : \n",
      " [3257961149 31 '1398/06/23' 26574 'B51']\n",
      "248\n",
      "t0 = 26574\n",
      "ts = 76151\n",
      "time_intervals 83\n",
      "Origin destination interval view reindex \n",
      "    time_in  time_out\n",
      "0  26574.0   27174.0\n",
      "1  28374.0   30774.0\n",
      "2  33774.0   34974.0\n",
      "3  37974.0   40374.0\n",
      "4  43974.0   44574.0\n",
      "5  48174.0   51174.0\n",
      "6  53574.0   73374.0\n",
      "OD bus stations of transactions: \n",
      "            CardID LineCode       FDate   Time  plat Station\n",
      "0       542446139        1  1398/06/23  24030  A145    3169\n",
      "1      2620656172        1  1398/06/23  24302  A145    3169\n",
      "2      3446252780        1  1398/06/23  26200  A145    1227\n",
      "3         7900260        1  1398/06/23  29677  A145    3169\n",
      "4       361857972        1  1398/06/23  29720  A145    3169\n",
      "...           ...      ...         ...    ...   ...     ...\n",
      "62624  3178526574       31  1398/06/23  72997   B51    1889\n",
      "62625  4244748711       31  1398/06/23  73292   B51    1889\n",
      "62626  2138948461       31  1398/06/23  73294   B51    1889\n",
      "62627  3675992722       31  1398/06/23  73298   B51    1889\n",
      "62628  3151128462       31  1398/06/23  73333   B51    1889\n",
      "\n",
      "[62629 rows x 6 columns]\n",
      "transactions in line 31 plat B68\n",
      "ps: \n",
      "              CardID  LineCode       FDate   Time plat\n",
      "170349   725557975        31  1398/06/23  23895  B68\n",
      "170346  2123264148        31  1398/06/23  23915  B68\n",
      "170347  4059623325        31  1398/06/23  24046  B68\n",
      "170348   645958173        31  1398/06/23  24062  B68\n",
      "170350  2590438468        31  1398/06/23  24195  B68\n",
      "170351  3446694348        31  1398/06/23  24261  B68\n",
      "170352   645958173        31  1398/06/23  24475  B68\n",
      "170353   721791635        31  1398/06/23  24561  B68\n",
      "170354  1831868669        31  1398/06/23  24563  B68\n",
      "170355   736443712        31  1398/06/23  24573  B68\n",
      "170356   185787478        31  1398/06/23  24763  B68\n",
      "170357   185787478        31  1398/06/23  24766  B68\n",
      "170358  3109145781        31  1398/06/23  24799  B68\n",
      "170359   981628091        31  1398/06/23  24935  B68\n",
      "170360  3405816227        31  1398/06/23  25161  B68\n",
      "170361  3648990356        31  1398/06/23  25384  B68\n",
      "170362  4265727746        31  1398/06/23  25458  B68\n",
      "170363  1831860765        31  1398/06/23  25460  B68\n",
      "170364  2628444548        31  1398/06/23  25524  B68\n",
      "170367  4266329650        31  1398/06/23  25528  B68\n",
      "170365   721907975        31  1398/06/23  25531  B68\n",
      "170368  1530469166        31  1398/06/23  25531  B68\n",
      "170369  1002952279        31  1398/06/23  25544  B68\n",
      "170366  4057527933        31  1398/06/23  25546  B68\n",
      "170371  3201078084        31  1398/06/23  25592  B68\n",
      "170370  2620671724        31  1398/06/23  25717  B68\n",
      "170372  4265776146        31  1398/06/23  25717  B68\n",
      "170373  3793953356        31  1398/06/23  25858  B68\n",
      "170374  3151556430        31  1398/06/23  26102  B68\n",
      "first row of the selected chunck : \n",
      " [725557975 31 '1398/06/23' 23895 'B68']\n",
      "29\n",
      "t0 = 23895\n",
      "ts = 26102\n",
      "time_intervals 4\n",
      "Origin destination interval view reindex \n",
      "    time_in  time_out\n",
      "0  23895.0   24495.0\n",
      "OD bus stations of transactions: \n",
      "            CardID LineCode       FDate   Time  plat Station\n",
      "0       542446139        1  1398/06/23  24030  A145    3169\n",
      "1      2620656172        1  1398/06/23  24302  A145    3169\n",
      "2      3446252780        1  1398/06/23  26200  A145    1227\n",
      "3         7900260        1  1398/06/23  29677  A145    3169\n",
      "4       361857972        1  1398/06/23  29720  A145    3169\n",
      "...           ...      ...         ...    ...   ...     ...\n",
      "62727  4059623325       31  1398/06/23  24046   B68    1889\n",
      "62728   645958173       31  1398/06/23  24062   B68    1889\n",
      "62729  2590438468       31  1398/06/23  24195   B68    1889\n",
      "62730  3446694348       31  1398/06/23  24261   B68    1889\n",
      "62731   645958173       31  1398/06/23  24475   B68    1889\n",
      "\n",
      "[62732 rows x 6 columns]\n",
      "transactions in line 31 plat B74\n",
      "ps: \n",
      "              CardID  LineCode       FDate   Time plat\n",
      "147204   210381515        31  1398/06/23  21676  B74\n",
      "147206  3104711102        31  1398/06/23  22024  B74\n",
      "147205  3446862860        31  1398/06/23  22102  B74\n",
      "147207  2122550628        31  1398/06/23  22141  B74\n",
      "147209   425844446        31  1398/06/23  22280  B74\n",
      "...            ...       ...         ...    ...  ...\n",
      "101105  2741877428        31  1398/06/23  73227  B74\n",
      "101106   869232470        31  1398/06/23  73229  B74\n",
      "101101  3553249420        31  1398/06/23  73314  B74\n",
      "101107  3181162190        31  1398/06/23  73872  B74\n",
      "16887    361553668        31  1398/06/23  77465  B74\n",
      "\n",
      "[638 rows x 5 columns]\n",
      "first row of the selected chunck : \n",
      " [210381515 31 '1398/06/23' 21676 'B74']\n",
      "638\n",
      "t0 = 21676\n",
      "ts = 77465\n",
      "time_intervals 93\n",
      "Origin destination interval view reindex \n",
      "     time_in  time_out\n",
      "0   21676.0   22276.0\n",
      "1   25876.0   27076.0\n",
      "2   28876.0   30676.0\n",
      "3   33076.0   34876.0\n",
      "4   37876.0   39676.0\n",
      "5   42676.0   45076.0\n",
      "6   51676.0   53476.0\n",
      "7   56476.0   57676.0\n",
      "8   59476.0   61276.0\n",
      "9   63676.0   65476.0\n",
      "10  69076.0   70276.0\n",
      "11  74476.0   77476.0\n",
      "OD bus stations of transactions: \n",
      "            CardID LineCode       FDate   Time  plat Station\n",
      "0       542446139        1  1398/06/23  24030  A145    3169\n",
      "1      2620656172        1  1398/06/23  24302  A145    3169\n",
      "2      3446252780        1  1398/06/23  26200  A145    1227\n",
      "3         7900260        1  1398/06/23  29677  A145    3169\n",
      "4       361857972        1  1398/06/23  29720  A145    3169\n",
      "...           ...      ...         ...    ...   ...     ...\n",
      "62783  2541646190       31  1398/06/23  65255   B74    3595\n",
      "62784   184532710       31  1398/06/23  65260   B74    3595\n",
      "62785   180407588       31  1398/06/23  65266   B74    3595\n",
      "62786   293436251       31  1398/06/23  70215   B74    1889\n",
      "62787   361553668       31  1398/06/23  77465   B74    3595\n",
      "\n",
      "[62788 rows x 6 columns]\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "C:\\Users\\esmaeli.h\\AppData\\Local\\Temp/ipykernel_12452/1949912630.py:257: ConvergenceWarning: Number of distinct clusters (33) found smaller than n_clusters (36). Possibly due to duplicate points in X.\n",
      "  kmeans = KMeans(n_clusters=len(filter_go_stations)-1,random_state=0).fit(partial_times.to_numpy())\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "transactions in line 31 plat B77\n",
      "ps: \n",
      "              CardID  LineCode       FDate   Time plat\n",
      "498503  3701588805        31  1398/06/23  26064  B77\n",
      "498504   985194555        31  1398/06/23  26182  B77\n",
      "498507  3649760836        31  1398/06/23  26361  B77\n",
      "498505  1002452199        31  1398/06/23  26374  B77\n",
      "498508  3630877036        31  1398/06/23  26388  B77\n",
      "...            ...       ...         ...    ...  ...\n",
      "445986   210412699        31  1398/06/23  76731  B77\n",
      "445987   210412699        31  1398/06/23  76732  B77\n",
      "445988   235334954        31  1398/06/23  76735  B77\n",
      "445989  1528787486        31  1398/06/23  76754  B77\n",
      "445990   721922390        31  1398/06/23  76947  B77\n",
      "\n",
      "[550 rows x 5 columns]\n",
      "first row of the selected chunck : \n",
      " [3701588805 31 '1398/06/23' 26064 'B77']\n",
      "550\n",
      "t0 = 26064\n",
      "ts = 76947\n",
      "time_intervals 85\n",
      "Origin destination interval view reindex \n",
      "     time_in  time_out\n",
      "0   26064.0   26664.0\n",
      "1   29664.0   30264.0\n",
      "2   32664.0   33264.0\n",
      "3   36864.0   38064.0\n",
      "4   41064.0   42864.0\n",
      "5   46464.0   47064.0\n",
      "6   50064.0   51864.0\n",
      "7   54264.0   55464.0\n",
      "8   57264.0   59064.0\n",
      "9   61464.0   62064.0\n",
      "10  65064.0   68664.0\n",
      "11  72264.0   74664.0\n",
      "OD bus stations of transactions: \n",
      "            CardID LineCode       FDate   Time  plat Station\n",
      "0       542446139        1  1398/06/23  24030  A145    3169\n",
      "1      2620656172        1  1398/06/23  24302  A145    3169\n",
      "2      3446252780        1  1398/06/23  26200  A145    1227\n",
      "3         7900260        1  1398/06/23  29677  A145    3169\n",
      "4       361857972        1  1398/06/23  29720  A145    3169\n",
      "...           ...      ...         ...    ...   ...     ...\n",
      "63302  2541636702       31  1398/06/23  74402   B77    3595\n",
      "63303  1831750957       31  1398/06/23  74441   B77    3595\n",
      "63304  3679982572       31  1398/06/23  74509   B77    3595\n",
      "63305   980507915       31  1398/06/23  74543   B77    3595\n",
      "63306   721971269       31  1398/06/23  74548   B77    3595\n",
      "\n",
      "[63307 rows x 6 columns]\n",
      "transactions in line 31 plat C20\n",
      "ps: \n",
      "              CardID  LineCode       FDate   Time plat\n",
      "196985  2239130779        31  1398/06/23  22725  C20\n",
      "196986   473914314        31  1398/06/23  22811  C20\n",
      "196987  3648924132        31  1398/06/23  23312  C20\n",
      "196988  1528906526        31  1398/06/23  23316  C20\n",
      "196989  1527223406        31  1398/06/23  23321  C20\n",
      "...            ...       ...         ...    ...  ...\n",
      "196980  2123749188        31  1398/06/23  75612  C20\n",
      "196981  2123749188        31  1398/06/23  75614  C20\n",
      "196982  2123749188        31  1398/06/23  75616  C20\n",
      "196983  2123749188        31  1398/06/23  75618  C20\n",
      "196984  2123749188        31  1398/06/23  75620  C20\n",
      "\n",
      "[570 rows x 5 columns]\n",
      "first row of the selected chunck : \n",
      " [2239130779 31 '1398/06/23' 22725 'C20']\n",
      "570\n",
      "t0 = 22725\n",
      "ts = 75620\n",
      "time_intervals 88\n",
      "Origin destination interval view reindex \n",
      "     time_in  time_out\n",
      "0   22725.0   23325.0\n",
      "1   23925.0   25125.0\n",
      "2   26325.0   28125.0\n",
      "3   30525.0   31725.0\n",
      "4   32325.0   32925.0\n",
      "5   35325.0   37125.0\n",
      "6   40125.0   40725.0\n",
      "7   44925.0   46725.0\n",
      "8   49125.0   49725.0\n",
      "9   52725.0   53925.0\n",
      "10  56925.0   58125.0\n",
      "11  60525.0   61725.0\n",
      "12  65325.0   66525.0\n",
      "13  70125.0   73725.0\n",
      "OD bus stations of transactions: \n",
      "            CardID LineCode       FDate   Time  plat Station\n",
      "0       542446139        1  1398/06/23  24030  A145    3169\n",
      "1      2620656172        1  1398/06/23  24302  A145    3169\n",
      "2      3446252780        1  1398/06/23  26200  A145    1227\n",
      "3         7900260        1  1398/06/23  29677  A145    3169\n",
      "4       361857972        1  1398/06/23  29720  A145    3169\n",
      "...           ...      ...         ...    ...   ...     ...\n",
      "63698   212053964       31  1398/06/23  73553   C20    3595\n",
      "63699  3792783692       31  1398/06/23  73627   C20    3595\n",
      "63700  3405813529       31  1398/06/23  73630   C20    3595\n",
      "63701  2239101330       31  1398/06/23  73636   C20    3595\n",
      "63702   428295374       31  1398/06/23  73723   C20    3595\n",
      "\n",
      "[63703 rows x 6 columns]\n",
      "transactions in line 31 plat C64\n",
      "ps: \n",
      "              CardID  LineCode       FDate   Time plat\n",
      "321835  3556199537        31  1398/06/23  37974  C64\n",
      "321836  3793203836        31  1398/06/23  38649  C64\n",
      "321837  3793203836        31  1398/06/23  38650  C64\n",
      "321838   362356692        31  1398/06/23  38655  C64\n",
      "321839  2742396068        31  1398/06/23  38701  C64\n",
      "...            ...       ...         ...    ...  ...\n",
      "418533  2505199300        31  1398/06/23  78436  C64\n",
      "418532   429912926        31  1398/06/23  78462  C64\n",
      "418534   722227716        31  1398/06/23  78792  C64\n",
      "321833  3603957084        31  1398/06/23  79240  C64\n",
      "321834  3603957084        31  1398/06/23  79243  C64\n",
      "\n",
      "[457 rows x 5 columns]\n",
      "first row of the selected chunck : \n",
      " [3556199537 31 '1398/06/23' 37974 'C64']\n",
      "457\n",
      "t0 = 37974\n",
      "ts = 79243\n",
      "time_intervals 69\n",
      "Origin destination interval view reindex \n",
      "    time_in  time_out\n",
      "0  37974.0   39174.0\n",
      "1  42174.0   43374.0\n",
      "2  47574.0   48174.0\n",
      "3  50574.0   52974.0\n",
      "4  55374.0   56574.0\n",
      "5  58374.0   60774.0\n",
      "6  63174.0   63774.0\n",
      "7  67374.0   69774.0\n",
      "8  72774.0   76374.0\n",
      "9  78174.0   78774.0\n",
      "OD bus stations of transactions: \n",
      "            CardID LineCode       FDate   Time  plat Station\n",
      "0       542446139        1  1398/06/23  24030  A145    3169\n",
      "1      2620656172        1  1398/06/23  24302  A145    3169\n",
      "2      3446252780        1  1398/06/23  26200  A145    1227\n",
      "3         7900260        1  1398/06/23  29677  A145    3169\n",
      "4       361857972        1  1398/06/23  29720  A145    3169\n",
      "...           ...      ...         ...    ...   ...     ...\n",
      "64152  1407239710       31  1398/06/23  78415   C64    3595\n",
      "64153  3679725852       31  1398/06/23  78419   C64    3595\n",
      "64154   428387294       31  1398/06/23  78432   C64    3595\n",
      "64155  2505199300       31  1398/06/23  78436   C64    3595\n",
      "64156   429912926       31  1398/06/23  78462   C64    3595\n",
      "\n",
      "[64157 rows x 6 columns]\n",
      "transactions in line 31 plat D80\n",
      "ps: \n",
      "              CardID  LineCode       FDate   Time plat\n",
      "530379  3629876508        31  1398/06/23  23737  D80\n",
      "530380  3794984828        31  1398/06/23  23743  D80\n",
      "530378  3996727908        31  1398/06/23  23799  D80\n",
      "530381  3629902252        31  1398/06/23  23801  D80\n",
      "530384   261581873        31  1398/06/23  23881  D80\n",
      "...            ...       ...         ...    ...  ...\n",
      "558702  3794607596        31  1398/06/23  76722  D80\n",
      "558703  3794607596        31  1398/06/23  76724  D80\n",
      "558704   113375651        31  1398/06/23  76876  D80\n",
      "530377  3679755868        31  1398/06/23  76939  D80\n",
      "558705  2137600829        31  1398/06/23  77274  D80\n",
      "\n",
      "[529 rows x 5 columns]\n",
      "first row of the selected chunck : \n",
      " [3629876508 31 '1398/06/23' 23737 'D80']\n",
      "529\n",
      "t0 = 23737\n",
      "ts = 77274\n",
      "time_intervals 89\n",
      "Origin destination interval view reindex \n",
      "     time_in  time_out\n",
      "0   23737.0   24337.0\n",
      "1   26137.0   26737.0\n",
      "2   29137.0   30337.0\n",
      "3   32737.0   33937.0\n",
      "4   36937.0   39337.0\n",
      "5   42937.0   43537.0\n",
      "6   47737.0   48937.0\n",
      "7   51337.0   52537.0\n",
      "8   54337.0   56137.0\n",
      "9   58537.0   59737.0\n",
      "10  61537.0   63937.0\n",
      "11  66937.0   69337.0\n",
      "12  71737.0   72337.0\n",
      "13  72937.0   74737.0\n",
      "14  75337.0   75937.0\n",
      "OD bus stations of transactions: \n",
      "            CardID LineCode       FDate   Time  plat Station\n",
      "0       542446139        1  1398/06/23  24030  A145    3169\n",
      "1      2620656172        1  1398/06/23  24302  A145    3169\n",
      "2      3446252780        1  1398/06/23  26200  A145    1227\n",
      "3         7900260        1  1398/06/23  29677  A145    3169\n",
      "4       361857972        1  1398/06/23  29720  A145    3169\n",
      "...           ...      ...         ...    ...   ...     ...\n",
      "64476  3679755868       31  1398/06/23  74523   D80    3595\n",
      "64477   722172247       31  1398/06/23  75364   D80    1889\n",
      "64478   721854606       31  1398/06/23  75661   D80    1889\n",
      "64479  3446120620       31  1398/06/23  75676   D80    1889\n",
      "64480  2855449102       31  1398/06/23  75731   D80    1889\n",
      "\n",
      "[64481 rows x 6 columns]\n",
      "transactions in line 31 plat E131\n",
      "ps: \n",
      "              CardID  LineCode       FDate   Time  plat\n",
      "518497  1786759012        31  1398/06/23  25576  E131\n",
      "518498  3793020508        31  1398/06/23  25796  E131\n",
      "518500   235934362        31  1398/06/23  25903  E131\n",
      "518499  3151482574        31  1398/06/23  26022  E131\n",
      "518501  1527018302        31  1398/06/23  26359  E131\n",
      "...            ...       ...         ...    ...   ...\n",
      "342519  1900304853        31  1398/06/23  37446  E131\n",
      "342520   209697675        31  1398/06/23  37450  E131\n",
      "342521  3677909884        31  1398/06/23  37631  E131\n",
      "342522  1834693565        31  1398/06/23  39250  E131\n",
      "342523  1371936974        31  1398/06/23  39253  E131\n",
      "\n",
      "[190 rows x 5 columns]\n",
      "first row of the selected chunck : \n",
      " [1786759012 31 '1398/06/23' 25576 'E131']\n",
      "190\n",
      "t0 = 25576\n",
      "ts = 39253\n",
      "time_intervals 23\n",
      "Origin destination interval view reindex \n",
      "    time_in  time_out\n",
      "0  25576.0   26176.0\n",
      "1  30976.0   31576.0\n",
      "2  35176.0   36376.0\n",
      "3  38776.0   39376.0\n",
      "OD bus stations of transactions: \n",
      "            CardID LineCode       FDate   Time  plat Station\n",
      "0       542446139        1  1398/06/23  24030  A145    3169\n",
      "1      2620656172        1  1398/06/23  24302  A145    3169\n",
      "2      3446252780        1  1398/06/23  26200  A145    1227\n",
      "3         7900260        1  1398/06/23  29677  A145    3169\n",
      "4       361857972        1  1398/06/23  29720  A145    3169\n",
      "...           ...      ...         ...    ...   ...     ...\n",
      "64702  2740650804       31  1398/06/23  31181  E131    3595\n",
      "64703  1001146558       31  1398/06/23  36100  E131    1889\n",
      "64704  1409668937       31  1398/06/23  36300  E131    1889\n",
      "64705  1834693565       31  1398/06/23  39250  E131    3595\n",
      "64706  1371936974       31  1398/06/23  39253  E131    3595\n",
      "\n",
      "[64707 rows x 6 columns]\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "transactions in line 31 plat E214\n",
      "ps: \n",
      "              CardID  LineCode       FDate   Time  plat\n",
      "34437   3792648508        31  1398/06/23  23156  E214\n",
      "34438    554954606        31  1398/06/23  23313  E214\n",
      "34439    474011290        31  1398/06/23  23462  E214\n",
      "34440    982358811        31  1398/06/23  23477  E214\n",
      "34441   4270537890        31  1398/06/23  23623  E214\n",
      "...            ...       ...         ...    ...   ...\n",
      "243763  2043911966        31  1398/06/23  73771  E214\n",
      "243764  1782184180        31  1398/06/23  73906  E214\n",
      "243765  3678840508        31  1398/06/23  73918  E214\n",
      "243766  4241564471        31  1398/06/23  74055  E214\n",
      "243767  4255614324        31  1398/06/23  74056  E214\n",
      "\n",
      "[353 rows x 5 columns]\n",
      "first row of the selected chunck : \n",
      " [3792648508 31 '1398/06/23' 23156 'E214']\n",
      "353\n",
      "t0 = 23156\n",
      "ts = 74056\n",
      "time_intervals 85\n",
      "Origin destination interval view reindex \n",
      "     time_in  time_out\n",
      "0   23156.0   23756.0\n",
      "1   24956.0   25556.0\n",
      "2   27356.0   28556.0\n",
      "3   31556.0   33356.0\n",
      "4   35756.0   37556.0\n",
      "5   40556.0   41756.0\n",
      "6   44156.0   45356.0\n",
      "7   45956.0   47756.0\n",
      "8   50156.0   50756.0\n",
      "9   53156.0   60956.0\n",
      "10  63956.0   65756.0\n",
      "11  68156.0   71756.0\n",
      "OD bus stations of transactions: \n",
      "            CardID LineCode       FDate   Time  plat Station\n",
      "0       542446139        1  1398/06/23  24030  A145    3169\n",
      "1      2620656172        1  1398/06/23  24302  A145    3169\n",
      "2      3446252780        1  1398/06/23  26200  A145    1227\n",
      "3         7900260        1  1398/06/23  29677  A145    3169\n",
      "4       361857972        1  1398/06/23  29720  A145    3169\n",
      "...           ...      ...         ...    ...   ...     ...\n",
      "64912  3208751172       31  1398/06/23  65456  E214    1889\n",
      "64913  3208751172       31  1398/06/23  65457  E214    1889\n",
      "64914   429821422       31  1398/06/23  65626  E214    1889\n",
      "64915  2125767268       31  1398/06/23  65632  E214    1889\n",
      "64916  4278541570       31  1398/06/23  71575  E214    3595\n",
      "\n",
      "[64917 rows x 6 columns]\n",
      "transactions in line 31 plat E228\n",
      "ps: \n",
      "              CardID  LineCode       FDate   Time  plat\n",
      "112374  3977417108        31  1398/06/23  59016  E228\n",
      "112378  3794241756        31  1398/06/23  59231  E228\n",
      "112379  3794241756        31  1398/06/23  59233  E228\n",
      "112375   183120406        31  1398/06/23  59351  E228\n",
      "112376   183120406        31  1398/06/23  59352  E228\n",
      "...            ...       ...         ...    ...   ...\n",
      "199260   722197474        31  1398/06/23  69748  E228\n",
      "199261   722197474        31  1398/06/23  69749  E228\n",
      "250834  3679799116        31  1398/06/23  69777  E228\n",
      "199257  2123305876        31  1398/06/23  69911  E228\n",
      "199262  2139034093        31  1398/06/23  70071  E228\n",
      "\n",
      "[139 rows x 5 columns]\n",
      "first row of the selected chunck : \n",
      " [3977417108 31 '1398/06/23' 59016 'E228']\n",
      "139\n",
      "t0 = 59016\n",
      "ts = 70071\n",
      "time_intervals 18\n",
      "Origin destination interval view reindex \n",
      "    time_in  time_out\n",
      "0  59016.0   59616.0\n",
      "1  62616.0   63216.0\n",
      "2  66216.0   68016.0\n",
      "OD bus stations of transactions: \n",
      "            CardID LineCode       FDate   Time  plat Station\n",
      "0       542446139        1  1398/06/23  24030  A145    3169\n",
      "1      2620656172        1  1398/06/23  24302  A145    3169\n",
      "2      3446252780        1  1398/06/23  26200  A145    1227\n",
      "3         7900260        1  1398/06/23  29677  A145    3169\n",
      "4       361857972        1  1398/06/23  29720  A145    3169\n",
      "...           ...      ...         ...    ...   ...     ...\n",
      "65063   209706171       31  1398/06/23  62689  E228    3595\n",
      "65064   980998859       31  1398/06/23  62835  E228    3595\n",
      "65065   722215286       31  1398/06/23  62840  E228    3595\n",
      "65066  3794865900       31  1398/06/23  67776  E228    1889\n",
      "65067  3631548012       31  1398/06/23  67965  E228    1889\n",
      "\n",
      "[65068 rows x 6 columns]\n",
      "transactions in line 31 plat F175\n",
      "ps: \n",
      "              CardID  LineCode       FDate   Time  plat\n",
      "558709  1837872845        31  1398/06/23  21948  F175\n",
      "558710  2123978164        31  1398/06/23  22063  F175\n",
      "558711  1781600020        31  1398/06/23  22107  F175\n",
      "558712   808909906        31  1398/06/23  22218  F175\n",
      "558713   173221606        31  1398/06/23  22317  F175\n",
      "558714   173221606        31  1398/06/23  22318  F175\n",
      "558715  1596918836        31  1398/06/23  22474  F175\n",
      "558716  3792027004        31  1398/06/23  22537  F175\n",
      "558717  2740831924        31  1398/06/23  22764  F175\n",
      "613085   429882206        31  1398/06/23  47212  F175\n",
      "613086   429882206        31  1398/06/23  47213  F175\n",
      "613087  2239172526        31  1398/06/23  47217  F175\n",
      "613083  1831506141        31  1398/06/23  47220  F175\n",
      "613088  3792153708        31  1398/06/23  47221  F175\n",
      "613084   737639488        31  1398/06/23  47355  F175\n",
      "613091   262206641        31  1398/06/23  47961  F175\n",
      "613089  3795048876        31  1398/06/23  47962  F175\n",
      "613090  3180638350        31  1398/06/23  48052  F175\n",
      "613092  1777606820        31  1398/06/23  48206  F175\n",
      "613093  3151744590        31  1398/06/23  48207  F175\n",
      "613094  3151744590        31  1398/06/23  48208  F175\n",
      "613095  3794970892        31  1398/06/23  48216  F175\n",
      "613096  1531643182        31  1398/06/23  48227  F175\n",
      "613097   722025510        31  1398/06/23  48385  F175\n",
      "613098   361447220        31  1398/06/23  48388  F175\n",
      "613099   342816580        31  1398/06/23  48416  F175\n",
      "613100  3405835972        31  1398/06/23  48422  F175\n",
      "613101  3405872299        31  1398/06/23  48445  F175\n",
      "613102   426511806        31  1398/06/23  48596  F175\n",
      "613103   426511806        31  1398/06/23  48597  F175\n",
      "613104   426511806        31  1398/06/23  48600  F175\n",
      "613105  1838212077        31  1398/06/23  48676  F175\n",
      "613106  1838212077        31  1398/06/23  48678  F175\n",
      "613107  2044935598        31  1398/06/23  48873  F175\n",
      "613108  2743328340        31  1398/06/23  48943  F175\n",
      "first row of the selected chunck : \n",
      " [1837872845 31 '1398/06/23' 21948 'F175']\n",
      "35\n",
      "t0 = 21948\n",
      "ts = 48943\n",
      "time_intervals 45\n",
      "Origin destination interval view reindex \n",
      "    time_in  time_out\n",
      "0  21948.0   22548.0\n",
      "1  23748.0   47748.0\n",
      "OD bus stations of transactions: \n",
      "            CardID LineCode       FDate   Time  plat Station\n",
      "0       542446139        1  1398/06/23  24030  A145    3169\n",
      "1      2620656172        1  1398/06/23  24302  A145    3169\n",
      "2      3446252780        1  1398/06/23  26200  A145    1227\n",
      "3         7900260        1  1398/06/23  29677  A145    3169\n",
      "4       361857972        1  1398/06/23  29720  A145    3169\n",
      "...           ...      ...         ...    ...   ...     ...\n",
      "65180   429882206       31  1398/06/23  47213  F175    3595\n",
      "65181  2239172526       31  1398/06/23  47217  F175    3595\n",
      "65182  1831506141       31  1398/06/23  47220  F175    3595\n",
      "65183  3792153708       31  1398/06/23  47221  F175    3595\n",
      "65184   737639488       31  1398/06/23  47355  F175    3595\n",
      "\n",
      "[65185 rows x 6 columns]\n",
      "transactions in line 31 plat F26\n",
      "ps: \n",
      "              CardID  LineCode       FDate   Time plat\n",
      "176773  1003600391        31  1398/06/23  23906  F26\n",
      "176774  3179499646        31  1398/06/23  23958  F26\n",
      "176775  3673491234        31  1398/06/23  24246  F26\n",
      "176776  2586829860        31  1398/06/23  24267  F26\n",
      "176778  2125745044        31  1398/06/23  24580  F26\n",
      "...            ...       ...         ...    ...  ...\n",
      "176768  3678874780        31  1398/06/23  78536  F26\n",
      "176769  3678874780        31  1398/06/23  78537  F26\n",
      "176770  3678874780        31  1398/06/23  78540  F26\n",
      "176771  3678874780        31  1398/06/23  78544  F26\n",
      "176772  3678874780        31  1398/06/23  78546  F26\n",
      "\n",
      "[486 rows x 5 columns]\n",
      "first row of the selected chunck : \n",
      " [1003600391 31 '1398/06/23' 23906 'F26']\n",
      "486\n",
      "t0 = 23906\n",
      "ts = 78546\n",
      "time_intervals 91\n",
      "Origin destination interval view reindex \n",
      "    time_in  time_out\n",
      "0  23906.0   24506.0\n",
      "1  26906.0   28706.0\n",
      "2  31706.0   32306.0\n",
      "3  35906.0   37106.0\n",
      "4  49706.0   50906.0\n",
      "5  54506.0   55706.0\n",
      "6  58106.0   59906.0\n",
      "7  63506.0   64106.0\n",
      "8  68906.0   69506.0\n",
      "9  74306.0   75506.0\n",
      "OD bus stations of transactions: \n",
      "            CardID LineCode       FDate   Time  plat Station\n",
      "0       542446139        1  1398/06/23  24030  A145    3169\n",
      "1      2620656172        1  1398/06/23  24302  A145    3169\n",
      "2      3446252780        1  1398/06/23  26200  A145    1227\n",
      "3         7900260        1  1398/06/23  29677  A145    3169\n",
      "4       361857972        1  1398/06/23  29720  A145    3169\n",
      "...           ...      ...         ...    ...   ...     ...\n",
      "65217  3405892850       31  1398/06/23  74938   F26    3595\n",
      "65218  3647914548       31  1398/06/23  75114   F26    3595\n",
      "65219  3647914548       31  1398/06/23  75115   F26    3595\n",
      "65220  2122366228       31  1398/06/23  75131   F26    3595\n",
      "65221  2122366228       31  1398/06/23  75134   F26    3595\n",
      "\n",
      "[65222 rows x 6 columns]\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "C:\\Users\\esmaeli.h\\AppData\\Local\\Temp/ipykernel_12452/1949912630.py:257: ConvergenceWarning: Number of distinct clusters (35) found smaller than n_clusters (36). Possibly due to duplicate points in X.\n",
      "  kmeans = KMeans(n_clusters=len(filter_go_stations)-1,random_state=0).fit(partial_times.to_numpy())\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "transactions in line 31 plat M41\n",
      "ps: \n",
      "              CardID  LineCode       FDate   Time plat\n",
      "324813   474031322        31  1398/06/23  29471  M41\n",
      "324814  2125383908        31  1398/06/23  29643  M41\n",
      "324815  3793410268        31  1398/06/23  29646  M41\n",
      "324817  2239076261        31  1398/06/23  29648  M41\n",
      "324818  3151414510        31  1398/06/23  29655  M41\n",
      "...            ...       ...         ...    ...  ...\n",
      "348716   212614060        31  1398/06/23  45601  M41\n",
      "348717   234171706        31  1398/06/23  45605  M41\n",
      "348718  3630260588        31  1398/06/23  46250  M41\n",
      "348719  2501863188        31  1398/06/23  46527  M41\n",
      "348720  2501863188        31  1398/06/23  46531  M41\n",
      "\n",
      "[135 rows x 5 columns]\n",
      "first row of the selected chunck : \n",
      " [474031322 31 '1398/06/23' 29471 'M41']\n",
      "135\n",
      "t0 = 29471\n",
      "ts = 46531\n",
      "time_intervals 28\n",
      "Origin destination interval view reindex \n",
      "    time_in  time_out\n",
      "0  29471.0   30071.0\n",
      "1  31871.0   33671.0\n",
      "2  36071.0   37271.0\n",
      "3  39671.0   40271.0\n",
      "4  40871.0   43271.0\n",
      "OD bus stations of transactions: \n",
      "            CardID LineCode       FDate   Time  plat Station\n",
      "0       542446139        1  1398/06/23  24030  A145    3169\n",
      "1      2620656172        1  1398/06/23  24302  A145    3169\n",
      "2      3446252780        1  1398/06/23  26200  A145    1227\n",
      "3         7900260        1  1398/06/23  29677  A145    3169\n",
      "4       361857972        1  1398/06/23  29720  A145    3169\n",
      "...           ...      ...         ...    ...   ...     ...\n",
      "65620  3679825100       31  1398/06/23  39899   M41    3595\n",
      "65621  3679825100       31  1398/06/23  39901   M41    3595\n",
      "65622  3679825100       31  1398/06/23  39903   M41    3595\n",
      "65623  3679825100       31  1398/06/23  39906   M41    3595\n",
      "65624  1003057303       31  1398/06/23  42848   M41    1889\n",
      "\n",
      "[65625 rows x 6 columns]\n",
      "transactions in line 31 plat M44\n",
      "ps: \n",
      "              CardID  LineCode       FDate   Time plat\n",
      "186487  3107540597        31  1398/06/23  31920  M44\n",
      "186488  3678036364        31  1398/06/23  31987  M44\n",
      "186486   982766059        31  1398/06/23  31988  M44\n",
      "186489  1530429102        31  1398/06/23  32003  M44\n",
      "186490  1530429102        31  1398/06/23  32004  M44\n",
      "...            ...       ...         ...    ...  ...\n",
      "186296  3791702060        31  1398/06/23  77565  M44\n",
      "186297  3791702060        31  1398/06/23  77566  M44\n",
      "186298  3791702060        31  1398/06/23  77568  M44\n",
      "186483  3791702060        31  1398/06/23  77570  M44\n",
      "186484  3791702060        31  1398/06/23  77574  M44\n",
      "\n",
      "[446 rows x 5 columns]\n",
      "first row of the selected chunck : \n",
      " [3107540597 31 '1398/06/23' 31920 'M44']\n",
      "446\n",
      "t0 = 31920\n",
      "ts = 77574\n",
      "time_intervals 76\n",
      "Origin destination interval view reindex \n",
      "    time_in  time_out\n",
      "0  31920.0   32520.0\n",
      "1  33720.0   38520.0\n",
      "2  41520.0   42720.0\n",
      "3  46920.0   48120.0\n",
      "4  57720.0   58320.0\n",
      "5  61320.0   62520.0\n",
      "6  67320.0   68520.0\n",
      "7  71520.0   72120.0\n",
      "8  72720.0   75120.0\n",
      "OD bus stations of transactions: \n",
      "            CardID LineCode       FDate   Time  plat Station\n",
      "0       542446139        1  1398/06/23  24030  A145    3169\n",
      "1      2620656172        1  1398/06/23  24302  A145    3169\n",
      "2      3446252780        1  1398/06/23  26200  A145    1227\n",
      "3         7900260        1  1398/06/23  29677  A145    3169\n",
      "4       361857972        1  1398/06/23  29720  A145    3169\n",
      "...           ...      ...         ...    ...   ...     ...\n",
      "65666   737495680       31  1398/06/23  71774   M44    3595\n",
      "65667  1837911261       31  1398/06/23  71880   M44    3595\n",
      "65668  3977778244       31  1398/06/23  74763   M44    1889\n",
      "65669   261845041       31  1398/06/23  75101   M44    1889\n",
      "65670   233184090       31  1398/06/23  75106   M44    1889\n",
      "\n",
      "[65671 rows x 6 columns]\n",
      "stations in a specefic bus line 32\n",
      "len-of-go stations: 14\n",
      "len-of-back stations: 15\n",
      "len-of-go back stations: 0\n",
      "first Station  [1780 '32' '1' 'go' '????? ? ???? ??????-32' 51.698955 32.609063 'od'\n",
      " 'normal' 'no'] 1780\n",
      "last Station  [1554 '32' '1' 'back' '????? ?????-61-32' 51.663816 32.618544 'od'\n",
      " 'normal' 'no']\n",
      "['E88']\n",
      "transactions in line 32 plat E88\n",
      "ps: \n",
      "              CardID  LineCode       FDate   Time plat\n",
      "89073   3680323068        32  1398/06/23  27231  E88\n",
      "89074   3630480220        32  1398/06/23  30353  E88\n",
      "89075   3630480220        32  1398/06/23  32771  E88\n",
      "89076   3444863132        32  1398/06/23  33925  E88\n",
      "89077   2507963252        32  1398/06/23  34148  E88\n",
      "89070   3680347644        32  1398/06/23  34625  E88\n",
      "89078   1626395717        32  1398/06/23  34729  E88\n",
      "89079   1838201885        32  1398/06/23  37639  E88\n",
      "157039  1524444820        32  1398/06/23  37647  E88\n",
      "157040  1524444820        32  1398/06/23  38706  E88\n",
      "157041  2741403876        32  1398/06/23  39470  E88\n",
      "157042  2741403876        32  1398/06/23  39471  E88\n",
      "157043   721897845        32  1398/06/23  41768  E88\n",
      "157045  2509070372        32  1398/06/23  45282  E88\n",
      "157046   721717354        32  1398/06/23  45547  E88\n",
      "157047  1838201885        32  1398/06/23  47038  E88\n",
      "157048   210328187        32  1398/06/23  49676  E88\n",
      "157049  3258147917        32  1398/06/23  49840  E88\n",
      "157050  2741403876        32  1398/06/23  51910  E88\n",
      "157051   426527870        32  1398/06/23  55454  E88\n",
      "157052  3104915621        32  1398/06/23  56553  E88\n",
      "157053  3104915621        32  1398/06/23  56555  E88\n",
      "157054  3210027700        32  1398/06/23  59205  E88\n",
      "157055  3794839212        32  1398/06/23  59512  E88\n",
      "157056   982085051        32  1398/06/23  59683  E88\n",
      "157057  2136978717        32  1398/06/23  61716  E88\n",
      "157058  2741595364        32  1398/06/23  62767  E88\n",
      "157059  3793396748        32  1398/06/23  63347  E88\n",
      "157060  3792596236        32  1398/06/23  64831  E88\n",
      "157061  3792596236        32  1398/06/23  64832  E88\n",
      "157062  3104915621        32  1398/06/23  66786  E88\n",
      "157064  3678550940        32  1398/06/23  67617  E88\n",
      "157065  1003266711        32  1398/06/23  68397  E88\n",
      "157066  3405893771        32  1398/06/23  70299  E88\n",
      "157067  3793421100        32  1398/06/23  71200  E88\n",
      "157068  2123065332        32  1398/06/23  71609  E88\n",
      "157069  2123065332        32  1398/06/23  71610  E88\n",
      "157070  3210027700        32  1398/06/23  72322  E88\n",
      "89071   3791726156        32  1398/06/23  73860  E88\n",
      "first row of the selected chunck : \n",
      " [3680323068 32 '1398/06/23' 27231 'E88']\n",
      "39\n",
      "t0 = 27231\n",
      "ts = 73860\n",
      "time_intervals 78\n",
      "Origin destination interval view reindex \n",
      "     time_in  time_out\n",
      "0   27231.0   30831.0\n",
      "1   31431.0   33231.0\n",
      "2   33831.0   34431.0\n",
      "3   35631.0   38031.0\n",
      "4   38631.0   39231.0\n",
      "5   40431.0   42231.0\n",
      "6   42831.0   45831.0\n",
      "7   46431.0   47631.0\n",
      "8   48231.0   50031.0\n",
      "9   50631.0   52431.0\n",
      "10  53031.0   56031.0\n",
      "11  57231.0   59631.0\n",
      "12  60831.0   62031.0\n",
      "13  62631.0   63231.0\n",
      "14  64431.0   65031.0\n",
      "15  65631.0   66831.0\n",
      "16  67431.0   68031.0\n",
      "17  69231.0   70431.0\n",
      "18  71031.0   71631.0\n",
      "19  72231.0   72831.0\n",
      "20  73431.0   74031.0\n",
      "OD bus stations of transactions: \n",
      "            CardID LineCode       FDate   Time  plat Station\n",
      "0       542446139        1  1398/06/23  24030  A145    3169\n",
      "1      2620656172        1  1398/06/23  24302  A145    3169\n",
      "2      3446252780        1  1398/06/23  26200  A145    1227\n",
      "3         7900260        1  1398/06/23  29677  A145    3169\n",
      "4       361857972        1  1398/06/23  29720  A145    3169\n",
      "...           ...      ...         ...    ...   ...     ...\n",
      "66017  3793421100       32  1398/06/23  71200   E88    1780\n",
      "66018  2123065332       32  1398/06/23  71609   E88    1780\n",
      "66019  2123065332       32  1398/06/23  71610   E88    1780\n",
      "66020  3210027700       32  1398/06/23  72322   E88    1554\n",
      "66021  3791726156       32  1398/06/23  73860   E88    1780\n",
      "\n",
      "[66022 rows x 6 columns]\n",
      "stations in a specefic bus line 33\n",
      "len-of-go stations: 12\n",
      "len-of-back stations: 11\n",
      "len-of-go back stations: 0\n",
      "first Station  [3435 '33' '1' 'go' '??? ??????-33' 51.580338 32.62075 'od' 'normal' 'no'] 3435\n",
      "last Station  [4129 '33' '1' 'back' '????? ????' 51.594699 32.613086 'normal' 'normal'\n",
      " 'no']\n",
      "['B64' 'D41' 'F90' 'M101' 'M158']\n",
      "transactions in line 33 plat B64\n",
      "ps: \n",
      "              CardID  LineCode       FDate   Time plat\n",
      "367514  2742349636        33  1398/06/23  23378  B64\n",
      "367515   262079489        33  1398/06/23  23481  B64\n",
      "367516   722108099        33  1398/06/23  23549  B64\n",
      "367517  3648625524        33  1398/06/23  23551  B64\n",
      "367518   176957190        33  1398/06/23  24259  B64\n",
      "...            ...       ...         ...    ...  ...\n",
      "473804  1529370206        33  1398/06/23  74555  B64\n",
      "473805   174430244        33  1398/06/23  74561  B64\n",
      "473806  2621662124        33  1398/06/23  74563  B64\n",
      "473802   869229281        33  1398/06/23  74571  B64\n",
      "473807  1835528221        33  1398/06/23  74577  B64\n",
      "\n",
      "[213 rows x 5 columns]\n",
      "first row of the selected chunck : \n",
      " [2742349636 33 '1398/06/23' 23378 'B64']\n",
      "213\n",
      "t0 = 23378\n",
      "ts = 74577\n",
      "time_intervals 85\n",
      "Origin destination interval view reindex \n",
      "     time_in  time_out\n",
      "0   23378.0   23978.0\n",
      "1   25178.0   25778.0\n",
      "2   28178.0   28778.0\n",
      "3   31178.0   42578.0\n",
      "4   43178.0   44978.0\n",
      "5   46778.0   47978.0\n",
      "6   48578.0   49178.0\n",
      "7   49778.0   51578.0\n",
      "8   52778.0   53978.0\n",
      "9   56378.0   64778.0\n",
      "10  66578.0   68978.0\n",
      "11  71378.0   73178.0\n",
      "12  73778.0   74378.0\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "OD bus stations of transactions: \n",
      "            CardID LineCode       FDate   Time  plat Station\n",
      "0       542446139        1  1398/06/23  24030  A145    3169\n",
      "1      2620656172        1  1398/06/23  24302  A145    3169\n",
      "2      3446252780        1  1398/06/23  26200  A145    1227\n",
      "3         7900260        1  1398/06/23  29677  A145    3169\n",
      "4       361857972        1  1398/06/23  29720  A145    3169\n",
      "...           ...      ...         ...    ...   ...     ...\n",
      "66097  3679763916       33  1398/06/23  74118   B64    3435\n",
      "66098  3679763916       33  1398/06/23  74120   B64    3435\n",
      "66099  3630030252       33  1398/06/23  74145   B64    3435\n",
      "66100   721773762       33  1398/06/23  74193   B64    3435\n",
      "66101  3152429310       33  1398/06/23  74303   B64    3435\n",
      "\n",
      "[66102 rows x 6 columns]\n",
      "transactions in line 33 plat D41\n",
      "ps: \n",
      "              CardID  LineCode       FDate   Time plat\n",
      "127754  2049444578        33  1398/06/23  21539  D41\n",
      "127751  3214261668        33  1398/06/23  21598  D41\n",
      "127752  3258328813        33  1398/06/23  21602  D41\n",
      "127753  2184065235        33  1398/06/23  21698  D41\n",
      "127755  2680066942        33  1398/06/23  21699  D41\n",
      "...            ...       ...         ...    ...  ...\n",
      "150659  2044382478        33  1398/06/23  75901  D41\n",
      "150660  3631728396        33  1398/06/23  76000  D41\n",
      "150661   722035889        33  1398/06/23  76022  D41\n",
      "150662   722035889        33  1398/06/23  76023  D41\n",
      "150663   184420630        33  1398/06/23  76338  D41\n",
      "\n",
      "[311 rows x 5 columns]\n",
      "first row of the selected chunck : \n",
      " [2049444578 33 '1398/06/23' 21539 'D41']\n",
      "311\n",
      "t0 = 21539\n",
      "ts = 76338\n",
      "time_intervals 91\n",
      "Origin destination interval view reindex \n",
      "     time_in  time_out\n",
      "0   21539.0   22139.0\n",
      "1   22739.0   23339.0\n",
      "2   24539.0   25739.0\n",
      "3   26939.0   28139.0\n",
      "4   30539.0   31139.0\n",
      "5   33539.0   35339.0\n",
      "6   37739.0   38939.0\n",
      "7   41339.0   44339.0\n",
      "8   47939.0   48539.0\n",
      "9   49739.0   51539.0\n",
      "10  52139.0   53939.0\n",
      "11  55739.0   56939.0\n",
      "12  58739.0   59939.0\n",
      "13  62339.0   64139.0\n",
      "14  65939.0   67739.0\n",
      "15  70139.0   71339.0\n",
      "16  73139.0   76139.0\n",
      "OD bus stations of transactions: \n",
      "            CardID LineCode       FDate   Time  plat Station\n",
      "0       542446139        1  1398/06/23  24030  A145    3169\n",
      "1      2620656172        1  1398/06/23  24302  A145    3169\n",
      "2      3446252780        1  1398/06/23  26200  A145    1227\n",
      "3         7900260        1  1398/06/23  29677  A145    3169\n",
      "4       361857972        1  1398/06/23  29720  A145    3169\n",
      "...           ...      ...         ...    ...   ...     ...\n",
      "66328  2044382478       33  1398/06/23  75898   D41    3435\n",
      "66329  2044382478       33  1398/06/23  75901   D41    3435\n",
      "66330  3631728396       33  1398/06/23  76000   D41    3435\n",
      "66331   722035889       33  1398/06/23  76022   D41    3435\n",
      "66332   722035889       33  1398/06/23  76023   D41    3435\n",
      "\n",
      "[66333 rows x 6 columns]\n",
      "transactions in line 33 plat F90\n",
      "ps: \n",
      "              CardID  LineCode       FDate   Time plat\n",
      "309051  2239187153        33  1398/06/23  32935  F90\n",
      "309053  3791768908        33  1398/06/23  33006  F90\n",
      "309054  2044284094        33  1398/06/23  33017  F90\n",
      "309055  3630874060        33  1398/06/23  33040  F90\n",
      "309056  2505127668        33  1398/06/23  33110  F90\n",
      "...            ...       ...         ...    ...  ...\n",
      "41656   3632211436        33  1398/06/23  73331  F90\n",
      "41657   3632211436        33  1398/06/23  73332  F90\n",
      "41658   2742349636        33  1398/06/23  73656  F90\n",
      "41659    736719600        33  1398/06/23  73782  F90\n",
      "41660    982469499        33  1398/06/23  73848  F90\n",
      "\n",
      "[249 rows x 5 columns]\n",
      "first row of the selected chunck : \n",
      " [2239187153 33 '1398/06/23' 32935 'F90']\n",
      "249\n",
      "t0 = 32935\n",
      "ts = 73848\n",
      "time_intervals 68\n",
      "Origin destination interval view reindex \n",
      "     time_in  time_out\n",
      "0   32935.0   33535.0\n",
      "1   35935.0   37135.0\n",
      "2   37735.0   38335.0\n",
      "3   38935.0   40135.0\n",
      "4   42535.0   43135.0\n",
      "5   43735.0   44335.0\n",
      "6   44935.0   46135.0\n",
      "7   46735.0   47335.0\n",
      "8   47935.0   49135.0\n",
      "9   49735.0   50335.0\n",
      "10  51535.0   52135.0\n",
      "11  54535.0   55735.0\n",
      "12  58135.0   58735.0\n",
      "13  59935.0   60535.0\n",
      "14  61135.0   62335.0\n",
      "15  63535.0   65935.0\n",
      "16  68335.0   69535.0\n",
      "17  71935.0   72535.0\n",
      "OD bus stations of transactions: \n",
      "            CardID LineCode       FDate   Time  plat Station\n",
      "0       542446139        1  1398/06/23  24030  A145    3169\n",
      "1      2620656172        1  1398/06/23  24302  A145    3169\n",
      "2      3446252780        1  1398/06/23  26200  A145    1227\n",
      "3         7900260        1  1398/06/23  29677  A145    3169\n",
      "4       361857972        1  1398/06/23  29720  A145    3169\n",
      "...           ...      ...         ...    ...   ...     ...\n",
      "66631  3184007998       33  1398/06/23  72330   F90    4129\n",
      "66632  3630720684       33  1398/06/23  72340   F90    4129\n",
      "66633   721760979       33  1398/06/23  72342   F90    4129\n",
      "66634   261637793       33  1398/06/23  72346   F90    4129\n",
      "66635  2740844564       33  1398/06/23  72365   F90    4129\n",
      "\n",
      "[66636 rows x 6 columns]\n",
      "transactions in line 33 plat M101\n",
      "ps: \n",
      "              CardID  LineCode       FDate   Time  plat\n",
      "416347  3553709020        33  1398/06/23  23441  M101\n",
      "416349  1612004261        33  1398/06/23  23890  M101\n",
      "416350   721916940        33  1398/06/23  23892  M101\n",
      "416348  3180379310        33  1398/06/23  23957  M101\n",
      "416351  3150847806        33  1398/06/23  23958  M101\n",
      "...            ...       ...         ...    ...   ...\n",
      "327628  3678895228        33  1398/06/23  74709  M101\n",
      "327629  3207932852        33  1398/06/23  74736  M101\n",
      "327630  3630981148        33  1398/06/23  75062  M101\n",
      "416345  3791731244        33  1398/06/23  75637  M101\n",
      "416346  3791731244        33  1398/06/23  75642  M101\n",
      "\n",
      "[307 rows x 5 columns]\n",
      "first row of the selected chunck : \n",
      " [3553709020 33 '1398/06/23' 23441 'M101']\n",
      "307\n",
      "t0 = 23441\n",
      "ts = 75642\n",
      "time_intervals 87\n",
      "Origin destination interval view reindex \n",
      "     time_in  time_out\n",
      "0   23441.0   24041.0\n",
      "1   25841.0   27041.0\n",
      "2   28841.0   30641.0\n",
      "3   31241.0   31841.0\n",
      "4   32441.0   33641.0\n",
      "5   36041.0   37241.0\n",
      "6   38441.0   39041.0\n",
      "7   39641.0   40841.0\n",
      "8   43241.0   43841.0\n",
      "9   46241.0   46841.0\n",
      "10  48641.0   49841.0\n",
      "11  51641.0   53441.0\n",
      "12  55241.0   56441.0\n",
      "13  57641.0   59441.0\n",
      "14  60041.0   60641.0\n",
      "15  61841.0   63041.0\n",
      "16  64841.0   66641.0\n",
      "17  69041.0   70241.0\n",
      "18  72641.0   73841.0\n",
      "19  74441.0   75041.0\n",
      "OD bus stations of transactions: \n",
      "            CardID LineCode       FDate   Time  plat Station\n",
      "0       542446139        1  1398/06/23  24030  A145    3169\n",
      "1      2620656172        1  1398/06/23  24302  A145    3169\n",
      "2      3446252780        1  1398/06/23  26200  A145    1227\n",
      "3         7900260        1  1398/06/23  29677  A145    3169\n",
      "4       361857972        1  1398/06/23  29720  A145    3169\n",
      "...           ...      ...         ...    ...   ...     ...\n",
      "66826   645405325       33  1398/06/23  74677  M101    4129\n",
      "66827   721978226       33  1398/06/23  74693  M101    4129\n",
      "66828  3675077298       33  1398/06/23  74694  M101    4129\n",
      "66829  3678895228       33  1398/06/23  74709  M101    4129\n",
      "66830  3207932852       33  1398/06/23  74736  M101    4129\n",
      "\n",
      "[66831 rows x 6 columns]\n",
      "transactions in line 33 plat M158\n",
      "ps: \n",
      "              CardID  LineCode       FDate   Time  plat\n",
      "418677   480214068        33  1398/06/23  22130  M158\n",
      "418678   980539211        33  1398/06/23  22284  M158\n",
      "418679   362101492        33  1398/06/23  22287  M158\n",
      "418680   722136282        33  1398/06/23  22352  M158\n",
      "418681  2589910324        33  1398/06/23  22354  M158\n",
      "...            ...       ...         ...    ...   ...\n",
      "473417   425979646        33  1398/06/23  76995  M158\n",
      "473418  2044664190        33  1398/06/23  77046  M158\n",
      "473419  2740844564        33  1398/06/23  77132  M158\n",
      "473420  2123696452        33  1398/06/23  77192  M158\n",
      "473421  3166413086        33  1398/06/23  77260  M158\n",
      "\n",
      "[375 rows x 5 columns]\n",
      "first row of the selected chunck : \n",
      " [480214068 33 '1398/06/23' 22130 'M158']\n",
      "375\n",
      "t0 = 22130\n",
      "ts = 77260\n",
      "time_intervals 92\n",
      "Origin destination interval view reindex \n",
      "     time_in  time_out\n",
      "0   22130.0   22730.0\n",
      "1   23930.0   25130.0\n",
      "2   26330.0   28130.0\n",
      "3   30530.0   31130.0\n",
      "4   31730.0   32330.0\n",
      "5   32930.0   33530.0\n",
      "6   37730.0   38330.0\n",
      "7   40730.0   41930.0\n",
      "8   44330.0   45530.0\n",
      "9   49130.0   49730.0\n",
      "10  50930.0   52130.0\n",
      "11  53930.0   55130.0\n",
      "12  56930.0   58130.0\n",
      "13  59930.0   61130.0\n",
      "14  63530.0   64730.0\n",
      "15  65930.0   66530.0\n",
      "16  67730.0   68330.0\n",
      "17  70730.0   71330.0\n",
      "18  71930.0   72530.0\n",
      "19  74330.0   76730.0\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "OD bus stations of transactions: \n",
      "            CardID LineCode       FDate   Time  plat Station\n",
      "0       542446139        1  1398/06/23  24030  A145    3169\n",
      "1      2620656172        1  1398/06/23  24302  A145    3169\n",
      "2      3446252780        1  1398/06/23  26200  A145    1227\n",
      "3         7900260        1  1398/06/23  29677  A145    3169\n",
      "4       361857972        1  1398/06/23  29720  A145    3169\n",
      "...           ...      ...         ...    ...   ...     ...\n",
      "67108   361439012       33  1398/06/23  76609  M158    4129\n",
      "67109  3677947996       33  1398/06/23  76616  M158    4129\n",
      "67110   721948138       33  1398/06/23  76624  M158    4129\n",
      "67111   984099531       33  1398/06/23  76695  M158    4129\n",
      "67112   984099531       33  1398/06/23  76697  M158    4129\n",
      "\n",
      "[67113 rows x 6 columns]\n",
      "stations in a specefic bus line 34\n",
      "len-of-go stations: 46\n",
      "len-of-back stations: 40\n",
      "len-of-go back stations: 0\n",
      "first Station  [4179 '34' '1' 'go' '?????? ???? ???-34' 51.602428 32.714758 'od' 'normal'\n",
      " 'yes'] 4179\n",
      "last Station  [3586 '34' '1' 'back' '?????? ???-34' 51.669836 32.589488 'od' 'normal'\n",
      " 'yes']\n",
      "['A12' 'A130' 'A38' 'A48' 'A50' 'A53' 'A59' 'B112' 'B113' 'C40' 'E179'\n",
      " 'F101' 'M104' 'M105' 'M106' 'M111' 'M113' 'M118' 'M144' 'M159' 'M169'\n",
      " 'M170' 'M177' 'M180' 'M181' 'M185' 'M186' 'M188' 'M193' 'M194' 'M197'\n",
      " 'M55' 'M82' 'M99' 'N105' 'N110' 'N124' 'N128' 'N129' 'N134' 'N136' 'N141'\n",
      " 'N15' 'N58' 'N98']\n",
      "transactions in line 34 plat A12\n",
      "ps: \n",
      "               CardID  LineCode       FDate   Time plat\n",
      "2372279  2854933982        34  1398/06/23  21357  A12\n",
      "2372282   428084878        34  1398/06/23  21372  A12\n",
      "2372285   361142868        34  1398/06/23  21601  A12\n",
      "2372288   361845572        34  1398/06/23  21666  A12\n",
      "2372291  3557756721        34  1398/06/23  21760  A12\n",
      "...             ...       ...         ...    ...  ...\n",
      "2372263  3680319692        34  1398/06/23  78002  A12\n",
      "2372267  3680319692        34  1398/06/23  78835  A12\n",
      "2372271  3680319692        34  1398/06/23  78841  A12\n",
      "2372275  3680319692        34  1398/06/23  78849  A12\n",
      "2372277  3680319692        34  1398/06/23  78852  A12\n",
      "\n",
      "[817 rows x 5 columns]\n",
      "first row of the selected chunck : \n",
      " [2854933982 34 '1398/06/23' 21357 'A12']\n",
      "817\n",
      "t0 = 21357\n",
      "ts = 78852\n",
      "time_intervals 96\n",
      "Origin destination interval view reindex \n",
      "    time_in  time_out\n",
      "0  21357.0   21957.0\n",
      "1  23157.0   25557.0\n",
      "2  29757.0   30357.0\n",
      "3  36357.0   36957.0\n",
      "4  41757.0   44157.0\n",
      "5  48957.0   51357.0\n",
      "6  54957.0   57357.0\n",
      "7  61557.0   65157.0\n",
      "8  69957.0   74157.0\n",
      "OD bus stations of transactions: \n",
      "            CardID LineCode       FDate   Time  plat Station\n",
      "0       542446139        1  1398/06/23  24030  A145    3169\n",
      "1      2620656172        1  1398/06/23  24302  A145    3169\n",
      "2      3446252780        1  1398/06/23  26200  A145    1227\n",
      "3         7900260        1  1398/06/23  29677  A145    3169\n",
      "4       361857972        1  1398/06/23  29720  A145    3169\n",
      "...           ...      ...         ...    ...   ...     ...\n",
      "67340  2491173684       34  1398/06/23  65041   A12    3586\n",
      "67341   722089712       34  1398/06/23  65078   A12    3586\n",
      "67342   869337137       34  1398/06/23  65094   A12    3586\n",
      "67343  2741793300       34  1398/06/23  73836   A12    4179\n",
      "67344  3699842325       34  1398/06/23  73838   A12    4179\n",
      "\n",
      "[67345 rows x 6 columns]\n",
      "transactions in line 34 plat A130\n",
      "ps: \n",
      "              CardID  LineCode       FDate   Time  plat\n",
      "188973  3405886612        34  1398/06/23  23811  A130\n",
      "188974   721765905        34  1398/06/23  23904  A130\n",
      "188975  3629871260        34  1398/06/23  24077  A130\n",
      "188978  3818880453        34  1398/06/23  24157  A130\n",
      "188979   343037353        34  1398/06/23  24158  A130\n",
      "...            ...       ...         ...    ...   ...\n",
      "188971  3679856844        34  1398/06/23  74789  A130\n",
      "188972  3679856844        34  1398/06/23  74791  A130\n",
      "238004  1528107086        34  1398/06/23  74989  A130\n",
      "238006  3630081388        34  1398/06/23  75299  A130\n",
      "238007   981888619        34  1398/06/23  75825  A130\n",
      "\n",
      "[637 rows x 5 columns]\n",
      "first row of the selected chunck : \n",
      " [3405886612 34 '1398/06/23' 23811 'A130']\n",
      "637\n",
      "t0 = 23811\n",
      "ts = 75825\n",
      "time_intervals 87\n",
      "Origin destination interval view reindex \n",
      "    time_in  time_out\n",
      "0  23811.0   24411.0\n",
      "1  28011.0   29211.0\n",
      "2  32811.0   33411.0\n",
      "3  34011.0   35211.0\n",
      "4  40611.0   42411.0\n",
      "5  47811.0   49611.0\n",
      "6  53211.0   55611.0\n",
      "7  59811.0   64011.0\n",
      "8  68211.0   73011.0\n",
      "OD bus stations of transactions: \n",
      "            CardID LineCode       FDate   Time  plat Station\n",
      "0       542446139        1  1398/06/23  24030  A145    3169\n",
      "1      2620656172        1  1398/06/23  24302  A145    3169\n",
      "2      3446252780        1  1398/06/23  26200  A145    1227\n",
      "3         7900260        1  1398/06/23  29677  A145    3169\n",
      "4       361857972        1  1398/06/23  29720  A145    3169\n",
      "...           ...      ...         ...    ...   ...     ...\n",
      "68036   722144841       34  1398/06/23  72971  A130    4179\n",
      "68037  3630526652       34  1398/06/23  72975  A130    4179\n",
      "68038  3630526652       34  1398/06/23  72976  A130    4179\n",
      "68039   426421854       34  1398/06/23  72979  A130    4179\n",
      "68040   426421854       34  1398/06/23  72980  A130    4179\n",
      "\n",
      "[68041 rows x 6 columns]\n",
      "transactions in line 34 plat A38\n",
      "ps: \n",
      "              CardID  LineCode       FDate   Time plat\n",
      "150694  2618355868        34  1398/06/23  20807  A38\n",
      "150695   261203073        34  1398/06/23  20899  A38\n",
      "150696   173837622        34  1398/06/23  20934  A38\n",
      "150697  1528047870        34  1398/06/23  21064  A38\n",
      "150700  3792971404        34  1398/06/23  21082  A38\n",
      "...            ...       ...         ...    ...  ...\n",
      "551114  3679899708        34  1398/06/23  79575  A38\n",
      "551115  3679899708        34  1398/06/23  79588  A38\n",
      "551116  3679899708        34  1398/06/23  79590  A38\n",
      "551117  3679899708        34  1398/06/23  79592  A38\n",
      "551118  3679899708        34  1398/06/23  79594  A38\n",
      "\n",
      "[4031 rows x 5 columns]\n",
      "first row of the selected chunck : \n",
      " [2618355868 34 '1398/06/23' 20807 'A38']\n",
      "4031\n",
      "t0 = 20807\n",
      "ts = 79594\n",
      "time_intervals 98\n",
      "Origin destination interval view reindex \n",
      "    time_in  time_out\n",
      "0  20807.0   21407.0\n",
      "OD bus stations of transactions: \n",
      "            CardID LineCode       FDate   Time  plat Station\n",
      "0       542446139        1  1398/06/23  24030  A145    3169\n",
      "1      2620656172        1  1398/06/23  24302  A145    3169\n",
      "2      3446252780        1  1398/06/23  26200  A145    1227\n",
      "3         7900260        1  1398/06/23  29677  A145    3169\n",
      "4       361857972        1  1398/06/23  29720  A145    3169\n",
      "...           ...      ...         ...    ...   ...     ...\n",
      "68528  1528047870       34  1398/06/23  21064   A38    4179\n",
      "68529  3792971404       34  1398/06/23  21082   A38    4179\n",
      "68530   186587222       34  1398/06/23  21121   A38    4179\n",
      "68531  4276653778       34  1398/06/23  21130   A38    4179\n",
      "68532   173092246       34  1398/06/23  21337   A38    4179\n",
      "\n",
      "[68533 rows x 6 columns]\n",
      "transactions in line 34 plat A48\n",
      "ps: \n",
      "              CardID  LineCode       FDate   Time plat\n",
      "692682  2129412548        34  1398/06/23  43785  A48\n",
      "692683   722130780        34  1398/06/23  43791  A48\n",
      "692684   722130780        34  1398/06/23  43793  A48\n",
      "692685  3107174453        34  1398/06/23  43802  A48\n",
      "692686  3794960076        34  1398/06/23  43804  A48\n",
      "...            ...       ...         ...    ...  ...\n",
      "692899   550792901        34  1398/06/23  51979  A48\n",
      "114575  1284018782        34  1398/06/23  52382  A48\n",
      "114576   981863771        34  1398/06/23  52786  A48\n",
      "114577  1524496036        34  1398/06/23  52789  A48\n",
      "114578  2742200244        34  1398/06/23  52790  A48\n",
      "\n",
      "[112 rows x 5 columns]\n",
      "first row of the selected chunck : \n",
      " [2129412548 34 '1398/06/23' 43785 'A48']\n",
      "112\n",
      "t0 = 43785\n",
      "ts = 52790\n",
      "time_intervals 15\n",
      "Origin destination interval view reindex \n",
      "    time_in  time_out\n",
      "0  43785.0   44385.0\n",
      "1  47385.0   49785.0\n",
      "OD bus stations of transactions: \n",
      "            CardID LineCode       FDate   Time  plat Station\n",
      "0       542446139        1  1398/06/23  24030  A145    3169\n",
      "1      2620656172        1  1398/06/23  24302  A145    3169\n",
      "2      3446252780        1  1398/06/23  26200  A145    1227\n",
      "3         7900260        1  1398/06/23  29677  A145    3169\n",
      "4       361857972        1  1398/06/23  29720  A145    3169\n",
      "...           ...      ...         ...    ...   ...     ...\n",
      "68570   175356022       34  1398/06/23  49576   A48    3586\n",
      "68571  3108795573       34  1398/06/23  49577   A48    3586\n",
      "68572  1360642362       34  1398/06/23  49661   A48    3586\n",
      "68573  1291767934       34  1398/06/23  49666   A48    3586\n",
      "68574  4246533175       34  1398/06/23  49682   A48    3586\n",
      "\n",
      "[68575 rows x 6 columns]\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "transactions in line 34 plat A50\n",
      "ps: \n",
      "              CardID  LineCode       FDate   Time plat\n",
      "123378  3183109774        34  1398/06/23  26705  A50\n",
      "123417  3679770460        34  1398/06/23  26705  A50\n",
      "123420  1001873918        34  1398/06/23  26706  A50\n",
      "123380  2138934605        34  1398/06/23  26708  A50\n",
      "123423  4276193282        34  1398/06/23  26708  A50\n",
      "...            ...       ...         ...    ...  ...\n",
      "227024  3630974140        34  1398/06/23  37192  A50\n",
      "227029  2741560068        34  1398/06/23  41397  A50\n",
      "227032  2137067325        34  1398/06/23  41630  A50\n",
      "227036  3680072636        34  1398/06/23  42087  A50\n",
      "227038  3680072636        34  1398/06/23  42090  A50\n",
      "\n",
      "[228 rows x 5 columns]\n",
      "first row of the selected chunck : \n",
      " [3183109774 34 '1398/06/23' 26705 'A50']\n",
      "228\n",
      "t0 = 26705\n",
      "ts = 42090\n",
      "time_intervals 26\n",
      "Origin destination interval view reindex \n",
      "    time_in  time_out\n",
      "0  26705.0   27305.0\n",
      "1  29105.0   29705.0\n",
      "2  30305.0   32705.0\n",
      "3  38105.0   41705.0\n",
      "OD bus stations of transactions: \n",
      "            CardID LineCode       FDate   Time  plat Station\n",
      "0       542446139        1  1398/06/23  24030  A145    3169\n",
      "1      2620656172        1  1398/06/23  24302  A145    3169\n",
      "2      3446252780        1  1398/06/23  26200  A145    1227\n",
      "3         7900260        1  1398/06/23  29677  A145    3169\n",
      "4       361857972        1  1398/06/23  29720  A145    3169\n",
      "...           ...      ...         ...    ...   ...     ...\n",
      "68642  1765019732       34  1398/06/23  32361   A50    4179\n",
      "68643  3405875506       34  1398/06/23  32588   A50    4179\n",
      "68644  3677539180       34  1398/06/23  32611   A50    4179\n",
      "68645  2741560068       34  1398/06/23  41397   A50    3586\n",
      "68646  2137067325       34  1398/06/23  41630   A50    3586\n",
      "\n",
      "[68647 rows x 6 columns]\n",
      "transactions in line 34 plat A53\n",
      "ps: \n",
      "              CardID  LineCode       FDate   Time plat\n",
      "230280  2586900916        34  1398/06/23  22187  A53\n",
      "230281  1213783454        34  1398/06/23  22266  A53\n",
      "230282  3104655598        34  1398/06/23  22269  A53\n",
      "230283  1765037284        34  1398/06/23  22278  A53\n",
      "230284  4275861106        34  1398/06/23  22396  A53\n",
      "...            ...       ...         ...    ...  ...\n",
      "252654  2541130574        34  1398/06/23  75781  A53\n",
      "230279  3791728652        34  1398/06/23  75899  A53\n",
      "252655   212205164        34  1398/06/23  76128  A53\n",
      "252657   982111307        34  1398/06/23  76286  A53\n",
      "252656  2136729421        34  1398/06/23  76363  A53\n",
      "\n",
      "[748 rows x 5 columns]\n",
      "first row of the selected chunck : \n",
      " [2586900916 34 '1398/06/23' 22187 'A53']\n",
      "748\n",
      "t0 = 22187\n",
      "ts = 76363\n",
      "time_intervals 90\n",
      "Origin destination interval view reindex \n",
      "    time_in  time_out\n",
      "0  22187.0   22787.0\n",
      "1  23987.0   25187.0\n",
      "2  28787.0   30587.0\n",
      "3  35387.0   36587.0\n",
      "4  41387.0   43787.0\n",
      "5  49187.0   50387.0\n",
      "6  54587.0   56987.0\n",
      "7  61187.0   64787.0\n",
      "8  68987.0   73187.0\n",
      "OD bus stations of transactions: \n",
      "            CardID LineCode       FDate   Time  plat Station\n",
      "0       542446139        1  1398/06/23  24030  A145    3169\n",
      "1      2620656172        1  1398/06/23  24302  A145    3169\n",
      "2      3446252780        1  1398/06/23  26200  A145    1227\n",
      "3         7900260        1  1398/06/23  29677  A145    3169\n",
      "4       361857972        1  1398/06/23  29720  A145    3169\n",
      "...           ...      ...         ...    ...   ...     ...\n",
      "68808   300727131       34  1398/06/23  64656   A53    3586\n",
      "68809  2137773469       34  1398/06/23  64662   A53    3586\n",
      "68810   722220323       34  1398/06/23  64664   A53    3586\n",
      "68811  1788899636       34  1398/06/23  64776   A53    3586\n",
      "68812  1002091703       34  1398/06/23  73093   A53    4179\n",
      "\n",
      "[68813 rows x 6 columns]\n",
      "transactions in line 34 plat A59\n",
      "ps: \n",
      "              CardID  LineCode       FDate   Time plat\n",
      "73334   3679868300        34  1398/06/23  24397  A59\n",
      "73345   1765070804        34  1398/06/23  24447  A59\n",
      "73346   4245858599        34  1398/06/23  24607  A59\n",
      "73347   3210385636        34  1398/06/23  24609  A59\n",
      "73348   2586426148        34  1398/06/23  24611  A59\n",
      "...            ...       ...         ...    ...  ...\n",
      "230244  1598767060        34  1398/06/23  75145  A59\n",
      "229842  3151805422        34  1398/06/23  75146  A59\n",
      "230245  1213800670        34  1398/06/23  75183  A59\n",
      "230246  1371195582        34  1398/06/23  75848  A59\n",
      "230247  1611394955        34  1398/06/23  75850  A59\n",
      "\n",
      "[392 rows x 5 columns]\n",
      "first row of the selected chunck : \n",
      " [3679868300 34 '1398/06/23' 24397 'A59']\n",
      "392\n",
      "t0 = 24397\n",
      "ts = 75850\n",
      "time_intervals 86\n",
      "Origin destination interval view reindex \n",
      "    time_in  time_out\n",
      "0  24397.0   24997.0\n",
      "1  27997.0   29797.0\n",
      "2  33997.0   50797.0\n",
      "3  53197.0   56197.0\n",
      "4  58597.0   63997.0\n",
      "5  67597.0   68197.0\n",
      "6  68797.0   73597.0\n",
      "OD bus stations of transactions: \n",
      "            CardID LineCode       FDate   Time  plat Station\n",
      "0       542446139        1  1398/06/23  24030  A145    3169\n",
      "1      2620656172        1  1398/06/23  24302  A145    3169\n",
      "2      3446252780        1  1398/06/23  26200  A145    1227\n",
      "3         7900260        1  1398/06/23  29677  A145    3169\n",
      "4       361857972        1  1398/06/23  29720  A145    3169\n",
      "...           ...      ...         ...    ...   ...     ...\n",
      "69500  3258445485       34  1398/06/23  73526   A59    4179\n",
      "69501   805642530       34  1398/06/23  73533   A59    4179\n",
      "69502  2036145252       34  1398/06/23  73535   A59    4179\n",
      "69503  4279050146       34  1398/06/23  73538   A59    4179\n",
      "69504  4279050146       34  1398/06/23  73539   A59    4179\n",
      "\n",
      "[69505 rows x 6 columns]\n",
      "transactions in line 34 plat B112\n",
      "ps: \n",
      "               CardID  LineCode       FDate   Time  plat\n",
      "2715288  1002923383        34  1398/06/23  22720  B112\n",
      "2715292   234295770        34  1398/06/23  23047  B112\n",
      "2715297  3179430334        34  1398/06/23  23060  B112\n",
      "2715301  3553911788        34  1398/06/23  23120  B112\n",
      "2715304  2117995572        34  1398/06/23  23259  B112\n",
      "...             ...       ...         ...    ...   ...\n",
      "244543    261876209        34  1398/06/23  74527  B112\n",
      "244547    261876209        34  1398/06/23  74528  B112\n",
      "2715274  3678827292        34  1398/06/23  76612  B112\n",
      "2715279  3678827292        34  1398/06/23  76614  B112\n",
      "2715284  3678827292        34  1398/06/23  76617  B112\n",
      "\n",
      "[744 rows x 5 columns]\n",
      "first row of the selected chunck : \n",
      " [1002923383 34 '1398/06/23' 22720 'B112']\n",
      "744\n",
      "t0 = 22720\n",
      "ts = 76617\n",
      "time_intervals 90\n",
      "Origin destination interval view reindex \n",
      "    time_in  time_out\n",
      "0  22720.0   23320.0\n",
      "1  26920.0   28120.0\n",
      "2  31720.0   33520.0\n",
      "3  38320.0   40720.0\n",
      "4  44920.0   47920.0\n",
      "5  52120.0   54520.0\n",
      "6  58120.0   62320.0\n",
      "7  67120.0   70120.0\n",
      "8  75520.0   76720.0\n",
      "OD bus stations of transactions: \n",
      "            CardID LineCode       FDate   Time  plat Station\n",
      "0       542446139        1  1398/06/23  24030  A145    3169\n",
      "1      2620656172        1  1398/06/23  24302  A145    3169\n",
      "2      3446252780        1  1398/06/23  26200  A145    1227\n",
      "3         7900260        1  1398/06/23  29677  A145    3169\n",
      "4       361857972        1  1398/06/23  29720  A145    3169\n",
      "...           ...      ...         ...    ...   ...     ...\n",
      "69775  1598837764       34  1398/06/23  69908  B112    3586\n",
      "69776  3677832732       34  1398/06/23  69980  B112    3586\n",
      "69777  3678827292       34  1398/06/23  76612  B112    4179\n",
      "69778  3678827292       34  1398/06/23  76614  B112    4179\n",
      "69779  3678827292       34  1398/06/23  76617  B112    4179\n",
      "\n",
      "[69780 rows x 6 columns]\n",
      "transactions in line 34 plat B113\n",
      "ps: \n",
      "              CardID  LineCode       FDate   Time  plat\n",
      "234026  3405933273        34  1398/06/23  22448  B113\n",
      "234027  2505358596        34  1398/06/23  22462  B113\n",
      "234028  1529880734        34  1398/06/23  22481  B113\n",
      "234029  2681843070        34  1398/06/23  22544  B113\n",
      "234030  2482456164        34  1398/06/23  22556  B113\n",
      "...            ...       ...         ...    ...   ...\n",
      "133466  3206053668        34  1398/06/23  74115  B113\n",
      "133467  3206053668        34  1398/06/23  74116  B113\n",
      "133468  1598233300        34  1398/06/23  74134  B113\n",
      "133469  3646320532        34  1398/06/23  74144  B113\n",
      "133470  3646320532        34  1398/06/23  74146  B113\n",
      "\n",
      "[703 rows x 5 columns]\n",
      "first row of the selected chunck : \n",
      " [3405933273 34 '1398/06/23' 22448 'B113']\n",
      "703\n",
      "t0 = 22448\n",
      "ts = 74146\n",
      "time_intervals 86\n",
      "Origin destination interval view reindex \n",
      "    time_in  time_out\n",
      "0  22448.0   23048.0\n",
      "1  26048.0   29648.0\n",
      "2  33848.0   35648.0\n",
      "3  41048.0   41648.0\n",
      "4  47048.0   48248.0\n",
      "5  52448.0   55448.0\n",
      "6  59648.0   62048.0\n",
      "7  66848.0   69848.0\n",
      "8  70448.0   71048.0\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "OD bus stations of transactions: \n",
      "            CardID LineCode       FDate   Time  plat Station\n",
      "0       542446139        1  1398/06/23  24030  A145    3169\n",
      "1      2620656172        1  1398/06/23  24302  A145    3169\n",
      "2      3446252780        1  1398/06/23  26200  A145    1227\n",
      "3         7900260        1  1398/06/23  29677  A145    3169\n",
      "4       361857972        1  1398/06/23  29720  A145    3169\n",
      "...           ...      ...         ...    ...   ...     ...\n",
      "70519  4266532786       34  1398/06/23  69519  B113    3586\n",
      "70520  3258383901       34  1398/06/23  69770  B113    3586\n",
      "70521  2183638707       34  1398/06/23  70522  B113    4179\n",
      "70522  3258015725       34  1398/06/23  70841  B113    4179\n",
      "70523  4265808514       34  1398/06/23  70844  B113    4179\n",
      "\n",
      "[70524 rows x 6 columns]\n",
      "transactions in line 34 plat C40\n",
      "ps: \n",
      "             CardID  LineCode       FDate   Time plat\n",
      "92385  2482464180        34  1398/06/23  70972  C40\n",
      "92958  2590627636        34  1398/06/23  71017  C40\n",
      "92959   428690238        34  1398/06/23  71021  C40\n",
      "92960   428690238        34  1398/06/23  71022  C40\n",
      "92961   428690238        34  1398/06/23  71023  C40\n",
      "92962  2235384835        34  1398/06/23  71034  C40\n",
      "92963  3792484476        34  1398/06/23  71037  C40\n",
      "92964   474071482        34  1398/06/23  71039  C40\n",
      "92966  3649866036        34  1398/06/23  71041  C40\n",
      "92967   174680998        34  1398/06/23  71063  C40\n",
      "92968   174680998        34  1398/06/23  71065  C40\n",
      "92965  3791825788        34  1398/06/23  71208  C40\n",
      "92969  4269918498        34  1398/06/23  71306  C40\n",
      "92970  4269918498        34  1398/06/23  71307  C40\n",
      "92971  2741326980        34  1398/06/23  71403  C40\n",
      "92973  3649224388        34  1398/06/23  71585  C40\n",
      "92972  2741439252        34  1398/06/23  71675  C40\n",
      "92974  3151191134        34  1398/06/23  71726  C40\n",
      "92975  3151191134        34  1398/06/23  71728  C40\n",
      "92976  1832359293        34  1398/06/23  71759  C40\n",
      "92977  2505699780        34  1398/06/23  71766  C40\n",
      "92978  2505699780        34  1398/06/23  71770  C40\n",
      "92979  4270184530        34  1398/06/23  71907  C40\n",
      "92980  3794035084        34  1398/06/23  72154  C40\n",
      "92981  1530616414        34  1398/06/23  72160  C40\n",
      "92982  1001258286        34  1398/06/23  72367  C40\n",
      "92983  1550141845        34  1398/06/23  72370  C40\n",
      "92984   105732147        34  1398/06/23  72373  C40\n",
      "92986  3679981788        34  1398/06/23  72520  C40\n",
      "92987  3679981788        34  1398/06/23  72522  C40\n",
      "92988   361882756        34  1398/06/23  72525  C40\n",
      "92985  3207630980        34  1398/06/23  72670  C40\n",
      "92989   996616702        34  1398/06/23  72687  C40\n",
      "92990   996616702        34  1398/06/23  72688  C40\n",
      "92991   983122011        34  1398/06/23  73110  C40\n",
      "92992   710022565        34  1398/06/23  73112  C40\n",
      "92993  2855563566        34  1398/06/23  73116  C40\n",
      "92994  2855563566        34  1398/06/23  73117  C40\n",
      "92995  4059386509        34  1398/06/23  73121  C40\n",
      "92996  2680134062        34  1398/06/23  73126  C40\n",
      "92383  3792427020        34  1398/06/23  75406  C40\n",
      "92384  3792427020        34  1398/06/23  75408  C40\n",
      "first row of the selected chunck : \n",
      " [2482464180 34 '1398/06/23' 70972 'C40']\n",
      "42\n",
      "t0 = 70972\n",
      "ts = 75408\n",
      "time_intervals 7\n",
      "Origin destination interval view reindex \n",
      "    time_in  time_out\n",
      "0  70972.0   71572.0\n",
      "1  73972.0   75172.0\n",
      "OD bus stations of transactions: \n",
      "            CardID LineCode       FDate   Time  plat Station\n",
      "0       542446139        1  1398/06/23  24030  A145    3169\n",
      "1      2620656172        1  1398/06/23  24302  A145    3169\n",
      "2      3446252780        1  1398/06/23  26200  A145    1227\n",
      "3         7900260        1  1398/06/23  29677  A145    3169\n",
      "4       361857972        1  1398/06/23  29720  A145    3169\n",
      "...           ...      ...         ...    ...   ...     ...\n",
      "71086   174680998       34  1398/06/23  71065   C40    4179\n",
      "71087  3791825788       34  1398/06/23  71208   C40    4179\n",
      "71088  4269918498       34  1398/06/23  71306   C40    4179\n",
      "71089  4269918498       34  1398/06/23  71307   C40    4179\n",
      "71090  2741326980       34  1398/06/23  71403   C40    4179\n",
      "\n",
      "[71091 rows x 6 columns]\n",
      "transactions in line 34 plat E179\n",
      "ps: \n",
      "              CardID  LineCode       FDate   Time  plat\n",
      "622856   555821998        34  1398/06/23  21610  E179\n",
      "622857  2123285844        34  1398/06/23  21740  E179\n",
      "622858  2590346916        34  1398/06/23  21750  E179\n",
      "622859  3559246849        34  1398/06/23  21794  E179\n",
      "622860   710186053        34  1398/06/23  21810  E179\n",
      "...            ...       ...         ...    ...   ...\n",
      "543161  2045247358        34  1398/06/23  72027  E179\n",
      "543162  3678129324        34  1398/06/23  72122  E179\n",
      "543163  3678129324        34  1398/06/23  72123  E179\n",
      "543164  3949248082        34  1398/06/23  72248  E179\n",
      "543165   983870347        34  1398/06/23  72251  E179\n",
      "\n",
      "[528 rows x 5 columns]\n",
      "first row of the selected chunck : \n",
      " [555821998 34 '1398/06/23' 21610 'E179']\n",
      "528\n",
      "t0 = 21610\n",
      "ts = 72251\n",
      "time_intervals 84\n",
      "Origin destination interval view reindex \n",
      "    time_in  time_out\n",
      "0  21610.0   22210.0\n",
      "1  23410.0   28210.0\n",
      "2  32410.0   34810.0\n",
      "3  39610.0   40810.0\n",
      "4  45610.0   47410.0\n",
      "5  51010.0   54610.0\n",
      "6  58810.0   60610.0\n",
      "7  65410.0   67810.0\n",
      "OD bus stations of transactions: \n",
      "            CardID LineCode       FDate   Time  plat Station\n",
      "0       542446139        1  1398/06/23  24030  A145    3169\n",
      "1      2620656172        1  1398/06/23  24302  A145    3169\n",
      "2      3446252780        1  1398/06/23  26200  A145    1227\n",
      "3         7900260        1  1398/06/23  29677  A145    3169\n",
      "4       361857972        1  1398/06/23  29720  A145    3169\n",
      "...           ...      ...         ...    ...   ...     ...\n",
      "71146   177385030       34  1398/06/23  60379  E179    4179\n",
      "71147  2137138509       34  1398/06/23  60412  E179    4179\n",
      "71148  2045194254       34  1398/06/23  60477  E179    4179\n",
      "71149  3214042932       34  1398/06/23  60528  E179    4179\n",
      "71150  1775746756       34  1398/06/23  67768  E179    3586\n",
      "\n",
      "[71151 rows x 6 columns]\n",
      "transactions in line 34 plat F101\n",
      "ps: \n",
      "             CardID  LineCode       FDate   Time  plat\n",
      "84895  3679669468        34  1398/06/23  30378  F101\n",
      "84896  3180015582        34  1398/06/23  30380  F101\n",
      "84880  4244787431        34  1398/06/23  30383  F101\n",
      "84897  1527644542        34  1398/06/23  30383  F101\n",
      "84903  1832647933        34  1398/06/23  30385  F101\n",
      "...           ...       ...         ...    ...   ...\n",
      "85342  1837790797        34  1398/06/23  31609  F101\n",
      "85403  2239174390        34  1398/06/23  31652  F101\n",
      "85406  2232622019        34  1398/06/23  31834  F101\n",
      "84873   484341300        34  1398/06/23  46888  F101\n",
      "84877   484341300        34  1398/06/23  46890  F101\n",
      "\n",
      "[87 rows x 5 columns]\n",
      "first row of the selected chunck : \n",
      " [3679669468 34 '1398/06/23' 30378 'F101']\n",
      "87\n",
      "t0 = 30378\n",
      "ts = 46890\n",
      "time_intervals 28\n",
      "Origin destination interval view reindex \n",
      "    time_in  time_out\n",
      "0  30378.0   30978.0\n",
      "1  32778.0   47178.0\n",
      "OD bus stations of transactions: \n",
      "            CardID LineCode       FDate   Time  plat Station\n",
      "0       542446139        1  1398/06/23  24030  A145    3169\n",
      "1      2620656172        1  1398/06/23  24302  A145    3169\n",
      "2      3446252780        1  1398/06/23  26200  A145    1227\n",
      "3         7900260        1  1398/06/23  29677  A145    3169\n",
      "4       361857972        1  1398/06/23  29720  A145    3169\n",
      "...           ...      ...         ...    ...   ...     ...\n",
      "71541   869242471       34  1398/06/23  30857  F101    4179\n",
      "71542  3205023541       34  1398/06/23  30934  F101    4179\n",
      "71543  3151390702       34  1398/06/23  30936  F101    4179\n",
      "71544   484341300       34  1398/06/23  46888  F101    3586\n",
      "71545   484341300       34  1398/06/23  46890  F101    3586\n",
      "\n",
      "[71546 rows x 6 columns]\n",
      "transactions in line 34 plat M104\n",
      "ps: \n",
      "              CardID  LineCode       FDate   Time  plat\n",
      "252915  3207205716        34  1398/06/23  26152  M104\n",
      "252916  4279263778        34  1398/06/23  26427  M104\n",
      "252660  1610926763        34  1398/06/23  26587  M104\n",
      "252917  2038236362        34  1398/06/23  26743  M104\n",
      "252921   722141509        34  1398/06/23  26743  M104\n",
      "...            ...       ...         ...    ...   ...\n",
      "105000   473694570        34  1398/06/23  49802  M104\n",
      "105001   538054334        34  1398/06/23  49804  M104\n",
      "105002  3997313796        34  1398/06/23  49807  M104\n",
      "104998   428479854        34  1398/06/23  49823  M104\n",
      "104999  1292383774        34  1398/06/23  49826  M104\n",
      "\n",
      "[399 rows x 5 columns]\n",
      "first row of the selected chunck : \n",
      " [3207205716 34 '1398/06/23' 26152 'M104']\n",
      "399\n",
      "t0 = 26152\n",
      "ts = 49826\n",
      "time_intervals 39\n",
      "Origin destination interval view reindex \n",
      "    time_in  time_out\n",
      "0  26152.0   26752.0\n",
      "1  30352.0   32152.0\n",
      "2  36952.0   38152.0\n",
      "3  43552.0   45352.0\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "OD bus stations of transactions: \n",
      "            CardID LineCode       FDate   Time  plat Station\n",
      "0       542446139        1  1398/06/23  24030  A145    3169\n",
      "1      2620656172        1  1398/06/23  24302  A145    3169\n",
      "2      3446252780        1  1398/06/23  26200  A145    1227\n",
      "3         7900260        1  1398/06/23  29677  A145    3169\n",
      "4       361857972        1  1398/06/23  29720  A145    3169\n",
      "...           ...      ...         ...    ...   ...     ...\n",
      "71568  3405806955       34  1398/06/23  37912  M104    4179\n",
      "71569  3257428269       34  1398/06/23  37917  M104    4179\n",
      "71570  2677982276       34  1398/06/23  44951  M104    3586\n",
      "71571  3558370625       34  1398/06/23  45148  M104    3586\n",
      "71572  1610926763       34  1398/06/23  45229  M104    3586\n",
      "\n",
      "[71573 rows x 6 columns]\n",
      "transactions in line 34 plat M105\n",
      "ps: \n",
      "              CardID  LineCode       FDate   Time  plat\n",
      "285521  3152262318        34  1398/06/23  33108  M105\n",
      "285526  4275554786        34  1398/06/23  33109  M105\n",
      "285522  2239113585        34  1398/06/23  33111  M105\n",
      "285528   234289050        34  1398/06/23  33111  M105\n",
      "285529  4279296642        34  1398/06/23  33116  M105\n",
      "...            ...       ...         ...    ...   ...\n",
      "25942   2743349268        34  1398/06/23  80651  M105\n",
      "201061   361536612        34  1398/06/23  81932  M105\n",
      "201062   361536612        34  1398/06/23  81934  M105\n",
      "285512   361536612        34  1398/06/23  81936  M105\n",
      "285513   361536612        34  1398/06/23  81938  M105\n",
      "\n",
      "[536 rows x 5 columns]\n",
      "first row of the selected chunck : \n",
      " [3152262318 34 '1398/06/23' 33108 'M105']\n",
      "536\n",
      "t0 = 33108\n",
      "ts = 81938\n",
      "time_intervals 81\n",
      "Origin destination interval view reindex \n",
      "    time_in  time_out\n",
      "0  33108.0   33708.0\n",
      "1  35508.0   37908.0\n",
      "2  43308.0   45108.0\n",
      "3  49908.0   51108.0\n",
      "4  55308.0   58908.0\n",
      "5  63108.0   65508.0\n",
      "6  70908.0   75108.0\n",
      "7  75708.0   76308.0\n",
      "8  76908.0   78708.0\n",
      "OD bus stations of transactions: \n",
      "            CardID LineCode       FDate   Time  plat Station\n",
      "0       542446139        1  1398/06/23  24030  A145    3169\n",
      "1      2620656172        1  1398/06/23  24302  A145    3169\n",
      "2      3446252780        1  1398/06/23  26200  A145    1227\n",
      "3         7900260        1  1398/06/23  29677  A145    3169\n",
      "4       361857972        1  1398/06/23  29720  A145    3169\n",
      "...           ...      ...         ...    ...   ...     ...\n",
      "71866   582532699       34  1398/06/23  75798  M105    3586\n",
      "71867   582532699       34  1398/06/23  75800  M105    3586\n",
      "71868  3207318757       34  1398/06/23  76238  M105    3586\n",
      "71869  3650024932       34  1398/06/23  78525  M105    4179\n",
      "71870  3498928964       34  1398/06/23  78657  M105    4179\n",
      "\n",
      "[71871 rows x 6 columns]\n",
      "transactions in line 34 plat M106\n",
      "ps: \n",
      "              CardID  LineCode       FDate   Time  plat\n",
      "576470  3677470284        34  1398/06/23  24802  M106\n",
      "576471   736511232        34  1398/06/23  24804  M106\n",
      "576472  3178776398        34  1398/06/23  24807  M106\n",
      "576473  3630326572        34  1398/06/23  24810  M106\n",
      "576474   174886948        34  1398/06/23  24814  M106\n",
      "...            ...       ...         ...    ...   ...\n",
      "659248   482966932        34  1398/06/23  79155  M106\n",
      "659249   482966932        34  1398/06/23  79161  M106\n",
      "659250   482966932        34  1398/06/23  79163  M106\n",
      "659251   482966932        34  1398/06/23  79165  M106\n",
      "659252   482966932        34  1398/06/23  79167  M106\n",
      "\n",
      "[661 rows x 5 columns]\n",
      "first row of the selected chunck : \n",
      " [3677470284 34 '1398/06/23' 24802 'M106']\n",
      "661\n",
      "t0 = 24802\n",
      "ts = 79167\n",
      "time_intervals 91\n",
      "Origin destination interval view reindex \n",
      "    time_in  time_out\n",
      "0  24802.0   25402.0\n",
      "1  29002.0   31402.0\n",
      "2  35602.0   37402.0\n",
      "3  42802.0   44602.0\n",
      "4  48202.0   50602.0\n",
      "5  55402.0   58402.0\n",
      "6  62602.0   65002.0\n",
      "7  69202.0   69802.0\n",
      "8  71602.0   73402.0\n",
      "9  76402.0   77002.0\n",
      "OD bus stations of transactions: \n",
      "            CardID LineCode       FDate   Time  plat Station\n",
      "0       542446139        1  1398/06/23  24030  A145    3169\n",
      "1      2620656172        1  1398/06/23  24302  A145    3169\n",
      "2      3446252780        1  1398/06/23  26200  A145    1227\n",
      "3         7900260        1  1398/06/23  29677  A145    3169\n",
      "4       361857972        1  1398/06/23  29720  A145    3169\n",
      "...           ...      ...         ...    ...   ...     ...\n",
      "72347  3679702380       34  1398/06/23  76674  M106    3586\n",
      "72348  2239149846       34  1398/06/23  76748  M106    3586\n",
      "72349  2239149846       34  1398/06/23  76750  M106    3586\n",
      "72350  3677664780       34  1398/06/23  76817  M106    3586\n",
      "72351   482650612       34  1398/06/23  76875  M106    3586\n",
      "\n",
      "[72352 rows x 6 columns]\n",
      "transactions in line 34 plat M111\n",
      "ps: \n",
      "              CardID  LineCode       FDate   Time  plat\n",
      "316587   869226541        34  1398/06/23  21840  M111\n",
      "316590  3630708732        34  1398/06/23  21986  M111\n",
      "316594  3630591724        34  1398/06/23  22038  M111\n",
      "316881   211230060        34  1398/06/23  22112  M111\n",
      "316883   211230060        34  1398/06/23  22114  M111\n",
      "...            ...       ...         ...    ...   ...\n",
      "153012  3151385918        34  1398/06/23  71031  M111\n",
      "153024   341850084        34  1398/06/23  71361  M111\n",
      "153027   262862625        34  1398/06/23  71364  M111\n",
      "153020  2239166391        34  1398/06/23  71365  M111\n",
      "153030   425977806        34  1398/06/23  71375  M111\n",
      "\n",
      "[669 rows x 5 columns]\n",
      "first row of the selected chunck : \n",
      " [869226541 34 '1398/06/23' 21840 'M111']\n",
      "669\n",
      "t0 = 21840\n",
      "ts = 71375\n",
      "time_intervals 83\n",
      "Origin destination interval view reindex \n",
      "    time_in  time_out\n",
      "0  21840.0   22440.0\n",
      "1  23640.0   26040.0\n",
      "2  29040.0   32040.0\n",
      "3  36840.0   39240.0\n",
      "4  44640.0   45840.0\n",
      "5  50640.0   52440.0\n",
      "6  54840.0   55440.0\n",
      "7  56040.0   59640.0\n",
      "8  64440.0   66840.0\n",
      "OD bus stations of transactions: \n",
      "            CardID LineCode       FDate   Time  plat Station\n",
      "0       542446139        1  1398/06/23  24030  A145    3169\n",
      "1      2620656172        1  1398/06/23  24302  A145    3169\n",
      "2      3446252780        1  1398/06/23  26200  A145    1227\n",
      "3         7900260        1  1398/06/23  29677  A145    3169\n",
      "4       361857972        1  1398/06/23  29720  A145    3169\n",
      "...           ...      ...         ...    ...   ...     ...\n",
      "72855  1611795691       34  1398/06/23  66626  M111    4179\n",
      "72856   480121956       34  1398/06/23  66634  M111    4179\n",
      "72857  3207207973       34  1398/06/23  66644  M111    4179\n",
      "72858   210874971       34  1398/06/23  66672  M111    4179\n",
      "72859   427912910       34  1398/06/23  66799  M111    4179\n",
      "\n",
      "[72860 rows x 6 columns]\n",
      "transactions in line 34 plat M113\n",
      "ps: \n",
      "              CardID  LineCode       FDate   Time  plat\n",
      "85514    429900366        34  1398/06/23  23135  M113\n",
      "85515   4266087810        34  1398/06/23  23170  M113\n",
      "85517   1002016862        34  1398/06/23  23362  M113\n",
      "85516   2672132740        34  1398/06/23  23363  M113\n",
      "85518   3151213982        34  1398/06/23  23498  M113\n",
      "...            ...       ...         ...    ...   ...\n",
      "268028  1368213054        34  1398/06/23  60419  M113\n",
      "268038   211508555        34  1398/06/23  60419  M113\n",
      "215683  2181573939        34  1398/06/23  60420  M113\n",
      "215684  2181573939        34  1398/06/23  60421  M113\n",
      "267878  3792001212        34  1398/06/23  60422  M113\n",
      "\n",
      "[613 rows x 5 columns]\n",
      "first row of the selected chunck : \n",
      " [429900366 34 '1398/06/23' 23135 'M113']\n",
      "613\n",
      "t0 = 23135\n",
      "ts = 60422\n",
      "time_intervals 62\n",
      "Origin destination interval view reindex \n",
      "    time_in  time_out\n",
      "0  23135.0   23735.0\n",
      "1  26735.0   28535.0\n",
      "2  33335.0   33935.0\n",
      "3  38735.0   41735.0\n",
      "4  47735.0   60335.0\n",
      "OD bus stations of transactions: \n",
      "            CardID LineCode       FDate   Time  plat Station\n",
      "0       542446139        1  1398/06/23  24030  A145    3169\n",
      "1      2620656172        1  1398/06/23  24302  A145    3169\n",
      "2      3446252780        1  1398/06/23  26200  A145    1227\n",
      "3         7900260        1  1398/06/23  29677  A145    3169\n",
      "4       361857972        1  1398/06/23  29720  A145    3169\n",
      "...           ...      ...         ...    ...   ...     ...\n",
      "73349  2124163284       34  1398/06/23  41603  M113    3586\n",
      "73350  4276387458       34  1398/06/23  41619  M113    3586\n",
      "73351   174864548       34  1398/06/23  41649  M113    3586\n",
      "73352  2742634340       34  1398/06/23  41655  M113    3586\n",
      "73353  3555311025       34  1398/06/23  41664  M113    3586\n",
      "\n",
      "[73354 rows x 6 columns]\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "transactions in line 34 plat M118\n",
      "ps: \n",
      "              CardID  LineCode       FDate   Time  plat\n",
      "220260   981454155        34  1398/06/23  21154  M118\n",
      "220261  1527142254        34  1398/06/23  21313  M118\n",
      "220262  2508045796        34  1398/06/23  21319  M118\n",
      "220263  2508145444        34  1398/06/23  21564  M118\n",
      "220264   256742129        34  1398/06/23  21597  M118\n",
      "...            ...       ...         ...    ...   ...\n",
      "209424   982575307        34  1398/06/23  71194  M118\n",
      "209425   261143073        34  1398/06/23  71195  M118\n",
      "209426   980930747        34  1398/06/23  71402  M118\n",
      "220258  3678861852        34  1398/06/23  71570  M118\n",
      "220259  3678861852        34  1398/06/23  76366  M118\n",
      "\n",
      "[633 rows x 5 columns]\n",
      "first row of the selected chunck : \n",
      " [981454155 34 '1398/06/23' 21154 'M118']\n",
      "633\n",
      "t0 = 21154\n",
      "ts = 76366\n",
      "time_intervals 92\n",
      "Origin destination interval view reindex \n",
      "     time_in  time_out\n",
      "0   21154.0   21754.0\n",
      "1   24754.0   25954.0\n",
      "2   30154.0   32554.0\n",
      "3   36754.0   39154.0\n",
      "4   43954.0   44554.0\n",
      "5   45154.0   45754.0\n",
      "6   51154.0   52354.0\n",
      "7   55354.0   55954.0\n",
      "8   56554.0   60154.0\n",
      "9   64954.0   67354.0\n",
      "10  72754.0   76354.0\n",
      "OD bus stations of transactions: \n",
      "            CardID LineCode       FDate   Time  plat Station\n",
      "0       542446139        1  1398/06/23  24030  A145    3169\n",
      "1      2620656172        1  1398/06/23  24302  A145    3169\n",
      "2      3446252780        1  1398/06/23  26200  A145    1227\n",
      "3         7900260        1  1398/06/23  29677  A145    3169\n",
      "4       361857972        1  1398/06/23  29720  A145    3169\n",
      "...           ...      ...         ...    ...   ...     ...\n",
      "73809  2590317012       34  1398/06/23  67053  M118    3586\n",
      "73810  3258218125       34  1398/06/23  67103  M118    3586\n",
      "73811  2052652914       34  1398/06/23  67235  M118    3586\n",
      "73812  3405843059       34  1398/06/23  67312  M118    3586\n",
      "73813  3405843059       34  1398/06/23  67314  M118    3586\n",
      "\n",
      "[73814 rows x 6 columns]\n",
      "transactions in line 34 plat M144\n",
      "ps: \n",
      "              CardID  LineCode       FDate   Time  plat\n",
      "217337  2640097740        34  1398/06/23  23281  M144\n",
      "217338  4279208674        34  1398/06/23  23306  M144\n",
      "217339   396729434        34  1398/06/23  23456  M144\n",
      "217340  3210426036        34  1398/06/23  23508  M144\n",
      "217341  2138841149        34  1398/06/23  23518  M144\n",
      "...            ...       ...         ...    ...   ...\n",
      "84495   2044509518        34  1398/06/23  75509  M144\n",
      "84496    985008299        34  1398/06/23  75512  M144\n",
      "84497    722212805        34  1398/06/23  75513  M144\n",
      "84498   3181385102        34  1398/06/23  75520  M144\n",
      "84493   4265667234        34  1398/06/23  75577  M144\n",
      "\n",
      "[572 rows x 5 columns]\n",
      "first row of the selected chunck : \n",
      " [2640097740 34 '1398/06/23' 23281 'M144']\n",
      "572\n",
      "t0 = 23281\n",
      "ts = 75577\n",
      "time_intervals 87\n",
      "Origin destination interval view reindex \n",
      "    time_in  time_out\n",
      "0  23281.0   23881.0\n",
      "1  27481.0   29881.0\n",
      "2  33481.0   35881.0\n",
      "3  40081.0   40681.0\n",
      "4  41281.0   43081.0\n",
      "5  48481.0   49081.0\n",
      "6  52681.0   56281.0\n",
      "7  61081.0   62881.0\n",
      "8  65881.0   70681.0\n",
      "9  73081.0   73681.0\n",
      "OD bus stations of transactions: \n",
      "            CardID LineCode       FDate   Time  plat Station\n",
      "0       542446139        1  1398/06/23  24030  A145    3169\n",
      "1      2620656172        1  1398/06/23  24302  A145    3169\n",
      "2      3446252780        1  1398/06/23  26200  A145    1227\n",
      "3         7900260        1  1398/06/23  29677  A145    3169\n",
      "4       361857972        1  1398/06/23  29720  A145    3169\n",
      "...           ...      ...         ...    ...   ...     ...\n",
      "74381  2742348180       34  1398/06/23  73568  M144    3586\n",
      "74382   362758468       34  1398/06/23  73615  M144    3586\n",
      "74383   362758468       34  1398/06/23  73620  M144    3586\n",
      "74384  3211775460       34  1398/06/23  73629  M144    3586\n",
      "74385  3603954508       34  1398/06/23  73647  M144    3586\n",
      "\n",
      "[74386 rows x 6 columns]\n",
      "transactions in line 34 plat M159\n",
      "ps: \n",
      "              CardID  LineCode       FDate   Time  plat\n",
      "273068  1283409038        34  1398/06/23  19409  M159\n",
      "273069  3213017332        34  1398/06/23  19909  M159\n",
      "273070   721775190        34  1398/06/23  19995  M159\n",
      "273071  1295674414        34  1398/06/23  20352  M159\n",
      "273072  2239167525        34  1398/06/23  20387  M159\n",
      "...            ...       ...         ...    ...   ...\n",
      "87613   1524202580        34  1398/06/23  53669  M159\n",
      "87614    115446051        34  1398/06/23  53900  M159\n",
      "87615   3181128718        34  1398/06/23  54038  M159\n",
      "273065  3603959628        34  1398/06/23  58880  M159\n",
      "273066  3603959628        34  1398/06/23  58882  M159\n",
      "\n",
      "[433 rows x 5 columns]\n",
      "first row of the selected chunck : \n",
      " [1283409038 34 '1398/06/23' 19409 'M159']\n",
      "433\n",
      "t0 = 19409\n",
      "ts = 58882\n",
      "time_intervals 66\n",
      "Origin destination interval view reindex \n",
      "    time_in  time_out\n",
      "0  19409.0   20009.0\n",
      "1  22409.0   25409.0\n",
      "2  29609.0   32009.0\n",
      "3  35609.0   38609.0\n",
      "4  44009.0   45209.0\n",
      "5  50009.0   51809.0\n",
      "6  54809.0   59009.0\n",
      "OD bus stations of transactions: \n",
      "            CardID LineCode       FDate   Time  plat Station\n",
      "0       542446139        1  1398/06/23  24030  A145    3169\n",
      "1      2620656172        1  1398/06/23  24302  A145    3169\n",
      "2      3446252780        1  1398/06/23  26200  A145    1227\n",
      "3         7900260        1  1398/06/23  29677  A145    3169\n",
      "4       361857972        1  1398/06/23  29720  A145    3169\n",
      "...           ...      ...         ...    ...   ...     ...\n",
      "74727  2053429554       34  1398/06/23  51346  M159    3586\n",
      "74728   179377974       34  1398/06/23  51452  M159    3586\n",
      "74729  1777744612       34  1398/06/23  51529  M159    3586\n",
      "74730  3603959628       34  1398/06/23  58880  M159    4179\n",
      "74731  3603959628       34  1398/06/23  58882  M159    4179\n",
      "\n",
      "[74732 rows x 6 columns]\n",
      "transactions in line 34 plat M169\n",
      "ps: \n",
      "              CardID  LineCode       FDate   Time  plat\n",
      "64815   4270435826        34  1398/06/23  24406  M169\n",
      "64818   2053069154        34  1398/06/23  24568  M169\n",
      "64821   2127906836        34  1398/06/23  24655  M169\n",
      "64824   2122222820        34  1398/06/23  24914  M169\n",
      "64831   2502094500        34  1398/06/23  24914  M169\n",
      "...            ...       ...         ...    ...   ...\n",
      "319987  3405830822        34  1398/06/23  76755  M169\n",
      "319989  2741277124        34  1398/06/23  77175  M169\n",
      "319993  4257821108        34  1398/06/23  77178  M169\n",
      "319999   262681681        34  1398/06/23  77180  M169\n",
      "320001   362303764        34  1398/06/23  77182  M169\n",
      "\n",
      "[796 rows x 5 columns]\n",
      "first row of the selected chunck : \n",
      " [4270435826 34 '1398/06/23' 24406 'M169']\n",
      "796\n",
      "t0 = 24406\n",
      "ts = 77182\n",
      "time_intervals 88\n",
      "Origin destination interval view reindex \n",
      "    time_in  time_out\n",
      "0  24406.0   25006.0\n",
      "1  28606.0   30406.0\n",
      "2  33406.0   34606.0\n",
      "3  35206.0   35806.0\n",
      "4  40606.0   43006.0\n",
      "5  54406.0   56806.0\n",
      "6  60406.0   64606.0\n",
      "7  70606.0   73606.0\n",
      "8  74206.0   74806.0\n",
      "OD bus stations of transactions: \n",
      "            CardID LineCode       FDate   Time  plat Station\n",
      "0       542446139        1  1398/06/23  24030  A145    3169\n",
      "1      2620656172        1  1398/06/23  24302  A145    3169\n",
      "2      3446252780        1  1398/06/23  26200  A145    1227\n",
      "3         7900260        1  1398/06/23  29677  A145    3169\n",
      "4       361857972        1  1398/06/23  29720  A145    3169\n",
      "...           ...      ...         ...    ...   ...     ...\n",
      "75136  3405849600       34  1398/06/23  74548  M169    4179\n",
      "75137  2239142637       34  1398/06/23  74561  M169    4179\n",
      "75138   211189244       34  1398/06/23  74684  M169    4179\n",
      "75139   300244059       34  1398/06/23  74691  M169    4179\n",
      "75140   262998225       34  1398/06/23  74692  M169    4179\n",
      "\n",
      "[75141 rows x 6 columns]\n",
      "transactions in line 34 plat M170\n",
      "ps: \n",
      "              CardID  LineCode       FDate   Time  plat\n",
      "218709  3405808668        34  1398/06/23  22671  M170\n",
      "218712  3648219108        34  1398/06/23  22698  M170\n",
      "218713  3648219108        34  1398/06/23  22700  M170\n",
      "218710  1787283012        34  1398/06/23  22779  M170\n",
      "218711  3700986453        34  1398/06/23  22783  M170\n",
      "...            ...       ...         ...    ...   ...\n",
      "3480    2044511374        34  1398/06/23  74623  M170\n",
      "218705  3679766204        34  1398/06/23  76385  M170\n",
      "218706  3679766204        34  1398/06/23  76387  M170\n",
      "218707  3679766204        34  1398/06/23  76389  M170\n",
      "218708  3679766204        34  1398/06/23  76392  M170\n",
      "\n",
      "[535 rows x 5 columns]\n",
      "first row of the selected chunck : \n",
      " [3405808668 34 '1398/06/23' 22671 'M170']\n",
      "535\n",
      "t0 = 22671\n",
      "ts = 76392\n",
      "time_intervals 90\n",
      "Origin destination interval view reindex \n",
      "    time_in  time_out\n",
      "0  22671.0   23271.0\n",
      "1  25071.0   42471.0\n",
      "2  47271.0   48471.0\n",
      "3  53271.0   55671.0\n",
      "4  58671.0   62271.0\n",
      "5  67671.0   70071.0\n",
      "6  75471.0   76671.0\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "OD bus stations of transactions: \n",
      "            CardID LineCode       FDate   Time  plat Station\n",
      "0       542446139        1  1398/06/23  24030  A145    3169\n",
      "1      2620656172        1  1398/06/23  24302  A145    3169\n",
      "2      3446252780        1  1398/06/23  26200  A145    1227\n",
      "3         7900260        1  1398/06/23  29677  A145    3169\n",
      "4       361857972        1  1398/06/23  29720  A145    3169\n",
      "...           ...      ...         ...    ...   ...     ...\n",
      "75828   869236526       34  1398/06/23  70050  M170    3586\n",
      "75829  3679766204       34  1398/06/23  76385  M170    4179\n",
      "75830  3679766204       34  1398/06/23  76387  M170    4179\n",
      "75831  3679766204       34  1398/06/23  76389  M170    4179\n",
      "75832  3679766204       34  1398/06/23  76392  M170    4179\n",
      "\n",
      "[75833 rows x 6 columns]\n",
      "transactions in line 34 plat M177\n",
      "ps: \n",
      "              CardID  LineCode       FDate   Time  plat\n",
      "369381  1371167854        34  1398/06/23  21972  M177\n",
      "369382   210979403        34  1398/06/23  22002  M177\n",
      "369383  3254663437        34  1398/06/23  22091  M177\n",
      "369384  1281599246        34  1398/06/23  22093  M177\n",
      "369385  3179400862        34  1398/06/23  22232  M177\n",
      "...            ...       ...         ...    ...   ...\n",
      "369376  3678666044        34  1398/06/23  73903  M177\n",
      "369377  3678666044        34  1398/06/23  73905  M177\n",
      "369378  3678666044        34  1398/06/23  73907  M177\n",
      "369379  3678666044        34  1398/06/23  76086  M177\n",
      "369380  3678666044        34  1398/06/23  76092  M177\n",
      "\n",
      "[835 rows x 5 columns]\n",
      "first row of the selected chunck : \n",
      " [1371167854 34 '1398/06/23' 21972 'M177']\n",
      "835\n",
      "t0 = 21972\n",
      "ts = 76092\n",
      "time_intervals 90\n",
      "Origin destination interval view reindex \n",
      "    time_in  time_out\n",
      "0  21972.0   22572.0\n",
      "1  25572.0   28572.0\n",
      "2  32772.0   34572.0\n",
      "3  39972.0   41172.0\n",
      "4  47172.0   47772.0\n",
      "5  52572.0   54972.0\n",
      "6  59172.0   60972.0\n",
      "7  65772.0   68772.0\n",
      "8  74772.0   75972.0\n",
      "OD bus stations of transactions: \n",
      "            CardID LineCode       FDate   Time  plat Station\n",
      "0       542446139        1  1398/06/23  24030  A145    3169\n",
      "1      2620656172        1  1398/06/23  24302  A145    3169\n",
      "2      3446252780        1  1398/06/23  26200  A145    1227\n",
      "3         7900260        1  1398/06/23  29677  A145    3169\n",
      "4       361857972        1  1398/06/23  29720  A145    3169\n",
      "...           ...      ...         ...    ...   ...     ...\n",
      "76275   360982244       34  1398/06/23  68278  M177    3586\n",
      "76276  2500603604       34  1398/06/23  68359  M177    3586\n",
      "76277  3446882316       34  1398/06/23  68535  M177    3586\n",
      "76278   869463296       34  1398/06/23  68543  M177    3586\n",
      "76279   263065009       34  1398/06/23  68747  M177    3586\n",
      "\n",
      "[76280 rows x 6 columns]\n",
      "transactions in line 34 plat M180\n",
      "ps: \n",
      "              CardID  LineCode       FDate   Time  plat\n",
      "275831  3179235614        34  1398/06/23  25192  M180\n",
      "275845  2044179876        34  1398/06/23  25192  M180\n",
      "275833  4269780450        34  1398/06/23  25194  M180\n",
      "275847  3555573681        34  1398/06/23  25194  M180\n",
      "275835  2541233630        34  1398/06/23  25196  M180\n",
      "...            ...       ...         ...    ...   ...\n",
      "36961   2671753988        34  1398/06/23  73162  M180\n",
      "37024   3793686700        34  1398/06/23  73334  M180\n",
      "37028   4255037508        34  1398/06/23  75782  M180\n",
      "275826  3678819308        34  1398/06/23  77917  M180\n",
      "275828  3678819308        34  1398/06/23  77922  M180\n",
      "\n",
      "[620 rows x 5 columns]\n",
      "first row of the selected chunck : \n",
      " [3179235614 34 '1398/06/23' 25192 'M180']\n",
      "620\n",
      "t0 = 25192\n",
      "ts = 77922\n",
      "time_intervals 88\n",
      "Origin destination interval view reindex \n",
      "     time_in  time_out\n",
      "0   25192.0   25792.0\n",
      "1   27592.0   29392.0\n",
      "2   33592.0   34792.0\n",
      "3   38992.0   41992.0\n",
      "4   46792.0   48592.0\n",
      "5   52792.0   55192.0\n",
      "6   58192.0   58792.0\n",
      "7   59392.0   62992.0\n",
      "8   68392.0   71392.0\n",
      "9   74392.0   76192.0\n",
      "10  76792.0   77992.0\n",
      "OD bus stations of transactions: \n",
      "            CardID LineCode       FDate   Time  plat Station\n",
      "0       542446139        1  1398/06/23  24030  A145    3169\n",
      "1      2620656172        1  1398/06/23  24302  A145    3169\n",
      "2      3446252780        1  1398/06/23  26200  A145    1227\n",
      "3         7900260        1  1398/06/23  29677  A145    3169\n",
      "4       361857972        1  1398/06/23  29720  A145    3169\n",
      "...           ...      ...         ...    ...   ...     ...\n",
      "77139  4266543570       34  1398/06/23  71226  M180    4179\n",
      "77140   537215467       34  1398/06/23  71264  M180    4179\n",
      "77141  4255037508       34  1398/06/23  75782  M180    3586\n",
      "77142  3678819308       34  1398/06/23  77917  M180    4179\n",
      "77143  3678819308       34  1398/06/23  77922  M180    4179\n",
      "\n",
      "[77144 rows x 6 columns]\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "C:\\Users\\esmaeli.h\\AppData\\Local\\Temp/ipykernel_12452/1949912630.py:257: ConvergenceWarning: Number of distinct clusters (44) found smaller than n_clusters (45). Possibly due to duplicate points in X.\n",
      "  kmeans = KMeans(n_clusters=len(filter_go_stations)-1,random_state=0).fit(partial_times.to_numpy())\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "transactions in line 34 plat M181\n",
      "ps: \n",
      "              CardID  LineCode       FDate   Time  plat\n",
      "176031  1002880663        34  1398/06/23  21107  M181\n",
      "176033  3179273598        34  1398/06/23  21441  M181\n",
      "176035  2590415396        34  1398/06/23  21467  M181\n",
      "176037     7945796        34  1398/06/23  21532  M181\n",
      "176039  3445646540        34  1398/06/23  21534  M181\n",
      "...            ...       ...         ...    ...   ...\n",
      "268858  3109337269        34  1398/06/23  71781  M181\n",
      "268860  3793341580        34  1398/06/23  71795  M181\n",
      "268863  3109491365        34  1398/06/23  72537  M181\n",
      "268867  1292965550        34  1398/06/23  72649  M181\n",
      "268869   982944475        34  1398/06/23  73296  M181\n",
      "\n",
      "[600 rows x 5 columns]\n",
      "first row of the selected chunck : \n",
      " [1002880663 34 '1398/06/23' 21107 'M181']\n",
      "600\n",
      "t0 = 21107\n",
      "ts = 73296\n",
      "time_intervals 87\n",
      "Origin destination interval view reindex \n",
      "    time_in  time_out\n",
      "0  21107.0   21707.0\n",
      "1  23507.0   27707.0\n",
      "2  31907.0   33707.0\n",
      "3  34307.0   34907.0\n",
      "4  37907.0   42707.0\n",
      "5  45107.0   47507.0\n",
      "6  51107.0   51707.0\n",
      "7  52307.0   54107.0\n",
      "8  57107.0   61307.0\n",
      "9  67307.0   69107.0\n",
      "OD bus stations of transactions: \n",
      "            CardID LineCode       FDate   Time  plat Station\n",
      "0       542446139        1  1398/06/23  24030  A145    3169\n",
      "1      2620656172        1  1398/06/23  24302  A145    3169\n",
      "2      3446252780        1  1398/06/23  26200  A145    1227\n",
      "3         7900260        1  1398/06/23  29677  A145    3169\n",
      "4       361857972        1  1398/06/23  29720  A145    3169\n",
      "...           ...      ...         ...    ...   ...     ...\n",
      "77640  2742439316       34  1398/06/23  61148  M181    4179\n",
      "77641  3254397805       34  1398/06/23  61177  M181    4179\n",
      "77642  3997269876       34  1398/06/23  61235  M181    4179\n",
      "77643  2228950323       34  1398/06/23  69059  M181    3586\n",
      "77644  2053261906       34  1398/06/23  69063  M181    3586\n",
      "\n",
      "[77645 rows x 6 columns]\n",
      "transactions in line 34 plat M185\n",
      "ps: \n",
      "             CardID  LineCode       FDate   Time  plat\n",
      "83781   984287003        34  1398/06/23  22637  M185\n",
      "83783   181761654        34  1398/06/23  22745  M185\n",
      "83838  3631417932        34  1398/06/23  22866  M185\n",
      "83841  1598335044        34  1398/06/23  22966  M185\n",
      "83849  3254652493        34  1398/06/23  23186  M185\n",
      "...           ...       ...         ...    ...   ...\n",
      "83770  3791687868        34  1398/06/23  76972  M185\n",
      "83772  3791687868        34  1398/06/23  76974  M185\n",
      "83774  3791687868        34  1398/06/23  76976  M185\n",
      "83777  3791687868        34  1398/06/23  76977  M185\n",
      "83779  3791687868        34  1398/06/23  76979  M185\n",
      "\n",
      "[503 rows x 5 columns]\n",
      "first row of the selected chunck : \n",
      " [984287003 34 '1398/06/23' 22637 'M185']\n",
      "503\n",
      "t0 = 22637\n",
      "ts = 76979\n",
      "time_intervals 91\n",
      "Origin destination interval view reindex \n",
      "    time_in  time_out\n",
      "0  22637.0   23237.0\n",
      "1  26237.0   28037.0\n",
      "2  30437.0   31037.0\n",
      "3  32237.0   48437.0\n",
      "4  52637.0   54437.0\n",
      "5  58037.0   61637.0\n",
      "6  66437.0   69437.0\n",
      "7  74837.0   77237.0\n",
      "OD bus stations of transactions: \n",
      "            CardID LineCode       FDate   Time  plat Station\n",
      "0       542446139        1  1398/06/23  24030  A145    3169\n",
      "1      2620656172        1  1398/06/23  24302  A145    3169\n",
      "2      3446252780        1  1398/06/23  26200  A145    1227\n",
      "3         7900260        1  1398/06/23  29677  A145    3169\n",
      "4       361857972        1  1398/06/23  29720  A145    3169\n",
      "...           ...      ...         ...    ...   ...     ...\n",
      "78133  3791687868       34  1398/06/23  76972  M185    3586\n",
      "78134  3791687868       34  1398/06/23  76974  M185    3586\n",
      "78135  3791687868       34  1398/06/23  76976  M185    3586\n",
      "78136  3791687868       34  1398/06/23  76977  M185    3586\n",
      "78137  3791687868       34  1398/06/23  76979  M185    3586\n",
      "\n",
      "[78138 rows x 6 columns]\n",
      "transactions in line 34 plat M186\n",
      "ps: \n",
      "             CardID  LineCode       FDate   Time  plat\n",
      "39098  4245276391        34  1398/06/23  25857  M186\n",
      "39128   641433114        34  1398/06/23  25857  M186\n",
      "39101   722102916        34  1398/06/23  25858  M186\n",
      "39104   721970925        34  1398/06/23  25860  M186\n",
      "39131   869395325        34  1398/06/23  25860  M186\n",
      "...           ...       ...         ...    ...   ...\n",
      "39067  2123748468        34  1398/06/23  76784  M186\n",
      "39072  2123748468        34  1398/06/23  76785  M186\n",
      "39082  2123748468        34  1398/06/23  76787  M186\n",
      "39089  2123748468        34  1398/06/23  76789  M186\n",
      "39094  2123748468        34  1398/06/23  76791  M186\n",
      "\n",
      "[650 rows x 5 columns]\n",
      "first row of the selected chunck : \n",
      " [4245276391 34 '1398/06/23' 25857 'M186']\n",
      "650\n",
      "t0 = 25857\n",
      "ts = 76791\n",
      "time_intervals 85\n",
      "Origin destination interval view reindex \n",
      "    time_in  time_out\n",
      "0  25857.0   26457.0\n",
      "1  28257.0   30657.0\n",
      "2  34857.0   36057.0\n",
      "3  40857.0   43257.0\n",
      "4  48657.0   49857.0\n",
      "5  54057.0   56457.0\n",
      "6  60057.0   64257.0\n",
      "7  68457.0   72657.0\n",
      "8  76257.0   76857.0\n",
      "OD bus stations of transactions: \n",
      "            CardID LineCode       FDate   Time  plat Station\n",
      "0       542446139        1  1398/06/23  24030  A145    3169\n",
      "1      2620656172        1  1398/06/23  24302  A145    3169\n",
      "2      3446252780        1  1398/06/23  26200  A145    1227\n",
      "3         7900260        1  1398/06/23  29677  A145    3169\n",
      "4       361857972        1  1398/06/23  29720  A145    3169\n",
      "...           ...      ...         ...    ...   ...     ...\n",
      "78643  2123748468       34  1398/06/23  76784  M186    4179\n",
      "78644  2123748468       34  1398/06/23  76785  M186    4179\n",
      "78645  2123748468       34  1398/06/23  76787  M186    4179\n",
      "78646  2123748468       34  1398/06/23  76789  M186    4179\n",
      "78647  2123748468       34  1398/06/23  76791  M186    4179\n",
      "\n",
      "[78648 rows x 6 columns]\n",
      "transactions in line 34 plat M188\n",
      "ps: \n",
      "              CardID  LineCode       FDate   Time  plat\n",
      "575181   473734586        34  1398/06/23  21237  M188\n",
      "575182   556675486        34  1398/06/23  21406  M188\n",
      "575183   556675486        34  1398/06/23  21408  M188\n",
      "575184   256835777        34  1398/06/23  21498  M188\n",
      "575185  3794266620        34  1398/06/23  22080  M188\n",
      "...            ...       ...         ...    ...   ...\n",
      "339457  3206180388        34  1398/06/23  63871  M188\n",
      "339460  2045157022        34  1398/06/23  63879  M188\n",
      "575178  3792427020        34  1398/06/23  67642  M188\n",
      "575179  3792427020        34  1398/06/23  67643  M188\n",
      "575180  3792427020        34  1398/06/23  67645  M188\n",
      "\n",
      "[538 rows x 5 columns]\n",
      "first row of the selected chunck : \n",
      " [473734586 34 '1398/06/23' 21237 'M188']\n",
      "538\n",
      "t0 = 21237\n",
      "ts = 67645\n",
      "time_intervals 77\n",
      "Origin destination interval view reindex \n",
      "    time_in  time_out\n",
      "0  21237.0   21837.0\n",
      "1  24837.0   27837.0\n",
      "2  32037.0   33837.0\n",
      "3  39237.0   40437.0\n",
      "4  45837.0   47037.0\n",
      "5  51237.0   51837.0\n",
      "6  52437.0   53637.0\n",
      "7  57837.0   59637.0\n",
      "8  62637.0   64437.0\n",
      "9  65037.0   67437.0\n",
      "OD bus stations of transactions: \n",
      "            CardID LineCode       FDate   Time  plat Station\n",
      "0       542446139        1  1398/06/23  24030  A145    3169\n",
      "1      2620656172        1  1398/06/23  24302  A145    3169\n",
      "2      3446252780        1  1398/06/23  26200  A145    1227\n",
      "3         7900260        1  1398/06/23  29677  A145    3169\n",
      "4       361857972        1  1398/06/23  29720  A145    3169\n",
      "...           ...      ...         ...    ...   ...     ...\n",
      "79153   721970925       34  1398/06/23  59622  M188    3586\n",
      "79154  2742367860       34  1398/06/23  63861  M188    4179\n",
      "79155  2049349458       34  1398/06/23  63865  M188    4179\n",
      "79156  3206180388       34  1398/06/23  63871  M188    4179\n",
      "79157  2045157022       34  1398/06/23  63879  M188    4179\n",
      "\n",
      "[79158 rows x 6 columns]\n",
      "transactions in line 34 plat M193\n",
      "ps: \n",
      "              CardID  LineCode       FDate   Time  plat\n",
      "702697   722270964        34  1398/06/23  21585  M193\n",
      "702698   722270964        34  1398/06/23  21586  M193\n",
      "702699  2052229938        34  1398/06/23  22022  M193\n",
      "702700  3679112172        34  1398/06/23  22025  M193\n",
      "702701  3603706684        34  1398/06/23  22466  M193\n",
      "...            ...       ...         ...    ...   ...\n",
      "702692  3145176611        34  1398/06/23  77037  M193\n",
      "702693  3145176611        34  1398/06/23  77039  M193\n",
      "702694  3145176611        34  1398/06/23  77043  M193\n",
      "702695  3145176611        34  1398/06/23  77046  M193\n",
      "702696  3145176611        34  1398/06/23  77050  M193\n",
      "\n",
      "[673 rows x 5 columns]\n",
      "first row of the selected chunck : \n",
      " [722270964 34 '1398/06/23' 21585 'M193']\n",
      "673\n",
      "t0 = 21585\n",
      "ts = 77050\n",
      "time_intervals 92\n",
      "Origin destination interval view reindex \n",
      "    time_in  time_out\n",
      "0  21585.0   22185.0\n",
      "1  24585.0   28185.0\n",
      "2  32385.0   34185.0\n",
      "3  45585.0   46785.0\n",
      "4  50985.0   53985.0\n",
      "5  57585.0   59985.0\n",
      "6  64785.0   67785.0\n",
      "7  73185.0   76785.0\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "OD bus stations of transactions: \n",
      "            CardID LineCode       FDate   Time  plat Station\n",
      "0       542446139        1  1398/06/23  24030  A145    3169\n",
      "1      2620656172        1  1398/06/23  24302  A145    3169\n",
      "2      3446252780        1  1398/06/23  26200  A145    1227\n",
      "3         7900260        1  1398/06/23  29677  A145    3169\n",
      "4       361857972        1  1398/06/23  29720  A145    3169\n",
      "...           ...      ...         ...    ...   ...     ...\n",
      "79679  2124141956       34  1398/06/23  67495  M193    4179\n",
      "79680  4278624114       34  1398/06/23  67663  M193    4179\n",
      "79681   428461966       34  1398/06/23  67685  M193    4179\n",
      "79682  2184068883       34  1398/06/23  67769  M193    4179\n",
      "79683   806964930       34  1398/06/23  67772  M193    4179\n",
      "\n",
      "[79684 rows x 6 columns]\n",
      "transactions in line 34 plat M194\n",
      "ps: \n",
      "              CardID  LineCode       FDate   Time  plat\n",
      "176253  3603706684        34  1398/06/23  21039  M194\n",
      "176256   722001620        34  1398/06/23  21489  M194\n",
      "176260  3650051748        34  1398/06/23  21548  M194\n",
      "176263  1001966590        34  1398/06/23  21708  M194\n",
      "176265  4278481170        34  1398/06/23  21711  M194\n",
      "...            ...       ...         ...    ...   ...\n",
      "268878  2741335156        34  1398/06/23  69363  M194\n",
      "176248  3679967916        34  1398/06/23  69690  M194\n",
      "268879  2482595860        34  1398/06/23  69707  M194\n",
      "268880  4266269442        34  1398/06/23  69760  M194\n",
      "268881  2138045645        34  1398/06/23  70304  M194\n",
      "\n",
      "[621 rows x 5 columns]\n",
      "first row of the selected chunck : \n",
      " [3603706684 34 '1398/06/23' 21039 'M194']\n",
      "621\n",
      "t0 = 21039\n",
      "ts = 70304\n",
      "time_intervals 82\n",
      "Origin destination interval view reindex \n",
      "    time_in  time_out\n",
      "0  21039.0   21639.0\n",
      "1  23439.0   25839.0\n",
      "2  30039.0   31839.0\n",
      "3  36639.0   39039.0\n",
      "4  44439.0   45039.0\n",
      "5  49839.0   52239.0\n",
      "6  55839.0   59439.0\n",
      "7  63639.0   66639.0\n",
      "OD bus stations of transactions: \n",
      "            CardID LineCode       FDate   Time  plat Station\n",
      "0       542446139        1  1398/06/23  24030  A145    3169\n",
      "1      2620656172        1  1398/06/23  24302  A145    3169\n",
      "2      3446252780        1  1398/06/23  26200  A145    1227\n",
      "3         7900260        1  1398/06/23  29677  A145    3169\n",
      "4       361857972        1  1398/06/23  29720  A145    3169\n",
      "...           ...      ...         ...    ...   ...     ...\n",
      "80307  1832888541       34  1398/06/23  66295  M194    3586\n",
      "80308   722194829       34  1398/06/23  66298  M194    3586\n",
      "80309  3678114380       34  1398/06/23  66335  M194    3586\n",
      "80310  3648893460       34  1398/06/23  66585  M194    3586\n",
      "80311   261702529       34  1398/06/23  66586  M194    3586\n",
      "\n",
      "[80312 rows x 6 columns]\n",
      "transactions in line 34 plat M197\n",
      "ps: \n",
      "              CardID  LineCode       FDate   Time  plat\n",
      "232455  2740971956        34  1398/06/23  25964  M197\n",
      "232456  2481950324        34  1398/06/23  26047  M197\n",
      "232460  2481950324        34  1398/06/23  26052  M197\n",
      "232474  3445644876        34  1398/06/23  26183  M197\n",
      "232478  4256977892        34  1398/06/23  26257  M197\n",
      "...            ...       ...         ...    ...   ...\n",
      "232432  3680177420        34  1398/06/23  78820  M197\n",
      "232435  3680177420        34  1398/06/23  78826  M197\n",
      "232441  3680177420        34  1398/06/23  78828  M197\n",
      "232445  3680177420        34  1398/06/23  78831  M197\n",
      "232451  3680177420        34  1398/06/23  78833  M197\n",
      "\n",
      "[774 rows x 5 columns]\n",
      "first row of the selected chunck : \n",
      " [2740971956 34 '1398/06/23' 25964 'M197']\n",
      "774\n",
      "t0 = 25964\n",
      "ts = 78833\n",
      "time_intervals 88\n",
      "Origin destination interval view reindex \n",
      "    time_in  time_out\n",
      "0  25964.0   26564.0\n",
      "1  30164.0   31964.0\n",
      "2  36164.0   37964.0\n",
      "3  43364.0   45164.0\n",
      "4  50564.0   51764.0\n",
      "5  55964.0   58364.0\n",
      "6  62564.0   66164.0\n",
      "7  71564.0   76364.0\n",
      "OD bus stations of transactions: \n",
      "            CardID LineCode       FDate   Time  plat Station\n",
      "0       542446139        1  1398/06/23  24030  A145    3169\n",
      "1      2620656172        1  1398/06/23  24302  A145    3169\n",
      "2      3446252780        1  1398/06/23  26200  A145    1227\n",
      "3         7900260        1  1398/06/23  29677  A145    3169\n",
      "4       361857972        1  1398/06/23  29720  A145    3169\n",
      "...           ...      ...         ...    ...   ...     ...\n",
      "80826  2116139732       34  1398/06/23  76206  M197    3586\n",
      "80827  3672766354       34  1398/06/23  76208  M197    3586\n",
      "80828  3672766354       34  1398/06/23  76209  M197    3586\n",
      "80829  1765105748       34  1398/06/23  76211  M197    3586\n",
      "80830  1765105748       34  1398/06/23  76212  M197    3586\n",
      "\n",
      "[80831 rows x 6 columns]\n",
      "transactions in line 34 plat M55\n",
      "ps: \n",
      "             CardID  LineCode       FDate   Time plat\n",
      "51577   736224944        34  1398/06/23  26542  M55\n",
      "51578  1835531261        34  1398/06/23  26673  M55\n",
      "51579   722204380        34  1398/06/23  26963  M55\n",
      "51580   722204380        34  1398/06/23  26964  M55\n",
      "51581   721971434        34  1398/06/23  26971  M55\n",
      "...           ...       ...         ...    ...  ...\n",
      "12373  2239162061        34  1398/06/23  78308  M55\n",
      "52129  2680064974        34  1398/06/23  78460  M55\n",
      "52130  3630145260        34  1398/06/23  78462  M55\n",
      "52131  3630145260        34  1398/06/23  78464  M55\n",
      "52132   980400331        34  1398/06/23  78895  M55\n",
      "\n",
      "[788 rows x 5 columns]\n",
      "first row of the selected chunck : \n",
      " [736224944 34 '1398/06/23' 26542 'M55']\n",
      "788\n",
      "t0 = 26542\n",
      "ts = 78895\n",
      "time_intervals 87\n",
      "Origin destination interval view reindex \n",
      "    time_in  time_out\n",
      "0  26542.0   27142.0\n",
      "1  30742.0   32542.0\n",
      "2  36742.0   38542.0\n",
      "3  43942.0   45742.0\n",
      "4  50542.0   52342.0\n",
      "5  56542.0   58342.0\n",
      "6  61942.0   62542.0\n",
      "7  63142.0   66142.0\n",
      "8  71542.0   76342.0\n",
      "OD bus stations of transactions: \n",
      "            CardID LineCode       FDate   Time  plat Station\n",
      "0       542446139        1  1398/06/23  24030  A145    3169\n",
      "1      2620656172        1  1398/06/23  24302  A145    3169\n",
      "2      3446252780        1  1398/06/23  26200  A145    1227\n",
      "3         7900260        1  1398/06/23  29677  A145    3169\n",
      "4       361857972        1  1398/06/23  29720  A145    3169\n",
      "...           ...      ...         ...    ...   ...     ...\n",
      "81506   360969572       34  1398/06/23  66130   M55    3586\n",
      "81507  3105503861       34  1398/06/23  66138   M55    3586\n",
      "81508  3445553068       34  1398/06/23  76034   M55    4179\n",
      "81509  4265745666       34  1398/06/23  76176   M55    4179\n",
      "81510  3405836345       34  1398/06/23  76320   M55    4179\n",
      "\n",
      "[81511 rows x 6 columns]\n",
      "transactions in line 34 plat M82\n",
      "ps: \n",
      "              CardID  LineCode       FDate   Time plat\n",
      "25399   1832128989        34  1398/06/23  20286  M82\n",
      "25403    638424475        34  1398/06/23  20289  M82\n",
      "25405   2491061300        34  1398/06/23  20307  M82\n",
      "25409   3678671868        34  1398/06/23  20384  M82\n",
      "25412   3183974110        34  1398/06/23  20739  M82\n",
      "...            ...       ...         ...    ...  ...\n",
      "123781   480037844        34  1398/06/23  73265  M82\n",
      "25396    263184038        34  1398/06/23  73431  M82\n",
      "124205  1832315693        34  1398/06/23  73784  M82\n",
      "124209   802957474        34  1398/06/23  73933  M82\n",
      "124212  3405880397        34  1398/06/23  73941  M82\n",
      "\n",
      "[711 rows x 5 columns]\n",
      "first row of the selected chunck : \n",
      " [1832128989 34 '1398/06/23' 20286 'M82']\n",
      "711\n",
      "t0 = 20286\n",
      "ts = 73941\n",
      "time_intervals 89\n",
      "Origin destination interval view reindex \n",
      "    time_in  time_out\n",
      "0  20286.0   20886.0\n",
      "1  22686.0   28086.0\n",
      "2  32286.0   34086.0\n",
      "3  38886.0   41286.0\n",
      "4  46686.0   48486.0\n",
      "5  52686.0   55086.0\n",
      "6  58086.0   62886.0\n",
      "7  67086.0   70686.0\n",
      "OD bus stations of transactions: \n",
      "            CardID LineCode       FDate   Time  plat Station\n",
      "0       542446139        1  1398/06/23  24030  A145    3169\n",
      "1      2620656172        1  1398/06/23  24302  A145    3169\n",
      "2      3446252780        1  1398/06/23  26200  A145    1227\n",
      "3         7900260        1  1398/06/23  29677  A145    3169\n",
      "4       361857972        1  1398/06/23  29720  A145    3169\n",
      "...           ...      ...         ...    ...   ...     ...\n",
      "82209  3184078206       34  1398/06/23  62852   M82    4179\n",
      "82210  3181379998       34  1398/06/23  62854   M82    4179\n",
      "82211   722144957       34  1398/06/23  70277   M82    3586\n",
      "82212  1003721143       34  1398/06/23  70374   M82    3586\n",
      "82213  4256499396       34  1398/06/23  70550   M82    3586\n",
      "\n",
      "[82214 rows x 6 columns]\n",
      "transactions in line 34 plat M99\n",
      "ps: \n",
      "              CardID  LineCode       FDate   Time plat\n",
      "401925  3631618572        34  1398/06/23  25632  M99\n",
      "401926  3631618572        34  1398/06/23  25634  M99\n",
      "401927  1530070494        34  1398/06/23  25727  M99\n",
      "401928   300424555        34  1398/06/23  25834  M99\n",
      "401929   300424555        34  1398/06/23  25835  M99\n",
      "...            ...       ...         ...    ...  ...\n",
      "401920   361520244        34  1398/06/23  77959  M99\n",
      "401921   361520244        34  1398/06/23  77967  M99\n",
      "401922   361520244        34  1398/06/23  77969  M99\n",
      "401923   361520244        34  1398/06/23  77971  M99\n",
      "401924   361520244        34  1398/06/23  77972  M99\n",
      "\n",
      "[904 rows x 5 columns]\n",
      "first row of the selected chunck : \n",
      " [3631618572 34 '1398/06/23' 25632 'M99']\n",
      "904\n",
      "t0 = 25632\n",
      "ts = 77972\n",
      "time_intervals 87\n",
      "Origin destination interval view reindex \n",
      "    time_in  time_out\n",
      "0  25632.0   26232.0\n",
      "1  29832.0   31632.0\n",
      "2  35832.0   37632.0\n",
      "3  41832.0   44232.0\n",
      "4  48432.0   50832.0\n",
      "5  55632.0   58032.0\n",
      "6  61632.0   65832.0\n",
      "7  71232.0   74832.0\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "OD bus stations of transactions: \n",
      "            CardID LineCode       FDate   Time  plat Station\n",
      "0       542446139        1  1398/06/23  24030  A145    3169\n",
      "1      2620656172        1  1398/06/23  24302  A145    3169\n",
      "2      3446252780        1  1398/06/23  26200  A145    1227\n",
      "3         7900260        1  1398/06/23  29677  A145    3169\n",
      "4       361857972        1  1398/06/23  29720  A145    3169\n",
      "...           ...      ...         ...    ...   ...     ...\n",
      "82816   183805190       34  1398/06/23  65767   M99    4179\n",
      "82817   722185035       34  1398/06/23  65770   M99    4179\n",
      "82818  3791900188       34  1398/06/23  65778   M99    4179\n",
      "82819  1371251374       34  1398/06/23  74616   M99    3586\n",
      "82820   721893475       34  1398/06/23  74640   M99    3586\n",
      "\n",
      "[82821 rows x 6 columns]\n",
      "transactions in line 34 plat N105\n",
      "ps: \n",
      "              CardID  LineCode       FDate   Time  plat\n",
      "278043  2128997828        34  1398/06/23  23668  N105\n",
      "278044  1282443470        34  1398/06/23  23727  N105\n",
      "278383   212433644        34  1398/06/23  23941  N105\n",
      "278384   234125626        34  1398/06/23  23943  N105\n",
      "278385   721921197        34  1398/06/23  23945  N105\n",
      "...            ...       ...         ...    ...   ...\n",
      "278038  3680036348        34  1398/06/23  76899  N105\n",
      "278039  3680036348        34  1398/06/23  76901  N105\n",
      "278040  3680036348        34  1398/06/23  76903  N105\n",
      "278041  3680036348        34  1398/06/23  76904  N105\n",
      "278042  3680036348        34  1398/06/23  76906  N105\n",
      "\n",
      "[647 rows x 5 columns]\n",
      "first row of the selected chunck : \n",
      " [2128997828 34 '1398/06/23' 23668 'N105']\n",
      "647\n",
      "t0 = 23668\n",
      "ts = 76906\n",
      "time_intervals 89\n",
      "Origin destination interval view reindex \n",
      "    time_in  time_out\n",
      "0  23668.0   24268.0\n",
      "1  27268.0   29068.0\n",
      "2  32668.0   35068.0\n",
      "3  39868.0   41668.0\n",
      "4  47068.0   48868.0\n",
      "5  50668.0   63268.0\n",
      "6  68068.0   71668.0\n",
      "7  75868.0   77068.0\n",
      "OD bus stations of transactions: \n",
      "            CardID LineCode       FDate   Time  plat Station\n",
      "0       542446139        1  1398/06/23  24030  A145    3169\n",
      "1      2620656172        1  1398/06/23  24302  A145    3169\n",
      "2      3446252780        1  1398/06/23  26200  A145    1227\n",
      "3         7900260        1  1398/06/23  29677  A145    3169\n",
      "4       361857972        1  1398/06/23  29720  A145    3169\n",
      "...           ...      ...         ...    ...   ...     ...\n",
      "83603  3680036348       34  1398/06/23  76899  N105    3586\n",
      "83604  3680036348       34  1398/06/23  76901  N105    3586\n",
      "83605  3680036348       34  1398/06/23  76903  N105    3586\n",
      "83606  3680036348       34  1398/06/23  76904  N105    3586\n",
      "83607  3680036348       34  1398/06/23  76906  N105    3586\n",
      "\n",
      "[83608 rows x 6 columns]\n",
      "transactions in line 34 plat N110\n",
      "ps: \n",
      "              CardID  LineCode       FDate   Time  plat\n",
      "227440  3254429101        34  1398/06/23  22290  N110\n",
      "227441  3678669500        34  1398/06/23  22320  N110\n",
      "227442  2232560819        34  1398/06/23  22330  N110\n",
      "227443   869457262        34  1398/06/23  22359  N110\n",
      "227444  2137816621        34  1398/06/23  22389  N110\n",
      "...            ...       ...         ...    ...   ...\n",
      "180500   736836640        34  1398/06/23  73815  N110\n",
      "180501   426985422        34  1398/06/23  73816  N110\n",
      "180502  3405777636        34  1398/06/23  74148  N110\n",
      "180503  3405777636        34  1398/06/23  74149  N110\n",
      "180504  3181356382        34  1398/06/23  74432  N110\n",
      "\n",
      "[704 rows x 5 columns]\n",
      "first row of the selected chunck : \n",
      " [3254429101 34 '1398/06/23' 22290 'N110']\n",
      "704\n",
      "t0 = 22290\n",
      "ts = 74432\n",
      "time_intervals 87\n",
      "Origin destination interval view reindex \n",
      "    time_in  time_out\n",
      "0  22290.0   22890.0\n",
      "1  24690.0   28890.0\n",
      "2  33690.0   35490.0\n",
      "3  40890.0   41490.0\n",
      "4  46890.0   48090.0\n",
      "5  51690.0   52290.0\n",
      "6  52890.0   55290.0\n",
      "7  56490.0   57090.0\n",
      "8  58890.0   61890.0\n",
      "9  65490.0   69090.0\n",
      "OD bus stations of transactions: \n",
      "            CardID LineCode       FDate   Time  plat Station\n",
      "0       542446139        1  1398/06/23  24030  A145    3169\n",
      "1      2620656172        1  1398/06/23  24302  A145    3169\n",
      "2      3446252780        1  1398/06/23  26200  A145    1227\n",
      "3         7900260        1  1398/06/23  29677  A145    3169\n",
      "4       361857972        1  1398/06/23  29720  A145    3169\n",
      "...           ...      ...         ...    ...   ...     ...\n",
      "84229  3257450957       34  1398/06/23  61822  N110    4179\n",
      "84230  1527076302       34  1398/06/23  61827  N110    4179\n",
      "84231  2129957412       34  1398/06/23  69070  N110    3586\n",
      "84232   736565744       34  1398/06/23  69073  N110    3586\n",
      "84233   722250922       34  1398/06/23  69078  N110    3586\n",
      "\n",
      "[84234 rows x 6 columns]\n",
      "transactions in line 34 plat N124\n",
      "ps: \n",
      "              CardID  LineCode       FDate   Time  plat\n",
      "104645  4059192509        34  1398/06/23  22910  N124\n",
      "104646  4059192509        34  1398/06/23  22911  N124\n",
      "104647  2741488276        34  1398/06/23  22940  N124\n",
      "104648  1414640569        34  1398/06/23  22972  N124\n",
      "104649   177330566        34  1398/06/23  22984  N124\n",
      "...            ...       ...         ...    ...   ...\n",
      "104639  3678641164        34  1398/06/23  75994  N124\n",
      "104640  3678641164        34  1398/06/23  75996  N124\n",
      "104641  3678641164        34  1398/06/23  75998  N124\n",
      "104642  3678641164        34  1398/06/23  76000  N124\n",
      "104643  3678641164        34  1398/06/23  76003  N124\n",
      "\n",
      "[689 rows x 5 columns]\n",
      "first row of the selected chunck : \n",
      " [4059192509 34 '1398/06/23' 22910 'N124']\n",
      "689\n",
      "t0 = 22910\n",
      "ts = 76003\n",
      "time_intervals 88\n",
      "Origin destination interval view reindex \n",
      "    time_in  time_out\n",
      "0  22910.0   23510.0\n",
      "1  27110.0   29510.0\n",
      "2  34310.0   36110.0\n",
      "3  40910.0   42710.0\n",
      "4  47510.0   50510.0\n",
      "5  52310.0   56510.0\n",
      "6  60710.0   62510.0\n",
      "7  66110.0   67310.0\n",
      "8  67910.0   70310.0\n",
      "OD bus stations of transactions: \n",
      "            CardID LineCode       FDate   Time  plat Station\n",
      "0       542446139        1  1398/06/23  24030  A145    3169\n",
      "1      2620656172        1  1398/06/23  24302  A145    3169\n",
      "2      3446252780        1  1398/06/23  26200  A145    1227\n",
      "3         7900260        1  1398/06/23  29677  A145    3169\n",
      "4       361857972        1  1398/06/23  29720  A145    3169\n",
      "...           ...      ...         ...    ...   ...     ...\n",
      "84779  1529045406       34  1398/06/23  66769  N124    3586\n",
      "84780  3648873076       34  1398/06/23  70060  N124    4179\n",
      "84781   262708657       34  1398/06/23  70140  N124    4179\n",
      "84782  2505044436       34  1398/06/23  70157  N124    4179\n",
      "84783  1527426190       34  1398/06/23  70220  N124    4179\n",
      "\n",
      "[84784 rows x 6 columns]\n",
      "transactions in line 34 plat N128\n",
      "ps: \n",
      "              CardID  LineCode       FDate   Time  plat\n",
      "289832  2239188650        34  1398/06/23  24174  N128\n",
      "289833  3700148725        34  1398/06/23  24183  N128\n",
      "289834   428265150        34  1398/06/23  24203  N128\n",
      "289835  3630130668        34  1398/06/23  24232  N128\n",
      "289836   556069438        34  1398/06/23  24263  N128\n",
      "...            ...       ...         ...    ...   ...\n",
      "289827   361035444        34  1398/06/23  79556  N128\n",
      "289828   361035444        34  1398/06/23  79557  N128\n",
      "289829   361035444        34  1398/06/23  79559  N128\n",
      "289830   361035444        34  1398/06/23  79561  N128\n",
      "289831   361035444        34  1398/06/23  79563  N128\n",
      "\n",
      "[615 rows x 5 columns]\n",
      "first row of the selected chunck : \n",
      " [2239188650 34 '1398/06/23' 24174 'N128']\n",
      "615\n",
      "t0 = 24174\n",
      "ts = 79563\n",
      "time_intervals 92\n",
      "Origin destination interval view reindex \n",
      "    time_in  time_out\n",
      "0  24174.0   24774.0\n",
      "1  27774.0   30774.0\n",
      "2  34974.0   36174.0\n",
      "3  41574.0   43974.0\n",
      "4  48774.0   49974.0\n",
      "5  53574.0   57774.0\n",
      "6  61974.0   64374.0\n",
      "7  69774.0   72174.0\n",
      "8  74574.0   75174.0\n",
      "9  78174.0   79374.0\n",
      "OD bus stations of transactions: \n",
      "            CardID LineCode       FDate   Time  plat Station\n",
      "0       542446139        1  1398/06/23  24030  A145    3169\n",
      "1      2620656172        1  1398/06/23  24302  A145    3169\n",
      "2      3446252780        1  1398/06/23  26200  A145    1227\n",
      "3         7900260        1  1398/06/23  29677  A145    3169\n",
      "4       361857972        1  1398/06/23  29720  A145    3169\n",
      "...           ...      ...         ...    ...   ...     ...\n",
      "85347  2138803021       34  1398/06/23  71978  N128    3586\n",
      "85348  4275873906       34  1398/06/23  72030  N128    3586\n",
      "85349   722259044       34  1398/06/23  74858  N128    4179\n",
      "85350   722259044       34  1398/06/23  74859  N128    4179\n",
      "85351  3555875665       34  1398/06/23  74969  N128    4179\n",
      "\n",
      "[85352 rows x 6 columns]\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "transactions in line 34 plat N129\n",
      "ps: \n",
      "              CardID  LineCode       FDate   Time  plat\n",
      "273147  1529266782        34  1398/06/23  23586  N129\n",
      "273148  3258294205        34  1398/06/23  23610  N129\n",
      "273149   536802654        34  1398/06/23  23661  N129\n",
      "273150   721829490        34  1398/06/23  23784  N129\n",
      "273151  1592536436        34  1398/06/23  23788  N129\n",
      "...            ...       ...         ...    ...   ...\n",
      "179242  4265953122        34  1398/06/23  75464  N129\n",
      "179243  2509395700        34  1398/06/23  75482  N129\n",
      "179244  1001177758        34  1398/06/23  75614  N129\n",
      "179245  2509395700        34  1398/06/23  76044  N129\n",
      "273146  3791690444        34  1398/06/23  79154  N129\n",
      "\n",
      "[611 rows x 5 columns]\n",
      "first row of the selected chunck : \n",
      " [1529266782 34 '1398/06/23' 23586 'N129']\n",
      "611\n",
      "t0 = 23586\n",
      "ts = 79154\n",
      "time_intervals 93\n",
      "Origin destination interval view reindex \n",
      "     time_in  time_out\n",
      "0   23586.0   24186.0\n",
      "1   27786.0   29586.0\n",
      "2   34986.0   36186.0\n",
      "3   41586.0   43386.0\n",
      "4   45186.0   45786.0\n",
      "5   47586.0   49986.0\n",
      "6   52386.0   52986.0\n",
      "7   53586.0   57186.0\n",
      "8   61386.0   63786.0\n",
      "9   67986.0   70986.0\n",
      "10  72186.0   72786.0\n",
      "11  76986.0   79386.0\n",
      "OD bus stations of transactions: \n",
      "            CardID LineCode       FDate   Time  plat Station\n",
      "0       542446139        1  1398/06/23  24030  A145    3169\n",
      "1      2620656172        1  1398/06/23  24302  A145    3169\n",
      "2      3446252780        1  1398/06/23  26200  A145    1227\n",
      "3         7900260        1  1398/06/23  29677  A145    3169\n",
      "4       361857972        1  1398/06/23  29720  A145    3169\n",
      "...           ...      ...         ...    ...   ...     ...\n",
      "85934   722116039       34  1398/06/23  72539  N129    4179\n",
      "85935   722116039       34  1398/06/23  72540  N129    4179\n",
      "85936  3791690444       34  1398/06/23  72576  N129    4179\n",
      "85937  2124292884       34  1398/06/23  72702  N129    4179\n",
      "85938  3791690444       34  1398/06/23  79154  N129    3586\n",
      "\n",
      "[85939 rows x 6 columns]\n",
      "transactions in line 34 plat N134\n",
      "ps: \n",
      "              CardID  LineCode       FDate   Time  plat\n",
      "145263  3405790375        34  1398/06/23  24961  N134\n",
      "145264   721971047        34  1398/06/23  24984  N134\n",
      "145265  4241657431        34  1398/06/23  25008  N134\n",
      "145266   721931370        34  1398/06/23  25051  N134\n",
      "145267   710169717        34  1398/06/23  25194  N134\n",
      "...            ...       ...         ...    ...   ...\n",
      "145258      520247        34  1398/06/23  79469  N134\n",
      "145259      520247        34  1398/06/23  79471  N134\n",
      "145260      520247        34  1398/06/23  79472  N134\n",
      "145261      520247        34  1398/06/23  79475  N134\n",
      "145262      520247        34  1398/06/23  79485  N134\n",
      "\n",
      "[572 rows x 5 columns]\n",
      "first row of the selected chunck : \n",
      " [3405790375 34 '1398/06/23' 24961 'N134']\n",
      "572\n",
      "t0 = 24961\n",
      "ts = 79485\n",
      "time_intervals 91\n",
      "Origin destination interval view reindex \n",
      "     time_in  time_out\n",
      "0   24961.0   25561.0\n",
      "1   27961.0   28561.0\n",
      "2   29161.0   30961.0\n",
      "3   35161.0   37561.0\n",
      "4   42961.0   44761.0\n",
      "5   45961.0   46561.0\n",
      "6   48961.0   50761.0\n",
      "7   54361.0   58561.0\n",
      "8   63361.0   65161.0\n",
      "9   69961.0   74761.0\n",
      "10  77161.0   77761.0\n",
      "11  78361.0   78961.0\n",
      "OD bus stations of transactions: \n",
      "            CardID LineCode       FDate   Time  plat Station\n",
      "0       542446139        1  1398/06/23  24030  A145    3169\n",
      "1      2620656172        1  1398/06/23  24302  A145    3169\n",
      "2      3446252780        1  1398/06/23  26200  A145    1227\n",
      "3         7900260        1  1398/06/23  29677  A145    3169\n",
      "4       361857972        1  1398/06/23  29720  A145    3169\n",
      "...           ...      ...         ...    ...   ...     ...\n",
      "86435  2742726772       34  1398/06/23  78374  N134    3586\n",
      "86436  1407159646       34  1398/06/23  78377  N134    3586\n",
      "86437  1780145076       34  1398/06/23  78769  N134    3586\n",
      "86438   721727966       34  1398/06/23  78852  N134    3586\n",
      "86439  3183567662       34  1398/06/23  78857  N134    3586\n",
      "\n",
      "[86440 rows x 6 columns]\n",
      "transactions in line 34 plat N136\n",
      "ps: \n",
      "              CardID  LineCode       FDate   Time  plat\n",
      "236754  3405963842        34  1398/06/23  22049  N136\n",
      "236756  4058243101        34  1398/06/23  22434  N136\n",
      "236757  4058243101        34  1398/06/23  22435  N136\n",
      "236758  3792818348        34  1398/06/23  22440  N136\n",
      "236761   428312510        34  1398/06/23  22621  N136\n",
      "...            ...       ...         ...    ...   ...\n",
      "128      721946827        34  1398/06/23  72708  N136\n",
      "132      869305054        34  1398/06/23  72989  N136\n",
      "130     3405935911        34  1398/06/23  72994  N136\n",
      "134      721894682        34  1398/06/23  72998  N136\n",
      "137      721894682        34  1398/06/23  72999  N136\n",
      "\n",
      "[535 rows x 5 columns]\n",
      "first row of the selected chunck : \n",
      " [3405963842 34 '1398/06/23' 22049 'N136']\n",
      "535\n",
      "t0 = 22049\n",
      "ts = 72999\n",
      "time_intervals 85\n",
      "Origin destination interval view reindex \n",
      "    time_in  time_out\n",
      "0  22049.0   22649.0\n",
      "1  26249.0   27449.0\n",
      "2  31049.0   33449.0\n",
      "3  37649.0   40649.0\n",
      "4  46049.0   47849.0\n",
      "5  52049.0   53849.0\n",
      "6  57449.0   61049.0\n",
      "7  66449.0   68849.0\n",
      "OD bus stations of transactions: \n",
      "            CardID LineCode       FDate   Time  plat Station\n",
      "0       542446139        1  1398/06/23  24030  A145    3169\n",
      "1      2620656172        1  1398/06/23  24302  A145    3169\n",
      "2      3446252780        1  1398/06/23  26200  A145    1227\n",
      "3         7900260        1  1398/06/23  29677  A145    3169\n",
      "4       361857972        1  1398/06/23  29720  A145    3169\n",
      "...           ...      ...         ...    ...   ...     ...\n",
      "86873  2052757650       34  1398/06/23  68540  N136    3586\n",
      "86874  1612275227       34  1398/06/23  68571  N136    3586\n",
      "86875   209423307       34  1398/06/23  68790  N136    3586\n",
      "86876   869402131       34  1398/06/23  68826  N136    3586\n",
      "86877   869402131       34  1398/06/23  68831  N136    3586\n",
      "\n",
      "[86878 rows x 6 columns]\n",
      "transactions in line 34 plat N141\n",
      "ps: \n",
      "              CardID  LineCode       FDate   Time  plat\n",
      "65825   1531693662        34  1398/06/23  22543  N141\n",
      "65826   3648216916        34  1398/06/23  23121  N141\n",
      "65827   2116129764        34  1398/06/23  23125  N141\n",
      "65828    261765121        34  1398/06/23  23230  N141\n",
      "214634  3677792332        34  1398/06/23  23249  N141\n",
      "...            ...       ...         ...    ...   ...\n",
      "218685   869303539        34  1398/06/23  71528  N141\n",
      "218689  3792431852        34  1398/06/23  71530  N141\n",
      "218686  3792687548        34  1398/06/23  71531  N141\n",
      "218690  1003471079        34  1398/06/23  71622  N141\n",
      "218691  2742788660        34  1398/06/23  72219  N141\n",
      "\n",
      "[716 rows x 5 columns]\n",
      "first row of the selected chunck : \n",
      " [1531693662 34 '1398/06/23' 22543 'N141']\n",
      "716\n",
      "t0 = 22543\n",
      "ts = 72219\n",
      "time_intervals 83\n",
      "Origin destination interval view reindex \n",
      "    time_in  time_out\n",
      "0  22543.0   23143.0\n",
      "1  24343.0   24943.0\n",
      "2  25543.0   27343.0\n",
      "3  31543.0   33343.0\n",
      "4  38743.0   39343.0\n",
      "5  45943.0   46543.0\n",
      "6  51343.0   53143.0\n",
      "7  55543.0   56143.0\n",
      "8  57943.0   59143.0\n",
      "9  63343.0   66943.0\n",
      "OD bus stations of transactions: \n",
      "            CardID LineCode       FDate   Time  plat Station\n",
      "0       542446139        1  1398/06/23  24030  A145    3169\n",
      "1      2620656172        1  1398/06/23  24302  A145    3169\n",
      "2      3446252780        1  1398/06/23  26200  A145    1227\n",
      "3         7900260        1  1398/06/23  29677  A145    3169\n",
      "4       361857972        1  1398/06/23  29720  A145    3169\n",
      "...           ...      ...         ...    ...   ...     ...\n",
      "87271  2504091188       34  1398/06/23  59000  N141    4179\n",
      "87272  3648391412       34  1398/06/23  59100  N141    4179\n",
      "87273  1598352836       34  1398/06/23  66577  N141    3586\n",
      "87274  1598352836       34  1398/06/23  66578  N141    3586\n",
      "87275  3405848494       34  1398/06/23  66865  N141    3586\n",
      "\n",
      "[87276 rows x 6 columns]\n",
      "transactions in line 34 plat N15\n",
      "ps: \n",
      "              CardID  LineCode       FDate   Time plat\n",
      "20064   3795032732        34  1398/06/23  22029  N15\n",
      "20063   4276520114        34  1398/06/23  22091  N15\n",
      "20065   3405830822        34  1398/06/23  22406  N15\n",
      "20066   2049975266        34  1398/06/23  22598  N15\n",
      "20067   1528107086        34  1398/06/23  22601  N15\n",
      "...            ...       ...         ...    ...  ...\n",
      "237095  1002437559        34  1398/06/23  71578  N15\n",
      "237096  2239132929        34  1398/06/23  71729  N15\n",
      "237097  2743195364        34  1398/06/23  72102  N15\n",
      "237098   869192917        34  1398/06/23  72156  N15\n",
      "237099  1598938132        34  1398/06/23  72420  N15\n",
      "\n",
      "[449 rows x 5 columns]\n",
      "first row of the selected chunck : \n",
      " [3795032732 34 '1398/06/23' 22029 'N15']\n",
      "449\n",
      "t0 = 22029\n",
      "ts = 72420\n",
      "time_intervals 84\n",
      "Origin destination interval view reindex \n",
      "    time_in  time_out\n",
      "0  22029.0   22629.0\n",
      "1  25029.0   26829.0\n",
      "2  31029.0   47229.0\n",
      "3  52029.0   53229.0\n",
      "4  56229.0   57429.0\n",
      "5  58029.0   61029.0\n",
      "6  65829.0   68229.0\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "OD bus stations of transactions: \n",
      "            CardID LineCode       FDate   Time  plat Station\n",
      "0       542446139        1  1398/06/23  24030  A145    3169\n",
      "1      2620656172        1  1398/06/23  24302  A145    3169\n",
      "2      3446252780        1  1398/06/23  26200  A145    1227\n",
      "3         7900260        1  1398/06/23  29677  A145    3169\n",
      "4       361857972        1  1398/06/23  29720  A145    3169\n",
      "...           ...      ...         ...    ...   ...     ...\n",
      "87846  2742383492       34  1398/06/23  56915   N15    4179\n",
      "87847  3183317054       34  1398/06/23  60634   N15    3586\n",
      "87848  2741648916       34  1398/06/23  67964   N15    4179\n",
      "87849  2741648916       34  1398/06/23  67966   N15    4179\n",
      "87850  1787119204       34  1398/06/23  68032   N15    4179\n",
      "\n",
      "[87851 rows x 6 columns]\n",
      "transactions in line 34 plat N58\n",
      "ps: \n",
      "              CardID  LineCode       FDate   Time plat\n",
      "156358  3648459156        34  1398/06/23  28591  N58\n",
      "156351  3154120414        34  1398/06/23  28592  N58\n",
      "156352   203175484        34  1398/06/23  28594  N58\n",
      "156359  3181185966        34  1398/06/23  28596  N58\n",
      "156353  1786582020        34  1398/06/23  28597  N58\n",
      "156360   722037421        34  1398/06/23  28597  N58\n",
      "156361   721871322        34  1398/06/23  28598  N58\n",
      "156354  2498101181        34  1398/06/23  28600  N58\n",
      "156362  1528743038        34  1398/06/23  28601  N58\n",
      "156355   983079323        34  1398/06/23  28602  N58\n",
      "156364  4278468562        34  1398/06/23  28604  N58\n",
      "156356   233184426        34  1398/06/23  28605  N58\n",
      "156365  2504334868        34  1398/06/23  28605  N58\n",
      "156366  2928657621        34  1398/06/23  28608  N58\n",
      "156367  3630360060        34  1398/06/23  28610  N58\n",
      "156357  2122281780        34  1398/06/23  28611  N58\n",
      "156368   181487654        34  1398/06/23  28612  N58\n",
      "156369   426201550        34  1398/06/23  28651  N58\n",
      "156370  3207803429        34  1398/06/23  28654  N58\n",
      "156371  3677971596        34  1398/06/23  28680  N58\n",
      "156373   341916740        34  1398/06/23  28683  N58\n",
      "156374  4275586962        34  1398/06/23  28688  N58\n",
      "156375   738103968        34  1398/06/23  28693  N58\n",
      "156344  1610804267        34  1398/06/23  28710  N58\n",
      "156376  3178574830        34  1398/06/23  28715  N58\n",
      "156377  1799197348        34  1398/06/23  28718  N58\n",
      "156378  3445632460        34  1398/06/23  28766  N58\n",
      "156372  2117721908        34  1398/06/23  28770  N58\n",
      "156379  3630491996        34  1398/06/23  28870  N58\n",
      "156380  2740644500        34  1398/06/23  28877  N58\n",
      "156381   725963175        34  1398/06/23  28908  N58\n",
      "156383  3678897676        34  1398/06/23  28991  N58\n",
      "156382  4278846546        34  1398/06/23  29063  N58\n",
      "156384  2038905834        34  1398/06/23  29186  N58\n",
      "156385  3557933121        34  1398/06/23  31025  N58\n",
      "156387   984293451        34  1398/06/23  31527  N58\n",
      "156386   981455787        34  1398/06/23  31530  N58\n",
      "156388   982620107        34  1398/06/23  31536  N58\n",
      "first row of the selected chunck : \n",
      " [3648459156 34 '1398/06/23' 28591 'N58']\n",
      "38\n",
      "t0 = 28591\n",
      "ts = 31536\n",
      "time_intervals 5\n",
      "Origin destination interval view reindex \n",
      "    time_in  time_out\n",
      "0  28591.0   29191.0\n",
      "1  29791.0   31591.0\n",
      "OD bus stations of transactions: \n",
      "            CardID LineCode       FDate   Time  plat Station\n",
      "0       542446139        1  1398/06/23  24030  A145    3169\n",
      "1      2620656172        1  1398/06/23  24302  A145    3169\n",
      "2      3446252780        1  1398/06/23  26200  A145    1227\n",
      "3         7900260        1  1398/06/23  29677  A145    3169\n",
      "4       361857972        1  1398/06/23  29720  A145    3169\n",
      "...           ...      ...         ...    ...   ...     ...\n",
      "88045  2038905834       34  1398/06/23  29186   N58    4179\n",
      "88046  3557933121       34  1398/06/23  31025   N58    3586\n",
      "88047   984293451       34  1398/06/23  31527   N58    3586\n",
      "88048   981455787       34  1398/06/23  31530   N58    3586\n",
      "88049   982620107       34  1398/06/23  31536   N58    3586\n",
      "\n",
      "[88050 rows x 6 columns]\n",
      "transactions in line 34 plat N98\n",
      "ps: \n",
      "              CardID  LineCode       FDate   Time plat\n",
      "180850  2137788333        34  1398/06/23  22296  N98\n",
      "180854  1528906526        34  1398/06/23  22340  N98\n",
      "180855   722225979        34  1398/06/23  22426  N98\n",
      "180858  3213479092        34  1398/06/23  22430  N98\n",
      "180861  1407217438        34  1398/06/23  22431  N98\n",
      "...            ...       ...         ...    ...  ...\n",
      "9499    1528441406        34  1398/06/23  71972  N98\n",
      "209429   722224785        34  1398/06/23  71977  N98\n",
      "209432   721986107        34  1398/06/23  71981  N98\n",
      "209438  1528441406        34  1398/06/23  71984  N98\n",
      "209441  3405789893        34  1398/06/23  71986  N98\n",
      "\n",
      "[779 rows x 5 columns]\n",
      "first row of the selected chunck : \n",
      " [2137788333 34 '1398/06/23' 22296 'N98']\n",
      "779\n",
      "t0 = 22296\n",
      "ts = 71986\n",
      "time_intervals 83\n",
      "Origin destination interval view reindex \n",
      "    time_in  time_out\n",
      "0  22296.0   22896.0\n",
      "1  23496.0   24096.0\n",
      "2  24696.0   26496.0\n",
      "3  30696.0   32496.0\n",
      "4  37296.0   39696.0\n",
      "5  45696.0   46296.0\n",
      "6  51096.0   52896.0\n",
      "7  56496.0   60696.0\n",
      "8  65496.0   67896.0\n",
      "OD bus stations of transactions: \n",
      "            CardID LineCode       FDate   Time  plat Station\n",
      "0       542446139        1  1398/06/23  24030  A145    3169\n",
      "1      2620656172        1  1398/06/23  24302  A145    3169\n",
      "2      3446252780        1  1398/06/23  26200  A145    1227\n",
      "3         7900260        1  1398/06/23  29677  A145    3169\n",
      "4       361857972        1  1398/06/23  29720  A145    3169\n",
      "...           ...      ...         ...    ...   ...     ...\n",
      "88117  3180594014       34  1398/06/23  67533   N98    4179\n",
      "88118   736795440       34  1398/06/23  67540   N98    4179\n",
      "88119   176990038       34  1398/06/23  67697   N98    4179\n",
      "88120  4270291890       34  1398/06/23  67766   N98    4179\n",
      "88121  1360620810       34  1398/06/23  67842   N98    4179\n",
      "\n",
      "[88122 rows x 6 columns]\n",
      "stations in a specefic bus line 35\n",
      "len-of-go stations: 23\n",
      "len-of-back stations: 22\n",
      "len-of-go back stations: 0\n",
      "first Station  [2566 '35' '1' 'go' '????? ???-35-13-5-4' 51.691879 32.678663 'od'\n",
      " 'normal' 'no'] 2566\n",
      "last Station  [4092 '35' '1' 'back' '???? ?? ? ?? ??-40' 51.666995 32.638822 'od'\n",
      " 'normal' 'no']\n",
      "['A38' 'B20' 'B25' 'B41' 'E116' 'E156' 'E198' 'E204' 'E82' 'F65' 'N117'\n",
      " 'N39']\n",
      "transactions in line 35 plat A38\n",
      "ps: \n",
      "              CardID  LineCode       FDate   Time plat\n",
      "144984  3445153708        35  1398/06/23  23914  A38\n",
      "144986   233237114        35  1398/06/23  24571  A38\n",
      "144989  2740876548        35  1398/06/23  24622  A38\n",
      "144991   736493600        35  1398/06/23  24927  A38\n",
      "144993  2137117501        35  1398/06/23  27346  A38\n",
      "...            ...       ...         ...    ...  ...\n",
      "150914  3678770316        35  1398/06/23  77352  A38\n",
      "150915   556006446        35  1398/06/23  77912  A38\n",
      "150917   474157866        35  1398/06/23  77923  A38\n",
      "150919  3254600557        35  1398/06/23  77926  A38\n",
      "150921   210805531        35  1398/06/23  77930  A38\n",
      "\n",
      "[227 rows x 5 columns]\n",
      "first row of the selected chunck : \n",
      " [3445153708 35 '1398/06/23' 23914 'A38']\n",
      "227\n",
      "t0 = 23914\n",
      "ts = 77930\n",
      "time_intervals 90\n",
      "Origin destination interval view reindex \n",
      "     time_in  time_out\n",
      "0   23914.0   25114.0\n",
      "1   25714.0   27514.0\n",
      "2   29314.0   29914.0\n",
      "3   35914.0   38314.0\n",
      "4   39514.0   40714.0\n",
      "5   46114.0   47314.0\n",
      "6   50914.0   52114.0\n",
      "7   53914.0   55114.0\n",
      "8   57514.0   59314.0\n",
      "9   64114.0   64714.0\n",
      "10  67714.0   68914.0\n",
      "11  71914.0   72514.0\n",
      "12  74314.0   76714.0\n",
      "13  77314.0   77914.0\n",
      "OD bus stations of transactions: \n",
      "            CardID LineCode       FDate   Time  plat Station\n",
      "0       542446139        1  1398/06/23  24030  A145    3169\n",
      "1      2620656172        1  1398/06/23  24302  A145    3169\n",
      "2      3446252780        1  1398/06/23  26200  A145    1227\n",
      "3         7900260        1  1398/06/23  29677  A145    3169\n",
      "4       361857972        1  1398/06/23  29720  A145    3169\n",
      "...           ...      ...         ...    ...   ...     ...\n",
      "88753  3996986708       35  1398/06/23  76383   A38    2566\n",
      "88754  3996986708       35  1398/06/23  76384   A38    2566\n",
      "88755  3678770316       35  1398/06/23  77350   A38    4092\n",
      "88756  3678770316       35  1398/06/23  77352   A38    4092\n",
      "88757   556006446       35  1398/06/23  77912   A38    4092\n",
      "\n",
      "[88758 rows x 6 columns]\n",
      "transactions in line 35 plat B20\n",
      "ps: \n",
      "              CardID  LineCode       FDate   Time plat\n",
      "194324  4245972903        35  1398/06/23  32582  B20\n",
      "194326  1838184989        35  1398/06/23  33406  B20\n",
      "194328   996803102        35  1398/06/23  33842  B20\n",
      "194331  1845558004        35  1398/06/23  33853  B20\n",
      "194337   737593424        35  1398/06/23  34079  B20\n",
      "...            ...       ...         ...    ...  ...\n",
      "702884  3105613381        35  1398/06/23  72781  B20\n",
      "702885   721752368        35  1398/06/23  72960  B20\n",
      "702886   287103067        35  1398/06/23  73340  B20\n",
      "702887   721934515        35  1398/06/23  73345  B20\n",
      "702888   722041489        35  1398/06/23  73514  B20\n",
      "\n",
      "[206 rows x 5 columns]\n",
      "first row of the selected chunck : \n",
      " [4245972903 35 '1398/06/23' 32582 'B20']\n",
      "206\n",
      "t0 = 32582\n",
      "ts = 73514\n",
      "time_intervals 68\n",
      "Origin destination interval view reindex \n",
      "     time_in  time_out\n",
      "0   32582.0   33782.0\n",
      "1   36782.0   37382.0\n",
      "2   39782.0   40382.0\n",
      "3   47582.0   48182.0\n",
      "4   50582.0   52382.0\n",
      "5   54782.0   56582.0\n",
      "6   60782.0   62582.0\n",
      "7   64382.0   64982.0\n",
      "8   65582.0   66182.0\n",
      "9   69182.0   69782.0\n",
      "10  71582.0   72782.0\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "OD bus stations of transactions: \n",
      "            CardID LineCode       FDate   Time  plat Station\n",
      "0       542446139        1  1398/06/23  24030  A145    3169\n",
      "1      2620656172        1  1398/06/23  24302  A145    3169\n",
      "2      3446252780        1  1398/06/23  26200  A145    1227\n",
      "3         7900260        1  1398/06/23  29677  A145    3169\n",
      "4       361857972        1  1398/06/23  29720  A145    3169\n",
      "...           ...      ...         ...    ...   ...     ...\n",
      "88912   361905332       35  1398/06/23  69772   B20    4092\n",
      "88913  3680310860       35  1398/06/23  69780   B20    4092\n",
      "88914  3405803477       35  1398/06/23  72545   B20    2566\n",
      "88915   722172180       35  1398/06/23  72641   B20    2566\n",
      "88916  3105613381       35  1398/06/23  72781   B20    2566\n",
      "\n",
      "[88917 rows x 6 columns]\n",
      "transactions in line 35 plat B25\n",
      "ps: \n",
      "              CardID  LineCode       FDate   Time plat\n",
      "17312    869419145        35  1398/06/23  30390  B25\n",
      "17315   2235710291        35  1398/06/23  30394  B25\n",
      "17318   2137509037        35  1398/06/23  30758  B25\n",
      "17322    735946544        35  1398/06/23  30968  B25\n",
      "17326    483270660        35  1398/06/23  31046  B25\n",
      "...            ...       ...         ...    ...  ...\n",
      "201161   721990019        35  1398/06/23  74400  B25\n",
      "201163  2182876467        35  1398/06/23  74405  B25\n",
      "201165   869269927        35  1398/06/23  74532  B25\n",
      "201166  3791835052        35  1398/06/23  74586  B25\n",
      "201168  2122193748        35  1398/06/23  74588  B25\n",
      "\n",
      "[236 rows x 5 columns]\n",
      "first row of the selected chunck : \n",
      " [869419145 35 '1398/06/23' 30390 'B25']\n",
      "236\n",
      "t0 = 30390\n",
      "ts = 74588\n",
      "time_intervals 74\n",
      "Origin destination interval view reindex \n",
      "    time_in  time_out\n",
      "0  30390.0   30990.0\n",
      "1  36390.0   38190.0\n",
      "2  40590.0   41790.0\n",
      "3  47790.0   48390.0\n",
      "4  51390.0   53190.0\n",
      "5  54990.0   55590.0\n",
      "6  58590.0   59790.0\n",
      "7  64590.0   65790.0\n",
      "8  66390.0   66990.0\n",
      "9  69390.0   70590.0\n",
      "OD bus stations of transactions: \n",
      "            CardID LineCode       FDate   Time  plat Station\n",
      "0       542446139        1  1398/06/23  24030  A145    3169\n",
      "1      2620656172        1  1398/06/23  24302  A145    3169\n",
      "2      3446252780        1  1398/06/23  26200  A145    1227\n",
      "3         7900260        1  1398/06/23  29677  A145    3169\n",
      "4       361857972        1  1398/06/23  29720  A145    3169\n",
      "...           ...      ...         ...    ...   ...     ...\n",
      "89024   721742789       35  1398/06/23  70195   B25    4092\n",
      "89025  1832349085       35  1398/06/23  70230   B25    4092\n",
      "89026  1093272532       35  1398/06/23  70247   B25    4092\n",
      "89027   641586154       35  1398/06/23  70372   B25    4092\n",
      "89028  3792427196       35  1398/06/23  70510   B25    4092\n",
      "\n",
      "[89029 rows x 6 columns]\n",
      "transactions in line 35 plat B41\n",
      "ps: \n",
      "              CardID  LineCode       FDate   Time plat\n",
      "574978  3792806556        35  1398/06/23  29532  B41\n",
      "574979  3207894292        35  1398/06/23  29599  B41\n",
      "574980  2124500820        35  1398/06/23  29721  B41\n",
      "574983  1765242308        35  1398/06/23  29724  B41\n",
      "574996  3648454740        35  1398/06/23  29726  B41\n",
      "...            ...       ...         ...    ...  ...\n",
      "575311   737378976        35  1398/06/23  41678  B41\n",
      "575312  3553847996        35  1398/06/23  41826  B41\n",
      "575313   429546414        35  1398/06/23  42022  B41\n",
      "575314  2122339812        35  1398/06/23  42433  B41\n",
      "574977  3678569676        35  1398/06/23  42823  B41\n",
      "\n",
      "[67 rows x 5 columns]\n",
      "first row of the selected chunck : \n",
      " [3792806556 35 '1398/06/23' 29532 'B41']\n",
      "67\n",
      "t0 = 29532\n",
      "ts = 42823\n",
      "time_intervals 22\n",
      "Origin destination interval view reindex \n",
      "    time_in  time_out\n",
      "0  29532.0   30132.0\n",
      "1  31332.0   31932.0\n",
      "2  33132.0   33732.0\n",
      "3  34332.0   36732.0\n",
      "OD bus stations of transactions: \n",
      "            CardID LineCode       FDate   Time  plat Station\n",
      "0       542446139        1  1398/06/23  24030  A145    3169\n",
      "1      2620656172        1  1398/06/23  24302  A145    3169\n",
      "2      3446252780        1  1398/06/23  26200  A145    1227\n",
      "3         7900260        1  1398/06/23  29677  A145    3169\n",
      "4       361857972        1  1398/06/23  29720  A145    3169\n",
      "...           ...      ...         ...    ...   ...     ...\n",
      "89141  4265723298       35  1398/06/23  30075   B41    2566\n",
      "89142   177085654       35  1398/06/23  30094   B41    2566\n",
      "89143   721725977       35  1398/06/23  31531   B41    4092\n",
      "89144  1001420078       35  1398/06/23  33518   B41    2566\n",
      "89145  2189177891       35  1398/06/23  36671   B41    4092\n",
      "\n",
      "[89146 rows x 6 columns]\n",
      "transactions in line 35 plat E116\n",
      "ps: \n",
      "             CardID  LineCode       FDate   Time  plat\n",
      "38697  2620436412        35  1398/06/23  23346  E116\n",
      "38698   869399428        35  1398/06/23  23486  E116\n",
      "38701  2541779214        35  1398/06/23  23633  E116\n",
      "38699  3405958256        35  1398/06/23  23634  E116\n",
      "38700   982196763        35  1398/06/23  23636  E116\n",
      "...           ...       ...         ...    ...   ...\n",
      "78703  2124629572        35  1398/06/23  75647  E116\n",
      "78704  2124629572        35  1398/06/23  75648  E116\n",
      "78705  1368369422        35  1398/06/23  76433  E116\n",
      "78706  1368369422        35  1398/06/23  76434  E116\n",
      "78707   980563755        35  1398/06/23  77127  E116\n",
      "\n",
      "[216 rows x 5 columns]\n",
      "first row of the selected chunck : \n",
      " [2620436412 35 '1398/06/23' 23346 'E116']\n",
      "216\n",
      "t0 = 23346\n",
      "ts = 77127\n",
      "time_intervals 90\n",
      "Origin destination interval view reindex \n",
      "     time_in  time_out\n",
      "0   23346.0   23946.0\n",
      "1   25746.0   26346.0\n",
      "2   30546.0   31146.0\n",
      "3   34746.0   35346.0\n",
      "4   38346.0   39546.0\n",
      "5   41946.0   43746.0\n",
      "6   46146.0   46746.0\n",
      "7   47946.0   48546.0\n",
      "8   49746.0   51546.0\n",
      "9   53346.0   54546.0\n",
      "10  56946.0   58146.0\n",
      "11  59946.0   60546.0\n",
      "12  61146.0   67746.0\n",
      "13  69546.0   70146.0\n",
      "14  70746.0   72546.0\n",
      "15  74346.0   74946.0\n",
      "OD bus stations of transactions: \n",
      "            CardID LineCode       FDate   Time  plat Station\n",
      "0       542446139        1  1398/06/23  24030  A145    3169\n",
      "1      2620656172        1  1398/06/23  24302  A145    3169\n",
      "2      3446252780        1  1398/06/23  26200  A145    1227\n",
      "3         7900260        1  1398/06/23  29677  A145    3169\n",
      "4       361857972        1  1398/06/23  29720  A145    3169\n",
      "...           ...      ...         ...    ...   ...     ...\n",
      "89204  1776428980       35  1398/06/23  74822  E116    4092\n",
      "89205  1776428980       35  1398/06/23  74823  E116    4092\n",
      "89206  1002497191       35  1398/06/23  74897  E116    4092\n",
      "89207  1002497191       35  1398/06/23  74899  E116    4092\n",
      "89208   425818190       35  1398/06/23  74920  E116    4092\n",
      "\n",
      "[89209 rows x 6 columns]\n",
      "transactions in line 35 plat E156\n",
      "ps: \n",
      "              CardID  LineCode       FDate   Time  plat\n",
      "288901  3179252142        35  1398/06/23  25527  E156\n",
      "288902   981270523        35  1398/06/23  25529  E156\n",
      "288903  3213195668        35  1398/06/23  25534  E156\n",
      "288904  4270631490        35  1398/06/23  25583  E156\n",
      "288911   981472219        35  1398/06/23  25627  E156\n",
      "...            ...       ...         ...    ...   ...\n",
      "74680    869374180        35  1398/06/23  46187  E156\n",
      "74681   2239099899        35  1398/06/23  46191  E156\n",
      "74682    360979012        35  1398/06/23  46200  E156\n",
      "74683   2741539620        35  1398/06/23  47502  E156\n",
      "74684   2741539620        35  1398/06/23  47505  E156\n",
      "\n",
      "[214 rows x 5 columns]\n",
      "first row of the selected chunck : \n",
      " [3179252142 35 '1398/06/23' 25527 'E156']\n",
      "214\n",
      "t0 = 25527\n",
      "ts = 47505\n",
      "time_intervals 37\n",
      "Origin destination interval view reindex \n",
      "    time_in  time_out\n",
      "0  25527.0   26127.0\n",
      "1  28527.0   29127.0\n",
      "2  32127.0   33327.0\n",
      "3  36327.0   39327.0\n",
      "4  42327.0   43527.0\n",
      "5  47127.0   47727.0\n",
      "OD bus stations of transactions: \n",
      "            CardID LineCode       FDate   Time  plat Station\n",
      "0       542446139        1  1398/06/23  24030  A145    3169\n",
      "1      2620656172        1  1398/06/23  24302  A145    3169\n",
      "2      3446252780        1  1398/06/23  26200  A145    1227\n",
      "3         7900260        1  1398/06/23  29677  A145    3169\n",
      "4       361857972        1  1398/06/23  29720  A145    3169\n",
      "...           ...      ...         ...    ...   ...     ...\n",
      "89304  1599035236       35  1398/06/23  39281  E156    4092\n",
      "89305  2124127748       35  1398/06/23  39290  E156    4092\n",
      "89306  2501641140       35  1398/06/23  43202  E156    2566\n",
      "89307  2741539620       35  1398/06/23  47502  E156    4092\n",
      "89308  2741539620       35  1398/06/23  47505  E156    4092\n",
      "\n",
      "[89309 rows x 6 columns]\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "transactions in line 35 plat E198\n",
      "ps: \n",
      "             CardID  LineCode       FDate   Time  plat\n",
      "10054  3648806180        35  1398/06/23  25410  E198\n",
      "10055  3405949635        35  1398/06/23  25580  E198\n",
      "10120   202903468        35  1398/06/23  25580  E198\n",
      "10121   174374774        35  1398/06/23  25585  E198\n",
      "10122  1612064155        35  1398/06/23  25653  E198\n",
      "...           ...       ...         ...    ...   ...\n",
      "11492  1612064155        35  1398/06/23  52788  E198\n",
      "11496   361538324        35  1398/06/23  52931  E198\n",
      "11499  4265409602        35  1398/06/23  53030  E198\n",
      "11494   429240677        35  1398/06/23  53101  E198\n",
      "11500   981314123        35  1398/06/23  55570  E198\n",
      "\n",
      "[163 rows x 5 columns]\n",
      "first row of the selected chunck : \n",
      " [3648806180 35 '1398/06/23' 25410 'E198']\n",
      "163\n",
      "t0 = 25410\n",
      "ts = 55570\n",
      "time_intervals 50\n",
      "Origin destination interval view reindex \n",
      "    time_in  time_out\n",
      "0  25410.0   26010.0\n",
      "1  27210.0   27810.0\n",
      "2  30210.0   33210.0\n",
      "3  38010.0   40410.0\n",
      "4  42210.0   43410.0\n",
      "5  47010.0   47610.0\n",
      "6  50010.0   51210.0\n",
      "7  54210.0   55410.0\n",
      "OD bus stations of transactions: \n",
      "            CardID LineCode       FDate   Time  plat Station\n",
      "0       542446139        1  1398/06/23  24030  A145    3169\n",
      "1      2620656172        1  1398/06/23  24302  A145    3169\n",
      "2      3446252780        1  1398/06/23  26200  A145    1227\n",
      "3         7900260        1  1398/06/23  29677  A145    3169\n",
      "4       361857972        1  1398/06/23  29720  A145    3169\n",
      "...           ...      ...         ...    ...   ...     ...\n",
      "89424  2239177178       35  1398/06/23  50882  E198    2566\n",
      "89425   710839349       35  1398/06/23  50907  E198    2566\n",
      "89426   537037835       35  1398/06/23  50937  E198    2566\n",
      "89427  1527421710       35  1398/06/23  50987  E198    2566\n",
      "89428  1527421710       35  1398/06/23  50989  E198    2566\n",
      "\n",
      "[89429 rows x 6 columns]\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "C:\\Users\\esmaeli.h\\AppData\\Local\\Temp/ipykernel_12452/1949912630.py:257: ConvergenceWarning: Number of distinct clusters (21) found smaller than n_clusters (22). Possibly due to duplicate points in X.\n",
      "  kmeans = KMeans(n_clusters=len(filter_go_stations)-1,random_state=0).fit(partial_times.to_numpy())\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "transactions in line 35 plat E204\n",
      "ps: \n",
      "              CardID  LineCode       FDate   Time  plat\n",
      "177786  2117881492        35  1398/06/23  25357  E204\n",
      "177784  2481881044        35  1398/06/23  25377  E204\n",
      "177787  4279132146        35  1398/06/23  26216  E204\n",
      "177789   722073021        35  1398/06/23  26218  E204\n",
      "177790   429932526        35  1398/06/23  26221  E204\n",
      "...            ...       ...         ...    ...   ...\n",
      "175741  4245162631        35  1398/06/23  53057  E204\n",
      "175744  3629998268        35  1398/06/23  53332  E204\n",
      "175745  3152362414        35  1398/06/23  54528  E204\n",
      "175748  3258226925        35  1398/06/23  54680  E204\n",
      "175750  3258226925        35  1398/06/23  54681  E204\n",
      "\n",
      "[132 rows x 5 columns]\n",
      "first row of the selected chunck : \n",
      " [2117881492 35 '1398/06/23' 25357 'E204']\n",
      "132\n",
      "t0 = 25357\n",
      "ts = 54681\n",
      "time_intervals 49\n",
      "Origin destination interval view reindex \n",
      "     time_in  time_out\n",
      "0   25357.0   25957.0\n",
      "1   30157.0   30757.0\n",
      "2   33157.0   34957.0\n",
      "3   35557.0   36157.0\n",
      "4   37957.0   38557.0\n",
      "5   40957.0   42157.0\n",
      "6   43957.0   44557.0\n",
      "7   45157.0   46357.0\n",
      "8   48757.0   51157.0\n",
      "9   52357.0   53557.0\n",
      "10  54157.0   54757.0\n",
      "OD bus stations of transactions: \n",
      "            CardID LineCode       FDate   Time  plat Station\n",
      "0       542446139        1  1398/06/23  24030  A145    3169\n",
      "1      2620656172        1  1398/06/23  24302  A145    3169\n",
      "2      3446252780        1  1398/06/23  26200  A145    1227\n",
      "3         7900260        1  1398/06/23  29677  A145    3169\n",
      "4       361857972        1  1398/06/23  29720  A145    3169\n",
      "...           ...      ...         ...    ...   ...     ...\n",
      "89545  4245162631       35  1398/06/23  53057  E204    4092\n",
      "89546  3629998268       35  1398/06/23  53332  E204    4092\n",
      "89547  3152362414       35  1398/06/23  54528  E204    2566\n",
      "89548  3258226925       35  1398/06/23  54680  E204    2566\n",
      "89549  3258226925       35  1398/06/23  54681  E204    2566\n",
      "\n",
      "[89550 rows x 6 columns]\n",
      "transactions in line 35 plat E82\n",
      "ps: \n",
      "              CardID  LineCode       FDate   Time plat\n",
      "60901   1407207563        35  1398/06/23  21773  E82\n",
      "60902   2045251406        35  1398/06/23  21777  E82\n",
      "60903   3201852244        35  1398/06/23  22050  E82\n",
      "60906   2124191780        35  1398/06/23  22050  E82\n",
      "60904    869322629        35  1398/06/23  22054  E82\n",
      "...            ...       ...         ...    ...  ...\n",
      "526838   722265202        35  1398/06/23  62758  E82\n",
      "526839   722265202        35  1398/06/23  62759  E82\n",
      "542293  3405825723        35  1398/06/23  62761  E82\n",
      "542294   210849131        35  1398/06/23  62762  E82\n",
      "526840   262848081        35  1398/06/23  62763  E82\n",
      "\n",
      "[90 rows x 5 columns]\n",
      "first row of the selected chunck : \n",
      " [1407207563 35 '1398/06/23' 21773 'E82']\n",
      "90\n",
      "t0 = 21773\n",
      "ts = 62763\n",
      "time_intervals 68\n",
      "Origin destination interval view reindex \n",
      "    time_in  time_out\n",
      "0  21773.0   22373.0\n",
      "1  25373.0   25973.0\n",
      "2  31973.0   43373.0\n",
      "3  43973.0   55373.0\n",
      "4  55973.0   58973.0\n",
      "5  59573.0   61973.0\n",
      "OD bus stations of transactions: \n",
      "            CardID LineCode       FDate   Time  plat Station\n",
      "0       542446139        1  1398/06/23  24030  A145    3169\n",
      "1      2620656172        1  1398/06/23  24302  A145    3169\n",
      "2      3446252780        1  1398/06/23  26200  A145    1227\n",
      "3         7900260        1  1398/06/23  29677  A145    3169\n",
      "4       361857972        1  1398/06/23  29720  A145    3169\n",
      "...           ...      ...         ...    ...   ...     ...\n",
      "89609  3630236796       35  1398/06/23  55010   E82    4092\n",
      "89610  3446165292       35  1398/06/23  58515   E82    2566\n",
      "89611  3446165292       35  1398/06/23  58516   E82    2566\n",
      "89612  2506492388       35  1398/06/23  61922   E82    4092\n",
      "89613  2506492388       35  1398/06/23  61923   E82    4092\n",
      "\n",
      "[89614 rows x 6 columns]\n",
      "transactions in line 35 plat F65\n",
      "ps: \n",
      "              CardID  LineCode       FDate   Time plat\n",
      "27352    211921868        35  1398/06/23  24078  F65\n",
      "27356   2742310468        35  1398/06/23  24286  F65\n",
      "27358   2482296932        35  1398/06/23  24286  F65\n",
      "27362   3446828812        35  1398/06/23  24357  F65\n",
      "27365   1002380215        35  1398/06/23  24625  F65\n",
      "...            ...       ...         ...    ...  ...\n",
      "194814   983870907        35  1398/06/23  74481  F65\n",
      "194818   181766420        35  1398/06/23  74626  F65\n",
      "194821   181766420        35  1398/06/23  74627  F65\n",
      "194825  2854920366        35  1398/06/23  74633  F65\n",
      "27347   3791712492        35  1398/06/23  77391  F65\n",
      "\n",
      "[205 rows x 5 columns]\n",
      "first row of the selected chunck : \n",
      " [211921868 35 '1398/06/23' 24078 'F65']\n",
      "205\n",
      "t0 = 24078\n",
      "ts = 77391\n",
      "time_intervals 89\n",
      "Origin destination interval view reindex \n",
      "     time_in  time_out\n",
      "0   24078.0   24678.0\n",
      "1   25878.0   27078.0\n",
      "2   27678.0   28878.0\n",
      "3   30078.0   31278.0\n",
      "4   34878.0   36678.0\n",
      "5   39078.0   42078.0\n",
      "6   43878.0   44478.0\n",
      "7   45078.0   46278.0\n",
      "8   48678.0   49878.0\n",
      "9   52878.0   53478.0\n",
      "10  54078.0   56478.0\n",
      "11  58278.0   58878.0\n",
      "12  61878.0   63678.0\n",
      "13  70278.0   70878.0\n",
      "14  72078.0   73278.0\n",
      "15  74478.0   75078.0\n",
      "16  75678.0   77478.0\n",
      "OD bus stations of transactions: \n",
      "            CardID LineCode       FDate   Time  plat Station\n",
      "0       542446139        1  1398/06/23  24030  A145    3169\n",
      "1      2620656172        1  1398/06/23  24302  A145    3169\n",
      "2      3446252780        1  1398/06/23  26200  A145    1227\n",
      "3         7900260        1  1398/06/23  29677  A145    3169\n",
      "4       361857972        1  1398/06/23  29720  A145    3169\n",
      "...           ...      ...         ...    ...   ...     ...\n",
      "89706   983870907       35  1398/06/23  74481   F65    4092\n",
      "89707   181766420       35  1398/06/23  74626   F65    4092\n",
      "89708   181766420       35  1398/06/23  74627   F65    4092\n",
      "89709  2854920366       35  1398/06/23  74633   F65    4092\n",
      "89710  3791712492       35  1398/06/23  77391   F65    2566\n",
      "\n",
      "[89711 rows x 6 columns]\n",
      "transactions in line 35 plat N117\n",
      "ps: \n",
      "              CardID  LineCode       FDate   Time  plat\n",
      "157690  1527252286        35  1398/06/23  25476  N117\n",
      "157678  3445563788        35  1398/06/23  25477  N117\n",
      "157681  2503420756        35  1398/06/23  25480  N117\n",
      "157685  4275775426        35  1398/06/23  25554  N117\n",
      "157688   428324654        35  1398/06/23  25557  N117\n",
      "...            ...       ...         ...    ...   ...\n",
      "76194   2741918612        35  1398/06/23  72967  N117\n",
      "76197    291434075        35  1398/06/23  73094  N117\n",
      "157664   387382421        35  1398/06/23  74508  N117\n",
      "157668   387382421        35  1398/06/23  74512  N117\n",
      "157672   387382421        35  1398/06/23  74514  N117\n",
      "\n",
      "[174 rows x 5 columns]\n",
      "first row of the selected chunck : \n",
      " [1527252286 35 '1398/06/23' 25476 'N117']\n",
      "174\n",
      "t0 = 25476\n",
      "ts = 74514\n",
      "time_intervals 82\n",
      "Origin destination interval view reindex \n",
      "     time_in  time_out\n",
      "0   25476.0   26076.0\n",
      "1   27876.0   29076.0\n",
      "2   30876.0   31476.0\n",
      "3   32076.0   40476.0\n",
      "4   43476.0   44076.0\n",
      "5   46476.0   47076.0\n",
      "6   49476.0   50076.0\n",
      "7   51876.0   54276.0\n",
      "8   54876.0   56076.0\n",
      "9   57876.0   58476.0\n",
      "10  60876.0   61476.0\n",
      "11  62676.0   63276.0\n",
      "12  66276.0   66876.0\n",
      "13  71676.0   72876.0\n",
      "14  74076.0   74676.0\n",
      "OD bus stations of transactions: \n",
      "            CardID LineCode       FDate   Time  plat Station\n",
      "0       542446139        1  1398/06/23  24030  A145    3169\n",
      "1      2620656172        1  1398/06/23  24302  A145    3169\n",
      "2      3446252780        1  1398/06/23  26200  A145    1227\n",
      "3         7900260        1  1398/06/23  29677  A145    3169\n",
      "4       361857972        1  1398/06/23  29720  A145    3169\n",
      "...           ...      ...         ...    ...   ...     ...\n",
      "89825   537836046       35  1398/06/23  72811  N117    4092\n",
      "89826  2542134302       35  1398/06/23  72816  N117    4092\n",
      "89827   387382421       35  1398/06/23  74508  N117    2566\n",
      "89828   387382421       35  1398/06/23  74512  N117    2566\n",
      "89829   387382421       35  1398/06/23  74514  N117    2566\n",
      "\n",
      "[89830 rows x 6 columns]\n",
      "transactions in line 35 plat N39\n",
      "ps: \n",
      "              CardID  LineCode       FDate   Time plat\n",
      "444689  3109023717        35  1398/06/23  22393  N39\n",
      "444693  1527584398        35  1398/06/23  22559  N39\n",
      "444691   721928766        35  1398/06/23  22645  N39\n",
      "444695   722170582        35  1398/06/23  24619  N39\n",
      "444697  3630124268        35  1398/06/23  24824  N39\n",
      "...            ...       ...         ...    ...  ...\n",
      "72905   3559165489        35  1398/06/23  75106  N39\n",
      "72914   3180317934        35  1398/06/23  75276  N39\n",
      "72917   1001791694        35  1398/06/23  75680  N39\n",
      "128664  3679852636        35  1398/06/23  75798  N39\n",
      "444687  3791679212        35  1398/06/23  77984  N39\n",
      "\n",
      "[229 rows x 5 columns]\n",
      "first row of the selected chunck : \n",
      " [3109023717 35 '1398/06/23' 22393 'N39']\n",
      "229\n",
      "t0 = 22393\n",
      "ts = 77984\n",
      "time_intervals 93\n",
      "Origin destination interval view reindex \n",
      "     time_in  time_out\n",
      "0   22393.0   22993.0\n",
      "1   23593.0   24793.0\n",
      "2   28993.0   30193.0\n",
      "3   32593.0   34393.0\n",
      "4   36793.0   37993.0\n",
      "5   40993.0   42193.0\n",
      "6   43393.0   44593.0\n",
      "7   48793.0   49993.0\n",
      "8   51193.0   51793.0\n",
      "9   54793.0   57193.0\n",
      "10  61993.0   63793.0\n",
      "11  64393.0   64993.0\n",
      "12  66793.0   67393.0\n",
      "13  73393.0   73993.0\n",
      "14  76993.0   78193.0\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "OD bus stations of transactions: \n",
      "            CardID LineCode       FDate   Time  plat Station\n",
      "0       542446139        1  1398/06/23  24030  A145    3169\n",
      "1      2620656172        1  1398/06/23  24302  A145    3169\n",
      "2      3446252780        1  1398/06/23  26200  A145    1227\n",
      "3         7900260        1  1398/06/23  29677  A145    3169\n",
      "4       361857972        1  1398/06/23  29720  A145    3169\n",
      "...           ...      ...         ...    ...   ...     ...\n",
      "89897  3679107324       35  1398/06/23  73470   N39    4092\n",
      "89898  1781711748       35  1398/06/23  73695   N39    4092\n",
      "89899  1781711748       35  1398/06/23  73696   N39    4092\n",
      "89900   426511598       35  1398/06/23  73949   N39    4092\n",
      "89901  3791679212       35  1398/06/23  77984   N39    2566\n",
      "\n",
      "[89902 rows x 6 columns]\n",
      "stations in a specefic bus line 36\n",
      "len-of-go stations: 16\n",
      "len-of-back stations: 16\n",
      "len-of-go back stations: 0\n",
      "first Station  [3342 '36' '1' 'go' '??? ???? 2-??36' 51.673388 32.597384 'od' 'normal'\n",
      " 'no'] 3342\n",
      "last Station  [2881 '36' '1' 'back' '?? ? ?? ??-62-61-14' 51.666285 32.642218 'od'\n",
      " 'normal' 'no']\n",
      "['A38' 'E105' 'N196']\n",
      "transactions in line 36 plat A38\n",
      "ps: \n",
      "              CardID  LineCode       FDate   Time plat\n",
      "217582  4270509074        36  1398/06/23  29438  A38\n",
      "217578   555616382        36  1398/06/23  29628  A38\n",
      "217579   389292394        36  1398/06/23  29633  A38\n",
      "217580  1832763517        36  1398/06/23  29636  A38\n",
      "217581  3205800164        36  1398/06/23  29638  A38\n",
      "...            ...       ...         ...    ...  ...\n",
      "218109  1832087213        36  1398/06/23  75693  A38\n",
      "218111  3678542716        36  1398/06/23  76356  A38\n",
      "218112  3678542716        36  1398/06/23  76357  A38\n",
      "218113  3254590141        36  1398/06/23  76440  A38\n",
      "218114  3445534588        36  1398/06/23  76445  A38\n",
      "\n",
      "[78 rows x 5 columns]\n",
      "first row of the selected chunck : \n",
      " [4270509074 36 '1398/06/23' 29438 'A38']\n",
      "78\n",
      "t0 = 29438\n",
      "ts = 76445\n",
      "time_intervals 78\n",
      "Origin destination interval view reindex \n",
      "    time_in  time_out\n",
      "0  29438.0   30038.0\n",
      "1  30638.0   31238.0\n",
      "2  33038.0   34838.0\n",
      "3  36038.0   42038.0\n",
      "4  43838.0   44438.0\n",
      "5  45638.0   49838.0\n",
      "6  51038.0   53438.0\n",
      "7  55838.0   70238.0\n",
      "8  70838.0   71438.0\n",
      "9  73238.0   75638.0\n",
      "OD bus stations of transactions: \n",
      "            CardID LineCode       FDate   Time  plat Station\n",
      "0       542446139        1  1398/06/23  24030  A145    3169\n",
      "1      2620656172        1  1398/06/23  24302  A145    3169\n",
      "2      3446252780        1  1398/06/23  26200  A145    1227\n",
      "3         7900260        1  1398/06/23  29677  A145    3169\n",
      "4       361857972        1  1398/06/23  29720  A145    3169\n",
      "...           ...      ...         ...    ...   ...     ...\n",
      "90016  3672142082       36  1398/06/23  75460   A38    2881\n",
      "90017   260911153       36  1398/06/23  75462   A38    2881\n",
      "90018  2239163587       36  1398/06/23  75468   A38    2881\n",
      "90019  3405933273       36  1398/06/23  75473   A38    2881\n",
      "90020  4278148674       36  1398/06/23  75483   A38    2881\n",
      "\n",
      "[90021 rows x 6 columns]\n",
      "transactions in line 36 plat E105\n",
      "ps: \n",
      "              CardID  LineCode       FDate   Time  plat\n",
      "333251  2740769924        36  1398/06/23  21326  E105\n",
      "333252   427159390        36  1398/06/23  21402  E105\n",
      "333253  4076096042        36  1398/06/23  21674  E105\n",
      "333254   721775190        36  1398/06/23  21892  E105\n",
      "333255  3150775342        36  1398/06/23  21971  E105\n",
      "...            ...       ...         ...    ...   ...\n",
      "530355  1360582442        36  1398/06/23  77512  E105\n",
      "530356  3793129404        36  1398/06/23  77587  E105\n",
      "530359   721719822        36  1398/06/23  77904  E105\n",
      "530360  3405893771        36  1398/06/23  78028  E105\n",
      "530358  3677156044        36  1398/06/23  78047  E105\n",
      "\n",
      "[309 rows x 5 columns]\n",
      "first row of the selected chunck : \n",
      " [2740769924 36 '1398/06/23' 21326 'E105']\n",
      "309\n",
      "t0 = 21326\n",
      "ts = 78047\n",
      "time_intervals 95\n",
      "Origin destination interval view reindex \n",
      "     time_in  time_out\n",
      "0   21326.0   21926.0\n",
      "1   23126.0   24326.0\n",
      "2   27326.0   28526.0\n",
      "3   32726.0   33326.0\n",
      "4   33926.0   34526.0\n",
      "5   36926.0   37526.0\n",
      "6   41726.0   42926.0\n",
      "7   44126.0   45326.0\n",
      "8   46526.0   47126.0\n",
      "9   48326.0   50126.0\n",
      "10  51326.0   51926.0\n",
      "11  53126.0   53726.0\n",
      "12  56126.0   56726.0\n",
      "13  58526.0   59126.0\n",
      "14  60926.0   61526.0\n",
      "15  65126.0   66926.0\n",
      "16  67526.0   68126.0\n",
      "17  70526.0   71126.0\n",
      "18  72326.0   73526.0\n",
      "19  74726.0   77126.0\n",
      "OD bus stations of transactions: \n",
      "            CardID LineCode       FDate   Time  plat Station\n",
      "0       542446139        1  1398/06/23  24030  A145    3169\n",
      "1      2620656172        1  1398/06/23  24302  A145    3169\n",
      "2      3446252780        1  1398/06/23  26200  A145    1227\n",
      "3         7900260        1  1398/06/23  29677  A145    3169\n",
      "4       361857972        1  1398/06/23  29720  A145    3169\n",
      "...           ...      ...         ...    ...   ...     ...\n",
      "90117   721895715       36  1398/06/23  73506  E105    3342\n",
      "90118   721895715       36  1398/06/23  73507  E105    3342\n",
      "90119  3405961265       36  1398/06/23  73509  E105    3342\n",
      "90120  3405961265       36  1398/06/23  73510  E105    3342\n",
      "90121  3793996316       36  1398/06/23  76886  E105    2881\n",
      "\n",
      "[90122 rows x 6 columns]\n",
      "transactions in line 36 plat N196\n",
      "ps: \n",
      "             CardID  LineCode       FDate   Time  plat\n",
      "49986  3104707493        36  1398/06/23  22798  N196\n",
      "49987  2741209332        36  1398/06/23  23078  N196\n",
      "49988  3405788669        36  1398/06/23  23078  N196\n",
      "49989  1000738478        36  1398/06/23  23190  N196\n",
      "49990   209551691        36  1398/06/23  24678  N196\n",
      "49991  3446126108        36  1398/06/23  24773  N196\n",
      "49992   427455934        36  1398/06/23  24838  N196\n",
      "49993   362308116        36  1398/06/23  69620  N196\n",
      "49994   362308116        36  1398/06/23  69623  N196\n",
      "49995   722029141        36  1398/06/23  69667  N196\n",
      "49997   261587009        36  1398/06/23  69866  N196\n",
      "49998   261587009        36  1398/06/23  69867  N196\n",
      "49999  3208535172        36  1398/06/23  69868  N196\n",
      "50000   710022565        36  1398/06/23  69870  N196\n",
      "49996  3202343444        36  1398/06/23  69871  N196\n",
      "50001  4059386509        36  1398/06/23  69876  N196\n",
      "50002   721916844        36  1398/06/23  69879  N196\n",
      "50003   721916844        36  1398/06/23  69880  N196\n",
      "50004  4269523250        36  1398/06/23  70272  N196\n",
      "50005   395608666        36  1398/06/23  70289  N196\n",
      "50006   722002641        36  1398/06/23  71717  N196\n",
      "50007   722002641        36  1398/06/23  71719  N196\n",
      "50008  3445649660        36  1398/06/23  71983  N196\n",
      "50009  1765663316        36  1398/06/23  72138  N196\n",
      "50011  3154261054        36  1398/06/23  73150  N196\n",
      "50071  3154261054        36  1398/06/23  73151  N196\n",
      "50072  3996958580        36  1398/06/23  73314  N196\n",
      "50010  2740787940        36  1398/06/23  73316  N196\n",
      "50073  1598366692        36  1398/06/23  73316  N196\n",
      "50074  1598366692        36  1398/06/23  73317  N196\n",
      "50075  2742666660        36  1398/06/23  73318  N196\n",
      "50076  1835759485        36  1398/06/23  73323  N196\n",
      "50077   235215370        36  1398/06/23  73350  N196\n",
      "50078   722097339        36  1398/06/23  73450  N196\n",
      "50079  1775872916        36  1398/06/23  73736  N196\n",
      "50080  3590586565        36  1398/06/23  73743  N196\n",
      "50081  3647857876        36  1398/06/23  73747  N196\n",
      "50085   181717302        36  1398/06/23  73868  N196\n",
      "50086   181717302        36  1398/06/23  73869  N196\n",
      "50087  3180555278        36  1398/06/23  73874  N196\n",
      "50082   483197716        36  1398/06/23  73884  N196\n",
      "50088   426930990        36  1398/06/23  74015  N196\n",
      "50084   177284038        36  1398/06/23  74019  N196\n",
      "50089  4270140594        36  1398/06/23  74019  N196\n",
      "50090  2123603396        36  1398/06/23  74023  N196\n",
      "50091  2123603396        36  1398/06/23  74025  N196\n",
      "50092   177284038        36  1398/06/23  74610  N196\n",
      "49982   361339812        36  1398/06/23  76254  N196\n",
      "49983   361339812        36  1398/06/23  76263  N196\n",
      "49984   361339812        36  1398/06/23  76267  N196\n",
      "first row of the selected chunck : \n",
      " [3104707493 36 '1398/06/23' 22798 'N196']\n",
      "50\n",
      "t0 = 22798\n",
      "ts = 76267\n",
      "time_intervals 89\n",
      "Origin destination interval view reindex \n",
      "    time_in  time_out\n",
      "0  22798.0   23398.0\n",
      "1  23998.0   25198.0\n",
      "2  25798.0   70198.0\n",
      "3  71398.0   71998.0\n",
      "4  75598.0   76198.0\n",
      "OD bus stations of transactions: \n",
      "            CardID LineCode       FDate   Time  plat Station\n",
      "0       542446139        1  1398/06/23  24030  A145    3169\n",
      "1      2620656172        1  1398/06/23  24302  A145    3169\n",
      "2      3446252780        1  1398/06/23  26200  A145    1227\n",
      "3         7900260        1  1398/06/23  29677  A145    3169\n",
      "4       361857972        1  1398/06/23  29720  A145    3169\n",
      "...           ...      ...         ...    ...   ...     ...\n",
      "90252   721916844       36  1398/06/23  69879  N196    3342\n",
      "90253   721916844       36  1398/06/23  69880  N196    3342\n",
      "90254   722002641       36  1398/06/23  71717  N196    2881\n",
      "90255   722002641       36  1398/06/23  71719  N196    2881\n",
      "90256  3445649660       36  1398/06/23  71983  N196    2881\n",
      "\n",
      "[90257 rows x 6 columns]\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "stations in a specefic bus line 37\n",
      "len-of-go stations: 0\n",
      "len-of-back stations: 0\n",
      "len-of-go back stations: 0\n",
      "stations in a specefic bus line 38\n",
      "len-of-go stations: 20\n",
      "len-of-back stations: 0\n",
      "len-of-go back stations: 0\n",
      "stations in a specefic bus line 39\n",
      "len-of-go stations: 0\n",
      "len-of-back stations: 0\n",
      "len-of-go back stations: 20\n",
      "stations in a specefic bus line 40\n",
      "len-of-go stations: 23\n",
      "len-of-back stations: 30\n",
      "len-of-go back stations: 0\n",
      "first Station  [3656 '40' '1' 'go' '????' 51.596397 32.612497 'od' 'normal' 'no'] 3656\n",
      "last Station  [1632 '40' '1' 'back' '?? ? ?? ??-40' 51.665753 32.642641 'od' 'normal'\n",
      " 'no']\n",
      "['A163' 'D28' 'E230' 'F111' 'F114' 'F128' 'F136' 'F141' 'F175' 'F96'\n",
      " 'M212' 'M43' 'N159' 'N163' 'N78']\n",
      "transactions in line 40 plat A163\n",
      "ps: \n",
      "              CardID  LineCode       FDate   Time  plat\n",
      "327639  3258051101        40  1398/06/23  22554  A163\n",
      "327641  4057798477        40  1398/06/23  22698  A163\n",
      "327640   340743849        40  1398/06/23  22732  A163\n",
      "327643  1528672750        40  1398/06/23  23421  A163\n",
      "327644   985231499        40  1398/06/23  23423  A163\n",
      "...            ...       ...         ...    ...   ...\n",
      "509881  1002177543        40  1398/06/23  72814  A163\n",
      "327635  3791685244        40  1398/06/23  75615  A163\n",
      "327636  3791685244        40  1398/06/23  75622  A163\n",
      "327637  3791685244        40  1398/06/23  75624  A163\n",
      "327638  3791685244        40  1398/06/23  75626  A163\n",
      "\n",
      "[347 rows x 5 columns]\n",
      "first row of the selected chunck : \n",
      " [3258051101 40 '1398/06/23' 22554 'A163']\n",
      "347\n",
      "t0 = 22554\n",
      "ts = 75626\n",
      "time_intervals 88\n",
      "Origin destination interval view reindex \n",
      "     time_in  time_out\n",
      "0   22554.0   23154.0\n",
      "1   25554.0   26154.0\n",
      "2   27354.0   27954.0\n",
      "3   28554.0   29154.0\n",
      "4   30954.0   31554.0\n",
      "5   33354.0   33954.0\n",
      "6   36354.0   38154.0\n",
      "7   42354.0   42954.0\n",
      "8   43554.0   44154.0\n",
      "9   46554.0   48354.0\n",
      "10  49554.0   50154.0\n",
      "11  52554.0   53754.0\n",
      "12  54354.0   55554.0\n",
      "13  57354.0   58554.0\n",
      "14  60354.0   61554.0\n",
      "15  64554.0   65754.0\n",
      "16  68154.0   69954.0\n",
      "17  73554.0   75354.0\n",
      "OD bus stations of transactions: \n",
      "            CardID LineCode       FDate   Time  plat Station\n",
      "0       542446139        1  1398/06/23  24030  A145    3169\n",
      "1      2620656172        1  1398/06/23  24302  A145    3169\n",
      "2      3446252780        1  1398/06/23  26200  A145    1227\n",
      "3         7900260        1  1398/06/23  29677  A145    3169\n",
      "4       361857972        1  1398/06/23  29720  A145    3169\n",
      "...           ...      ...         ...    ...   ...     ...\n",
      "90340  3792748972       40  1398/06/23  69841  A163    3656\n",
      "90341  3676290722       40  1398/06/23  69854  A163    3656\n",
      "90342  3676290722       40  1398/06/23  69858  A163    3656\n",
      "90343  3676290722       40  1398/06/23  69863  A163    3656\n",
      "90344  1294655134       40  1398/06/23  69866  A163    3656\n",
      "\n",
      "[90345 rows x 6 columns]\n",
      "transactions in line 40 plat D28\n",
      "ps: \n",
      "              CardID  LineCode       FDate   Time plat\n",
      "15904   1295767726        40  1398/06/23  60551  D28\n",
      "15905    869381318        40  1398/06/23  60558  D28\n",
      "15906    869381318        40  1398/06/23  60560  D28\n",
      "15907   2618222620        40  1398/06/23  60985  D28\n",
      "15908    983867099        40  1398/06/23  61005  D28\n",
      "...            ...       ...         ...    ...  ...\n",
      "288889  3254425053        40  1398/06/23  70691  D28\n",
      "288892  3793695324        40  1398/06/23  70693  D28\n",
      "288890  3254425053        40  1398/06/23  70696  D28\n",
      "288893  2183428211        40  1398/06/23  70898  D28\n",
      "288894   902533268        40  1398/06/23  70902  D28\n",
      "\n",
      "[112 rows x 5 columns]\n",
      "first row of the selected chunck : \n",
      " [1295767726 40 '1398/06/23' 60551 'D28']\n",
      "112\n",
      "t0 = 60551\n",
      "ts = 70902\n",
      "time_intervals 17\n",
      "Origin destination interval view reindex \n",
      "    time_in  time_out\n",
      "0  60551.0   61151.0\n",
      "1  63551.0   64751.0\n",
      "2  67151.0   68351.0\n",
      "OD bus stations of transactions: \n",
      "            CardID LineCode       FDate   Time  plat Station\n",
      "0       542446139        1  1398/06/23  24030  A145    3169\n",
      "1      2620656172        1  1398/06/23  24302  A145    3169\n",
      "2      3446252780        1  1398/06/23  26200  A145    1227\n",
      "3         7900260        1  1398/06/23  29677  A145    3169\n",
      "4       361857972        1  1398/06/23  29720  A145    3169\n",
      "...           ...      ...         ...    ...   ...     ...\n",
      "90522  2743048468       40  1398/06/23  68058   D28    3656\n",
      "90523  4265542674       40  1398/06/23  68074   D28    3656\n",
      "90524  2742841188       40  1398/06/23  68205   D28    3656\n",
      "90525   982670395       40  1398/06/23  68297   D28    3656\n",
      "90526  2587122932       40  1398/06/23  68347   D28    3656\n",
      "\n",
      "[90527 rows x 6 columns]\n",
      "transactions in line 40 plat E230\n",
      "ps: \n",
      "              CardID  LineCode       FDate   Time  plat\n",
      "521138   234284522        40  1398/06/23  26122  E230\n",
      "521139   869247532        40  1398/06/23  26152  E230\n",
      "521140  2742509188        40  1398/06/23  26222  E230\n",
      "521141   211781659        40  1398/06/23  27195  E230\n",
      "521142  2123113348        40  1398/06/23  28050  E230\n",
      "...            ...       ...         ...    ...   ...\n",
      "517168  2621503820        40  1398/06/23  46243  E230\n",
      "517169   721940508        40  1398/06/23  46298  E230\n",
      "517170   179797846        40  1398/06/23  46378  E230\n",
      "517172   983222635        40  1398/06/23  46707  E230\n",
      "517171  3104637973        40  1398/06/23  46711  E230\n",
      "\n",
      "[178 rows x 5 columns]\n",
      "first row of the selected chunck : \n",
      " [234284522 40 '1398/06/23' 26122 'E230']\n",
      "178\n",
      "t0 = 26122\n",
      "ts = 46711\n",
      "time_intervals 34\n",
      "Origin destination interval view reindex \n",
      "    time_in  time_out\n",
      "0  26122.0   26722.0\n",
      "1  27922.0   28522.0\n",
      "2  36922.0   37522.0\n",
      "3  41722.0   43522.0\n",
      "OD bus stations of transactions: \n",
      "            CardID LineCode       FDate   Time  plat Station\n",
      "0       542446139        1  1398/06/23  24030  A145    3169\n",
      "1      2620656172        1  1398/06/23  24302  A145    3169\n",
      "2      3446252780        1  1398/06/23  26200  A145    1227\n",
      "3         7900260        1  1398/06/23  29677  A145    3169\n",
      "4       361857972        1  1398/06/23  29720  A145    3169\n",
      "...           ...      ...         ...    ...   ...     ...\n",
      "90546  2618094156       40  1398/06/23  43279  E230    1632\n",
      "90547  3632321180       40  1398/06/23  43281  E230    1632\n",
      "90548  3631106108       40  1398/06/23  43287  E230    1632\n",
      "90549  3631106108       40  1398/06/23  43288  E230    1632\n",
      "90550  3631106108       40  1398/06/23  43289  E230    1632\n",
      "\n",
      "[90551 rows x 6 columns]\n",
      "transactions in line 40 plat F111\n",
      "ps: \n",
      "              CardID  LineCode       FDate   Time  plat\n",
      "517290  3792035212        40  1398/06/23  22440  F111\n",
      "517291  1764819028        40  1398/06/23  23453  F111\n",
      "517292  3205926972        40  1398/06/23  24394  F111\n",
      "517293  4255232628        40  1398/06/23  24771  F111\n",
      "517294  2740650804        40  1398/06/23  24871  F111\n",
      "...            ...       ...         ...    ...   ...\n",
      "517660  4266290786        40  1398/06/23  45127  F111\n",
      "517661   210884620        40  1398/06/23  45308  F111\n",
      "517288  3679960348        40  1398/06/23  45323  F111\n",
      "517289  3679960348        40  1398/06/23  45326  F111\n",
      "517662  1360461498        40  1398/06/23  45357  F111\n",
      "\n",
      "[137 rows x 5 columns]\n",
      "first row of the selected chunck : \n",
      " [3792035212 40 '1398/06/23' 22440 'F111']\n",
      "137\n",
      "t0 = 22440\n",
      "ts = 45357\n",
      "time_intervals 38\n",
      "Origin destination interval view reindex \n",
      "    time_in  time_out\n",
      "0  22440.0   23640.0\n",
      "1  24240.0   24840.0\n",
      "2  26640.0   27840.0\n",
      "3  31440.0   32640.0\n",
      "4  35040.0   35640.0\n",
      "5  37440.0   38040.0\n",
      "6  42240.0   43440.0\n",
      "OD bus stations of transactions: \n",
      "            CardID LineCode       FDate   Time  plat Station\n",
      "0       542446139        1  1398/06/23  24030  A145    3169\n",
      "1      2620656172        1  1398/06/23  24302  A145    3169\n",
      "2      3446252780        1  1398/06/23  26200  A145    1227\n",
      "3         7900260        1  1398/06/23  29677  A145    3169\n",
      "4       361857972        1  1398/06/23  29720  A145    3169\n",
      "...           ...      ...         ...    ...   ...     ...\n",
      "90699  3679960348       40  1398/06/23  37994  F111    1632\n",
      "90700  3679960348       40  1398/06/23  37997  F111    1632\n",
      "90701  3679960348       40  1398/06/23  38000  F111    1632\n",
      "90702  3679960348       40  1398/06/23  38002  F111    1632\n",
      "90703   261222113       40  1398/06/23  43410  F111    3656\n",
      "\n",
      "[90704 rows x 6 columns]\n",
      "transactions in line 40 plat F114\n",
      "ps: \n",
      "              CardID  LineCode       FDate   Time  plat\n",
      "266628   484073988        40  1398/06/23  48394  F114\n",
      "266629  2497663485        40  1398/06/23  48489  F114\n",
      "266630  3678285020        40  1398/06/23  48785  F114\n",
      "266631   721820029        40  1398/06/23  48871  F114\n",
      "266632  3108606277        40  1398/06/23  48901  F114\n",
      "...            ...       ...         ...    ...   ...\n",
      "267406  2681539854        40  1398/06/23  75384  F114\n",
      "267407  3154202718        40  1398/06/23  75392  F114\n",
      "267408   556539230        40  1398/06/23  75818  F114\n",
      "267409  3405889460        40  1398/06/23  75824  F114\n",
      "267410  3154273630        40  1398/06/23  75855  F114\n",
      "\n",
      "[194 rows x 5 columns]\n",
      "first row of the selected chunck : \n",
      " [484073988 40 '1398/06/23' 48394 'F114']\n",
      "194\n",
      "t0 = 48394\n",
      "ts = 75855\n",
      "time_intervals 46\n",
      "Origin destination interval view reindex \n",
      "    time_in  time_out\n",
      "0  48394.0   48994.0\n",
      "1  51994.0   53794.0\n",
      "2  56194.0   57994.0\n",
      "3  61594.0   62194.0\n",
      "4  66994.0   67594.0\n",
      "5  71794.0   72394.0\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "OD bus stations of transactions: \n",
      "            CardID LineCode       FDate   Time  plat Station\n",
      "0       542446139        1  1398/06/23  24030  A145    3169\n",
      "1      2620656172        1  1398/06/23  24302  A145    3169\n",
      "2      3446252780        1  1398/06/23  26200  A145    1227\n",
      "3         7900260        1  1398/06/23  29677  A145    3169\n",
      "4       361857972        1  1398/06/23  29720  A145    3169\n",
      "...           ...      ...         ...    ...   ...     ...\n",
      "90748  1832876013       40  1398/06/23  67556  F114    3656\n",
      "90749  1598410260       40  1398/06/23  67580  F114    3656\n",
      "90750  3203269956       40  1398/06/23  71987  F114    1632\n",
      "90751  3203269956       40  1398/06/23  71989  F114    1632\n",
      "90752  3203269956       40  1398/06/23  71992  F114    1632\n",
      "\n",
      "[90753 rows x 6 columns]\n",
      "transactions in line 40 plat F128\n",
      "ps: \n",
      "              CardID  LineCode       FDate   Time  plat\n",
      "416074  2138312877        40  1398/06/23  72662  F128\n",
      "416075  1837621325        40  1398/06/23  72665  F128\n",
      "416076   722121427        40  1398/06/23  72715  F128\n",
      "416077  3181357022        40  1398/06/23  75469  F128\n",
      "416078   722074979        40  1398/06/23  75502  F128\n",
      "416079  1407240396        40  1398/06/23  75520  F128\n",
      "416080   556392862        40  1398/06/23  75527  F128\n",
      "416084   722212469        40  1398/06/23  75592  F128\n",
      "416085   539281163        40  1398/06/23  75629  F128\n",
      "416081   212192651        40  1398/06/23  75641  F128\n",
      "416082   212192651        40  1398/06/23  75648  F128\n",
      "416083   260832081        40  1398/06/23  75653  F128\n",
      "416310   721970106        40  1398/06/23  75654  F128\n",
      "416311   721970106        40  1398/06/23  75655  F128\n",
      "416312   262762449        40  1398/06/23  75692  F128\n",
      "416314  3547381348        40  1398/06/23  75833  F128\n",
      "416315  3547381348        40  1398/06/23  75834  F128\n",
      "416316  2742559908        40  1398/06/23  75898  F128\n",
      "416317   343223572        40  1398/06/23  75902  F128\n",
      "416318   722194154        40  1398/06/23  75905  F128\n",
      "416313  3258177005        40  1398/06/23  75947  F128\n",
      "416319   428732894        40  1398/06/23  75960  F128\n",
      "416320  2506156612        40  1398/06/23  75962  F128\n",
      "416323  2239060995        40  1398/06/23  76016  F128\n",
      "416324   428488094        40  1398/06/23  76027  F128\n",
      "416325  3555499857        40  1398/06/23  76031  F128\n",
      "416321  3792348364        40  1398/06/23  76032  F128\n",
      "416322  3977285940        40  1398/06/23  76038  F128\n",
      "416326   722154814        40  1398/06/23  76072  F128\n",
      "416327  3258269997        40  1398/06/23  76151  F128\n",
      "416328  1776149076        40  1398/06/23  76171  F128\n",
      "416329  1776149076        40  1398/06/23  76173  F128\n",
      "416330   869299426        40  1398/06/23  76208  F128\n",
      "416331   209482411        40  1398/06/23  76290  F128\n",
      "416332  3678315420        40  1398/06/23  76355  F128\n",
      "416333  1407204257        40  1398/06/23  76359  F128\n",
      "416334  1407204257        40  1398/06/23  76360  F128\n",
      "416335  1407204257        40  1398/06/23  76361  F128\n",
      "416336  1765075636        40  1398/06/23  76428  F128\n",
      "416337   869249137        40  1398/06/23  76790  F128\n",
      "416338  1832260813        40  1398/06/23  76793  F128\n",
      "416339   869249137        40  1398/06/23  76797  F128\n",
      "416340  1530435694        40  1398/06/23  76860  F128\n",
      "416341   869184157        40  1398/06/23  77092  F128\n",
      "first row of the selected chunck : \n",
      " [2138312877 40 '1398/06/23' 72662 'F128']\n",
      "44\n",
      "t0 = 72662\n",
      "ts = 77092\n",
      "time_intervals 7\n",
      "Origin destination interval view reindex \n",
      "    time_in  time_out\n",
      "0  72662.0   73262.0\n",
      "1  73862.0   75662.0\n",
      "OD bus stations of transactions: \n",
      "            CardID LineCode       FDate   Time  plat Station\n",
      "0       542446139        1  1398/06/23  24030  A145    3169\n",
      "1      2620656172        1  1398/06/23  24302  A145    3169\n",
      "2      3446252780        1  1398/06/23  26200  A145    1227\n",
      "3         7900260        1  1398/06/23  29677  A145    3169\n",
      "4       361857972        1  1398/06/23  29720  A145    3169\n",
      "...           ...      ...         ...    ...   ...     ...\n",
      "90868   212192651       40  1398/06/23  75641  F128    1632\n",
      "90869   212192651       40  1398/06/23  75648  F128    1632\n",
      "90870   260832081       40  1398/06/23  75653  F128    1632\n",
      "90871   721970106       40  1398/06/23  75654  F128    1632\n",
      "90872   721970106       40  1398/06/23  75655  F128    1632\n",
      "\n",
      "[90873 rows x 6 columns]\n",
      "transactions in line 40 plat F136\n",
      "ps: \n",
      "              CardID  LineCode       FDate   Time  plat\n",
      "117823   980539211        40  1398/06/23  23606  F136\n",
      "117824  2618137164        40  1398/06/23  23777  F136\n",
      "117825   983313531        40  1398/06/23  23823  F136\n",
      "117826  2048044690        40  1398/06/23  23824  F136\n",
      "117827  2122422804        40  1398/06/23  23826  F136\n",
      "...            ...       ...         ...    ...   ...\n",
      "309046  1610738027        40  1398/06/23  73991  F136\n",
      "117819  3791710924        40  1398/06/23  75483  F136\n",
      "117820  3791710924        40  1398/06/23  75485  F136\n",
      "117821  3791710924        40  1398/06/23  75487  F136\n",
      "117822  3791710924        40  1398/06/23  75490  F136\n",
      "\n",
      "[258 rows x 5 columns]\n",
      "first row of the selected chunck : \n",
      " [980539211 40 '1398/06/23' 23606 'F136']\n",
      "258\n",
      "t0 = 23606\n",
      "ts = 75490\n",
      "time_intervals 86\n",
      "Origin destination interval view reindex \n",
      "     time_in  time_out\n",
      "0   23606.0   24206.0\n",
      "1   25406.0   26006.0\n",
      "2   26606.0   27206.0\n",
      "3   29006.0   30806.0\n",
      "4   32606.0   33806.0\n",
      "5   37406.0   39206.0\n",
      "6   43406.0   44606.0\n",
      "7   48206.0   48806.0\n",
      "8   49406.0   50006.0\n",
      "9   50606.0   51206.0\n",
      "10  53606.0   54806.0\n",
      "11  57206.0   57806.0\n",
      "12  59606.0   60206.0\n",
      "13  62006.0   63806.0\n",
      "14  66806.0   67406.0\n",
      "15  69806.0   70406.0\n",
      "16  71006.0   72206.0\n",
      "17  74606.0   75206.0\n",
      "OD bus stations of transactions: \n",
      "            CardID LineCode       FDate   Time  plat Station\n",
      "0       542446139        1  1398/06/23  24030  A145    3169\n",
      "1      2620656172        1  1398/06/23  24302  A145    3169\n",
      "2      3446252780        1  1398/06/23  26200  A145    1227\n",
      "3         7900260        1  1398/06/23  29677  A145    3169\n",
      "4       361857972        1  1398/06/23  29720  A145    3169\n",
      "...           ...      ...         ...    ...   ...     ...\n",
      "90929  3673044722       40  1398/06/23  71982  F136    3656\n",
      "90930  2129511860       40  1398/06/23  72026  F136    3656\n",
      "90931   645797853       40  1398/06/23  72100  F136    3656\n",
      "90932  2742917108       40  1398/06/23  72126  F136    3656\n",
      "90933  2740862900       40  1398/06/23  72129  F136    3656\n",
      "\n",
      "[90934 rows x 6 columns]\n",
      "transactions in line 40 plat F141\n",
      "ps: \n",
      "              CardID  LineCode       FDate   Time  plat\n",
      "257584  3405847899        40  1398/06/23  59376  F141\n",
      "257585   474164554        40  1398/06/23  59410  F141\n",
      "257586  2498208749        40  1398/06/23  59708  F141\n",
      "257587  1837694685        40  1398/06/23  59840  F141\n",
      "257588   235049402        40  1398/06/23  59863  F141\n",
      "...            ...       ...         ...    ...   ...\n",
      "257491  3791726652        40  1398/06/23  74747  F141\n",
      "49965   1002019543        40  1398/06/23  74934  F141\n",
      "49966   2026882778        40  1398/06/23  74937  F141\n",
      "49967   3214516932        40  1398/06/23  74940  F141\n",
      "49968   2505494772        40  1398/06/23  75153  F141\n",
      "\n",
      "[109 rows x 5 columns]\n",
      "first row of the selected chunck : \n",
      " [3405847899 40 '1398/06/23' 59376 'F141']\n",
      "109\n",
      "t0 = 59376\n",
      "ts = 75153\n",
      "time_intervals 26\n",
      "Origin destination interval view reindex \n",
      "    time_in  time_out\n",
      "0  59376.0   59976.0\n",
      "1  65376.0   65976.0\n",
      "2  68376.0   69576.0\n",
      "3  70776.0   73176.0\n",
      "OD bus stations of transactions: \n",
      "            CardID LineCode       FDate   Time  plat Station\n",
      "0       542446139        1  1398/06/23  24030  A145    3169\n",
      "1      2620656172        1  1398/06/23  24302  A145    3169\n",
      "2      3446252780        1  1398/06/23  26200  A145    1227\n",
      "3         7900260        1  1398/06/23  29677  A145    3169\n",
      "4       361857972        1  1398/06/23  29720  A145    3169\n",
      "...           ...      ...         ...    ...   ...     ...\n",
      "91027   427700366       40  1398/06/23  72920  F141    1632\n",
      "91028  3405856677       40  1398/06/23  72930  F141    1632\n",
      "91029  3179275886       40  1398/06/23  73061  F141    1632\n",
      "91030   113944371       40  1398/06/23  73131  F141    1632\n",
      "91031   428580878       40  1398/06/23  73172  F141    1632\n",
      "\n",
      "[91032 rows x 6 columns]\n",
      "transactions in line 40 plat F175\n",
      "ps: \n",
      "              CardID  LineCode       FDate   Time  plat\n",
      "611016  2620532428        40  1398/06/23  66733  F175\n",
      "611017   212324444        40  1398/06/23  67553  F175\n",
      "611018  3701199605        40  1398/06/23  67559  F175\n",
      "611019   900706388        40  1398/06/23  67568  F175\n",
      "611020   900706388        40  1398/06/23  67570  F175\n",
      "...            ...       ...         ...    ...   ...\n",
      "611313   869432410        40  1398/06/23  75492  F175\n",
      "611314  3405813518        40  1398/06/23  75492  F175\n",
      "558706  3679702732        40  1398/06/23  78605  F175\n",
      "558707  3679702732        40  1398/06/23  78607  F175\n",
      "558708  3679702732        40  1398/06/23  78609  F175\n",
      "\n",
      "[68 rows x 5 columns]\n",
      "first row of the selected chunck : \n",
      " [2620532428 40 '1398/06/23' 66733 'F175']\n",
      "68\n",
      "t0 = 66733\n",
      "ts = 78609\n",
      "time_intervals 20\n",
      "Origin destination interval view reindex \n",
      "    time_in  time_out\n",
      "0  66733.0   67933.0\n",
      "1  71533.0   73933.0\n",
      "2  76333.0   78733.0\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "OD bus stations of transactions: \n",
      "            CardID LineCode       FDate   Time  plat Station\n",
      "0       542446139        1  1398/06/23  24030  A145    3169\n",
      "1      2620656172        1  1398/06/23  24302  A145    3169\n",
      "2      3446252780        1  1398/06/23  26200  A145    1227\n",
      "3         7900260        1  1398/06/23  29677  A145    3169\n",
      "4       361857972        1  1398/06/23  29720  A145    3169\n",
      "...           ...      ...         ...    ...   ...     ...\n",
      "91085  2680198494       40  1398/06/23  73473  F175    1632\n",
      "91086  3257456477       40  1398/06/23  73901  F175    1632\n",
      "91087  3679702732       40  1398/06/23  78605  F175    3656\n",
      "91088  3679702732       40  1398/06/23  78607  F175    3656\n",
      "91089  3679702732       40  1398/06/23  78609  F175    3656\n",
      "\n",
      "[91090 rows x 6 columns]\n",
      "transactions in line 40 plat F96\n",
      "ps: \n",
      "             CardID  LineCode       FDate   Time plat\n",
      "51260  1407176343        40  1398/06/23  63483  F96\n",
      "51262  4256782516        40  1398/06/23  63746  F96\n",
      "51263  4256782516        40  1398/06/23  63748  F96\n",
      "51261   645797853        40  1398/06/23  63926  F96\n",
      "51264   235773898        40  1398/06/23  64141  F96\n",
      "51265  1613776373        40  1398/06/23  64285  F96\n",
      "51266   722037836        40  1398/06/23  64285  F96\n",
      "51267   722037836        40  1398/06/23  64286  F96\n",
      "51268   722037836        40  1398/06/23  64288  F96\n",
      "51269   982676699        40  1398/06/23  64371  F96\n",
      "51270  3793925820        40  1398/06/23  64599  F96\n",
      "51271   722221370        40  1398/06/23  64762  F96\n",
      "51272   722221370        40  1398/06/23  64763  F96\n",
      "51273   869208444        40  1398/06/23  67172  F96\n",
      "51274   869208444        40  1398/06/23  67174  F96\n",
      "51384  1407540649        40  1398/06/23  67322  F96\n",
      "51385   362464132        40  1398/06/23  67387  F96\n",
      "51386  3676296866        40  1398/06/23  67402  F96\n",
      "51387   721930509        40  1398/06/23  67406  F96\n",
      "51388   210069995        40  1398/06/23  67413  F96\n",
      "51390  1371254078        40  1398/06/23  67439  F96\n",
      "51389   722210202        40  1398/06/23  67538  F96\n",
      "51391  1407170073        40  1398/06/23  67644  F96\n",
      "51392  3792096460        40  1398/06/23  67821  F96\n",
      "51393  1835460141        40  1398/06/23  67852  F96\n",
      "51394  2183573203        40  1398/06/23  68186  F96\n",
      "51397   180213444        40  1398/06/23  68282  F96\n",
      "51395   646071325        40  1398/06/23  68389  F96\n",
      "51398  1296120494        40  1398/06/23  68393  F96\n",
      "51396   387697226        40  1398/06/23  68406  F96\n",
      "51399  2490946116        40  1398/06/23  68686  F96\n",
      "51400  3183103966        40  1398/06/23  68688  F96\n",
      "51401   722182724        40  1398/06/23  71632  F96\n",
      "51402   722182724        40  1398/06/23  71634  F96\n",
      "51403  3445057388        40  1398/06/23  72136  F96\n",
      "51404  2742161044        40  1398/06/23  72403  F96\n",
      "51405  2048063842        40  1398/06/23  72587  F96\n",
      "51406  2048063842        40  1398/06/23  72588  F96\n",
      "51407  2541579758        40  1398/06/23  72692  F96\n",
      "51408  2541579758        40  1398/06/23  72693  F96\n",
      "51409   722037692        40  1398/06/23  72703  F96\n",
      "51410  4275314706        40  1398/06/23  72862  F96\n",
      "51413  2742425060        40  1398/06/23  73218  F96\n",
      "51411  3151345998        40  1398/06/23  73219  F96\n",
      "51412  1001078510        40  1398/06/23  73223  F96\n",
      "first row of the selected chunck : \n",
      " [1407176343 40 '1398/06/23' 63483 'F96']\n",
      "45\n",
      "t0 = 63483\n",
      "ts = 73223\n",
      "time_intervals 16\n",
      "Origin destination interval view reindex \n",
      "    time_in  time_out\n",
      "0  63483.0   64083.0\n",
      "1  65883.0   67683.0\n",
      "2  69483.0   71883.0\n",
      "OD bus stations of transactions: \n",
      "            CardID LineCode       FDate   Time  plat Station\n",
      "0       542446139        1  1398/06/23  24030  A145    3169\n",
      "1      2620656172        1  1398/06/23  24302  A145    3169\n",
      "2      3446252780        1  1398/06/23  26200  A145    1227\n",
      "3         7900260        1  1398/06/23  29677  A145    3169\n",
      "4       361857972        1  1398/06/23  29720  A145    3169\n",
      "...           ...      ...         ...    ...   ...     ...\n",
      "91137  1371254078       40  1398/06/23  67439   F96    1632\n",
      "91138   722210202       40  1398/06/23  67538   F96    1632\n",
      "91139  1407170073       40  1398/06/23  67644   F96    1632\n",
      "91140   722182724       40  1398/06/23  71632   F96    3656\n",
      "91141   722182724       40  1398/06/23  71634   F96    3656\n",
      "\n",
      "[91142 rows x 6 columns]\n",
      "transactions in line 40 plat M212\n",
      "ps: \n",
      "              CardID  LineCode       FDate   Time  plat\n",
      "473013  3630426188        40  1398/06/23  26023  M212\n",
      "473014   721965570        40  1398/06/23  26188  M212\n",
      "473015  3258130397        40  1398/06/23  26284  M212\n",
      "473016   211443884        40  1398/06/23  26292  M212\n",
      "473017  3677712572        40  1398/06/23  26464  M212\n",
      "...            ...       ...         ...    ...   ...\n",
      "474370  4279381890        40  1398/06/23  75013  M212\n",
      "474371  3208572532        40  1398/06/23  75015  M212\n",
      "474372   721899250        40  1398/06/23  75200  M212\n",
      "474373  2138776669        40  1398/06/23  75721  M212\n",
      "474374   721981085        40  1398/06/23  75982  M212\n",
      "\n",
      "[327 rows x 5 columns]\n",
      "first row of the selected chunck : \n",
      " [3630426188 40 '1398/06/23' 26023 'M212']\n",
      "327\n",
      "t0 = 26023\n",
      "ts = 75982\n",
      "time_intervals 83\n",
      "Origin destination interval view reindex \n",
      "     time_in  time_out\n",
      "0   26023.0   26623.0\n",
      "1   28423.0   29023.0\n",
      "2   33823.0   34423.0\n",
      "3   37423.0   41623.0\n",
      "4   42223.0   47623.0\n",
      "5   53623.0   54223.0\n",
      "6   57223.0   57823.0\n",
      "7   59023.0   60823.0\n",
      "8   62623.0   63223.0\n",
      "9   65623.0   66223.0\n",
      "10  67423.0   68023.0\n",
      "11  74023.0   74623.0\n",
      "OD bus stations of transactions: \n",
      "            CardID LineCode       FDate   Time  plat Station\n",
      "0       542446139        1  1398/06/23  24030  A145    3169\n",
      "1      2620656172        1  1398/06/23  24302  A145    3169\n",
      "2      3446252780        1  1398/06/23  26200  A145    1227\n",
      "3         7900260        1  1398/06/23  29677  A145    3169\n",
      "4       361857972        1  1398/06/23  29720  A145    3169\n",
      "...           ...      ...         ...    ...   ...     ...\n",
      "91202   996624590       40  1398/06/23  74225  M212    1632\n",
      "91203   996624590       40  1398/06/23  74227  M212    1632\n",
      "91204   796393486       40  1398/06/23  74392  M212    1632\n",
      "91205  3792216844       40  1398/06/23  74538  M212    1632\n",
      "91206   181643844       40  1398/06/23  74574  M212    1632\n",
      "\n",
      "[91207 rows x 6 columns]\n",
      "transactions in line 40 plat M43\n",
      "ps: \n",
      "              CardID  LineCode       FDate   Time plat\n",
      "616341   427039134        40  1398/06/23  22600  M43\n",
      "616342  3258063229        40  1398/06/23  25104  M43\n",
      "616343  2541931486        40  1398/06/23  25755  M43\n",
      "616346   426357678        40  1398/06/23  25884  M43\n",
      "616347  2123812212        40  1398/06/23  25886  M43\n",
      "...            ...       ...         ...    ...  ...\n",
      "617376   996694174        40  1398/06/23  76568  M43\n",
      "617495   996694174        40  1398/06/23  76569  M43\n",
      "617496   343043492        40  1398/06/23  76612  M43\n",
      "616340   361347140        40  1398/06/23  76638  M43\n",
      "617497  3444810844        40  1398/06/23  76919  M43\n",
      "\n",
      "[201 rows x 5 columns]\n",
      "first row of the selected chunck : \n",
      " [427039134 40 '1398/06/23' 22600 'M43']\n",
      "201\n",
      "t0 = 22600\n",
      "ts = 76919\n",
      "time_intervals 91\n",
      "Origin destination interval view reindex \n",
      "     time_in  time_out\n",
      "0   22600.0   25600.0\n",
      "1   27400.0   28600.0\n",
      "2   29200.0   29800.0\n",
      "3   30400.0   31000.0\n",
      "4   32200.0   40600.0\n",
      "5   43000.0   43600.0\n",
      "6   46000.0   46600.0\n",
      "7   48400.0   49000.0\n",
      "8   51400.0   52000.0\n",
      "9   55000.0   55600.0\n",
      "10  57400.0   59200.0\n",
      "11  63400.0   65200.0\n",
      "12  67600.0   68800.0\n",
      "13  71200.0   76000.0\n",
      "OD bus stations of transactions: \n",
      "            CardID LineCode       FDate   Time  plat Station\n",
      "0       542446139        1  1398/06/23  24030  A145    3169\n",
      "1      2620656172        1  1398/06/23  24302  A145    3169\n",
      "2      3446252780        1  1398/06/23  26200  A145    1227\n",
      "3         7900260        1  1398/06/23  29677  A145    3169\n",
      "4       361857972        1  1398/06/23  29720  A145    3169\n",
      "...           ...      ...         ...    ...   ...     ...\n",
      "91457   361347140       40  1398/06/23  68482   M43    3656\n",
      "91458  1580935445       40  1398/06/23  68566   M43    3656\n",
      "91459  4270091250       40  1398/06/23  68722   M43    3656\n",
      "91460   361347140       40  1398/06/23  75815   M43    1632\n",
      "91461  2125271908       40  1398/06/23  75932   M43    1632\n",
      "\n",
      "[91462 rows x 6 columns]\n",
      "transactions in line 40 plat N159\n",
      "ps: \n",
      "              CardID  LineCode       FDate   Time  plat\n",
      "127826   427545710        40  1398/06/23  21887  N159\n",
      "127827  1361146165        40  1398/06/23  22086  N159\n",
      "127828   537659822        40  1398/06/23  22090  N159\n",
      "127829  2129163668        40  1398/06/23  22139  N159\n",
      "127830   428347118        40  1398/06/23  22354  N159\n",
      "...            ...       ...         ...    ...   ...\n",
      "320752   113607603        40  1398/06/23  75624  N159\n",
      "320753   177147958        40  1398/06/23  75852  N159\n",
      "320754  3183395918        40  1398/06/23  75982  N159\n",
      "320755  3183135646        40  1398/06/23  76560  N159\n",
      "127825  3791691884        40  1398/06/23  79579  N159\n",
      "\n",
      "[300 rows x 5 columns]\n",
      "first row of the selected chunck : \n",
      " [427545710 40 '1398/06/23' 21887 'N159']\n",
      "300\n",
      "t0 = 21887\n",
      "ts = 79579\n",
      "time_intervals 96\n",
      "Origin destination interval view reindex \n",
      "     time_in  time_out\n",
      "0   21887.0   22487.0\n",
      "1   23087.0   24287.0\n",
      "2   24887.0   25487.0\n",
      "3   26087.0   26687.0\n",
      "4   29087.0   30887.0\n",
      "5   32687.0   33287.0\n",
      "6   35087.0   36287.0\n",
      "7   38087.0   38687.0\n",
      "8   40487.0   41687.0\n",
      "9   45887.0   47687.0\n",
      "10  50087.0   50687.0\n",
      "11  52487.0   53087.0\n",
      "12  62687.0   64487.0\n",
      "13  67487.0   68087.0\n",
      "14  71087.0   73487.0\n",
      "15  77687.0   79487.0\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "OD bus stations of transactions: \n",
      "            CardID LineCode       FDate   Time  plat Station\n",
      "0       542446139        1  1398/06/23  24030  A145    3169\n",
      "1      2620656172        1  1398/06/23  24302  A145    3169\n",
      "2      3446252780        1  1398/06/23  26200  A145    1227\n",
      "3         7900260        1  1398/06/23  29677  A145    3169\n",
      "4       361857972        1  1398/06/23  29720  A145    3169\n",
      "...           ...      ...         ...    ...   ...     ...\n",
      "91581  3254608749       40  1398/06/23  64421  N159    3656\n",
      "91582  2498287373       40  1398/06/23  64468  N159    3656\n",
      "91583  2498287373       40  1398/06/23  64470  N159    3656\n",
      "91584   234120762       40  1398/06/23  67766  N159    1632\n",
      "91585  2137731405       40  1398/06/23  73073  N159    3656\n",
      "\n",
      "[91586 rows x 6 columns]\n",
      "transactions in line 40 plat N163\n",
      "ps: \n",
      "              CardID  LineCode       FDate   Time  plat\n",
      "376263   721741233        40  1398/06/23  26580  N163\n",
      "376264  3445622028        40  1398/06/23  26897  N163\n",
      "376265   209410139        40  1398/06/23  26925  N163\n",
      "376266   262721217        40  1398/06/23  26927  N163\n",
      "376267  3181279310        40  1398/06/23  26940  N163\n",
      "...            ...       ...         ...    ...   ...\n",
      "376779  3180038014        40  1398/06/23  44323  N163\n",
      "376780  2116918980        40  1398/06/23  44328  N163\n",
      "376781  3109211797        40  1398/06/23  44330  N163\n",
      "376783  1611965419        40  1398/06/23  44773  N163\n",
      "376782  3794481468        40  1398/06/23  44957  N163\n",
      "\n",
      "[116 rows x 5 columns]\n",
      "first row of the selected chunck : \n",
      " [721741233 40 '1398/06/23' 26580 'N163']\n",
      "116\n",
      "t0 = 26580\n",
      "ts = 44957\n",
      "time_intervals 31\n",
      "Origin destination interval view reindex \n",
      "    time_in  time_out\n",
      "0  26580.0   27180.0\n",
      "1  27780.0   29580.0\n",
      "2  32580.0   33780.0\n",
      "3  35580.0   36180.0\n",
      "4  37980.0   39180.0\n",
      "5  40980.0   42180.0\n",
      "6  43380.0   43980.0\n",
      "OD bus stations of transactions: \n",
      "            CardID LineCode       FDate   Time  plat Station\n",
      "0       542446139        1  1398/06/23  24030  A145    3169\n",
      "1      2620656172        1  1398/06/23  24302  A145    3169\n",
      "2      3446252780        1  1398/06/23  26200  A145    1227\n",
      "3         7900260        1  1398/06/23  29677  A145    3169\n",
      "4       361857972        1  1398/06/23  29720  A145    3169\n",
      "...           ...      ...         ...    ...   ...     ...\n",
      "91744  2509218676       40  1398/06/23  41907  N163    1632\n",
      "91745  2239133462       40  1398/06/23  41994  N163    1632\n",
      "91746  3108661893       40  1398/06/23  43833  N163    3656\n",
      "91747  3108661893       40  1398/06/23  43835  N163    3656\n",
      "91748  3154282270       40  1398/06/23  43849  N163    3656\n",
      "\n",
      "[91749 rows x 6 columns]\n",
      "transactions in line 40 plat N78\n",
      "ps: \n",
      "              CardID  LineCode       FDate   Time plat\n",
      "101137  2585433092        40  1398/06/23  23996  N78\n",
      "101138  1598303876        40  1398/06/23  24311  N78\n",
      "101139  1837923549        40  1398/06/23  24338  N78\n",
      "101140  1407183364        40  1398/06/23  24342  N78\n",
      "101141   983237403        40  1398/06/23  24354  N78\n",
      "...            ...       ...         ...    ...  ...\n",
      "80801   2508501924        40  1398/06/23  74209  N78\n",
      "80802   2508501924        40  1398/06/23  74211  N78\n",
      "80799   3153117262        40  1398/06/23  74212  N78\n",
      "216686  4266236178        40  1398/06/23  74213  N78\n",
      "80800   2491582852        40  1398/06/23  74218  N78\n",
      "\n",
      "[348 rows x 5 columns]\n",
      "first row of the selected chunck : \n",
      " [2585433092 40 '1398/06/23' 23996 'N78']\n",
      "348\n",
      "t0 = 23996\n",
      "ts = 74218\n",
      "time_intervals 84\n",
      "Origin destination interval view reindex \n",
      "     time_in  time_out\n",
      "0   23996.0   24596.0\n",
      "1   25796.0   28196.0\n",
      "2   28796.0   32396.0\n",
      "3   34796.0   36596.0\n",
      "4   38996.0   39596.0\n",
      "5   42596.0   43196.0\n",
      "6   44396.0   44996.0\n",
      "7   45596.0   46196.0\n",
      "8   47996.0   48596.0\n",
      "9   49196.0   50396.0\n",
      "10  52796.0   53396.0\n",
      "11  56396.0   58196.0\n",
      "12  59396.0   60596.0\n",
      "13  63596.0   65996.0\n",
      "14  69596.0   71396.0\n",
      "OD bus stations of transactions: \n",
      "            CardID LineCode       FDate   Time  plat Station\n",
      "0       542446139        1  1398/06/23  24030  A145    3169\n",
      "1      2620656172        1  1398/06/23  24302  A145    3169\n",
      "2      3446252780        1  1398/06/23  26200  A145    1227\n",
      "3         7900260        1  1398/06/23  29677  A145    3169\n",
      "4       361857972        1  1398/06/23  29720  A145    3169\n",
      "...           ...      ...         ...    ...   ...     ...\n",
      "91814  1527193182       40  1398/06/23  71319   N78    3656\n",
      "91815  4278529394       40  1398/06/23  71336   N78    3656\n",
      "91816  2505017652       40  1398/06/23  71337   N78    3656\n",
      "91817   840270724       40  1398/06/23  71369   N78    3656\n",
      "91818   840270724       40  1398/06/23  71370   N78    3656\n",
      "\n",
      "[91819 rows x 6 columns]\n",
      "stations in a specefic bus line 41\n",
      "len-of-go stations: 28\n",
      "len-of-back stations: 30\n",
      "len-of-go back stations: 0\n",
      "first Station  [4190 '41' '1' 'go' '??? ????? ???? ???' 51.566755 32.681241 'od' 'normal'\n",
      " 'no'] 4190\n",
      "last Station  [1295 '41' '1' 'back' '?? ??? ???-85-41' 51.666631 32.659598 'od' 'normal'\n",
      " 'no']\n",
      "['A146' 'A164' 'B63' 'F163' 'F176' 'F46' 'F87' 'M11' 'M137' 'M60' 'M66'\n",
      " 'N157' 'N93']\n",
      "transactions in line 41 plat A146\n",
      "ps: \n",
      "              CardID  LineCode       FDate   Time  plat\n",
      "324171  3101678206        41  1398/06/23  32373  A146\n",
      "324172  3183377518        41  1398/06/23  32376  A146\n",
      "324168   472983082        41  1398/06/23  32379  A146\n",
      "324173  2742375524        41  1398/06/23  32440  A146\n",
      "324169  1506169518        41  1398/06/23  32482  A146\n",
      "...            ...       ...         ...    ...   ...\n",
      "348041  1524870436        41  1398/06/23  73797  A146\n",
      "348042   984076091        41  1398/06/23  73801  A146\n",
      "348043   174068518        41  1398/06/23  73805  A146\n",
      "348044  1524969172        41  1398/06/23  74648  A146\n",
      "348045   721777280        41  1398/06/23  74649  A146\n",
      "\n",
      "[377 rows x 5 columns]\n",
      "first row of the selected chunck : \n",
      " [3101678206 41 '1398/06/23' 32373 'A146']\n",
      "377\n",
      "t0 = 32373\n",
      "ts = 74649\n",
      "time_intervals 70\n",
      "Origin destination interval view reindex \n",
      "     time_in  time_out\n",
      "0   32373.0   32973.0\n",
      "1   34773.0   35973.0\n",
      "2   38973.0   40773.0\n",
      "3   44973.0   45573.0\n",
      "4   46773.0   48573.0\n",
      "5   50373.0   50973.0\n",
      "6   52773.0   55173.0\n",
      "7   56973.0   57573.0\n",
      "8   60573.0   62373.0\n",
      "9   67773.0   68973.0\n",
      "10  71373.0   71973.0\n",
      "OD bus stations of transactions: \n",
      "            CardID LineCode       FDate   Time  plat Station\n",
      "0       542446139        1  1398/06/23  24030  A145    3169\n",
      "1      2620656172        1  1398/06/23  24302  A145    3169\n",
      "2      3446252780        1  1398/06/23  26200  A145    1227\n",
      "3         7900260        1  1398/06/23  29677  A145    3169\n",
      "4       361857972        1  1398/06/23  29720  A145    3169\n",
      "...           ...      ...         ...    ...   ...     ...\n",
      "92071  3258060829       41  1398/06/23  62134  A146    4190\n",
      "92072  2681171844       41  1398/06/23  62224  A146    4190\n",
      "92073  2049628370       41  1398/06/23  62239  A146    4190\n",
      "92074  2128810244       41  1398/06/23  68808  A146    1295\n",
      "92075  3792870044       41  1398/06/23  71959  A146    4190\n",
      "\n",
      "[92076 rows x 6 columns]\n",
      "transactions in line 41 plat A164\n",
      "ps: \n",
      "              CardID  LineCode       FDate   Time  plat\n",
      "621065   173092246        41  1398/06/23  23106  A164\n",
      "621066  2742211844        41  1398/06/23  28468  A164\n",
      "621068  3405840459        41  1398/06/23  28866  A164\n",
      "621067   235379530        41  1398/06/23  28867  A164\n",
      "621069  3152071902        41  1398/06/23  28877  A164\n",
      "...            ...       ...         ...    ...   ...\n",
      "648204  1781731364        41  1398/06/23  77332  A164\n",
      "648264  3104390926        41  1398/06/23  77483  A164\n",
      "648265  3104390926        41  1398/06/23  77484  A164\n",
      "648266  2228618659        41  1398/06/23  77488  A164\n",
      "648267  2044379422        41  1398/06/23  77489  A164\n",
      "\n",
      "[459 rows x 5 columns]\n",
      "first row of the selected chunck : \n",
      " [173092246 41 '1398/06/23' 23106 'A164']\n",
      "459\n",
      "t0 = 23106\n",
      "ts = 77489\n",
      "time_intervals 91\n",
      "Origin destination interval view reindex \n",
      "    time_in  time_out\n",
      "0  23106.0   28506.0\n",
      "1  33906.0   36306.0\n",
      "2  42306.0   44106.0\n",
      "3  46506.0   47106.0\n",
      "4  50706.0   51906.0\n",
      "5  55506.0   58506.0\n",
      "6  63306.0   65106.0\n",
      "7  67506.0   68106.0\n",
      "8  71106.0   72306.0\n",
      "9  74706.0   75906.0\n",
      "OD bus stations of transactions: \n",
      "            CardID LineCode       FDate   Time  plat Station\n",
      "0       542446139        1  1398/06/23  24030  A145    3169\n",
      "1      2620656172        1  1398/06/23  24302  A145    3169\n",
      "2      3446252780        1  1398/06/23  26200  A145    1227\n",
      "3         7900260        1  1398/06/23  29677  A145    3169\n",
      "4       361857972        1  1398/06/23  29720  A145    3169\n",
      "...           ...      ...         ...    ...   ...     ...\n",
      "92358  4244868519       41  1398/06/23  75763  A164    1295\n",
      "92359  4244868519       41  1398/06/23  75764  A164    1295\n",
      "92360  3180760974       41  1398/06/23  75772  A164    1295\n",
      "92361  3180760974       41  1398/06/23  75773  A164    1295\n",
      "92362  3676105858       41  1398/06/23  75830  A164    1295\n",
      "\n",
      "[92363 rows x 6 columns]\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "transactions in line 41 plat B63\n",
      "ps: \n",
      "              CardID  LineCode       FDate   Time plat\n",
      "253656   473276602        41  1398/06/23  64831  B63\n",
      "253660   473276602        41  1398/06/23  64832  B63\n",
      "253663   473276602        41  1398/06/23  64833  B63\n",
      "253667  2138471693        41  1398/06/23  64887  B63\n",
      "253672  2138471693        41  1398/06/23  64888  B63\n",
      "...            ...       ...         ...    ...  ...\n",
      "50939   2137420445        41  1398/06/23  75191  B63\n",
      "279493   869229429        41  1398/06/23  75355  B63\n",
      "279577   235149530        41  1398/06/23  75650  B63\n",
      "279587   235149530        41  1398/06/23  75652  B63\n",
      "279597   721974049        41  1398/06/23  75867  B63\n",
      "\n",
      "[100 rows x 5 columns]\n",
      "first row of the selected chunck : \n",
      " [473276602 41 '1398/06/23' 64831 'B63']\n",
      "100\n",
      "t0 = 64831\n",
      "ts = 75867\n",
      "time_intervals 18\n",
      "Origin destination interval view reindex \n",
      "    time_in  time_out\n",
      "0  64831.0   65431.0\n",
      "1  67831.0   70231.0\n",
      "2  72031.0   73231.0\n",
      "OD bus stations of transactions: \n",
      "            CardID LineCode       FDate   Time  plat Station\n",
      "0       542446139        1  1398/06/23  24030  A145    3169\n",
      "1      2620656172        1  1398/06/23  24302  A145    3169\n",
      "2      3446252780        1  1398/06/23  26200  A145    1227\n",
      "3         7900260        1  1398/06/23  29677  A145    3169\n",
      "4       361857972        1  1398/06/23  29720  A145    3169\n",
      "...           ...      ...         ...    ...   ...     ...\n",
      "92672  3672266274       41  1398/06/23  73107   B63    4190\n",
      "92673  3210148644       41  1398/06/23  73195   B63    4190\n",
      "92674  3210148644       41  1398/06/23  73197   B63    4190\n",
      "92675   186100230       41  1398/06/23  73224   B63    4190\n",
      "92676   186100230       41  1398/06/23  73226   B63    4190\n",
      "\n",
      "[92677 rows x 6 columns]\n",
      "transactions in line 41 plat F163\n",
      "ps: \n",
      "             CardID  LineCode       FDate   Time  plat\n",
      "99935  2115869476        41  1398/06/23  23985  F163\n",
      "99936   722012704        41  1398/06/23  24054  F163\n",
      "99937  1458625125        41  1398/06/23  24059  F163\n",
      "99938  3179983150        41  1398/06/23  24184  F163\n",
      "99939  2117943972        41  1398/06/23  24187  F163\n",
      "...           ...       ...         ...    ...   ...\n",
      "52738   721990528        41  1398/06/23  78726  F163\n",
      "52739   869344637        41  1398/06/23  78770  F163\n",
      "52740  2506960548        41  1398/06/23  78864  F163\n",
      "52741  1408402329        41  1398/06/23  78945  F163\n",
      "52742   344580116        41  1398/06/23  80230  F163\n",
      "\n",
      "[516 rows x 5 columns]\n",
      "first row of the selected chunck : \n",
      " [2115869476 41 '1398/06/23' 23985 'F163']\n",
      "516\n",
      "t0 = 23985\n",
      "ts = 80230\n",
      "time_intervals 94\n",
      "Origin destination interval view reindex \n",
      "     time_in  time_out\n",
      "0   23985.0   24585.0\n",
      "1   28785.0   31185.0\n",
      "2   33585.0   34185.0\n",
      "3   36585.0   37785.0\n",
      "4   40785.0   41385.0\n",
      "5   44985.0   46185.0\n",
      "6   51585.0   54585.0\n",
      "7   58785.0   60585.0\n",
      "8   65385.0   66585.0\n",
      "9   68985.0   70185.0\n",
      "10  73185.0   74985.0\n",
      "11  75585.0   78585.0\n",
      "12  79785.0   80385.0\n",
      "OD bus stations of transactions: \n",
      "            CardID LineCode       FDate   Time  plat Station\n",
      "0       542446139        1  1398/06/23  24030  A145    3169\n",
      "1      2620656172        1  1398/06/23  24302  A145    3169\n",
      "2      3446252780        1  1398/06/23  26200  A145    1227\n",
      "3         7900260        1  1398/06/23  29677  A145    3169\n",
      "4       361857972        1  1398/06/23  29720  A145    3169\n",
      "...           ...      ...         ...    ...   ...     ...\n",
      "92763   211716923       41  1398/06/23  74981  F163    4190\n",
      "92764  3214958036       41  1398/06/23  78417  F163    1295\n",
      "92765  4270754578       41  1398/06/23  78487  F163    1295\n",
      "92766  3405840220       41  1398/06/23  78495  F163    1295\n",
      "92767   344580116       41  1398/06/23  80230  F163    4190\n",
      "\n",
      "[92768 rows x 6 columns]\n",
      "transactions in line 41 plat F176\n",
      "ps: \n",
      "              CardID  LineCode       FDate   Time  plat\n",
      "610799  2680400932        41  1398/06/23  36774  F176\n",
      "610800  2047799010        41  1398/06/23  36847  F176\n",
      "610795   721975642        41  1398/06/23  36850  F176\n",
      "610796  4270088706        41  1398/06/23  36862  F176\n",
      "610797   721715661        41  1398/06/23  36946  F176\n",
      "...            ...       ...         ...    ...   ...\n",
      "701954  2498346493        41  1398/06/23  76854  F176\n",
      "701955  1838076093        41  1398/06/23  77020  F176\n",
      "701956  1838076093        41  1398/06/23  77021  F176\n",
      "701957  2620632236        41  1398/06/23  77125  F176\n",
      "701958  3446854588        41  1398/06/23  78017  F176\n",
      "\n",
      "[337 rows x 5 columns]\n",
      "first row of the selected chunck : \n",
      " [2680400932 41 '1398/06/23' 36774 'F176']\n",
      "337\n",
      "t0 = 36774\n",
      "ts = 78017\n",
      "time_intervals 69\n",
      "Origin destination interval view reindex \n",
      "    time_in  time_out\n",
      "0  36774.0   37374.0\n",
      "1  43374.0   45174.0\n",
      "2  49374.0   50574.0\n",
      "3  52374.0   58374.0\n",
      "4  63774.0   65574.0\n",
      "5  67374.0   68574.0\n",
      "6  71574.0   73374.0\n",
      "7  75774.0   76974.0\n",
      "OD bus stations of transactions: \n",
      "            CardID LineCode       FDate   Time  plat Station\n",
      "0       542446139        1  1398/06/23  24030  A145    3169\n",
      "1      2620656172        1  1398/06/23  24302  A145    3169\n",
      "2      3446252780        1  1398/06/23  26200  A145    1227\n",
      "3         7900260        1  1398/06/23  29677  A145    3169\n",
      "4       361857972        1  1398/06/23  29720  A145    3169\n",
      "...           ...      ...         ...    ...   ...     ...\n",
      "93181   261221793       41  1398/06/23  76637  F176    1295\n",
      "93182   996757166       41  1398/06/23  76666  F176    1295\n",
      "93183  3553742796       41  1398/06/23  76722  F176    1295\n",
      "93184  2498346493       41  1398/06/23  76852  F176    1295\n",
      "93185  2498346493       41  1398/06/23  76854  F176    1295\n",
      "\n",
      "[93186 rows x 6 columns]\n",
      "transactions in line 41 plat F46\n",
      "ps: \n",
      "              CardID  LineCode       FDate   Time plat\n",
      "349594  2239118215        41  1398/06/23  25105  F46\n",
      "349596   180894214        41  1398/06/23  25109  F46\n",
      "566475  3104761054        41  1398/06/23  25129  F46\n",
      "349598  2855892478        41  1398/06/23  25178  F46\n",
      "349599   869364780        41  1398/06/23  25183  F46\n",
      "...            ...       ...         ...    ...  ...\n",
      "201033   869337034        41  1398/06/23  73929  F46\n",
      "201034  3254253213        41  1398/06/23  74002  F46\n",
      "201035  2137812797        41  1398/06/23  74442  F46\n",
      "201036  2137812797        41  1398/06/23  74447  F46\n",
      "201037  2137812797        41  1398/06/23  74450  F46\n",
      "\n",
      "[466 rows x 5 columns]\n",
      "first row of the selected chunck : \n",
      " [2239118215 41 '1398/06/23' 25105 'F46']\n",
      "466\n",
      "t0 = 25105\n",
      "ts = 74450\n",
      "time_intervals 82\n",
      "Origin destination interval view reindex \n",
      "     time_in  time_out\n",
      "0   25105.0   25705.0\n",
      "1   29905.0   32905.0\n",
      "2   35305.0   35905.0\n",
      "3   38905.0   41305.0\n",
      "4   43105.0   43705.0\n",
      "5   47305.0   47905.0\n",
      "6   48505.0   51505.0\n",
      "7   52105.0   55705.0\n",
      "8   60505.0   62305.0\n",
      "9   68905.0   69505.0\n",
      "10  71905.0   72505.0\n",
      "OD bus stations of transactions: \n",
      "            CardID LineCode       FDate   Time  plat Station\n",
      "0       542446139        1  1398/06/23  24030  A145    3169\n",
      "1      2620656172        1  1398/06/23  24302  A145    3169\n",
      "2      3446252780        1  1398/06/23  26200  A145    1227\n",
      "3         7900260        1  1398/06/23  29677  A145    3169\n",
      "4       361857972        1  1398/06/23  29720  A145    3169\n",
      "...           ...      ...         ...    ...   ...     ...\n",
      "93514  1598355956       41  1398/06/23  72401   F46    4190\n",
      "93515   721989457       41  1398/06/23  72439   F46    4190\n",
      "93516   233344970       41  1398/06/23  72442   F46    4190\n",
      "93517   641464554       41  1398/06/23  72485   F46    4190\n",
      "93518  2124746804       41  1398/06/23  72489   F46    4190\n",
      "\n",
      "[93519 rows x 6 columns]\n"
     ]
    }
   ],
   "source": [
    "import pandas as pd\n",
    "import numpy as np\n",
    "from sklearn.cluster import KMeans\n",
    "\n",
    "\n",
    "station_geo = pd.read_csv('station_geo.csv')\n",
    "station_geo_numpy = station_geo.to_numpy()\n",
    "print('station_geo \\n', station_geo)\n",
    "zones = station_geo.district_n.unique()\n",
    "zones.sort()\n",
    "print('Zones : \\n ',zones)\n",
    "zoneNumbers = len(zones)\n",
    "print('Number of stations : ', len(zones))\n",
    "\n",
    "od_matrix = np.zeros((zoneNumbers, zoneNumbers))\n",
    "od_matrix_df = pd.DataFrame(od_matrix, index=zones, columns=zones)\n",
    "print('od_matrix_df \\n', od_matrix_df)\n",
    "\n",
    "bus_records_raw = pd.read_csv('bus7.csv')\n",
    "print ('bus_records_raw \\n',bus_records_raw)\n",
    "bus_records = bus_records_raw.drop_duplicates()\n",
    "print ('bus_records after remove duplicates \\n',bus_records)\n",
    "bus_records = bus_records.sort_values(by=['FDate','LineCode','plat','Time'], inplace=False,\n",
    "               ascending = [True, True,True,True])\n",
    "\n",
    "print(\"Get the bus_records after sorting:\\n\", bus_records)\n",
    "\n",
    "routes = pd.read_csv('routes.csv')\n",
    "print(\"Bus routes \\n\",routes)\n",
    "\n",
    "metro_records_raw = pd.read_csv('metro7.csv')\n",
    "print ('metro_records_raw \\n',metro_records_raw)\n",
    "metro_records = metro_records_raw.drop_duplicates()\n",
    "print ('metro_records after remove duplicates \\n',metro_records)\n",
    "metro_records = metro_records.sort_values(by=['FDate','gate_id','Time'], inplace=False,\n",
    "               ascending = [True, True,True])\n",
    "\n",
    "print(\"Get the metro_records after sorting:\\n\", metro_records)\n",
    "\n",
    "\n",
    "unique_Bus_Fdates = bus_records.FDate.unique()\n",
    "print(\"Fdates in Bus records \\n\",unique_Bus_Fdates)\n",
    "\n",
    "\n",
    "unique_metro_Fdates = metro_records.FDate.unique()\n",
    "print(\"Fdates in metro records \\n\",unique_metro_Fdates)\n",
    "\n",
    "for h in range(len(unique_Bus_Fdates)):\n",
    "    print('**** FDate**** ',unique_Bus_Fdates[h])\n",
    "    print('Bus transactions in fdate',unique_Bus_Fdates[h],'\\n')  \n",
    "    bus_transactions = bus_records.loc[bus_records['FDate'] == unique_Bus_Fdates[h]]\n",
    "    print(bus_transactions)\n",
    "    \n",
    "    \n",
    "    print('Metro transactions in fdate',unique_Bus_Fdates[h],'\\n')  \n",
    "    metro_transactions = metro_records.loc[metro_records['FDate'] == unique_Bus_Fdates[h]]\n",
    "    print(metro_transactions)\n",
    "    \n",
    "    #list of active bus lines in selected Fdate\n",
    "    l = bus_transactions.LineCode.unique()\n",
    "    print('unique Line Codes: \\n ',sorted(l))\n",
    "\n",
    "    print('unique plats: \\n ',bus_transactions.plat.unique())\n",
    "\n",
    "    buses_with_station = pd.DataFrame(columns=[\"CardID\",\"LineCode\",\"FDate\",\"Time\",\"plat\",\"Station\"])\n",
    "\n",
    "    for i in range(len(l)):\n",
    "       # print('transactions in lines',l[i])\n",
    "        s = bus_transactions.loc[bus_transactions['LineCode'] == l[i]]\n",
    "\n",
    "\n",
    "        line_num =str(int(l[i]))\n",
    "        print('stations in a specefic bus line',line_num)\n",
    "        filter_go_stations = routes.loc[(routes['line'] == line_num) & (routes['go_back'] =='go')]\n",
    "        filter_back_stations = routes.loc[(routes['line'] == line_num) & (routes['go_back'] =='back')]\n",
    "        filter_go_back_stations = routes.loc[(routes['line'] == line_num) & (routes['go_back'] =='go_back')]\n",
    "        print ('len-of-go stations:',len(filter_go_stations))\n",
    "        print ('len-of-back stations:',len(filter_back_stations))\n",
    "        print ('len-of-go back stations:',len(filter_go_back_stations))\n",
    "\n",
    "        if(len(filter_go_stations)==0 or len(filter_back_stations)==0):\n",
    "            continue\n",
    "\n",
    "        orig_station = filter_go_stations.to_numpy()[0][0]\n",
    "        dest_station =  filter_back_stations.to_numpy()[0][0]\n",
    "        print('first Station ',filter_go_stations.to_numpy()[0],filter_go_stations.to_numpy()[0][0])\n",
    "        print('last Station ',filter_back_stations.to_numpy()[0])\n",
    "\n",
    "        print(s.plat.unique())\n",
    "        p = s.plat.unique()\n",
    "\n",
    "        for j in range(len(p)):\n",
    "\n",
    "            print('transactions in line',l[i],'plat',p[j])\n",
    "            ps  = bus_transactions.loc[(bus_transactions['LineCode'] == l[i]) & (bus_transactions['plat'] ==p[j])]\n",
    "\n",
    "            print('ps: \\n ',ps)\n",
    "\n",
    "            ps.to_csv('ps_test.csv')\n",
    "\n",
    "            # For each buckets of transactions in a specific line and plat, we try to  cluster transaction in related station\n",
    "            # ps evaluate to buses in my previous code\n",
    "\n",
    "            buses_numpy = ps.to_numpy()\n",
    "            print('first row of the selected chunck : \\n',buses_numpy[0])\n",
    "\n",
    "            t0= buses_numpy[0][3]\n",
    "            ts=buses_numpy[len(buses_numpy)-1][3]\n",
    "            print(len(buses_numpy))\n",
    "            print('t0 =',t0)\n",
    "            print('ts =',ts)\n",
    "            time_interval = 600 #second for finding orgin or destination stations(over 10 minute)\n",
    "            interval_counts=round((ts-t0)/time_interval)\n",
    "            print('time_intervals',round((ts-t0)/time_interval))\n",
    "            counter=1\n",
    "            buses_counter=1\n",
    "            sum_count=0\n",
    "            interval_numpy = np.ones((interval_counts,2))\n",
    "\n",
    "            for k in range(len(interval_numpy)):\n",
    "                while buses_numpy[buses_counter][3]<(t0):\n",
    "                    sum_count= sum_count+1\n",
    "                    #print(buses_numpy[buses_counter][3],t0)\n",
    "                    #print('sum_count=',sum_count)\n",
    "                    buses_counter = buses_counter+1\n",
    "                interval_numpy[k]=(t0,sum_count)\n",
    "                t0 = t0+time_interval\n",
    "                sum_count =0\n",
    "            #print('10min interval view \\n for line',l[i],'plat',p[j],' \\n',interval_numpy)\n",
    "            np.savetxt(\"interval_numpy.csv\", interval_numpy, delimiter=\",\")\n",
    "            interval_numpy2 = interval_numpy.copy()\n",
    "\n",
    "            #Calculate 10min intervals to find origin or destinations - Each row means a go or back\n",
    "            df_bus_service = pd.DataFrame(columns=[\"time_in\",\"time_out\"])\n",
    "\n",
    "\n",
    "            len_interval_numpy =  len(interval_numpy) \n",
    "\n",
    "            for k in range(len(interval_numpy2)):\n",
    "                #print ('k ',k)\n",
    "                if interval_numpy[k][1]==0: \n",
    "                    if k==0: #first row\n",
    "                        in_time = interval_numpy2[k][0]\n",
    "                        out_time =interval_numpy2[k][0]+ time_interval\n",
    "                        bus_services_row =[in_time,out_time]\n",
    "                        df_bus_service.loc[len(df_bus_service)] = bus_services_row   \n",
    "                        #print('in if \\n',df_bus_service)\n",
    "                    elif interval_numpy2[k-1][1]==0:\n",
    "                        in_time = interval_numpy2[k-1][0]\n",
    "                        out_time =interval_numpy2[k][0]+ time_interval\n",
    "                        bus_services_row =[in_time,out_time]\n",
    "                        df_bus_service.loc[len(df_bus_service)] = bus_services_row  \n",
    "                        df_bus_service.loc[df_bus_service['time_in'] == in_time] = bus_services_row\n",
    "                        interval_numpy2[k][0] = interval_numpy2[k-1][0]  \n",
    "                        #print('finded in data : ',df_bus_service2.loc[df_bus_service2['time_in'] == in_time])\n",
    "                        #print('in elif else \\n',df_bus_service)\n",
    "                    else:\n",
    "                        in_time = interval_numpy2[k][0]\n",
    "                        out_time =interval_numpy2[k][0]+ time_interval\n",
    "                        bus_services_row =[in_time,out_time]\n",
    "                        df_bus_service.loc[len(df_bus_service)] = bus_services_row\n",
    "\n",
    "                        #print('in else \\n',df_bus_service)\n",
    "            df_bus_service = df_bus_service.drop_duplicates()\n",
    "            #print('Origin destination interval view \\n',df_bus_service)\n",
    "            df_bus_service = df_bus_service.reset_index(drop=True)\n",
    "            print('Origin destination interval view reindex \\n',df_bus_service)\n",
    "            df_bus_service.to_csv('origin_destiniation_head_times_test.csv')                                  \n",
    "\n",
    "            #Assign origin and destination stations to the transactions\n",
    "          #  buses_with_station = pd.DataFrame(columns=[\"TID\",\"Time\",\"StationID\",\"Is_OD\"])\n",
    "            station_Counter = 1\n",
    "            station_org_or_des = orig_station\n",
    "            #buses_with_station = pd.DataFrame(columns=[\"CardID\",\"LineCode\",\"FDate\",\"Time\",\"plat\",\"Station\"])\n",
    "\n",
    "            for k in range(len(df_bus_service)):     #Orgin_destination Staions\n",
    "                time_in_od = df_bus_service.loc[k][0] #start_in orgin or destination\n",
    "                time_out_od = df_bus_service.loc[k][1]#end_out orgin or destination\n",
    "                #print('time_in_od,time_out_od:',time_in_od,time_out_od)\n",
    "\n",
    "                if station_Counter<0:\n",
    "                    station_org_or_des=dest_station\n",
    "                else:\n",
    "                    station_org_or_des = orig_station\n",
    "\n",
    "                for m in range(len(buses_numpy)):\n",
    "                    #print(buses_numpy[j][1])\n",
    "                    #buses_numpy[i][1]<=(time_in_od) and [bus_counter][1]>(time_out_od)\n",
    "                    #print('added',buses_numpy[bus_counter][1])\n",
    "                    #bus_station_row = [buses_numpy[bus_counter][0],buses_numpy[bus_counter][1],station_Counter,'yes']\n",
    "\n",
    "                    if(buses_numpy[m][3]>=(time_in_od) and buses_numpy[m][3]<=(time_out_od)):\n",
    "                        #print([buses_numpy[j][0],buses_numpy[j][1],station_Counter,'yes'])\n",
    "                        buses_with_station.loc[len(buses_with_station)]=[buses_numpy[m][0],buses_numpy[m][1],buses_numpy[m][2],buses_numpy[m][3],buses_numpy[m][4],station_org_or_des]\n",
    "                        #print('numpy len before delete:',len(buses_numpy))\n",
    "\n",
    "                        #print('np delete',np.delete(buses_numpy, m, axis=0))\n",
    "                        #print('numpy len after delete:',len(buses_numpy))\n",
    "                station_Counter= -station_Counter\n",
    "                #print('station_counter',station_Counter)\n",
    "            #first attempt to update stations of transactions - only orgin or destination\n",
    "            print('OD bus stations of transactions: \\n',buses_with_station)\n",
    "            buses_with_station.to_csv('OD_BUS_Stations_test.csv')\n",
    "\n",
    "            station_Counter = 1\n",
    "\n",
    "            ##dd\n",
    "            for k in range(len(df_bus_service)-1):     #Other Staions\n",
    "\n",
    "                time_start = df_bus_service.loc[k][1]#end_out orgin or destination\n",
    "                time_stop = df_bus_service.loc[k+1][0] #start_in orgin or destination\n",
    "                #print('time_start','time_stop',time_start,time_stop)\n",
    "                station_Counter = station_Counter+1\n",
    "                df_bus_partial = pd.DataFrame(columns=[\"CardID\",\"LineCode\",\"FDate\",\"Time\",\"plat\"])\n",
    "                for m in range(len(buses_numpy)):\n",
    "                    #print(buses_numpy[j][1])\n",
    "                    #buses_numpy[i][1]<=(time_in_od) and [bus_counter][1]>(time_out_od)\n",
    "                    #print('added',buses_numpy[bus_counter][1])\n",
    "                    #bus_station_row = [buses_numpy[bus_counter][0],buses_numpy[bus_counter][1],station_Counter,'yes']\n",
    "\n",
    "                    if(buses_numpy[m][3]>(time_start) and buses_numpy[m][3]<(time_stop)):\n",
    "                        #print([buses_numpy[j][0],buses_numpy[j][1],station_Counter,'no'])\n",
    "                        df_bus_partial.loc[len(df_bus_partial)]=[buses_numpy[m][0],buses_numpy[m][1],buses_numpy[m][2],buses_numpy[m][3],buses_numpy[m][4]]\n",
    "                       # buses_with_station.loc[len(buses_with_station)]=[buses_numpy[j][0],buses_numpy[j][1],station_Counter,'yes']\n",
    "                #print('df_bus_partial : \\n',df_bus_partial)\n",
    "\n",
    "                partial_times = df_bus_partial[[\"Time\",\"LineCode\"]]\n",
    "                numpy_df_bus_partial = df_bus_partial.to_numpy()\n",
    "                #print(partial_times)\n",
    "\n",
    "\n",
    "                if station_Counter<0: #Back\n",
    "                  station_org_or_des=dest_station\n",
    "\n",
    "                  if(len(df_bus_partial) >=len(filter_back_stations)):\n",
    "                    #print('if(len(df_bus_partial) >=len(filter_back_stations))')\n",
    "                    #We remove OD destinatio form filter_back_stations \n",
    "                    kmeans = KMeans(n_clusters=len(filter_back_stations)-1,random_state=0).fit(partial_times.to_numpy())\n",
    "                    #print('kmeans.labels_ in back routes',kmeans.labels_)\n",
    "\n",
    "                    kmeansLabels = pd.DataFrame(kmeans.labels_,columns=[\"label\"])\n",
    "                    print('kmeansLabels \\n',kmeansLabels.label.unique())\n",
    "                    uniqLabels = kmeansLabels.label.unique()\n",
    "                    for n in range(len(uniqLabels)):\n",
    "                      #print(uniqLabels[n])\n",
    "                      filteredLabels = kmeansLabels.loc[kmeansLabels['label'] == uniqLabels[n]]\n",
    "                      #print('filteredLabels',filteredLabels)\n",
    "                      for z in range(len(filteredLabels)):\n",
    "                        buses_with_station.loc[len(buses_with_station)]=[numpy_df_bus_partial[z][0],numpy_df_bus_partial[z][1],numpy_df_bus_partial[z][2],numpy_df_bus_partial[z][3],numpy_df_bus_partial[z][4],filter_go_stations.to_numpy()[n+1][0]]\n",
    "                        #print('partial entery :',numpy_df_bus_partial[z][0],numpy_df_bus_partial[z][1],numpy_df_bus_partial[z][2],numpy_df_bus_partial[z][3],numpy_df_bus_partial[z][4],filter_go_stations.to_numpy()[n+1][0])\n",
    "\n",
    "                else:   #Go\n",
    "                  station_org_or_des = orig_station\n",
    "                  if(len(df_bus_partial) >=len(filter_go_stations)):\n",
    "                    #print('if(len(df_bus_partial) >=len(filter_go_stations))')\n",
    "                    #We remove OD destinatio form filter_back_stations\n",
    "                    kmeans = KMeans(n_clusters=len(filter_go_stations)-1,random_state=0).fit(partial_times.to_numpy())\n",
    "                    #print('kmeans.labels_ in go routes',kmeans.labels_)\n",
    "\n",
    "                    kmeansLabels = pd.DataFrame(kmeans.labels_,columns=[\"label\"])\n",
    "                    #print('kmeansLabels \\n',kmeansLabels.label.unique())\n",
    "                    uniqLabels = kmeansLabels.label.unique()\n",
    "                    for n in range(len(uniqLabels)):\n",
    "                      #print(uniqLabels[n])\n",
    "                      filteredLabels = kmeansLabels.loc[kmeansLabels['label'] == uniqLabels[n]]\n",
    "                      #print('filteredLabels',filteredLabels)\n",
    "                      for z in range(len(filteredLabels)):\n",
    "                        buses_with_station.loc[len(buses_with_station)]=[numpy_df_bus_partial[z][0],numpy_df_bus_partial[z][1],numpy_df_bus_partial[z][2],numpy_df_bus_partial[z][3],numpy_df_bus_partial[z][4],filter_go_stations.to_numpy()[n+1][0]]\n",
    "                        #print('partial entery :',numpy_df_bus_partial[z][0],numpy_df_bus_partial[z][1],numpy_df_bus_partial[z][2],numpy_df_bus_partial[z][3],numpy_df_bus_partial[z][4],filter_go_stations.to_numpy()[n+1][0])\n",
    "                      #print('bus partial with all stations : \\n',df_bus_partial)\n",
    "                #df_bus_partial.to_csv(\"bus_partial\"+str(i)+\".csv\")\n",
    "\n",
    "                #kmeans = KMeans(n_clusters=10).fit(df_bus_partial.to_numpy())\n",
    "\n",
    "\n",
    "                #print(kmeans.labels_)\n",
    "        #buses_with_station.to_csv(\"bus_with_station980623_L\"+str(l[i])+\".csv\")\n",
    "    #buses_with_station.to_csv(\"bus_with_station_\"+ str(l[i])+\"_\"+ str(p[j])+\".csv\")\n",
    "    buses_with_station.to_csv(\"bus_with_station\"+str(h)+\".csv\")\n",
    "    \n",
    "    #Now we try to integrate bus transactions  with merto transactions on the stations\n",
    "    \n",
    "    bus_with_station = bus_with_station.drop_duplicates()\n",
    "    #print ('bus_with_station \\n ', bus_with_station)\n",
    "\n",
    "    bus_with_station_filter = bus_with_station[[\"CardID\", \"FDate\",\"Time\",\"Station\"]]\n",
    "    print('bus_with_station_filter \\n',bus_with_station_filter)\n",
    "\n",
    "    #metro_transactions = metro_transactions.rename(columns = {'gate_id':'Station'}, inplace = True)\n",
    "    metro_transactions = metro_transactions.reindex(columns=['CardID', 'FDate', 'Time','gate_id'])\n",
    "    metro_transactions.columns = metro_transactions.columns.str.replace(\"gate_id\", \"Station\")\n",
    "    print('metro_transactions \\n ', metro_transactions)\n",
    "\n",
    "    metro_bus_merge = pd.concat([metro_transactions, bus_with_station_filter])\n",
    "    print('concat \\n', metro_bus_merge)\n",
    "\n",
    "    uniqueCardIds = metro_bus_merge.CardID.unique()\n",
    "\n",
    "    print('unique cardIDs: \\n ',metro_bus_merge.CardID.unique())\n",
    "    print(len(uniqueCardIds))\n",
    "\n",
    "\n",
    "    for i in range(len(uniqueCardIds)):\n",
    "       # print('transactions in lines',l[i])\n",
    "        s = metro_bus_merge.loc[metro_bus_merge['CardID'] == uniqueCardIds[i]]\n",
    "        s = s.sort_values('Time')\n",
    "        s_numpy = s.to_numpy()\n",
    "        if(len(s)>1 and len(s)<9):\n",
    "            print(' \\n CardID : ',uniqueCardIds[i])\n",
    "            print('With stations: \\n',s)\n",
    "            #print('Without staions: \\n',bus_transactions.loc[bus_transactions['CardID'] == uniqueCardIds[i]])\n",
    "\n",
    "            for j in range(len(s)-1):\n",
    "                if ((s_numpy[j+1][2]- s_numpy[j][2])>600):#10min\n",
    "                    print('we find an arch : ', s_numpy[j][3],'-->', s_numpy[j+1][3])\n",
    "                    #maxtrix_OD_desc.loc[len(maxtrix_OD_desc)]=[s_numpy[j][1],s_numpy[j][3],s_numpy[j][2],s_numpy[j][5],s_numpy[j][4],s_numpy[j][6],s_numpy[j+1][2],s_numpy[j+1][5],s_numpy[j+1][4],s_numpy[j+1][6]]\n",
    "                    #od_matrix[1096][1096] = 3\n",
    "                    s1  = station_geo.loc[(station_geo['station_co'] == s_numpy[j][3])]\n",
    "                    s2=   station_geo.loc[(station_geo['station_co'] == s_numpy[j+1][3])]\n",
    "                    print('s1 = \\n ',s1)\n",
    "                    print('s2 = \\n',s2)\n",
    "                    z1 = int(s1.to_numpy()[0][1])\n",
    "                    z2 = int(s2.to_numpy()[0][1])\n",
    "                    if z1 != z2:\n",
    "                       print('z1,z2 ',z1,':',z2)\n",
    "                       print(od_matrix_df.at[z1, z2])\n",
    "                       od_matrix_df.at[z1, z2] = od_matrix_df.at[z1, z2]+1\n",
    "    print('mod_matrix: after  \\n ',od_matrix_df)\n",
    "    od_matrix_df.to_csv(\"od_matrix_df_\"+str(h)+\".csv\")    \n",
    "od_matrix_df.to_csv(\"od_matrix_df.csv\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "e83d2c14",
   "metadata": {},
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "bbb12097",
   "metadata": {},
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3 (ipykernel)",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.9.7"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
